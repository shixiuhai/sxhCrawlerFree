(()=>{"use strict";class t{static saveLocal(t,e){if("undefined"!=typeof TKLocalStorage&&Ut.supportMinimumTKVersion("4.0.0"))try{(new TKLocalStorage).set(t,e)}catch(i){}}static getLocalString(t){if("undefined"!=typeof TKLocalStorage&&Ut.supportMinimumTKVersion("4.0.0"))try{let e=(new TKLocalStorage).get(t);if(e)return e.toString()}catch(e){}return null}static getLocalInt(t){if("undefined"!=typeof TKLocalStorage&&Ut.supportMinimumTKVersion("4.0.0"))try{let e=(new TKLocalStorage).get(t);if(e)return Number.parseInt(e.toString())}catch(e){}return 0}static getLocalBoolean(t){if("undefined"!=typeof TKLocalStorage&&Ut.supportMinimumTKVersion("4.0.0"))try{let e=(new TKLocalStorage).get(t);if(e)return Boolean(e.toString)}catch(e){}return!1}}let e=null;const i="TKResIndexKey";class n{constructor(){var e,n,s;this.defaultHost="p1-lm.adukwai.com",this.currentIndex=0;let a=null===(s=null===(n=null===(e=Tt())||void 0===e?void 0:e.appConfig)||void 0===n?void 0:n.idc)||void 0===s?void 0:s.tkres;a&&0!=a.length||(a=["p1-lm.adukwai.com","p2-lm.adukwai.com"]),this.resList=a;let o=t.getLocalInt(i);o>a.length&&(o=0),this.currentIndex=o}static getInstance(){return e||(e=new n),e}getCurrentHost(){return this.currentIndex>=this.resList.length?this.defaultHost:this.resList[this.currentIndex]}markUrlFail(e){if(!(e.indexOf(this.getCurrentHost())<0||"undefined"!=typeof KSAdTKNetworkManager&&0==KSAdTKNetworkManager.getCurrentNetworkType())){const e=this.currentIndex;this.currentIndex=++this.currentIndex%this.resList.length,this.currentIndex!==e&&t.saveLocal(i,this.currentIndex)}}}var s,a;!function(t){t.START="start",t.CENTRT="center",t.END="end"}(s||(s={})),function(t){t[t.unknown=0]="unknown",t[t.DetailOne=1]="DetailOne",t[t.Simple=2]="Simple",t[t.DetailTwo=3]="DetailTwo"}(a||(a={}));var o,l,h;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.PRODUCT=1]="PRODUCT",t[t.EVENT=2]="EVENT",t[t.COUPON=3]="COUPON",t[t.PRODUCT_DEEP_VIDEO=4]="PRODUCT_DEEP_VIDEO"}(o||(o={}));!function(t){t[t.RETAIN_CARD_TYPE_1=8]="RETAIN_CARD_TYPE_1",t[t.RETAIN_CARD_TYPE_2=9]="RETAIN_CARD_TYPE_2",t[t.RETAIN_CARD_TYPE_3=10]="RETAIN_CARD_TYPE_3",t[t.RETAIN_CARD_TYPE_4=11]="RETAIN_CARD_TYPE_4",t[t.RETAIN_CARD_TYPE_5=14]="RETAIN_CARD_TYPE_5",t[t.RETAIN_CARD_TYPE_7=16]="RETAIN_CARD_TYPE_7",t[t.RETAIN_CARD_TYPE_8=17]="RETAIN_CARD_TYPE_8",t[t.RETAIN_CARD_TYPE_9=18]="RETAIN_CARD_TYPE_9",t[t.RETAIN_CARD_TYPE_10=19]="RETAIN_CARD_TYPE_10",t[t.RETAIN_CARD_TYPE_11=20]="RETAIN_CARD_TYPE_11"}(l||(l={}));class r{}!function(t){t[t.UNKNOWN_LIVE_ROOM_PATTERN=0]="UNKNOWN_LIVE_ROOM_PATTERN",t[t.STANDARD_LIVE_ROOM_PATTERN=1]="STANDARD_LIVE_ROOM_PATTERN",t[t.SIMPLIFIED_LIVE_ROOM_PATTERN=2]="SIMPLIFIED_LIVE_ROOM_PATTERN"}(h||(h={}));class d{}var c,p,m;!function(t){t[t.LIVE_CUT3_STYLE1=11]="LIVE_CUT3_STYLE1",t[t.LIVE_CUT3_STYLE2=12]="LIVE_CUT3_STYLE2"}(c||(c={})),function(t){t[t.LIVE_CUT3_STYLE2=1]="LIVE_CUT3_STYLE2"}(p||(p={})),function(t){t[t.unkonwn=0]="unkonwn",t[t.videoPromoteFollow=1]="videoPromoteFollow",t[t.videoPromoteGoods=2]="videoPromoteGoods",t[t.liveGoods=3]="liveGoods",t[t.liveNotGoods=4]="liveNotGoods",t[t.videoAd=5]="videoAd"}(m||(m={}));function u(t){try{const e=t.adMatrixInfo.adDataV2.styleComponentInfo;if(e&&e.styleComponentFlag)return!0}catch(e){}return!1}function w(t,e,i){if(console.log("tkloadcontroller target componentName:"+e+" slotId:"+i),Dt(e)&&!Ft(i))try{const n=t.adMatrixInfo.adDataV2.componentDatas.length;for(let s=0;s<n;s++){let n=t.adMatrixInfo.adDataV2.componentDatas[s];if(n.componentName==e&&n.slotId==i)return n}}catch(n){}}function g(t){try{if(t)return JSON.parse(t.data)}catch(e){}}function C(t,e,i=!0){try{const n=t.adMatrixInfo.adDataV2.styleComponentInfo;let s={component_id:e.componentId,combination_id:i?n.playCardInfo.combinationIds:n.endCardInfo.combinationIds,page_id:i?n.playCardInfo.pageId:n.endCardInfo.pageId};return JSON.stringify(s)}catch(n){return""}}class f{static isClickReward(t,e){try{let i=!0;if(Ut.isAndroid()&&!Ft(e)&&(i=e.sdkApiVersionCode>=3032401),t.adBaseInfo.extraClickReward&&i)return!0}catch(i){}return!1}static isEcOrder(t,e){try{return 1==t.abConfig.ecRewardAdKwaishopStyle&&(4==e.adStyleConfInfo.innerAdType||5==e.adStyleConfInfo.innerAdType)}catch(i){}return!1}static isOriginLiveAd(t){return 1==t.adBaseInfo.universeLiveType&&0!=t.advertiserInfo.userId}static getAuthorId(t){try{return t.advertiserInfo.userId||0}catch(e){return 0}}static getLiveStreamId(t){try{return t.adBaseInfo.liveStreamId||""}catch(e){return""}}static getLiveServiceToken(t){try{return t.adConversionInfo.liveServiceToken||""}catch(e){return""}}static getLiveUserId(t){try{return t.adConversionInfo.liveVisitorId||0}catch(e){return 0}}static getIconUrl(t){let e=t.adBaseInfo.appIconUrl;return!Ft(e)&&f.isDownloadInteraction(t)||(e=t.advertiserInfo.portraitUrl),Ft(e)&&(e="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),e}static isDownloadInteraction(t){return 1==t.adBaseInfo.adOperationType}static getAdTitle(t){let e=null;try{e=1==t.adBaseInfo.adOperationType?t.adBaseInfo.appName:t.adBaseInfo.productName,e=Dt(e)?e:t.advertiserInfo.rawUserName}catch(i){}return e=Dt(e)?e:"可爱的广告君",e}static getAdActionDesc(t){if(Ft(t))return"查看详情";let e=t.adBaseInfo.adActionDescription;return Ft(e)&&(e=this.isDownloadInteraction(t)?"立即下载":"查看详情"),e}static obtainVideoLiveData(t){let e=W(t,14);return JSON.parse(e.data)}static liveGetAuthorName(t,e){let i="";try{i=t.neoLiveAuthorInfoData.authorName}catch(n){}try{Ft(i)&&(i=t.neoLiveCartDetailData.authorName)}catch(n){}try{Ft(i)&&(i=e.adBaseInfo.appName)}catch(n){}return i}static liveGetLiveDesc(t,e){let i="";try{i=t.neoLiveCartDetailData.liveDesc}catch(n){}try{Ft(i)&&(i=t.neoLiveAuthorInfoData.liveDesc)}catch(n){}try{Ft(i)&&(i=t.adDescription)}catch(n){}try{Ft(i)&&(i=e.adBaseInfo.adDescription)}catch(n){}return i}static getNeoActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.neoTKInfo.actionBarCardType;if(!Ft(e))return e}catch(e){}return null}static getFullscreenActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.fullScreenInfo.actionBarCardType;if(!Ft(e))return e}catch(e){}return null}static getNeoAutoDialogType(t){var e;if(u(t)){if(w(t,"reward-dialog-common",5))return 1;if(w(t,"reward-dialog-fund",5))return 2}else try{let i=0;if(f.isOriginLiveAd(t))i=null===(e=t.adMatrixInfo.adDataV2.videoLiveTKInfo)||void 0===e?void 0:e.neoAutoDialogType;else{let e=S(t);i=1==e?t.adMatrixInfo.adDataV2.neoTKInfo.neoAutoDialogType:2==e?t.adMatrixInfo.adDataV2.videoImageTKInfo.neoAutoDialogType:0}1!=i&&2!=i&&(i=0);let n=function(t){if(null==t)return null;try{let e=null;if(f.isOriginLiveAd(t))e=H(t,14);else{let i=S(t);2==i?e=H(t,16):1==i&&(e=H(t,12))}if(e){let i=et(e,t);return JSON.parse(i.data).neoAutoDialog}}catch(e){}return null}(t);return 1==i&&Ft(n.neoAutoDialogGiftPic)&&Ft(n.neoAutoDialogGiftTitle)&&(i=0),i}catch(i){}return 0}static hasNeoAutoDialog(t){let e=f.getNeoAutoDialogType(t);return!Ft(e)&&0!=e}static newDeepVideoInteractCardInfo(t,e){if(Ft(t)||Ft(e))return null;let i;if(i=JSON.parse(JSON.stringify(Object.assign(t,e))),i.merchantStyleType=o.PRODUCT_DEEP_VIDEO,i.interactiveCardShowTime=0,i.rightsCardCustomImageUrl=t.icon,i.rightsCardCustomContent=t.name,i.rightsCardProductIconDesc="热卖",Ft(t.rating))i.rightsCardProductTags=t.serviceInfoList;else{let e=[t.rating];i.rightsCardProductTags=e.concat(t.serviceInfoList)}return i}}function v(t,e){if(!(null==t?void 0:t.impAdInfo)||0==t.impAdInfo.length)return null;let i=null;if(e)for(let n=0;n<t.impAdInfo.length;++n){let s=t.impAdInfo[n];if(s.adInfo.length>0&&s.adInfo[0].adBaseInfo.creativeId==e){i=s;break}}return i||(i=t.impAdInfo[0]),i}function y(t){var e;return(null===(e=null==t?void 0:t.adInfo)||void 0===e?void 0:e.length)>0?t.adInfo[0]:null}function V(t){if(!(null==t?void 0:t.impAdInfo)||0==t.impAdInfo.length)return null;const e=t.impAdInfo[0];return(null==e?void 0:e.adInfo)&&0!=e.adInfo.length?e.adInfo[0]:null}function I(t){let e;try{e=JSON.parse(t.adBaseInfo.expParam)}catch(i){}return e||{}}function T(t){let e=null;try{1==t.adBaseInfo.adOperationType&&Dt(t.adBaseInfo.appIconUrl)?e=t.adBaseInfo.appIconUrl:Dt(t.advertiserInfo.portraitUrl)&&(e=t.advertiserInfo.portraitUrl)}catch(i){}return e||"https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"}function S(t){try{return t.adMaterialInfo.materialFeature[0].featureType}catch(e){}return 0}function b(t){try{return function(t){try{return!Dt(t.firstFrame)||t.firstFrame.includes(".kpg")||t.firstFrame.includes(".webp")?Dt(t.coverUrl)?t.coverUrl:t.coverUrl||t.materialUrl||"":t.firstFrame}catch(e){}return""}(t.adMaterialInfo.materialFeature[0])}catch(e){}return""}function A(t){try{return t.adMaterialInfo.materialFeature[0].materialUrl}catch(e){}return""}function x(t){let e={width:0,height:0};try{const i=t.adMaterialInfo.materialFeature[0];1==i.featureType?(e.width=i.videoWidth,e.height=i.videoHeight):e=i.materialSize}catch(i){}return e.width>0&&e.height>0?e:{width:1280,height:720}}function k(t){try{return t.adMaterialInfo.materialFeature[0].videoDuration}catch(e){}return 0}function L(t){try{return 1==t.adBaseInfo.adOperationType}catch(e){}return!1}function _(t){let e=null;try{switch(t.adBaseInfo.adOperationType){case 1:e=t.adBaseInfo.appName;break;case 2:e=t.adBaseInfo.productName}Dt(e)||(e=t.advertiserInfo.rawUserName)}catch(i){}return e||"可爱的广告君"}function E(t){try{return t.adStyleConfInfo.innerAdType}catch(e){}return 0}function D(t){try{return t.adStyleConfInfo.actionBarType}catch(e){}return 0}function R(t){try{return t.adStyleConfInfo.endCardType}catch(e){}return 0}function P(t){let e=!1;try{e=4==t.adStyleConfInfo.innerAdType||5==t.adStyleConfInfo.innerAdType}catch(i){}return e}function B(t){let e=P(t)||function(t){let e=!1;try{e=3==t.adStyleConfInfo.innerAdType}catch(i){}return e}(t);return e}function F(t){let e=W(t,2);if(null!=e)return JSON.parse(e.data)}function M(t,e){let i=t.adAppUrl;return Dt(i)||(i=T(e)),i}function K(t,e){let i=t.adTitle;return Dt(i)||(i=_(e)),i}function O(t,e){let i=t.adDescription;return Dt(i)||(i=e.adBaseInfo.adDescription),i}function N(t){let e=null;try{if(e=t.advertiserInfo.fansCount,e>=200&&e<1e4)return e+"";if(e>=1e4)return e=(e/1e4).toFixed(1)+"w",e}catch(i){}return""}function z(t){return 1==E(t)}function H(t,e){let i;try{switch(e){case 1:i=t.adMatrixInfo.adDataV2.middleTKCardInfo.templateId;break;case 12:i=t.adMatrixInfo.adDataV2.neoTKInfo.templateId;break;case 3:i=t.adMatrixInfo.adDataV2.fullScreenInfo.templateId;break;case 2:i=t.adMatrixInfo.adDataV2.interstitialCardInfo.templateId;break;case 4:i=t.adMatrixInfo.adDataV2.topFloorTKInfo.templateId;break;case 6:case 9:i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId;break;case 5:i=t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.templateId;break;case 7:i=t.adMatrixInfo.adDataV2.activityMiddlePageInfo.templateId;break;case 10:i=t.adMatrixInfo.adDataV2.rewardVideoTaskInfo.templateId;break;case 11:i=t.adMatrixInfo.adDataV2.pushTKInfo.templateId;break;case 13:i=t.adMatrixInfo.adDataV2.splashEndCardTKInfo.templateId;break;case 14:i=t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId;break;case 15:i=t.adMatrixInfo.adDataV2.installedActivateInfo.templateId;break;case 16:i=t.adMatrixInfo.adDataV2.videoImageTKInfo.templateId;break;case 100:i=t.adMatrixInfo.adDataV2.complianceCardInfo.templateId;break;case 101:i=t.adMatrixInfo.adDataV2.downloadConfirmCardInfo.templateId;break;case 17:i=t.adMatrixInfo.adDataV2.feedTKCardInfo.templateId;break;default:i=void 0}}catch(n){i=void 0}return i}function W(t,e){let i=H(t,e);if(console.log("tkloadcontroller target templateid:"+i),!Dt(i))return;const n=t.adMatrixInfo.adDataV2.templateDatas.length;for(let s=0;s<n;s++){let e=t.adMatrixInfo.adDataV2.templateDatas[s];if(e.templateId==i)return e}}function U(t,e){let i=H(t,e);if(!i)return null;console.log("tkloadcontroller   get template is:"+i);const n=t.adMatrixInfo.styles.templates.length;for(let s=0;s<n;s++){let e=t.adMatrixInfo.styles.templates[s];if((null==e?void 0:e.templateId)==i)return e}return null}function G(t,e){let i=W(t,e);if(null!=i)return JSON.parse(i.data).autoCallAppInfo}function Y(t,e){let i=W(t,e);if(null!=i)return JSON.parse(i.data).downloadCardInfo}function j(t,e){let i=W(t,e);if(null!=i)return JSON.parse(i.data).cardDynamicEffects}function X(t){try{let e=t.autoOpenTime;return(e<=0||null==e)&&(e=3e3),e/1e3}catch(e){return 3}}function J(t){const e=t.adMaterialInfo.materialFeature.length>0?t.adMaterialInfo.materialFeature[0]:null;if(e){let n=e.videoDuration;0==n&&(n=e.videoDurationMs/1e3);let s=n;try{s=t.adRewardInfo.rewardTime}catch(i){}return s?0==n?s:Math.min(n,s):n}return-1}function $(t,e){let i=!0;if(1==t.adBaseInfo.adOperationType)try{let n=t.downloadSafeInfo.complianceInfo;if(console.log("tkloadcontroller   download ad:"+JSON.stringify(n)),null!=n)switch(e){case 1:i=3!=n.actionBarType;break;case 2:i=3!=n.describeBarType;break;case 3:i=3!=n.materialJumpType;break;default:i=!0}}catch(n){i=!0}else try{let n=t.unDownloadConf.unDownloadRegionConf;if(console.log("tkloadcontroller   h5 ad:"+JSON.stringify(n)+", clickArea: "+e),null!=n)switch(e){case 1:i=1!=n.actionBarType;break;case 2:i=1!=n.describeBarType;break;case 3:i=1!=n.materialJumpType;break;default:i=!0}console.log("tkloadcontroller   h5 ad:"+i)}catch(n){i=!0}return i}function Z(t){return 7==E(t)}function q(t){return f.isOriginLiveAd(t)||Z(t)}function Q(t){if(Ft(t))return"查看详情";let e=t.adBaseInfo.adActionDescription;return Ft(e)&&(e=L(t)?"立即下载":"查看详情"),e}function tt(t,e,i){try{if(!function(t,e){try{if(!Dt(t.adConversionInfo.playableUrl))return!1;const i=t.adConversionInfo.playableStyleInfo.playableOrientation;return 0==i||2==i&&1==e||1==i&&0==e}catch(i){}return!1}(t,i))return 0;if(3!=e){const e=I(t).playableStyle;return!e||e<=0?0:e}if(5==t.adMatrixInfo.adDataV2.actionBarInfo.cardType)return 1;if(6==t.adMatrixInfo.adDataV2.actionBarInfo.cardType)return 2}catch(n){}return 0}function et(t,e){try{let i=e.adMatrixInfo.adDataV2.templateDatas;for(let e=0;e<i.length;e++){let n=i[e];if(n&&t==n.templateId)return n}}catch(i){}}function it(t,e){let i=null,n=ht(t,e);return n&&(i=function(t,e){let i=W(t,e);if(null==i)return;return JSON.parse(i.data).redPacketInfo}(t,n)),i}function nt(t,e){let i=null,n=ht(t,e);return n&&(i=function(t,e){let i=W(t,e);if(null==i)return;return JSON.parse(i.data).merchantCardInfo}(t,n)),i}function st(t){let e=W(t,2);if(null!=e)return JSON.parse(e.data).creditsInfo}function at(t,e){let i=W(t,e);if(null==i)return;let n=JSON.parse(i.data),s=null;try{s=n.widgetInfo}catch(a){}return s}function ot(t,e){let i=null,n=ht(t,e);if(n){let e=at(t,n);e&&(i=e.redPacketInfo),i&&(i.showTime=1.5)}return i}function lt(t,e){let i=null,n=ht(t,e);return n&&(i=function(t,e){let i=W(t,e);if(null==i)return;return JSON.parse(i.data).giftBoxInfo}(t,n)),i}function ht(t,e){let i=null;try{if(function(t){let e=!1;try{e=1==t.adMatrixInfo.adDataV2.videoImageTKInfo.renderType}catch(i){}return e}(t))return 16;if(function(t){let e=!1;try{e=!Ft(t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId)}catch(i){}return e}(t))return 14;2==e?i=function(t){let e=!1;try{e=1==t.adMatrixInfo.adDataV2.neoTKInfo.renderType}catch(i){}return e}(t)?12:4:3==e?i=function(t){let e=!1;try{e=1==t.adMatrixInfo.adDataV2.fullScreenInfo.renderType}catch(i){}return e}(t)?3:4:13==e?i=2:4==e&&(i=5)}catch(n){}return i}function rt(t){if(Ut.isAndroid()){try{return t.shakeInfo.acceleration}catch(e){}return 12}{const i=[.35,.5,.65,.8,1,1.5,2];let n=5;try{n=t.shakeInfo.acceleration-1}catch(e){}return n<=0?n=5:n>=i.length&&(n=i.length-1),i[n]}}function dt(t,e){var i;if(!Ut.supportMinimumTKVersion("4.0.10"))return!1;let n=function(t,e){let i=U(t,e);return Ft(i)?null:i.templateUrl}(t,7);return!Ft(n)&&(null===(i=null==e?void 0:e.appConfig)||void 0===i?void 0:i.autoShowActivityMiddlePage)}function ct(t){if(null==t)return;let e=null;try{e=JSON.parse(t.data).merchantPlayInfo}catch(i){}return e}function pt(t){return!(!t.downloadSafeInfo||!Ut.isSupportDownloadDel())&&t.downloadSafeInfo.downloadDeleteEnable}function mt(t){return!!(L(t)&&t.downloadSafeInfo&&Ut.isSupportDownloadDel())&&t.downloadSafeInfo.downloadShowPauseEnable}var ut=null,wt=null,gt=null,Ct=null,ft=null;class vt{}function yt(t){console.log("tkloadcontroller  save global device info:"+JSON.stringify(t)),ut=t}function Vt(){return ft}function It(){return ut}function Tt(){return wt}function St(){return Ct}function bt(){const t=Tachikoma.env.styleTemplate;return t?JSON.parse(t):null}function At(t,e){e=e||bt(),t=t||V(St());const i=null==e?void 0:e.templateId,n=null==e?void 0:e.templateVersionCode,s=null==t?void 0:t.adTKGrayConfig,a=i+"#"+n;return(null==s?void 0:s.get(a))||0}function xt(t){return t instanceof Error?t.message+":"+t.stack:"string"==typeof t?t:"number"==typeof t?t+"":"unknown"}function kt(){return _t()?{left:0,top:0,bottom:0,right:0}:Tachikoma.env.safeAreaInsets}function Lt(){return!Ft(Tachikoma.env.hasTKBridge)&&1==Tachikoma.env.hasTKBridge}function _t(){return"Android"===Tachikoma.env.platform}function Et(t,e){let i={x:0,y:0};if(Ut.supportMinimumTKVersion("4.0.0")){const n=e.getLocationOnScreen(),s=t.position;if(!n||!s)return i;s.x=parseFloat((s.x+"").replace("dp","")),s.y=parseFloat((s.y+"").replace("dp","")),i={x:n.x+s.x,y:n.y+s.y}}return i}function Dt(t){return"string"==typeof t&&t.length>0}function Rt(){return ut?ut.tkVersion:Tachikoma.env.tkVersion||Tachikoma.env.TKVersion}function Pt(){return ut?ut.SDKVersion:Tachikoma.env.SDKVersion}function Bt(){return ut?ut.sdkType:Tachikoma.env.sdkType}function Ft(t){return null===t||null==t||""===t}function Mt(t){return!!Ft(t)||0==t.length}vt.matchParent="100%";new class{};class Kt{constructor(t,e,i){this.name=t,this.object=e,this.parent=i,this.children=new Map}addChildren(t,e){this.children.set(t,e)}}function Ot(t,e,i){if(t){e||(e=new Kt("root",t)),i||(i=new Set),i.add(t);for(const n in t){const s=typeof t[n],a=t[n];if("object"==s&&!n.includes("$")&&a){a.nativeID||(a.nativeID=n);const t=new Kt(n,a,e);if(e.addChildren(n,t),i.has(a)){const e=[];e.push(t);let i=t,n=!1;for(;i.parent;)if(i=i.parent,e.push(i),i.object===t.object){n=!0;break}if(n){let t="执行出错：发生循环引用\n";for(let n=e.length-1;n>=0;--n)i=e[n],t+=i.name+":"+i.object+"\n";throw new Error(t)}}Ot(a,t,i)}}}}function Nt(){return 1==Tachikoma.env.isDebug}function zt(t){let e=t;return e.indexOf("/")>=0||t.startsWith("http")||(e="https://"+n.getInstance().getCurrentHost()+"/kos/nlav111362/ksad/"+t),e}function Ht(t,e){!function(t,e,i){if(t&&e){const s=zt(e);t.setImageLoadCallback&&!Ft(s)&&s.startsWith("http")&&t.setImageLoadCallback((t=>{n.getInstance().markUrlFail(s),i&&i(t)})),t.setSrc(s)}}(t,e,null)}function Wt(t,e,i,s){let a=0;if(setTimeout((()=>{0==a&&(a=-1,s(!1))}),i),t&&e){const i=zt(e);t.setImageLoadCallback&&!Ft(i)&&i.startsWith("http")&&t.setImageLoadCallback((t=>{n.getInstance().markUrlFail(i),s&&0==a&&(a=1,s(t))})),t.setSrc(i)}}class Ut{static isAndroid(){return"Android"===this.platform}static isSupportDownloadProgressListen(){return this.isAndroid()||Ut.supportMinimumTKVersion("5.0.4")}static isSupportDownloadDel(){return this.isAndroid()&&Ut.supportMinimumTKVersion("5.0.7")}static getCurrentTimeStamp(){return(new Date).getTime()}static getSemiCircle(){return this.isAndroid()?180:Math.PI}static getRotateSemiCircle(){return this.isAndroid()?45:Math.PI}static compareVersion(t,e){if(void 0===t&&void 0===e)return 0;if(void 0===t)return-1;if(void 0===e)return 1;let i=t.split("."),n=e.split("."),s=Math.max(i.length,n.length);for(var a=0;a<s;a++){let t=Number(void 0!==i[a]?i[a]:"0"),e=Number(void 0!==n[a]?n[a]:"0");if(t>e)return 1;if(t!=e)return-1}return 0}static supportMinimumVersion(t="0.0.0",e="0.0.0"){let i=Bt(),n=1==i&&-1!=Ut.compareVersion(Pt(),t),s=2==i&&-1!=Ut.compareVersion(Pt(),e);return n||s}static supportCurrentVersion(t="0.0.0",e="0.0.0"){let i=Bt(),n=1==i&&0==Ut.compareVersion(Pt(),t),s=2==i&&0==Ut.compareVersion(Pt(),e);return n||s}static supportCurrentTKVersion(t="0.0.0"){return Rt()==t}static supportMinimumTKVersion(t="0.0.0"){return-1!=Ut.compareVersion(Rt(),t)}}function Gt(t){let e=0;switch(t.direction+""){case"down":case"8":e=4;break;case"up":case"4":e=1;break;case"left":case"2":e=2;break;case"right":case"1":e=3}return e}Ut.platform=Tachikoma.env.platform;zt("h5_default_icon.png"),zt("download_default_icon.png");const Yt=new class{constructor(){this.enabled=!1,this.logs=[]}setLoggerEnabled(t){this.enabled=t}log(t){if(this.enabled){const e=new Date;0==this.logs.length&&this.logs.push(e.getMonth()+1+":"+e.getDate()+"-"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.logs.push(e.getMilliseconds()+":"+t),Nt()&&console.log("tkloadcontroller:"+t)}}clear(){this.logs.splice(0,this.logs.length)}exportLog(){return JSON.stringify(this.logs)}};class jt{static randomString(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i="",n=0;n<t;n++)i+=e.charAt(Math.floor(48*Math.random()));return i}static randomName(t){return"jscb_"+t+"_"+this.randomString(4)+this.globalIndex++}static registerCallback(t,e=!0){return this.registerCallbackForAction(t,e,"")}static registerCallbackForAction(t,e=!0,i){if(!t)return null;const n=this.randomName(i);return Tachikoma[n]=e=>{t(e)},"Tachikoma."+n}}jt.globalIndex=0;class Xt{static getDeviceInfoAsync(){return Xt.callNative("getDeviceInfo",null).then((t=>(t.result&&t.data&&yt(t.data),t)))}static getKsAdDataAsync(){return Xt.callNative("getKsAdData",null).then((t=>{var e;return t.result&&t.data&&(e=t.data,Ct=e),t}))}static getKsAdConfigAsync(){return Xt.callNative("getKsAdConfig",null).then((t=>{var e;return t.result&&t.data&&(e=t.data,wt=e),t}))}static getScreenOrientationAsync(){return Xt.callNative("getScreenOrientation",null)}static getVideoCloseTime(){return Xt.callNative("getVideoCloseTime",null)}static getContainerLimitAsync(){return Xt.callNative("getContainerLimit",null)}static getTKPreEnvAsync(){return Xt.callNative("getTKPreEnv",null)}static getDeviceInfo(t){this.callNativeWithCallback("getDeviceInfo",null,t)}static getKsAdData(t){this.callNativeWithCallback("getKsAdData",null,t)}static getKsAdConfig(t){this.callNativeWithCallback("getKsAdConfig",null,t)}static getScreenOrientation(t){this.callNativeWithCallback("getScreenOrientation",null,t)}static getContainerLimit(t){return this.callNativeWithCallback("getContainerLimit",null,t)}static registerLifecycleListener(t){this.lifeStatusCallback=t,this.callNativeWithCallback("registerLifecycleListener",null,(t=>{this.lifeStatusCallback&&!this.isForceUpdateLifeStatus&&this.lifeStatusCallback(t)}),!1)}static forceUpdateLifeStatus(t,e){let i={result:1,data:{lifeStatus:t}};this.isForceUpdateLifeStatus=e,this.lifeStatusCallback&&this.lifeStatusCallback(i)}static registerFocusListener(t){Ut.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("registerFocusListener",null,t,!1)}static registerNativeId(t){this.callNativeWithCallback("configNativeId",null,t,!1)}static registerExtraDataListener(t){this.callNativeWithCallback("getKsAdExtraData",null,t,!1)}static hideCard(t,e,i,n=!0){this.callNativeWithCallback("hide",{type:t,playDuration:e},i,n)}static sendLog(t,e){this.callNativeWithCallback("log",t,e)}static sendCommonLog(t,e){this.callNativeWithCallback("commonLog",t,e)}static sendCommercialLog(t,e){this.callNativeWithCallback("commercialLog",t,e)}static adOutCallback(t,e){Ut.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("adOutCallback",t,e)}static pageStatus(t,e){this.callNativeWithCallback("pageStatus",{status:t,errorMsg:Dt(e)?e:""})}static clickActionBase(t,e){this.callNativeWithCallback("clickAction",t,e)}static convert(t){this.callNativeWithCallback("convert",{clickActionButton:t})}static updateExceptedPosition(t){this.callNativeWithCallback("initKsAdFrame",t)}static replayVideo(){this.callNativeWithCallback("replayVideo")}static registerVideoListener(t){this.callNativeWithCallback("registerVideoListener",null,t,!1)}static dislike(){this.callNativeWithCallback("dislike")}static registerProgressListener(t){this.callNativeWithCallback("registerProgressListener",null,(e=>{t&&t(e)}),!1)}static registerVideoProgressListener(t){this.callNativeWithCallback("registerVideoProgressListener",null,t,!1)}static registerGetDynamicActionDesListener(t){this.callNativeWithCallback("getDynamicActionDes",null,t,!1)}static registerTimerListener(t){this.callNativeWithCallback("registerTimerListener",null,t,!1)}static registerVideoMuteStateListener(t){this.callNativeWithCallback("registerMuteStateListener",null,t,!1)}static registerVideoAutoPlayListener(t){this.callNativeWithCallback("registerVideoAutoPlayListener",null,t,!1)}static registerPlayStateResetListener(t){this.callNativeWithCallback("registerPlayStateResetListener",null,t,!1)}static updateVideoMuteState(t){this.callNativeWithCallback("updateVideoMuteState",{muted:t})}static skipVideo(t,e,i,n=0){this.callNativeWithCallback("skipVideo",{needPromopt:t,needReport:e,showTime:i,playDuration:n})}static closeVideo(t){this.callNativeWithCallback("closeVideo",{forceClose:t})}static showPlayEnd(t,e=0){this.callNativeWithCallback("showPlayEnd",{userForce:t,type:e})}static showPlayable(t=0){this.callNativeWithCallback("showPlayable",{playableSource:t})}static registerSceneChangeListener(t){this.callNativeWithCallback("registerSceneChangeListener",null,t,!1)}static hasReward(t){this.callNativeWithCallback("hasReward",{severCheckResult:t})}static clickGift(){this.callNativeWithCallback("clickGift")}static clickCall(t){this.callNativeWithCallback("clickCall",{isEnd:t})}static callButtonImpressionWhenPlay(){this.callNativeWithCallback("callButtonImpressionWhenPlay")}static callButtonImpressionWhenFinish(){this.callNativeWithCallback("callButtonImpressionWhenFinish")}static registerDeepRewardListener(t){this.callNativeWithCallback("registerDeepRewardListener",null,t,!1)}static giveRewardInAdvance(t){this.callNativeWithCallback("giveRewardInAdvance",null,t,!1)}static showLiveEndPage(t){this.callNativeWithCallback("showLiveEndPage",null,t,!1)}static updateRewardTaskState(t){this.callNativeWithCallback("updateRewardTaskState",null,t,!1)}static openURL(t,e,i){this.callNativeWithCallback("openURL",{url:t,title:e,showConfirmDialog:i})}static showTKDialog(t){this.callNativeWithCallback("showTKDialog",{templateId:t})}static closeTKDialog(t){this.callNativeWithCallback("closeTKDialog",{templateId:t})}static registerKeyboardChangeListener(t){this.callNativeWithCallback("registerKeyboardChangeListener",null,t,!1)}static registerShakeListener(t){this.callNativeWithCallback("registerMotionListener",null,t,!1)}static close(t){this.callNativeWithCallback("close",null,t,!1)}static closePassData(t,e){this.callNativeWithCallback("close",t,e,!1)}static registerConvertStatusListener(t){this.callNativeWithCallback("registerConvertStatusListener",null,t,!1)}static cardImpression(){this.callNativeWithCallback("cardImpression")}static getCardShowCount(t){this.callNativeWithCallback("getCardShowCount",null,t,!1)}static getNativeData(t,e){this.callNativeWithCallback("getNativeData",{target:t},e,!1)}static updateExtraReward(t){this.callNativeWithCallback("updateExtraReward",t)}static registerApkInstalledListener(t){this.callNativeWithCallback("registerApkInstalledListener",null,t,!1)}static showToast(t){this.callNativeWithCallback("showToast",{message:t})}static registerExtraDialogListener(t){this.callNativeWithCallback("registerExtraDialogListener",null,t,!1)}static getPlayEndType(t){this.callNativeWithCallback("getPlayEndType",null,t,!1)}static playableConvert(t){this.callNativeWithCallback("playableConvert",t)}static getKsPlayableAdData(t){this.callNativeWithCallback("getKsPlayableAdData",null,t)}static getKsPlayableDeviceInfo(t){this.callNativeWithCallback("getKsPlayableDeviceInfo",null,t)}static registerPlayableStatusListener(t){this.callNativeWithCallback("registerPlayableStatusListener",null,t,!1)}static getTrackAdStatus(t){this.callNativeWithCallback("getTrackAdStatus",null,t,!1)}static showLandingPage(t){this.callNative("showLandingPage",{needCloseNeo:t})}static needCloseNeo(t){this.callNativeWithCallback("needCloseNeo",{needClose:t})}static registerBackPressed(t){_t()&&this.callNativeWithCallback("registerBackPressedListener",null,t,!1)}static innerAdImpression(){this.callNativeWithCallback("adImpression",null)}static neoDidShowPlayAgain(){this.callNativeWithCallback("neoDidShowPlayAgain")}static showPlayAgain(){this.callNativeWithCallback("showPlayAgain")}static registerAggregationDataListener(t){this.callNativeWithCallback("registerAggregationDataListener",null,t,!1)}static getLandingPageInfo(t){this.callNativeWithCallback("getLandingPageInfo",null,t,!1)}static registerNeoStatusListener(t){this.callNativeWithCallback("registerNeoStatusListener",null,t,!1)}static callNative(t,e){return new Promise(((i,n)=>this.callNativeWithCallback(t,e,(t=>{t?(1!=t.result&&(t.result=null),i(t)):i({result:0,data:null})}))))}static callNativeWithCallback(t,e,i,n=!0){const s=Lt()?1:0;Lt()&&"pageStatus"==t||Lt()&&"registerLifecycleListener"==t?this.callNativeWithCallbackAndType(t,e,i,n,0):this.callNativeWithCallbackAndType(t,e,i,n,s)}static callTKWithCallback(t,e,i,n=!0){this.callNativeWithCallbackAndType(t,e,i,n,1)}static callNativeWithCallbackAndType(t,e,i,n=!0,s=0){if("undefined"==typeof KwaiAd)return Yt.log("undefined value KwaiAd"),void(i&&i({result:0,data:null}));Yt.log("call:"+t);let a=e=>{let n=0,s=null;try{let t=null;t="string"==typeof e?JSON.parse(e):e,n=t.result,s=t.data}catch(a){n=0,s=null}Yt.log("cb:"+t+"  r:"+n),i&&i({result:n,data:s})};const o=jt.registerCallbackForAction(a,n,t),l={action:t,data:JSON.stringify(e||{}),callback:!0===Tachikoma.env.useNewBridge?a:o};0==s?KwaiAd.callAdBridge(l):KwaiAd.callTKBridge(l)}}function Jt(){Xt.callNativeWithCallback("callbackAfterHandleAdClick",{})}class $t{}class Zt{constructor(){this.reward_type=-1,this.task_type=-1,this.task_step=-1}static createPageShowInstance(t,e,i){if(0==e||Ft(i))return null;if(i.loadDataTime<=0||i.downloadFinishTime<=0)return null;let n=this.INVALID_VALUE;if(e!=this.INVALID_VALUE){n=Date.parse((new Date).toString())-e,n<this.INVALID_VALUE&&(n=this.INVALID_VALUE)}let s=new Zt;return s.page_status=2,s.load_type=i.loadFromCache?2:1,s.render_duration_ms=n,s.download_type=i.downloadType,s.download_size=i.downloadSize,s.creative_id=t.adBaseInfo.creativeId,s.video_url=A(t),s.video_duration_ms=k(t),s}}function qt(t){ie({category:"ad_client_apm_log",biz:"AD_SPLASH",sub_biz:"OTHER",rate:1,suffixRatio:"",primaryKey:"status",event_id:"ad_sdk_splash_load",type:"EXECUTION_BIZ_TIME",msg:{status:8001,error_msg:t||""}})}function Qt(t,e,i){if(!Ut.supportMinimumTKVersion("5.0.9"))return;let n={status:13,material_type:t,material_render_state:e,ab_params:i},s=new Date;$t.videoCreateTime=s.getTime(),ie({category:"ad_client_error_log",biz:"AD_INTERSTITIAL",sub_biz:"OTHER",rate:1,suffixRatio:"",event_id:"ad_sdk_interstitial_load",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:n})}function te(t){if(!Ut.supportMinimumVersion("3.3.44","3.3.44"))return;let e=new Date;ie({category:"ad_client_apm_log",biz:"AD_INTERSTITIAL",sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_sdk_interstitial_play",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:{creative_id:t.adBaseInfo.creativeId,status:3,video_url:A(t),play_started_duration_ms:e.getTime()-$t.videoCreateTime,video_duration_ms:k(t)}})}function ee(t){ie({category:"ad_client_apm_log",biz:"AD_SPLASH",sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_sdk_splash_load",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:t})}function ie(t){Ut.supportMinimumTKVersion("4.0.4")&&(t.msg&&(t.msg.report_source=1),Xt.sendCommercialLog(t,(()=>{})))}function ne(t,e){if(!Ut.supportMinimumTKVersion("4.0.7"))return;const i=St(),n=function(t){return(null==t?void 0:t.impAdInfo)&&0!=t.impAdInfo.length?t.impAdInfo[0]:null}(i),s=V(St());let a=Object.assign(Object.assign({},function(t,e){var i,n;return{creative_id:null==t?void 0:t.adBaseInfo.creativeId,llsid:e,template_id:null===(i=bt())||void 0===i?void 0:i.templateId,version_code:null===(n=bt())||void 0===n?void 0:n.templateVersionCode,tk_publish_type:At(t,bt())}}(s,i.llsid)),{status:t,errorMsg:e});ie({category:"ad_client_apm_log",biz:se(n.adStyle),sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_tk_endpage_performance",tag:"ad_tk_endpage_performance",primaryKey:"status",type:"OTHER",msg:a})}function se(t){let e="OTHER";switch(t){case 3:e="AD_FULLSCREEN";break;case 2:e="AD_REWARD";break;case 4:e="AD_SPLASH";break;case 13:e="AD_INTERSTITIAL";break;case 1:e="AD_FEED";break;case 1e4:e="AD_NATIVE"}return e}Zt.INVALID_VALUE=-1;var ae,oe,le,he;!function(t){t[t.NONE=-1]="NONE",t[t.ACTION_BAR_CLICK=1]="ACTION_BAR_CLICK",t[t.UNKNOWN_ITEM_CLICK=0]="UNKNOWN_ITEM_CLICK",t[t.PORTRAIT_CLICK=13]="PORTRAIT_CLICK",t[t.COMMENT_CLICK=14]="COMMENT_CLICK",t[t.PLAY_END_ICON_CLICK=15]="PLAY_END_ICON_CLICK",t[t.PLAY_END_ICON_TITLE_CLICK=16]="PLAY_END_ICON_TITLE_CLICK",t[t.PLAY_END_ICON_DESCRIPTION_CLICK=17]="PLAY_END_ICON_DESCRIPTION_CLICK",t[t.COMMENT_DETAIL_CLICK=25]="COMMENT_DETAIL_CLICK",t[t.PLAY_END_ACTION_BAR_CLICK=26]="PLAY_END_ACTION_BAR_CLICK",t[t.CARD_ACTION_BAR_CLICK=29]="CARD_ACTION_BAR_CLICK",t[t.CARD_ICON_CLICK=30]="CARD_ICON_CLICK",t[t.CARD_ICON_NAME_CLICK=31]="CARD_ICON_NAME_CLICK",t[t.CARD_ICON_COMMENT_CLICK=32]="CARD_ICON_COMMENT_CLICK",t[t.CARD_BLANK_AREA_CLICK=35]="CARD_BLANK_AREA_CLICK",t[t.CARD_PLAY_END_CLICK1=37]="CARD_PLAY_END_CLICK1",t[t.CARD_PLAY_END_CLICK2=38]="CARD_PLAY_END_CLICK2",t[t.PLAY_END_CALL_CLICK=39]="PLAY_END_CALL_CLICK",t[t.PLAY_DETAIL_CALL_CLICK=40]="PLAY_DETAIL_CALL_CLICK",t[t.PLAY_END_GIFT_CLICK=41]="PLAY_END_GIFT_CLICK",t[t.CARD_APP_STORE_CLICK=45]="CARD_APP_STORE_CLICK",t[t.CARD_APP_DOWNLOAD_NUM_CLICK=46]="CARD_APP_DOWNLOAD_NUM_CLICK",t[t.CARD_OTHERAREA_CLICK=53]="CARD_OTHERAREA_CLICK",t[t.CARD_ICON_MOBILE_CLICK=54]="CARD_ICON_MOBILE_CLICK",t[t.CARD_PICTURE_CLICK_ONE=57]="CARD_PICTURE_CLICK_ONE",t[t.CARD_PICTURE_CLICK_TWO=58]="CARD_PICTURE_CLICK_TWO",t[t.CARD_PICTURE_CLICK_THREE=59]="CARD_PICTURE_CLICK_THREE",t[t.CARD_PICTURE_TITLE_CLICK_ONE=60]="CARD_PICTURE_TITLE_CLICK_ONE",t[t.CARD_PICTURE_TITLE_CLICK_TWO=61]="CARD_PICTURE_TITLE_CLICK_TWO",t[t.CARD_PICTURE_TITLE_CLICK_THREE=62]="CARD_PICTURE_TITLE_CLICK_THREE",t[t.CARD_PICTURE_SUBTITLE_CLICK_ONE=63]="CARD_PICTURE_SUBTITLE_CLICK_ONE",t[t.CARD_PICTURE_SUBTITLE_CLICK_TWO=64]="CARD_PICTURE_SUBTITLE_CLICK_TWO",t[t.CARD_PICTURE_SUBTITLE_CLICK_THREE=65]="CARD_PICTURE_SUBTITLE_CLICK_THREE",t[t.CARD_RANK_CLICK=75]="CARD_RANK_CLICK",t[t.CARD_DOWNLOAD_CNT_CLICK=76]="CARD_DOWNLOAD_CNT_CLICK",t[t.CARD_TAG_CLICK=77]="CARD_TAG_CLICK",t[t.CARD_ITEM_BULLET_CLICK=80]="CARD_ITEM_BULLET_CLICK",t[t.CARD_RECOMMEND_REASON_CLICK=84]="CARD_RECOMMEND_REASON_CLICK",t[t.CARD_PAGE_CLICK=85]="CARD_PAGE_CLICK",t[t.COMMON_CARD_CLICK=89]="COMMON_CARD_CLICK",t[t.COMMENT_PICTURE_CLICK=100]="COMMENT_PICTURE_CLICK",t[t.PLAYEND_ICON_OTHERAREA_CLICK=104]="PLAYEND_ICON_OTHERAREA_CLICK",t[t.INTERACT_LANDING_PAGE_CLICK=110]="INTERACT_LANDING_PAGE_CLICK",t[t.ACTIONBAR_ICON_CLICK=115]="ACTIONBAR_ICON_CLICK",t[t.ACTIONBAR_ICON_COMMENT_CLICK=117]="ACTIONBAR_ICON_COMMENT_CLICK",t[t.ACTIONBAR_ICON_OTHER_AREA_CLICK=118]="ACTIONBAR_ICON_OTHER_AREA_CLICK",t[t.CLOSE_BULLET_ICON_CLICK=127]="CLOSE_BULLET_ICON_CLICK",t[t.CLOSE_BULLET_ICON_TITLE_CLICK=128]="CLOSE_BULLET_ICON_TITLE_CLICK",t[t.CLOSE_BULLET_ICON_DESCRIPTION_CLICK=129]="CLOSE_BULLET_ICON_DESCRIPTION_CLICK",t[t.CLOSE_BULLET_OTHERAREA_CLICK=130]="CLOSE_BULLET_OTHERAREA_CLICK",t[t.CLOSE_BULLET_ACTION_BAR_CLICK=131]="CLOSE_BULLET_ACTION_BAR_CLICK",t[t.SPLASH_CONVERSION_BUTTON_CLICK=132]="SPLASH_CONVERSION_BUTTON_CLICK",t[t.NEO_AUTO_SHOW_STOREKIT=147]="NEO_AUTO_SHOW_STOREKIT",t[t.CARD_LEFT_ACTION_BAR_CLICK=150]="CARD_LEFT_ACTION_BAR_CLICK",t[t.CARD_SWIPE_CONVERT=153]="CARD_SWIPE_CONVERT",t[t.ONLINE_AUDIENCE_NUM=154]="ONLINE_AUDIENCE_NUM",t[t.SHAKE_ICON_SHACK=157]="SHAKE_ICON_SHACK",t[t.SHAKE_BIG_ICON_CLICK=158]="SHAKE_BIG_ICON_CLICK",t[t.ROTATE_ICON_ROTATE=161]="ROTATE_ICON_ROTATE",t[t.ROTATE_BIG_ICON_CLICK=162]="ROTATE_BIG_ICON_CLICK",t[t.CARD_TROLLEY_ICON_CLICK=164]="CARD_TROLLEY_ICON_CLICK",t[t.LANDING_PAGE_OTHER_AREA_CLICK=171]="LANDING_PAGE_OTHER_AREA_CLICK",t[t.CARD_FOLLOW_NUM=172]="CARD_FOLLOW_NUM",t[t.FALL_ICON_CLICK=173]="FALL_ICON_CLICK",t[t.LIVE_BUTTON_CLICK=175]="LIVE_BUTTON_CLICK",t[t.DIRECT_H5_PAGE_CLICK=177]="DIRECT_H5_PAGE_CLICK",t[t.GOODS_ITEM_CARD_CLICK=178]="GOODS_ITEM_CARD_CLICK",t[t.GOODS_ITEM_CARD_SLIDE_CLICK=179]="GOODS_ITEM_CARD_SLIDE_CLICK",t[t.ITEM_HOT_BUY_STYLE_CLICK=180]="ITEM_HOT_BUY_STYLE_CLICK",t[t.GUIDE_ENTER_LIVE_CLICK=181]="GUIDE_ENTER_LIVE_CLICK",t[t.AUTO_CLICK_OTHER_AREA=182]="AUTO_CLICK_OTHER_AREA",t[t.POPLAY_FALL_IOCN=186]="POPLAY_FALL_IOCN",t[t.ROTATE_SHAKE_BIG_ICON_CLICK=187]="ROTATE_SHAKE_BIG_ICON_CLICK",t[t.RETAIN_AGG_CARD_CLICK=189]="RETAIN_AGG_CARD_CLICK",t[t.PLAYEND_AGG_CARD_CLICK=190]="PLAYEND_AGG_CARD_CLICK",t[t.SURPRISE_BOX_CLICK=191]="SURPRISE_BOX_CLICK",t[t.BUBBLE_RAIN_CLICK=192]="BUBBLE_RAIN_CLICK"}(ae||(ae={})),function(t){t[t.adClickReward=1]="adClickReward"}(oe||(oe={})),function(t){t[t.isRewarded=1]="isRewarded",t[t.noExtraReward=2]="noExtraReward",t[t.hasWatchReward=3]="hasWatchReward"}(le||(le={})),function(t){t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical"}(he||(he={}));const re="player_mute_change",de="player_play_failed",ce="player_play_finished",pe="player_update_video_progress",me="ad_convert_event";var ue,we,ge;let Ce;function fe(){var t;return Ce||(Ce={all:t=t||new Map,on(e,i){const n=t.get(e);n?n.push(i):t.set(e,[i])},off(e,i){const n=t.get(e);n&&(i?n.splice(n.indexOf(i)>>>0,1):t.set(e,[]))},emit(e,i){let n=t.get(e);n&&n.slice().map((t=>{t(i)})),n=t.get("*"),n&&n.slice().map((t=>{t(e,i)}))},clear(){t.clear()}}),Ce}!function(t){t[t.THREEIMG_DEFAULT_CLICK=0]="THREEIMG_DEFAULT_CLICK",t[t.THREEIMG_FIRST_CLICK=1]="THREEIMG_FIRST_CLICK",t[t.THREEIMG_SECOND_CLICK=2]="THREEIMG_SECOND_CLICK",t[t.THREEIMG_THIRD_CLICK=3]="THREEIMG_THIRD_CLICK"}(ue||(ue={})),function(t){t[t.picStyle=1]="picStyle",t[t.textStyle=2]="textStyle"}(we||(we={})),function(t){t[t.GRAYBG_ONE_LINE=1]="GRAYBG_ONE_LINE",t[t.GRADIENT_ONE_LINE=2]="GRADIENT_ONE_LINE",t[t.GRADIENT_TWO_LINE=3]="GRADIENT_TWO_LINE"}(ge||(ge={}));class ve{constructor(t,e,i,n,s,a,o){this.soundEnable=!1,this.ignoreCompliance=!1,this.disableDownloadDialog=!1,this.disableLeaveConfirm=!1,this.disableVideoWebPage=!1,this.disableActivityMiddlePage=!1,this.originAdInfo=t,this.deviceInfo=e,this.serverConfig=i,this.creativeId=a;let l=v(this.originAdInfo,a);this.adInfo=y(l),this.adCacheId=o||Tachikoma.env.adCacheId,this.originAdInfo.adCacheId=this.adCacheId,this.appId=s||Tachikoma.env.appId,this.scene=n,n||(Tachikoma.env.adScene?this.scene=JSON.parse(Tachikoma.env.adScene):this.scene={adStyle:l.adStyle,backUrl:""})}getCommercialLogInfo(){const t=new ye;t.creativeId=this.creativeId,t.llsid=this.originAdInfo.llsid,t.posId=this.originAdInfo.impAdInfo[0].posId;const e=this.adInfo.adConversionInfo.h5SecondConfirmationSwitch;return t.landingPageType=e?0:1,this.sourceTemplate&&(t.templateId=this.sourceTemplate.templateId,t.templateVersion=this.sourceTemplate.templateVersionCode,t.tkPublishType=At(this.adInfo,this.sourceTemplate)),t}getOcpcActionType(){try{return this.adInfo.ocpcActionType}catch(t){return 0}}getCampaignType(){try{return this.adInfo.adBaseInfo.campaignType}catch(t){return 0}}getIndustryFirstLevelId(){try{return this.adInfo.adBaseInfo.industryFirstLevelId}catch(t){return 0}}getAdOperationType(){try{return this.adInfo.adBaseInfo.adOperationType}catch(t){return 0}}}class ye{}class Ve{static createVideoCommonInstance(t,e){return 3==t?Ve.createFullscreenCommonInstance(e):2==t?Ve.createNeoCommonInstance(e):null}static createImageCommonInstance(t,e){var i;let n=new r;return n.template_id=H(e,16),n.template_version=null===(i=U(e,16))||void 0===i?void 0:i.templateVersion,n}static createLiveCommonInstance(t,e){var i;let n=new r;return n.template_id=H(e,14),n.template_version=null===(i=U(e,14))||void 0===i?void 0:i.templateVersion,n}static createNeoCommonInstance(t){var e;let i=new r,n=f.getNeoActionBarCardType(t);return i.actionbar_card_type=n,i.template_id=H(t,12),i.template_version=null===(e=U(t,12))||void 0===e?void 0:e.templateVersion,n!=c.LIVE_CUT3_STYLE1&&n!=c.LIVE_CUT3_STYLE2||(i.live_room_pattern=h.SIMPLIFIED_LIVE_ROOM_PATTERN),i}static createFullscreenCommonInstance(t){let e=new r,i=f.getFullscreenActionBarCardType(t);return e.actionbar_card_type=i,i!=c.LIVE_CUT3_STYLE1&&i!=c.LIVE_CUT3_STYLE2||(e.live_room_pattern=h.SIMPLIFIED_LIVE_ROOM_PATTERN),e}static appendNeoExtData(t,e,i,n){if(null==t)return;let s=t.neo_ext_data;null==s&&(s=new d,t.neo_ext_data=s),i&&(s.videoRollbackToImageTimeout=i.videoRollbackToImageTimeout),s.originalMaterialType=S(e),n&&s&&n(s)}}var Ie=function(t,e,i,n){return new(i||(i=Promise))((function(s,a){function o(t){try{h(n.next(t))}catch(e){a(e)}}function l(t){try{h(n.throw(t))}catch(e){a(e)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,l)}h((n=n.apply(t,e||[])).next())}))};class Te{static sendLog(t,e,i,n){this.log(t,null,e,i,n)}static log(t,e,i,n,s){(i=i||{}).renderContainer=1;const a={actionType:t,payload:JSON.stringify(i)};if(s&&(a.creativeId=s),n)if(null==n?void 0:n.adCacheId)a.adCacheId=null==n?void 0:n.adCacheId;else{const t=v(n,s);a.adTemplate=JSON.stringify(t)}e&&(a.clickInfo=e),Xt.sendLog(a)}static convertIfNeeded(t,e,i,n,s,a,o,l,h,d,c){let p=$(e,i);if(!p)return p;let m=gt;return Ft(m)||(a||(a=new r),Ft(a.template_id)&&(a.template_id=m.templateId),Ft(a.template_version)&&(a.template_version=m.templateVersion)),a=Te.appendGlobalNeoExtData(a,e),q(e)&&this.reportLivePlaySecond(this.sCurrentPlayTimeMs/1e3),this.convert(i,n,s,t,a,o,l,h,d,c),p}static convert(t,e,i,n,s,a,o,l,h,r){var d,c;return Ie(this,void 0,void 0,(function*(){const p=y(v(St(),l));if(!p||!$(p,t))return void console.log("tkloadcontroller invalid convert:"+p+":"+t);let m,u;m=Ft(s)?{itemClickType:i,renderContainer:1}:{itemClickType:i,renderContainer:1,clientExtData:JSON.stringify(s)},Ft(a)||Object.assign(m,a),fe().emit(me,{clickType:i}),e?(u={x:e.x,y:e.y},e.width&&(u.width=e.width),e.height&&(u.height=e.height)):u={};let w=-1;(null==o?void 0:o.convertType)&&(w=o.convertType,m.triggerType=w);let g=!1;if(this.matchTKConversion()){console.log("tkloadcontroller match conversion service");let i=KSAdTKBundleService.getInstance("CommercialKSAdConversionService","conversion-service",null);if(i){console.log("tkloadcontroller service instance is:"+i);const s=new ve(h||St(),It(),Tt());s.currentPlayTime=this.sCurrentPlayTimeMs,s.clickScene=n,s.convertType=w,s.creativeId=l,s.clickArea=t,s.soundEnable=this.sSoundEnable,s.sourceTemplate=bt(),(null==o?void 0:o.liveItemId)&&(s.liveItemId=o.liveItemId),Tachikoma.env.isDebug&&(C="TK转化链路开始",Xt.callNativeWithCallback("showToast",{message:C})),i.getVersion()>=2&&(this.sSecondClickCallback=t=>{0==t?Xt.forceUpdateLifeStatus("pageInvisiable",!0):1==t?Xt.forceUpdateLifeStatus("pageInvisiable",!1):2==t&&(Xt.forceUpdateLifeStatus("pageVisiable",!1),Ut.supportMinimumTKVersion("6.0.3")&&!Ut.isAndroid()&&Jt())},i.setSecondConfirmCallback(this.sSecondClickCallback),i.getVersion()>=3&&Ut.supportMinimumTKVersion("5.1.3")&&_t()&&(this.sDownloadTipCallback=t=>{switch(t){case 0:Xt.adOutCallback({targetMethod:"adDownloadConfirmTipShow"});break;case 2:Xt.adOutCallback({targetMethod:"adDownloadConfirmTipCancel"});break;case 1:Xt.adOutCallback({targetMethod:"adDownloadConfirmTipDismiss"})}},i.setDownloadConfirmTipCallback(this.sDownloadTipCallback))),this.sHandleAdClickCallback=t=>{if(this.sCurrentPlayTimeMs>0&&(m.playedDuration=this.sCurrentPlayTimeMs),t.reportExtraParam)try{let e=Ft(m.clientExtData)?{}:JSON.parse(m.clientExtData);e.clientExtData=JSON.parse(t.reportExtraParam),m.clientExtData=JSON.stringify(e)}catch(i){!function(t,e="",i=""){var n,s;ie({category:"ad_client_error_log",biz:"TACHIKOMA",sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_tk_render_performance",primaryKey:"unknown",type:"OTHER",msg:{render_state:3,error_reason:xt(t),template_id:Ft(i)?null===(n=bt())||void 0===n?void 0:n.templateId:i,version_code:Ft(e)?null===(s=bt())||void 0===s?void 0:s.templateVersionCode:e}})}(i)}this.log(2,e,m),Ut.isAndroid()||this.handleIOSConvertCallback(t)},this.sAfterHandleClickCallback=()=>{Ut.supportMinimumTKVersion("6.0.3")&&!Ut.isAndroid()&&Jt()},i.getVersion()>=4&&i.setAfterHandleClickCallback(this.sAfterHandleClickCallback),i.handleAdClick(JSON.stringify(s),this.sHandleAdClickCallback),g=!0}else this.loadConversionServiceIfNeeded((t=>{console.log("tkloadcontroller service load result:"+t)}))}var C;let f=null==h?void 0:h.impAdInfo[0];l||(l=null===(c=null===(d=V(h||St()))||void 0===d?void 0:d.adBaseInfo)||void 0===c?void 0:c.creativeId),function(t,e,i,n,s,a,o,l){e.isCallbackOnly=l,Xt.clickActionBase(Object.assign(Object.assign({area:t,logParam:e},i),{creativeId:n,adTemplate:a,disableCallback:o,isCallbackOnly:l}),s)}(t,{payload:JSON.stringify(m),clickInfo:u,sceneType:n,itemClickType:i},o,l,(i=>{1!=i.result&&(this.log(2,e,m),Xt.convert(1==t))}),f,r,g)}))}static handleIOSConvertCallback(t){t.success&&3==t.interactionType&&Xt.adOutCallback({targetMethod:"closeConvertPageCallback",methodParams:JSON.stringify({interactionType:t.interactionType})})}static reportClick(t,e,i,n){null==n&&(n=new r),n=Te.appendGlobalNeoExtData(n,t);let s={clientExtData:JSON.stringify(n)};s=Object.assign(s,i),Te.log(2,null,s)}static appendGlobalNeoExtData(t,e){let i=Tt(),n=Vt();return null!=n&&null!=i&&(t||(t=new r),Ve.appendNeoExtData(t,e,i.abConfig,(t=>{t.realRenderResult=n}))),t}static expose(t,e){this.log(1,null,t,e)}static exposeElement(t,e){(e=e||{}).elementType=t,this.log(140,null,e)}static clickElement(t){const e={elementType:t};this.log(141,null,e)}static convertWithTypeIfNeeded(t,e,i,n,s){this.convertWithType(e,i,n,s)}static convertWithType(t,e,i,n){this.convert(t,e,i,0,null,null,{convertType:n})}static convertWithTypeIfNeededNew(t,e,i,n,s,a){$(t,e)&&this.convertWithTypeNew(e,i,n,s,a)}static convertWithTypeNew(t,e,i,n,s){this.convert(t,e,i,0,null,s,{convertType:n})}static playNSecond(t,e){let i={photoPlaySecond:t};if(e){let t={clientExtData:JSON.stringify(e)};Object.assign(i,t)}this.log(402,null,i)}static playStart(t){let e=null;t&&(e={clientExtData:JSON.stringify(t)}),Te.log(399,null,e)}static reportLivePlaySecond(t){let e={photoPlaySecond:Math.round(t)},i={actionType:28,payload:JSON.stringify(e)};Xt.sendLog(i)}static skip(){this.log(501,null,null)}static loadConversionServiceIfNeeded(t){this.matchTKConversion()&&KSAdTKBundleService.loadBundle("CommercialKSAdConversionService",t),t&&t(!1)}static matchTKConversion(){var t,e;return!!(null===(e=null===(t=Tt())||void 0===t?void 0:t.abConfig)||void 0===e?void 0:e.tkConversionSwitch)&&(!(!_t()||!Ut.supportMinimumTKVersion("6.0.5"))||!_t()&&Ut.supportMinimumTKVersion("6.0.3"))}static updateVideoPlayStatus(t,e,i,n){!function(t,e,i,n){Xt.callNativeWithCallback("updateVideoPlayStatus",{status:t,errorCode:e||0,errorReason:i||"",currentTime:n||0})}(t,e,i,n),"progress"==t&&n&&(this.sCurrentPlayTimeMs=n)}static updateLivePlayStatus(t,e,i,n){"progress"==t&&n&&(this.sCurrentPlayTimeMs=n)}}Te.sSoundEnable=!1;class Se{constructor(){this.renderCalled=!1,this.renderStatusCalled=!1,this.rootView=new TKView,this.rootView.style={width:"100%",height:"100%"}}render(){return!this.renderCalled&&(this.renderCalled=!0,!0)}updateRenderStatus(t,e=""){this.renderCalled&&!this.renderStatusCalled&&(this.renderStatusCalled=!0,Xt.pageStatus(t,e),this.registerNativeId(),Te.loadConversionServiceIfNeeded((t=>{})))}registerNativeId(){Nt()&&Ut.supportMinimumTKVersion("4.0.7")&&!Ut.isAndroid()&&(this.startConfig(),Xt.registerNativeId((t=>{t&&t.data&&this.startConfig()})))}startConfig(){this.configNativeIdTimer&&clearTimeout(this.configNativeIdTimer),this.configNativeIdTimer=setTimeout((()=>{Ot(this)}),120)}}class be extends TKView{}class Ae extends Object{constructor(t,e,i,n){var s;super(),this.depIds={},this.vm=t,this.getter="function"==typeof e?e:this.parseGetter(e.trim()),this.cb=i,this.value=this.get(),this.cb(null!==(s=this.value)&&void 0!==s?s:n,null),console.log("Watcher on "+e)}update(){const t=this.get();t!=this.value&&(this.cb.call(this.vm,t,this.value),this.value=t)}addDep(t){const e=t.pid;this.depIds.hasOwnProperty(e)||(t.addDep(this),this.depIds[e]=t)}get(){Ae.target=this;const t=this.getter.call(this.vm,this.vm);return Ae.target=null,t}parseGetter(t){if(/[^\w.$]/.test(t))return;const e=t.split(".");return function(t){for(let i=0,n=e.length;i<n;i++){if(!t)return;t=t[e[i]]}return t}}}function xe(t){return!!t}function ke(t){return"string"==typeof t}let Le;function _e(){if(null!=Le)return Le;let t=!1;try{t=!1,Le=t}catch(e){}return t}function Ee(t,e){if(!0===_e()&&(null==t||!1===t))throw new Error("tkmvvm ----- 请检查传值: "+e)}function De(t){return t.$vm}function Re(t){_e()&&console.log("tachikoma TKMVVM log -> "+t)}class Pe extends Object{constructor(t,e){super(),this.object=t,this.observeKey=e,this._observe(t,e)}_observe(t,e){var i=this;Array.isArray(t)?this.defineArray(t):Object.keys(t).forEach((function(n){e?e===n&&i.observeValueWithKey(t,n):i.observeValueWithKey(t,n)}))}observeValueWithKey(t,e){let i=t[e];var n=new Fe(e);Me(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:function(){return Ae.target&&n.depend(),i},set:function(t){t!==i&&(i=t,n.notify(),Me(t))}})}defineArray(t){if(t)for(let e=0,i=t.length;e<i;e++)Me(t[e])}}var Be=0;class Fe extends Object{constructor(t){super(),this.key=t,this.pid=Be++,this.deps=new Array}depend(){Ae.target.addDep(this)}addDep(t){this.deps.push(t)}removeDep(t){}notify(){this.deps.forEach((function(t){t.update()}))}}function Me(t,e){if(!t||"object"!=typeof t)return;var i;if(!("object"==typeof(i=t)&&Object.keys(i).length>0))return;let n=!1,s=(null!=e?e:"")+"_tkmvvm_observed";if(t.hasOwnProperty(s)&&(n=t[s]),!n)return Re("observe "+s),t[s]=!0,new Pe(t,e);Re("already observe "+s)}const Ke={updateBackgroundColor:function(t,e,i){if(Ee(e,"backgroundColor"),t&&e&&ke(e)){const i=function(t){let e="#FE3666";return t?/^rgb|^hsl/.test(t)?t:(t.startsWith("#")||(t="#"+t),/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/.test(t)?t:e):e}(e);t.style={backgroundColor:i}}},updateStyle:function(t,e,i){Ee(e,"style"),t&&e&&(t.style=e)},updateText:function(t,e,i){if(Ee(e,"text"),t&&ke(e)){const i=t.setText;"function"==typeof i&&i.call(t,e)}},updateSrc:function(t,e,i){if(Ee(e,"src"),t&&e&&ke(e)){const i=t.setSrc;"function"==typeof i&&i.call(t,e)}}};class Oe extends Object{constructor(){super()}tk_observe(t){xe(t)&&(t in this?Me(this,t):console.log("=====++++++ observe2: key not in this:"+t+":"+typeof this))}}function Ne(t,e,i,n,s){if(!xe(t)||!xe(i))return;const a=e.charAt(0).toUpperCase()+e.slice(1),o=Ke["update"+a],l=We(i),h=null==l?void 0:l.split(".");if(!h)return void Ee(h,"tk_bind error, check bind path");const r=h[0],d=De(i);if(!d)return void Ee(d,"vm_bind get vm error");d.tk_observe(r),new Ae(d,l,((e,i)=>{if(s)for(let t=0;t<s.length;t++){s[t].dataCheck(e,l)}o&&o(t,e,i)}),n)}function ze(t,e){const i=De(t);if(!xe(i)||!xe(t)||!xe(e))return;const n=We(t),s=null==n?void 0:n.split(".");if(!s)return void Ee(s,"tk_bind error, check bind path");const a=s[0];i.tk_observe(a),new Ae(i,n,((t,i)=>{e&&e(t)}))}function He(t,e,i){if(!xe(t)||!xe(e)||!xe(i))return;const n=We(e),s=null==n?void 0:n.split(".");if(!s)return void Ee(s,"tk_bind error, check bind path");const a=s[0];t.tk_observe(a),new Ae(t,n,((t,e)=>{i&&i(t)}))}function We(t){let e=function(t){if(t)return t.bind_path?t.$bind_path:"string"==typeof t?t:void 0}(t);if(e)return e;Ee(e,"tk_bind error, check bind path")}class Ue{getStartTime(){return this.startTime}setStartTime(t){this.startTime=t}}class Ge extends Ue{constructor(t,e){super(),this.alpha=t,this.setStartTime(e)}getAplha(){return this.alpha}setAlpha(t){this.alpha=t}}class Ye extends Ue{getAplha(){return this.alpha}setAlpha(t){this.alpha=t}getRotationZ(){return this.rotationZ}getRotationX(){return this.rotationX}getRotationY(){return this.rotationY}setRotationX(t){this.rotationX=t}setRotationY(t){this.rotationY=t}setRotationZ(t){this.rotationZ=t}getScaleX(){return this.scaleX}setScaleX(t){this.scaleX=t}getScaleY(){return this.scaleY}setScaleY(t){this.scaleY=t}getTranslationX(){return this.translationX}setTranslationX(t){this.translationX=t}getTranslationY(){return this.translationY}setTranslationY(t){this.translationY=t}toString(){return"{alpha :"+this.alpha+" + rotationX :"+this.rotationX+" + rotationY :"+this.rotationY+" + rotationZ :"+this.rotationZ+" + scaleX :"+this.scaleX+" + scaleY :"+this.scaleY+" + translationX :"+this.translationX+" + translationY :"+this.translationY+"}"}}class je extends Ue{constructor(t,e,i,n){super(),this.rotationX=void 0,this.rotationY=void 0,this.rotationZ=t,this.rotationY=n,this.rotationX=i,this.setStartTime(e)}getRotationZ(){return this.rotationZ}getRotationX(){return this.rotationX}getRotationY(){return this.rotationY}setRotation(t){this.rotationZ=t}}class Xe extends Ue{constructor(t,e,i){super(),this.scaleX=t,this.scaleY=e,this.setStartTime(i)}getScaleX(){return this.scaleX}setScaleX(t){this.scaleX=t}getScaleY(){return this.scaleY}setScaleY(t){this.scaleY=t}}class Je extends Ue{constructor(t,e,i){super(),this.translationX=t,this.translationY=e,this.setStartTime(i)}getTranslationX(){return this.translationX}setTranslationX(t){this.translationX=t}getTranslationY(){return this.translationY}setTranslationY(t){this.translationY=t}}function $e(t,e){return t.getStartTime()-e.getStartTime()}function Ze(t,e,i,n,s){return((n-s)*t+(s-i)*e)/(n-i)}class qe{produceAnimationResult(t){t.sort($e);let e=t.length;this.rotationInfoList=new Array,this.alphaInfoList=new Array,this.scaleInfoList=new Array,this.translationInfoList=new Array,this.animationResult=new Map,this.timestampSet=new Set;for(let o=0;o<e;o++)this.timestampSet.add(t[o].getStartTime()),t[o]instanceof je?this.rotationInfoList.push(t[o]):t[o]instanceof Ge?this.alphaInfoList.push(t[o]):t[o]instanceof Xe?this.scaleInfoList.push(t[o]):t[o]instanceof Je&&this.translationInfoList.push(t[o]),this.duration=t[o].getStartTime();let i=0,n=0,s=0,a=0;for(this.timestampSet.forEach((t=>{for(;i<this.alphaInfoList.length;){let e=this.alphaInfoList[i].getStartTime();if(!(e<=t)){if(i>0&&this.alphaInfoList[i-1].getStartTime()!=t){let n=this.alphaInfoList[i-1].getStartTime(),s=Ze(this.alphaInfoList[i-1].getAplha(),this.alphaInfoList[i].getAplha(),n,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setAlpha(s);else{let e=new Ye;e.setStartTime(t),e.setAlpha(s),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setAlpha(this.alphaInfoList[i].getAplha());else{let n=new Ye;n.setStartTime(t),n.setAlpha(this.alphaInfoList[i].getAplha()),this.animationResult.set(e,n)}i++}for(;s<this.rotationInfoList.length;){let e=this.rotationInfoList[s].getStartTime();if(!(e<=t)){if(s>0&&this.rotationInfoList[s-1].getStartTime()!=t){let i=this.rotationInfoList[s-1].getStartTime(),n=Ze(this.rotationInfoList[s-1].getRotationZ(),this.rotationInfoList[s].getRotationZ(),i,e,t),a=Ze(this.rotationInfoList[s-1].getRotationY(),this.rotationInfoList[s].getRotationY(),i,e,t),o=Ze(this.rotationInfoList[s-1].getRotationX(),this.rotationInfoList[s].getRotationX(),i,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setRotationZ(n),this.animationResult.get(t).setRotationY(a),this.animationResult.get(t).setRotationX(o);else{let e=new Ye;e.setStartTime(t),e.setRotationZ(n),e.setRotationY(a),e.setRotationX(o),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setRotationZ(this.rotationInfoList[s].getRotationZ()),this.animationResult.get(e).setRotationY(this.rotationInfoList[s].getRotationY()),this.animationResult.get(e).setRotationX(this.rotationInfoList[s].getRotationX());else{let i=new Ye;i.setStartTime(t),i.setRotationZ(this.rotationInfoList[s].getRotationZ()),i.setRotationY(this.rotationInfoList[s].getRotationY()),i.setRotationX(this.rotationInfoList[s].getRotationX()),this.animationResult.set(e,i)}s++}for(;n<this.scaleInfoList.length;){let e=this.scaleInfoList[n].getStartTime();if(!(e<=t)){if(n>0&&this.scaleInfoList[n-1].getStartTime()!=t){let i=this.scaleInfoList[n-1].getStartTime(),s=Ze(this.scaleInfoList[n-1].getScaleX(),this.scaleInfoList[n].getScaleX(),i,e,t),a=Ze(this.scaleInfoList[n-1].getScaleY(),this.scaleInfoList[n].getScaleY(),i,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setScaleX(s),this.animationResult.get(t).setScaleY(a);else{let e=new Ye;e.setStartTime(t),e.setScaleX(s),e.setScaleY(a),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setScaleX(this.scaleInfoList[n].getScaleX()),this.animationResult.get(e).setScaleY(this.scaleInfoList[n].getScaleY());else{let i=new Ye;i.setStartTime(t),i.setScaleX(this.scaleInfoList[n].getScaleX()),i.setScaleY(this.scaleInfoList[n].getScaleY()),this.animationResult.set(e,i)}n++}for(;a<this.translationInfoList.length;){let e=this.translationInfoList[a].getStartTime();if(!(e<=t)){if(a>0&&this.translationInfoList[a-1].getStartTime()!=t){let i=this.translationInfoList[a-1].getStartTime(),n=Ze(this.translationInfoList[a-1].getTranslationX(),this.translationInfoList[a].getTranslationX(),i,e,t),s=Ze(this.translationInfoList[a-1].getTranslationY(),this.translationInfoList[a].getTranslationY(),i,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setTranslationX(n),this.animationResult.get(t).setTranslationY(s);else{let e=new Ye;e.setStartTime(t),e.setTranslationX(n),e.setTranslationY(s),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setTranslationX(this.translationInfoList[a].getTranslationX()),this.animationResult.get(e).setTranslationY(this.translationInfoList[a].getTranslationY());else{let t=new Ye;t.setStartTime(e),t.setTranslationX(this.translationInfoList[a].getTranslationX()),t.setTranslationY(this.translationInfoList[a].getTranslationY()),this.animationResult.set(e,t)}a++}}));i<this.alphaInfoList.length;){let t=this.alphaInfoList[i].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setAlpha(this.alphaInfoList[i].getAplha());else{let e=new Ye;e.setStartTime(t),e.setAlpha(this.alphaInfoList[i].getAplha()),this.animationResult.set(t,e)}i++}for(;s<this.rotationInfoList.length;){let t=this.rotationInfoList[s].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setRotationZ(this.rotationInfoList[s].getRotationZ()),this.animationResult.get(t).setRotationY(this.rotationInfoList[s].getRotationY()),this.animationResult.get(t).setRotationX(this.rotationInfoList[s].getRotationX());else{let e=new Ye;e.setRotationZ(this.rotationInfoList[s].getRotationZ()),e.setRotationY(this.rotationInfoList[s].getRotationY()),e.setRotationX(this.rotationInfoList[s].getRotationX()),this.animationResult.set(t,e)}s++}for(;n<this.scaleInfoList.length;){let t=this.scaleInfoList[n].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setScaleX(this.scaleInfoList[n].getScaleX()),this.animationResult.get(t).setScaleY(this.scaleInfoList[n].getScaleY());else{let e=new Ye;e.setScaleX(this.scaleInfoList[n].getScaleX()),e.setScaleY(this.scaleInfoList[n].getScaleY()),this.animationResult.set(t,e)}n++}for(;a<this.translationInfoList.length;){let t=this.translationInfoList[a].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setTranslationX(this.translationInfoList[a].getTranslationX()),this.animationResult.get(t).setTranslationY(this.translationInfoList[a].getTranslationY());else{let e=new Ye;e.setTranslationX(this.translationInfoList[a].getTranslationX()),e.setTranslationY(this.translationInfoList[a].getTranslationY()),this.animationResult.set(t,e)}a++}this.animationFiltering()}animationFiltering(){let t=-1;this.timestampSet.forEach((e=>{if(-1!=t){let i=this.animationResult.get(e);this.isInvaildNumber(i.getAplha())&&i.setAlpha(this.animationResult.get(t).getAplha()),this.isInvaildNumber(i.getRotationZ())&&i.setRotationZ(this.animationResult.get(t).getRotationZ()),this.isInvaildNumber(i.getRotationY())&&i.setRotationY(this.animationResult.get(t).getRotationY()),this.isInvaildNumber(i.getRotationX())&&i.setRotationX(this.animationResult.get(t).getRotationX()),this.isInvaildNumber(i.getScaleX())&&i.setScaleX(this.animationResult.get(t).getScaleX()),this.isInvaildNumber(i.getScaleY())&&i.setScaleY(this.animationResult.get(t).getScaleY()),this.isInvaildNumber(i.getTranslationX())&&i.setTranslationX(this.animationResult.get(t).getTranslationX()),this.isInvaildNumber(i.getTranslationY())&&i.setTranslationY(this.animationResult.get(t).getTranslationY())}t=e}))}isInvaildNumber(t){return isNaN(t)||null==t||null==t}bindViewAnmation(t,e,i,n){if(null==t)return;const s=new TKKeyframeAnimation;let a=new Array;this.timestampSet.forEach((e=>{a.push((()=>(t.style={transform:{scale:{x:this.animationResult.get(e).getScaleX(),y:this.animationResult.get(e).getScaleY()},translate:{x:this.animationResult.get(e).getTranslationX(),y:this.animationResult.get(e).getTranslationY()},rotate:{z:this.animationResult.get(e).getRotationZ(),y:this.animationResult.get(e).getRotationY(),x:this.animationResult.get(e).getRotationX()}},opacity:this.animationResult.get(e).getAplha()},0==this.duration?1:this.animationResult.get(e).getStartTime()/this.duration)))})),s.setAnimations(a),s.duration=this.duration,Ft(n)?s.timingFunction="linear":s.timingFunction=n,i&&(s.on("start",(t=>{i("start")})),s.on("end",(t=>{i("end")}))),t.addAnimation(s,e)}}class Qe{static bindAnimation(t,e,i,n,s){let a=new qe;a.produceAnimationResult(t),a.bindViewAnmation(e,i,n,s)}}class ti extends TKView{constructor(t,e){super(),this.downloadState=0,this.vm=t,this.showContainer=e,this.setupView(),this.setupAction(),ze(this.vm.$attrsPath.showPopupView,(t=>{console.log("jky KSAdDownloadPopup needShowPopupView: "+t),this.updatePopViewState(t)})),ze(this.vm.$attrsPath.downloadState,(t=>{this.updateControlBtnState(this.vm.isDownloadPaused())})),ze(this.vm.$attrsPath.descText,(t=>{this.desText&&t&&this.desText.setText(t)}))}setupView(){this.style={width:"100%",height:"100%",alignItems:"center",opacity:0,position:"absolute"},this.baseContainer=new TKView,this.baseContainer.style={alignItems:"center",justifyContent:"center",width:245,height:36,top:10,shadow:"0 0 8 #00000099",backgroundColor:"#FFFFFF",borderRadius:120,flexDirection:"row"},this.appendChild(this.baseContainer),this.closeButton=new TKImage,this.closeButton.style={marginStart:10,justifyContent:"center",width:10,height:10},this.closeButton.setSrc("image/ksad-compose-image/ksad_icon_close.png"),this.baseContainer.appendChild(this.closeButton),this.desText=new TKText,this.desText.style={marginStart:10,width:77,fontSize:12,textAlign:"left",includeFontPadding:!1,color:"#222222",fontWeight:"200"},this.desText.setText(this.vm.getDesText()),this.baseContainer.appendChild(this.desText),this.continueButton=new TKText,this.continueButton.style={marginStart:12,width:52,height:20,borderRadius:100,borderWidth:.5,borderColor:"#FE3666",color:"#F66484",fontSize:12,textAlign:"center"},this.updateControlBtnState(!1),this.baseContainer.appendChild(this.continueButton),this.delButton=new TKText,this.delButton.style={marginStart:8,width:52,height:20,borderRadius:100,borderWidth:.5,borderColor:"#4D666666",color:"#666666",fontSize:12,textAlign:"center"},this.delButton.setText("删除"),this.baseContainer.appendChild(this.delButton)}setupAction(){this.baseContainer.addEventListener("tap",(t=>{})),this.closeButton.addEventListener("tap",(t=>{this.vm.onCloseClick(),this.vm.showPopupView=!1})),this.continueButton.addEventListener("tap",(t=>{this.vm.convert(1,1,{x:t.position.rawX,y:t.position.rawY},ae.ACTION_BAR_CLICK),this.vm.isNeedShowDownloading()||this.dismissPopup()})),this.delButton.addEventListener("tap",(t=>{var e;e=t=>{Xt.showToast(this.vm.getDeleteToast())},Xt.callNativeWithCallback("cancelAppDownloadForAd",null,e),this.dismissPopup()}))}updatePopViewState(t){console.log("jky updatePopViewState: show: "+t+", isShow: "+this.isShow),t?this.isShow||(this.showContainer.appendChild(this),this.isShow=!0,this.startShowAnimation()):this.isShow&&(this.showContainer.removeChild(this),this.isShow=!1,this.dismissPopup())}updateControlBtnState(t){t?this.continueButton.setText("继续"):this.continueButton.setText("暂停")}startShowAnimation(){this.style={visibility:"visible"};const t=new TKKeyframeAnimation;t.setAnimations([()=>(this.style={marginTop:48,opacity:0},0),()=>(this.style={marginTop:64,opacity:1},1)]),t.duration=600,t.repeatCount=1,this.addAnimation(t,"popupShowAnimation")}dismissPopup(){const t=new TKKeyframeAnimation;t.setAnimations([()=>(this.style={opacity:1},0),()=>(this.style={opacity:0},1)]),t.duration=300,t.repeatCount=1,this.addAnimation(t,"popupDismissAnimation"),this.style={visibility:"hidden"}}setMarginTop(t){this.baseContainer.style={top:t}}}function ei(t,e){const i=new TKBasicAnimation;return i.duration=t,i.timingFunction="Linear",i.animValue={position:{x:e,y:0,z:0}},i}function ii(t,e,i,n,s=!1){const a=new TKKeyframeAnimation;return s?(a.setAnimations([()=>(t.style={transform:{scale:e}},.5),()=>(t.style={transform:{scale:1}},1)]),a.timingFunction="EaseInEaseOut"):(a.animType="scale",a.keyframes=[{percent:0,value:1,easing:"EaseInEaseOut"},{percent:.33,value:e,easing:"EaseInEaseOut"},{percent:.66,value:1/e,easing:"EaseInEaseOut"},{percent:1,value:1,easing:"EaseInEaseOut"}]),a.duration=i,a.repeatCount=n,a}function ni(t,e,i=!1){const n=new TKKeyframeAnimation;return i?(n.setAnimations([()=>(t.style={opacity:1},1)]),n.timingFunction="ease-in-out"):(n.animType="opacity",n.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:1,value:1,easing:"EaseInEaseOut"}]),n.duration=e,n}function si(t,e,i=!1){const n=new TKKeyframeAnimation;return i?(n.setAnimations([()=>(t.style={opacity:0},1)]),n.timingFunction="ease-in-out"):(n.animType="opacity",n.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}]),n.duration=e,n}class ai extends TKView{constructor(t,e,i){super();let n=e.adBaseInfo,s="#00000000";3==t?s="#00000019":0!=t&&(s="#00000025"),this.style={height:Ft(i)?16:i,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",backgroundColor:s,borderRadius:3==t?3:2};let a=3;if(2!=t){let e=null;1==t||3==t?Dt(n.adMarkIcon)&&(e=n.adMarkIcon):Dt(n.adGrayMarkIcon)&&(e=n.adGrayMarkIcon),Dt(e)&&(this.iconView=new TKImage,this.iconView.style={width:12,height:12,marginLeft:3,opacity:3==t?.4:1},a=4,this.appendChild(this.iconView),this.iconView.setSrc(e))}let o="#9C9C9C";0!=t&&(o="#FFFFFF"),this.titleLabel=new TKText,this.titleLabel.style={color:o,minimumTextScaleFactor:.5,fontSize:10,marginLeft:a,marginRight:3,textAlign:"center",includeFontPadding:!1,opacity:3==t?.4:1};let l=n.adSourceDescription;l||(l="广告"),this.titleLabel.setText(l),this.appendChild(this.titleLabel)}setTitleColor(t){this.titleLabel&&(this.titleLabel.style={color:t},this.style={height:16,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",borderRadius:2})}}class oi extends TKView{constructor(t,e,i,n="#30303099",s="#FFFFFF",a){super(),this.adInfo=t,this.isVertical=0==e,this.backgroundColor=n,this.color=s,this.shadow=a,this.containerWidth=i,this.setupView(),this.setupData()}setupView(){this.style={opacity:.6,flexDirection:"column",backgroundColor:this.backgroundColor,borderRadius:4,padding:10};let t=this.style.width;if("number"==typeof t)this.containerWidth=t;else if("string"==typeof t)if(isNaN(Number(t))){if("%"!=t.slice(-1))return;this.containerWidth*=Number(t.slice(0,-1))/100}else this.containerWidth=Number(t);if(this.addEventListener("tap",(()=>{})),this.appInfoLabel=this.createLabel(this.color),this.isVertical&&(this.appInfoLabel.style={flexShrink:1,textLineClamp:1,textOverflow:"ellipsis"},this.appInfoLabel.text=this.appendNameText(""),this.appInfoLabel.text=this.appendDeveloperText(this.appInfoLabel.text),Dt(this.appInfoLabel.text)&&Ut.supportMinimumTKVersion("5.0.0")))try{this.appInfoLabel.measureForText(this.appInfoLabel.text,this.containerWidth,2).startIndex>1&&(this.appendChild(this.appInfoLabel),this.isTooLong=!0)}catch(e){console.error("ignore"+new Error(e).stack)}this.otherLabel=this.createLabel(this.color),this.otherLabel.style={marginRight:10},this.appendChild(this.otherLabel),Dt(this.shadow)&&(this.otherLabel.style={shadow:this.shadow})}createLabel(t){let e=new TKText;return e.style={color:t,fontSize:10,textLineHeight:16},e}setupData(){let t="";if(this.isVertical?(this.isTooLong||(t=this.appendNameText(t),t=this.appendDeveloperText(t)),t=this.appendRecordText(t)):(t=this.appendNameText(t),t=this.appendDeveloperText(t),t=this.appendRecordText(t)),Ut.supportMinimumTKVersion("4.0.5")?Dt(this.adInfo.downloadSafeInfo.appVersion)&&(t+="| 版本 "+this.adInfo.downloadSafeInfo.appVersion):Dt(this.adInfo.adBaseInfo.appVersion)&&(t+="版本 "+this.adInfo.adBaseInfo.appVersion),Ft(this.adInfo.downloadSafeInfo.introductionInfoUrl)&&Ft(this.adInfo.downloadSafeInfo.appPermissionInfoUrl)&&Ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)?t+=" ":t+=" | ",this.span=new TKSpan,!Ft(this.adInfo.downloadSafeInfo.introductionInfoUrl)){const e=t.length;t+="功能";const i=t.length;Ft(this.adInfo.downloadSafeInfo.appPermissionInfoUrl)&&Ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)?t+=" ":t+=" | ",this.introductionClickSpanItem=new TKSpanItem,this.introductionClickSpanItem.spanType="click",this.introductionClickSpanItem.start=e,this.introductionClickSpanItem.end=i,this.introductionClickSpanItem.color=this.color,this.introductionClickSpanItem.setSpanOnClickListener((()=>{this.clickCallback&&this.clickCallback(this.adInfo.downloadSafeInfo.introductionInfoUrl,"功能介绍")})),this.span.addSpan(this.introductionClickSpanItem)}if(!Ft(this.adInfo.downloadSafeInfo.appPermissionInfoUrl)){const e=t.length;t+="权限";const i=t.length;Ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)?t+=" ":t+=" | ",this.permissionClickSpanItem=new TKSpanItem,this.permissionClickSpanItem.spanType="click",this.permissionClickSpanItem.start=e,this.permissionClickSpanItem.end=i,this.permissionClickSpanItem.color=this.color,this.permissionClickSpanItem.setSpanOnClickListener((()=>{this.clickCallback&&this.clickCallback(this.adInfo.downloadSafeInfo.appPermissionInfoUrl,"权限信息")})),this.span.addSpan(this.permissionClickSpanItem)}if(!Ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)){const e=t.length;t+="隐私";const i=t.length;t+=" ",this.privacyClickSpanItem=new TKSpanItem,this.privacyClickSpanItem.spanType="click",this.privacyClickSpanItem.start=e,this.privacyClickSpanItem.end=i,this.privacyClickSpanItem.color=this.color,this.privacyClickSpanItem.setSpanOnClickListener((()=>{this.clickCallback&&this.clickCallback(this.adInfo.downloadSafeInfo.appPrivacyUrl,"隐私政策")})),this.span.addSpan(this.privacyClickSpanItem)}this.otherLabel.setSpan(t,this.span)}appendNameText(t){return Ut.supportMinimumTKVersion("4.0.5")?Dt(this.adInfo.downloadSafeInfo.appName)&&(t+=this.adInfo.downloadSafeInfo.appName+" "):Dt(this.adInfo.adBaseInfo.appName)&&(t+=this.adInfo.adBaseInfo.appName+" "),t}appendDeveloperText(t){return Ut.supportMinimumTKVersion("4.0.5")?Dt(this.adInfo.downloadSafeInfo.corporationName)&&(t+=this.adInfo.downloadSafeInfo.corporationName+" "):Dt(this.adInfo.adBaseInfo.corporationName)&&(t+=this.adInfo.adBaseInfo.corporationName+" "),t}appendRecordText(t){return Ut.supportMinimumTKVersion("4.0.5")&&Dt(this.adInfo.downloadSafeInfo.recordNumber)&&(t+=this.adInfo.downloadSafeInfo.recordNumber+" "),t}}class li extends TKView{constructor(t){super(),this.showPopView=!1,this.viewModel=t,this.animationMap=new Map,this.produceAnimation()}produceAnimation(){this.floatBalloView1(),this.floatBalloView2(),this.floatBalloView3(),this.floatBalloView4(),this.floatBalloView5(),this.floatBalloView6(),this.floatBalloView7(),this.floatBalloView8()}isShowPopView(){return this.showPopView}configBallowView(){if(this.showPopView)return;let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height;this.showPopView=!0,this.ballows=new Array;let i=this.viewModel.creditsInfo.creditsIconUrls;for(let n=1;n<=8;n++){let s=new TKImage;s.style={position:"absolute",width:100,height:100,bottom:0,left:0,right:0,opacity:0},4==n?s.style={position:"absolute",width:100,height:100,bottom:.02*e,left:.48*t,opacity:0}:5==n&&(s.style={position:"absolute",width:100,height:100,bottom:.06*e,left:.6*t,opacity:0}),s.addEventListener("tap",(t=>{this.viewModel.convert(1,{x:t.position.rawX,y:t.position.rawY},ae.POPLAY_FALL_IOCN)})),null!=i&&i.length>0&&s.setSrc(i[Math.floor(Math.random()*i.length)]),Qe.bindAnimation(this.animationMap.get("floatBalloView"+n),s,"floatBalloView"+n),this.ballows.push(s),this.appendChild(s)}}disapperBallowView(){for(let t=1;t<=8;t++){let e=this.viewModel.containerLimit.height,i=new je(-12,1200),n=new Je(void 0,1.5*-e,1200);Qe.bindAnimation([i,n],this.ballows[t-1],"disapperBallowView"+t)}}floatBalloView1(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,350),new Ge(1,650),new je(0,350),new je(7,4e3),new je(27,5200),new je(20,5500),new Xe(.4,.4,350),new Xe(1.25,1.25,4e3),new Je(.02*-t,.02*-e,350),new Je(.04*-t,80-e,4e3),new Je(.02*-t,.95*-e+60,5200)],this.animationMap.set("floatBalloView1",i)}floatBalloView2(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,650),new Ge(1,950),new je(0,650),new je(-13,4e3),new je(-31,4950),new je(-12,5500),new Xe(.3,.3,650),new Xe(1.4,1.4,4e3),new Je(.11*t,.02*-e,650),new Je(.15*t,40-e,4e3),new Je(.2*t,.95*-e+67.5,4950)],this.animationMap.set("floatBalloView2",i)}floatBalloView3(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,200),new Ge(1,500),new je(15,4300),new je(21,5100),new je(6,5700),new Xe(.48,.48,200),new Xe(1.2,1.2,4300),new Je(.22*t,.02*-e,200),new Je(.4*t,.98*-e+60,4300),new Je(.44*t,.95*-e+65,5100)],this.animationMap.set("floatBalloView3",i)}floatBalloView4(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,0),new Ge(1,300),new je(0,0),new je(15,4600),new je(37,5200),new je(15,5800),new Xe(.4,.4,200),new Xe(1.5,1.5,4300),new Je(0,0,0),new Je(.02*-t,.5*-e+75+.02*e,2200),new Je(.72*t-.48*t,60-e+.02*e,4600),new Je(.77*t-.48*t,.93*-e+55+.02*e,5200)],this.animationMap.set("floatBalloView4",i)}floatBalloView5(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,0),new Ge(1,300),new je(0,0),new je(7,4400),new je(20,5300),new je(8,6e3),new Xe(.35,.35,0),new Xe(1.2,1.2,4400),new Je(0,0,0),new Je(.56*t-.6*t,.48*-e+60+.06*e,2100),new Je(.76*t-.6*t,.83*-e+60+.06*e,4400),new Je(.8*t-.6*t,.78*-e+60+.06*e,5300)],this.animationMap.set("floatBalloView5",i)}floatBalloView6(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,1e3),new Ge(1,1300),new je(0,1e3),new je(26,4350),new je(47,5200),new je(76,6e3),new Xe(.4,.4,0),new Xe(1.45,1.45,4400),new Je(.7*t,.06*-e+20,1e3),new Je(.38*t,.48*-e+60,2700),new Je(.18*t,.87*-e+72.5,4350),new Je(.26*t,.81*-e+65,5200)],this.animationMap.set("floatBalloView6",i)}floatBalloView7(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,750),new Ge(1,1050),new je(0,750),new je(-8,4300),new je(-22,5200),new je(-3,5800),new Xe(.3,.3,0),new Xe(1.4,1.4,4400),new Je(.86*t,.06*-e,750),new Je(.72*t,.48*-e+60,2450),new Je(.47*t,.86*-e+60,4300),new Je(.55*t,.8*-e+60,5200)],this.animationMap.set("floatBalloView7",i)}floatBalloView8(){let t=this.viewModel.containerLimit.width,e=this.viewModel.containerLimit.height,i=new Array;i=[new Ge(0,1e3),new Ge(1,1300),new je(0,1e3),new je(8,4400),new je(17,5100),new je(6,5800),new Xe(.4,.4,0),new Xe(1.35,1.35,4400),new Je(.1*t,.06*-e,1e3),new Je(0,.48*-e+60,2750),new Je(.07*-t,.86*-e+60,4400),new Je(.05*-t,.8*-e+60,5100)],this.animationMap.set("floatBalloView8",i)}}class hi extends Oe{constructor(){super(),this.$attrsPath=new Proxy(this,{get:(t,e)=>ri(t,e)})}getData(t){}}function ri(t,e){return new Proxy({$vm:t,$bind_path:e},{get:(i,n)=>"string"!=typeof n||"function"==typeof i[n]||0==n.indexOf("$")?Reflect.get(i,n):ri(t,e+"."+n)})}class di extends hi{constructor(t,e,i){super(),this.adInfo=e,this.creditsInfo=t,this.containerLimit=i}convert(t,e,i,n=null,s){Te.convertIfNeeded(1,this.adInfo,t,e,i,n,s)}}class ci extends TKView{constructor(t){super(),this.size=t,this.borderRadius=t.borderRadius,this.style={width:this.size.width,height:this.size.height,top:0,left:0,justifyContent:"center",alignItems:"center",borderRadius:this.borderRadius,position:"absolute"},Ut.supportMinimumTKVersion("5.0.0")&&(this.canvasView=new Canvas2DView,this.canvasView.style={width:"100%",height:"100%",borderRadius:this.borderRadius},this.canvasView.layerType=1,this.appendChild(this.canvasView),this.roundRectPaint=new Paint,this.roundRectPaint.setColor("FFFFFF30"),this.maskRectPath=new Path,this.maskRectPaint=new Paint,this.maskRectPaint.setColor("#FFFFFF00"),this.maskRectPaint.setPorterDuffMode(0))}setProgress(t){if(!t)return;if(t>1||t<0)return;if(!this.canvasView)return;if(!this.getSize())return;let e=this.getSize().width,i=this.getSize().height;if(e<=0||i<0)return;const n=this,s=t*e;this.canvasView.onDraw=t=>{t.save();const a={x:0,y:0,width:e,height:i};let o=i/2,l=Math.min(n.borderRadius,o);t.drawRoundRect(a,l,l,n.roundRectPaint),n.maskRectPath.reset(),n.maskRectPath.addRect({x:s,y:a.y,width:a.width,height:a.height}),t.drawPath(n.maskRectPath,n.maskRectPaint),t.restore()},this.canvasView.requestDraw()}setProgressColor(t){Ut.supportMinimumTKVersion("5.0.0")&&this.roundRectPaint.setColor(t)}}class pi extends TKView{constructor(t){super(),this.hasImpress=!1,this.viewModel=t,this.configView()}configView(){var t;null!=this.viewModel.creditsInfo&&0!=(null===(t=this.viewModel.creditsInfo)||void 0===t?void 0:t.hintStyle)&&(1==this.viewModel.creditsInfo.hintStyle?(this.creditContainer=new TKView,this.creditContainer.style={width:"100%",height:"21%",position:"absolute",bottom:-55,left:0},Ut.supportMinimumTKVersion("5.0.0")&&(this.hintView=new TKLottieImageView,this.hintView.style={width:"100%",height:"100%",position:"absolute",left:0},this.hintView.setUri("bundle://image/ksad-interstitial-card/lottie_hint_btn.json"),this.hintView.setLoop(!0),this.creditContainer.appendChild(this.hintView)),this.hintText=new TKText,this.hintText.style={fontSize:14,color:"#FFFFFF",flexWrap:"no-wrap",textLineClamp:1,textAlign:"center",width:"100%",bottom:20,textOverflow:"ellipsis",position:"absolute"},this.hintNumer=this.viewModel.creditsInfo.autoTriggerDelayTime/100,-1!=this.viewModel.creditsInfo.autoTriggerDelayTime&&this.hintNumer?this.hintText.setText(this.hintNumer+this.viewModel.creditsInfo.buttonText):this.hintText.setText(this.viewModel.creditsInfo.buttonText),this.creditContainer.appendChild(this.hintText),this.creditContainer.addEventListener("tap",(t=>{this.clickCallBack&&this.clickCallBack()})),this.appendChild(this.creditContainer)):(this.creditContainer=new TKView,this.creditContainer.style={width:200,height:196,position:"absolute",alignSelf:"center",justifyContent:"center",alignItems:"center"},this.creditView=new TKImage,this.creditView.style={width:100,height:100,top:0,position:"absolute"},this.creditView.setSrc(this.viewModel.creditsInfo.creditsIconUrls[0]),this.creditContainer.appendChild(this.creditView),this.progressBg=new TKImage,this.progressBg.style={width:110,height:30,bottom:50,position:"absolute"},this.progressBg.setSrc("image/ksad-interstitial-card/bg_progressbar.png"),this.creditContainer.appendChild(this.progressBg),this.progressBar=new ci({width:110,height:30,borderRadius:15}),this.progressBar.style={top:116,bottom:50,alignSelf:"center",left:45,justifyContent:"center",position:"absolute"},this.progressBar.setProgress(0),this.creditContainer.appendChild(this.progressBar),this.hintText=new TKText,this.hintText.style={fontSize:12,color:"#FFFDE4",flexWrap:"no-wrap",textLineClamp:1,textAlign:"center",width:"100%",bottom:50,height:30,textOverflow:"ellipsis",position:"absolute"},this.hintNumer=this.viewModel.creditsInfo.autoTriggerDelayTime/100,-1!=this.viewModel.creditsInfo.autoTriggerDelayTime&&this.hintNumer?this.hintText.setText(Math.ceil(this.hintNumer/10)+this.viewModel.creditsInfo.buttonText):this.hintText.setText(this.viewModel.creditsInfo.buttonText),this.creditContainer.appendChild(this.hintText),-1==this.viewModel.creditsInfo.autoTriggerDelayTime&&Ut.supportMinimumTKVersion("5.0.0")&&(this.hintView=new TKLottieImageView,this.hintView.style={width:"50%",height:"50%",left:"50%",top:"50%",position:"absolute",bottom:0},this.hintView.setUri("bundle://image/ksad-interstitial-card/lottie_hint_hand.json"),this.hintView.setLoop(!0),this.creditContainer.appendChild(this.hintView)),this.creditContainer.addEventListener("tap",(t=>{this.clickCallBack&&this.clickCallBack()})),this.appendChild(this.creditContainer)))}bindClickListener(t){this.clickCallBack=t}playAnimation(){this.hintView&&Ut.supportMinimumTKVersion("5.0.0")&&this.hintView.play()}updateHintText(){this.hintNumer-=1,this.hintNumer>0&&this.hintText&&this.hintText.setText(Math.ceil(this.hintNumer/10)+this.viewModel.creditsInfo.buttonText),this.progressBar&&this.progressBar.setProgress(100*(this.viewModel.creditsInfo.autoTriggerDelayTime/100-this.hintNumer)/this.viewModel.creditsInfo.autoTriggerDelayTime)}reportCreditHintImpress(){if(this.hasImpress)return;this.hasImpress=!0;let t=new r;t.universe_feature_freq=15;let e={elementType:222,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}}class mi extends TKView{constructor(t){super(),this.columnNum=3,this.traveViews=[],this.iconImages=[],this.iconDefaultSize={width:150,height:150},this.hasAnimedView=new Array(9),this.currentIntervalTime=0,this.animedCount=0,this.timer=0,this.hasShow=!1,this.vm=t,this.pendantRowDelay=0,this.rowNum=this.vm.getRowNum(),this.vm.checkParam()&&(this.style={width:"100%",height:"100%"},this.throughHitTest=!0,this.createTravelView(),this.createRedPacketInTravel())}createTravelView(){this.traveViews=[];for(let t=0;t<this.columnNum;t++){let e=new TKView;e.style={width:this.iconDefaultSize.width,height:this.vm.containerSize.height+this.iconDefaultSize.height+30,position:"absolute",left:this.getLeftMagin(t),alignItems:"center",top:-this.iconDefaultSize.height},e.throughHitTest=!0,this.appendChild(e),this.traveViews.push(e)}}getLeftMagin(t){let e=this.vm.containerSize.width/this.columnNum,i=this.iconDefaultSize.width-e;return 0==t?0:1==t?e-i/2:this.vm.containerSize.width-this.iconDefaultSize.width}createRedPacketInTravel(){this.iconImages=[];for(let t=0;t<this.columnNum;t++)for(let e=0;e<this.rowNum;e++){let i=this.createIconImage(e,t);this.iconImages[t*this.rowNum+e]=i,this.traveViews[t].appendChild(i)}}createIconImage(t,e){let i=new TKImage,n=this.vm.getScaleType(t,e);if(i.style={width:this.iconDefaultSize.width*n,height:this.iconDefaultSize.height*n,position:"absolute",top:0},this.vm.isCanClick()){let t=this;i.addEventListener("tap",(e=>{const n=Et(e,i);this.vm.convert(2,n,ae.FALL_ICON_CLICK),t.hide(!0)}))}else i.addEventListener("tap",(t=>{}));return i.setSrc(this.vm.getRedPacketIconUrl()),i}createIconAnimation(t,e){const i=1e3*this.vm.getShowTime(t),n=new TKKeyframeAnimation;let s=this;n.timingFunction="linear",n.setAnimations([()=>(e.style={top:0},0),()=>(e.style={top:s.vm.containerSize.height+s.iconDefaultSize.height+30},1)]),t==this.vm.getLastAnimIconIndex()&&n.on("end",(()=>{s.hide()})),n.duration=i;let a="translateAnimation"+t.toString();if(e.addAnimation(n,a),this.vm.isCanShowRotateAnim(t)&&setTimeout((()=>{this.startRotateAnimation(e)}),this.vm.getRotateAnimDelayTime(t)),2==this.vm.getAnimType()){const t=new TKKeyframeAnimation;t.timingFunction="ease-in",t.setAnimations([()=>(e.style={opacity:1},.5),()=>(e.style={opacity:.5},.75),()=>(e.style={opacity:0},1)]),t.duration=.6*i,e.addAnimation(t,"opacityAnimation")}}startRotateAnimation(t){const e=new TKKeyframeAnimation;e.setAnimations([()=>(t.style={transform:{rotate:{z:0}}},0),()=>(t.style={transform:{rotate:{z:-25}}},.2),()=>(t.style={transform:{rotate:{z:25}}},.4),()=>(t.style={transform:{rotate:{z:-21}}},.6),()=>(t.style={transform:{rotate:{z:21}}},.8),()=>(t.style={transform:{rotate:{z:0}}},1)]),e.duration=1500,t.addAnimation(e,"rotateAnim")}show(){this.vm.isParamValid()&&(this.hasShow||(this.hasShow=!0,this.vm.reportRedPacketImpression(),this.showRedPacketIconWithAnim()))}hide(t=!1){const e=this;setTimeout((()=>{e.removeAllAnimation(),e.removeAll(),e.vm.dismissCallbackOnlyOnce()}),t?100:0)}showRedPacketIconWithAnim(){this.tryShowAnim(),this.timer=setInterval((()=>{this.currentIntervalTime+=this.vm.getAnimMinTime(),this.tryShowAnim()}),this.vm.getAnimMinTime())}tryShowAnim(){if(this.animedCount!=this.vm.getAnimedCount()){for(let t=0;t<this.vm.getAnimedCount();t++)if(!this.hasAnimedView[t]&&this.currentIntervalTime==this.vm.getIconDelayTime(t)){this.hasAnimedView[t]=!0;let e=this.iconImages[t];this.createIconAnimation(t,e),this.animedCount=this.animedCount+1}}else this.timer&&clearInterval(this.timer)}}class ui extends TKView{constructor(t){super(),this.animationAllowed=!0,this.vm=t,this.setupView(),this.setupData(),this.setupAction(),this.startShowAnimation()}setupView(){this.throughHitTest=!0,this.style={alignItems:"flex-start",width:this.vm.getPendantSize().width,height:this.vm.getPendantSize().height},this.contentView=new TKView,this.contentView.style={justifyContent:"center",alignItems:"center"},this.appendChild(this.contentView),this.pendantTitle=new TKText,this.pendantTitle.style={top:0,marginLeft:this.vm.getPendantTitleMarginLR(),marginRight:this.vm.getPendantTitleMarginLR(),fontSize:this.vm.getPendantTitleFontSize(),color:"#FFFFFF",fontWeight:"bold",textAlign:"center",textLineHeight:20,opacity:0},this.contentView.appendChild(this.pendantTitle),this.pendantImage=new TKImage,this.pendantImage.style={width:this.vm.getPendantImageWH(),height:this.vm.getPendantImageWH(),opacity:0},this.contentView.appendChild(this.pendantImage),this.guidanceImage=new TKImage,this.guidanceImage.style={marginTop:this.vm.getGuidanceImageMarginTop(),marginLeft:this.vm.getGuidanceImageMarginLeft(),height:this.vm.getGuidanceImageWH(),width:this.vm.getGuidanceImageWH(),opacity:0},this.appendChild(this.guidanceImage)}setupData(){this.pendantTitle.setText(this.vm.getPendantTitleText()),this.pendantImage.setSrc(this.vm.getPendantImageUrl()),Ht(this.guidanceImage,"icon_ksad_hand_touch_guide.png")}setupAction(){const t=this;this.pendantImage&&this.vm.enableClickPendant()&&this.pendantImage.addEventListener("tap",(e=>{t.startHideAnimation(),this.vm.enableShowPendantClickAnim()?t.startClickAnimShowAnimation(e):t.vm.reportPendantClick(e)}))}startShowAnimation(){const t=this;this.startPendantImageShowAnimation((()=>{setTimeout((()=>{t.startPendantTitleShowAnimation((()=>{t.startGuidanceImageShowAnimation()}))}),500)})),this.vm.reportPendantImpression()}startPendantImageShowAnimation(t){const e=this,i=new TKKeyframeAnimation;i.setAnimations([()=>(e.pendantImage.style={transform:{scale:.6},opacity:0},0),()=>(e.pendantImage.style={transform:{scale:1},opacity:1},.56),()=>(e.pendantImage.style={transform:{scale:.9}},.78),()=>(e.pendantImage.style={transform:{scale:1}},1)]),i.timingFunction="ease-out",i.duration=700,i.on("end",(()=>{t&&t()})),this.pendantImage.addAnimation(i,"pendantImageShowAnimation")}startPendantTitleShowAnimation(t){const e=this,i=new TKKeyframeAnimation;i.setAnimations([()=>(e.pendantTitle.style={top:10,opacity:0},0),()=>(e.pendantTitle.style={top:0,opacity:1},1)]),i.timingFunction="ease-out",i.duration=300,i.on("end",(()=>{t&&t()})),this.pendantTitle.addAnimation(i,"pendantTitleShowAnimation")}stopActionAnimation(){this.animationAllowed=!1,this.guidanceImage&&this.guidanceImage.removeAllAnimation()}startGuidanceImageShowAnimation(){if(!this.vm.enableShowGuidanceImage())return;if(!this.animationAllowed)return!1;const t=ni(this.guidanceImage,200,!0);this.guidanceImage.addAnimation(t,"guidanceImageShowAnimation");const e=this;t.on("end",(()=>{e.startGuidanceImageMoveAnimation()}))}restartGuidanceImageMoveAnimationIfNeeded(){this.vm.enableShowGuidanceImage()&&(this.guidanceImage.removeAllAnimation(),this.startGuidanceImageMoveAnimation())}startGuidanceImageMoveAnimation(){const t=this;let e=new TKKeyframeAnimation;e.setAnimations([()=>(t.guidanceImage.style={transform:{translate:{x:0,y:0}}},.33),()=>(t.guidanceImage.style={transform:{translate:{x:10,y:10}}},.66),()=>(t.guidanceImage.style={transform:{translate:{x:0,y:0}}},1)]),e.duration=450,e.repeatCount=Number.MAX_SAFE_INTEGER,e.timingFunction="linear",this.guidanceImage.addAnimation(e,"guidanceImageMoveAnimation")}startHideAnimation(){this.startPendantImageHideAnimation();const t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.style={opacity:0},1)]),e.timingFunction="ease-out",e.duration=300,this.addAnimation(e,"pendantHideAnimation")}startPendantImageHideAnimation(){const t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.pendantImage.style={transform:{scale:.8}},1)]),e.timingFunction="ease-out",e.duration=300,this.pendantImage.addAnimation(e,"pendantImageHideAnimation")}createPendantClickAnimViewIfNeeded(t){this.vm.enableShowPendantClickAnim()&&(this.pendantClickAnimView=new mi(this.vm.pendantAnimViewModel),this.pendantClickAnimView.style={position:"absolute"},t.appendChild(this.pendantClickAnimView))}removePendantClickAnimViewIfNeeded(t){this.pendantClickAnimView&&t.removeChild(this.pendantClickAnimView)}startClickAnimShowAnimation(t){if(!this.pendantClickAnimView)return;this.pendantClickAnimView.show();const e=this;this.expireTimer=setTimeout((()=>{e.startClickAnimHideAnimation(),e.vm.reportPendantClick(t)}),this.vm.getPendantClickAnimDuration())}startClickAnimHideAnimation(){const t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.pendantClickAnimView.style={opacity:0},1)]),e.timingFunction="ease-out",e.duration=300,this.pendantClickAnimView.addAnimation(e,"pendantClickAnimHideAnimation")}clearTimeoutIfConverted(){this.expireTimer&&clearTimeout(this.expireTimer)}}class wi extends TKView{constructor(t,e){super(),this.vm=t,this.screenWidth=this.vm.callerContext.containerLimit.width,this.screenHeight=this.vm.callerContext.containerLimit.height,this.nextAnim=e,this.setupViews(),this.setupActions()}setupViews(){this.style={width:"100%",height:"100%",position:"absolute",top:0,left:0},this.throughHitTest=!0,this.setupPreHeatView(),setTimeout((()=>{this.vm.enableCountDown()?this.setBubbleAppearAnimation((()=>{this.vm.isShowEnd||(this.preHeatView.removeChild(this.preHeatBubbleRedPacketView),this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.setBubbleCountDownAnimation())}),wi.NEO_PREHEAT_ANIMATION_SPEED):this.vm.isSplash()?this.setBubbleAppearAnimation((()=>{this.vm.isShowEnd||(this.preHeatView.removeChild(this.preHeatBubbleRedPacketView),this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.setBubbleDisappearAnimation(wi.SPLASH_PREHEAT_ANIMATION_SPEED))}),wi.SPLASH_PREHEAT_ANIMATION_SPEED):this.setBubbleAppearAnimation((()=>{this.vm.isShowEnd||(this.preHeatView.removeChild(this.preHeatBubbleRedPacketView),this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.setBubbleDisappearAnimation(wi.INTERSTITIAL_PREHEAT_ANIMATION_SPEED))}),wi.INTERSTITIAL_PREHEAT_ANIMATION_SPEED)}),200)}setupPreHeatView(){this.preHeatView=new TKView,this.preHeatView.throughHitTest=!0,this.preHeatView.style={width:"100%",height:"100%",top:0,alignSelf:"center",flexDirection:"column",alignItems:"center"},this.appendChild(this.preHeatView),this.preHeatBubbleRedPacketView=new TKView,this.preHeatBubbleRedPacketView.throughHitTest=!0,this.preHeatBubbleRedPacketView.style={position:"absolute",width:"100%",height:"100%",top:0,opacity:0},this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.preHeatRedPacketView=new TKView,this.preHeatRedPacketView.style={position:"absolute",width:this.screenAdaptate(270),height:this.screenAdaptate(270),top:(this.screenHeight-this.screenAdaptate(270)-38)/2,alignSelf:"center"},this.preHeatBubbleRedPacketView.appendChild(this.preHeatRedPacketView);let t=this.vm.getIndustryTopIcon();this.preHeatRedPacket=new TKImage,Ft(t)?(this.preHeatRedPacket.style={position:"absolute",width:this.screenAdaptate(132),height:this.screenAdaptate(132),top:this.screenAdaptate(69),alignSelf:"center"},Ht(this.preHeatRedPacket,"image/BubbleRainResources/icon_ksad_bubble_rain_red_packet.png"),this.preHeatRedPacketView.appendChild(this.preHeatRedPacket),this.setupSubView(wi.LOGO_DISTANCE_WITHOUT_IP,wi.NUMBER_DISTANCE_WITHOUT_IP)):(this.preHeatRedPacket.style={position:"absolute",width:this.screenAdaptate(132),height:this.screenAdaptate(172),top:this.screenAdaptate(46),alignSelf:"center"},Ht(this.preHeatRedPacket,t),this.preHeatRedPacketView.appendChild(this.preHeatRedPacket),this.setupSubView(wi.LOGO_DISTANCE_WITH_IP,wi.NUMBER_DISTANCE_WITH_IP)),this.preHeatBubble=new TKImage,this.preHeatBubble.style={position:"absolute",width:this.screenAdaptate(270),height:this.screenAdaptate(270),top:(this.screenHeight-this.screenAdaptate(270)-38)/2,alignSelf:"center"},Ht(this.preHeatBubble,"image/BubbleRainResources/icon_ksad_bubble_rain_bubble.png"),this.preHeatBubbleRedPacketView.appendChild(this.preHeatBubble),this.preHeatDescView=new TKView,this.preHeatDescView.style={position:"absolute",width:202,height:38,top:(this.screenHeight+this.screenAdaptate(270)-38)/2,alignItems:"center"},this.preHeatView.appendChild(this.preHeatDescView),this.preHeatDescTextBackground=new TKView,this.preHeatDescTextBackground.style={width:202,height:38,borderRadius:20,gradientBgColor:"270, #FFF9EB, #B8976A, #DBC3A7"},this.preHeatDescView.appendChild(this.preHeatDescTextBackground),this.preHeatDescText=new TKText,this.preHeatDescText.style={position:"absolute",width:198,height:34,top:2,fontSize:16,color:"#FFFFFF",textLineHeight:22,borderRadius:20,textAlign:"center",fontWeight:"500",shadow:"0 1 3 #00000025",backgroundColor:"#FC4118"};let e=this.vm.getBubbleActionDes();Ft(e)&&(e="立即开启大促"),this.preHeatDescText.text=e,this.preHeatDescView.appendChild(this.preHeatDescText)}setupSubView(t,e){let i=this.vm.getRedPacketIndustryIcon();Ft(i)&&(i=""),this.preHeatLogo=new TKImage,this.preHeatLogo.style={position:"absolute",width:this.screenAdaptate(86),height:this.screenAdaptate(38),top:this.screenAdaptate(147+t),left:this.screenAdaptate(94)},Wt(this.preHeatLogo,i,500,(t=>{t||this.preHeatLogo.setVisibility("hidden")})),this.preHeatRedPacketView.appendChild(this.preHeatLogo),this.preHeatNumber3=new TKImage,this.preHeatNumber3.style={position:"absolute",width:this.screenAdaptate(24),height:this.screenAdaptate(34),top:this.screenAdaptate(146+e),left:this.screenAdaptate(122),opacity:0},Ht(this.preHeatNumber3,"image/BubbleRainResources/icon_ksad_bubble_rain_preheat_number3.png"),this.preHeatRedPacketView.appendChild(this.preHeatNumber3),this.preHeatNumber2=new TKImage,this.preHeatNumber2.style={position:"absolute",width:this.screenAdaptate(24),height:this.screenAdaptate(34),top:this.screenAdaptate(146+e),left:this.screenAdaptate(123),opacity:0},Ht(this.preHeatNumber2,"image/BubbleRainResources/icon_ksad_bubble_rain_preheat_number2.png"),this.preHeatRedPacketView.appendChild(this.preHeatNumber2),this.preHeatNumber1=new TKImage,this.preHeatNumber1.style={position:"absolute",width:this.screenAdaptate(14),height:this.screenAdaptate(35),top:this.screenAdaptate(146+e),left:this.screenAdaptate(127),opacity:0},Ht(this.preHeatNumber1,"image/BubbleRainResources/icon_ksad_bubble_rain_preheat_number1.png"),this.preHeatRedPacketView.appendChild(this.preHeatNumber1)}setBubbleAppearAnimation(t,e){let i=new TKKeyframeAnimation;_t()?i.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:.13,translate:{x:0,y:154,z:0},rotate:{x:0,y:180,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1.196,y:1.059},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]):i.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:.037,y:.13},translate:{x:0,y:154,z:0},rotate:{x:0,y:360,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1.196,y:1.059},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]),i.duration=400*e,i.timingFunction="0.0 0.0 0.0 1.0";let n=new TKKeyframeAnimation;n.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1.196,y:1.059},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:.985,y:1},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]),n.duration=200*e,n.timingFunction="0.0 0.0 0.56 1.0";let s=new TKKeyframeAnimation;s.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:.985,y:1},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1,y:1},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]),s.duration=250*e,s.timingFunction="linear",s.on("end",t),n.on("end",(()=>{this.vm.isShowEnd||this.preHeatBubbleRedPacketView.addAnimation(s,"bubbleAppearAnimation3")})),i.on("end",(()=>{this.vm.isShowEnd||this.preHeatBubbleRedPacketView.addAnimation(n,"bubbleAppearAnimation2")})),this.preHeatBubbleRedPacketView.addAnimation(i,"bubbleAppearAnimation1")}setBubbleCountDownAnimation(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.preHeatLogo.style={opacity:1},.001),()=>(this.preHeatLogo.style={opacity:0},1)]),t.duration=500,t.timingFunction="0.0 0.0 0.38 0.99",this.preHeatLogo.addAnimation(t,"logoAnimation");let e=new TKKeyframeAnimation;e.setAnimations([()=>(this.preHeatNumber3.style={opacity:0},.001),()=>(this.preHeatNumber3.style={opacity:1},5/7),()=>(this.preHeatNumber3.style={opacity:0},1)]),e.duration=700,e.timingFunction="0.0 0.0 0.38 0.99";let i=new TKKeyframeAnimation;i.setAnimations([()=>(this.preHeatNumber2.style={opacity:0},.001),()=>(this.preHeatNumber2.style={opacity:1},5/7),()=>(this.preHeatNumber2.style={opacity:0},1)]),i.duration=700,i.timingFunction="0.0 0.0 0.38 0.99";let n=new TKKeyframeAnimation;n.setAnimations([()=>(this.preHeatNumber1.style={opacity:0},.001),()=>(this.preHeatNumber1.style={opacity:1},1)]),n.duration=500,n.timingFunction="0.0 0.0 0.38 0.99",n.on("end",(()=>{this.vm.isShowEnd||this.setBubbleDisappearAnimation(wi.NEO_PREHEAT_ANIMATION_SPEED)})),i.on("end",(()=>{this.vm.isShowEnd||this.preHeatNumber1.addAnimation(n,"number1Animation")})),e.on("end",(()=>{this.vm.isShowEnd||this.preHeatNumber2.addAnimation(i,"number2Animation")})),this.preHeatNumber3.addAnimation(e,"number3Animation")}setBubbleDisappearAnimation(t){let e=new TKKeyframeAnimation;e.setAnimations([()=>(this.preHeatDescView.style={opacity:1},.001),()=>(this.preHeatDescView.style={opacity:0},1)]),e.duration=1e3*t,e.timingFunction="0.42 0.0 0.58 1.0",this.preHeatDescView.addAnimation(e,"buttonDisappearAnimation");let i=new TKKeyframeAnimation;i.setAnimations([()=>(this.preHeatBubble.style={transform:{scale:1,translate:{y:0}},opacity:1},.001),()=>(this.preHeatBubble.style={transform:{scale:9.47,translate:{y:250}},opacity:0},1)]),i.duration=1e3*t,i.timingFunction="0.42 0.0 0.58 1.0",this.preHeatBubble.addAnimation(i,"bubbleDisappearAnimation");let n=new TKKeyframeAnimation;n.setAnimations([()=>(this.preHeatRedPacketView.style={transform:{scale:1,translate:{y:0}}},.001),()=>(this.preHeatRedPacketView.style={transform:{scale:7.4,translate:{y:550}}},1)]),n.duration=1e3*t,n.timingFunction="0.42 0.0 0.58 1.0",this.preHeatRedPacketView.addAnimation(n,"redPacketEnlargeAnimation");let s=new TKKeyframeAnimation;s.setAnimations([()=>(this.preHeatRedPacketView.style={opacity:1},.001),()=>(this.preHeatRedPacketView.style={opacity:0},1)]),s.duration=1e3*t,s.on("end",(()=>{this.vm.isShowEnd||(this.nextAnim(),this.stopAllAnimation())})),this.preHeatRedPacketView.addAnimation(s,"redPacketDisappearAnimation")}setupActions(){let t=new r;t.template_show_type="bubble_id_click",this.preHeatDescText.addEventListener("tap",(e=>{this.vm.convert(1,{x:e.position.rawX,y:e.position.rawY},ae.BUBBLE_RAIN_CLICK,t)})),this.preHeatDescView.addEventListener("tap",(e=>{this.vm.convert(1,{x:e.position.rawX,y:e.position.rawY},ae.BUBBLE_RAIN_CLICK,t)})),this.preHeatBubble.addEventListener("tap",(e=>{this.vm.convert(1,{x:e.position.rawX,y:e.position.rawY},ae.BUBBLE_RAIN_CLICK,t)}))}stopAllAnimation(){this.preHeatBubbleRedPacketView&&this.preHeatBubbleRedPacketView.removeAllAnimation(),this.preHeatLogo&&this.preHeatLogo.removeAllAnimation(),this.preHeatNumber1&&this.preHeatNumber1.removeAllAnimation(),this.preHeatNumber2&&this.preHeatNumber2.removeAllAnimation(),this.preHeatNumber3&&this.preHeatNumber3.removeAllAnimation(),this.preHeatDescView&&this.preHeatDescView.removeAllAnimation(),this.preHeatBubble&&this.preHeatBubble.removeAllAnimation(),this.preHeatRedPacketView&&this.preHeatRedPacketView.removeAllAnimation(),this.removeAll()}screenAdaptate(t){return t*this.screenWidth/414}}wi.LOGO_DISTANCE_WITH_IP=17,wi.LOGO_DISTANCE_WITHOUT_IP=0,wi.NUMBER_DISTANCE_WITH_IP=17,wi.NUMBER_DISTANCE_WITHOUT_IP=0,wi.SPLASH_PREHEAT_ANIMATION_SPEED=.5,wi.NEO_PREHEAT_ANIMATION_SPEED=1,wi.INTERSTITIAL_PREHEAT_ANIMATION_SPEED=1;class gi extends TKView{constructor(t){super(),this.vm=t,this.animationMap=new Map,this.setupViews()}setupViews(){this.screenWidth=this.vm.callerContext.containerLimit.width,this.screenHeight=this.vm.callerContext.containerLimit.height,this.differenceLength=this.screenAdaptate(102)-this.screenHeight+896,this.style={width:"100%",height:"100%",position:"absolute",top:0,left:0},this.throughHitTest=!0,this.setBubbleRainAnimation()}setBubbleRainAnimation(){this.setBubbleAnimation1(),this.setBubbleAnimation2(),this.setBubbleAnimation3(),this.setBubbleAnimation4(),this.setBubbleAnimation5(),this.setBubbleAnimation6(),this.setBubbleAnimation7(),this.setBubbleAnimation8(),this.setBubbleAnimation9(),this.setBubbleAnimation10(),this.setBubbleAnimation11(),this.setBubbleAnimation12()}screenAdaptate(t){return t*this.screenWidth/414}bindBubbleRainAnim(){let t=this.vm.getRedPacketUrl(),e=this.vm.getRedPacketIndustryIcon();Ft(e)&&(e=""),this.bubbles=new Array;for(let i=1;i<=12;i++){let n=new TKView,s=new TKImage,a=new TKImage,o=new TKImage,l=new TKImage,h=new r;if(h.template_show_type="bubble_redpacket_click",5==i?(h.template_show_type="bubble_gold_redpacket_click",n.style={position:"absolute",width:this.screenAdaptate(259),height:this.screenAdaptate(259),top:0,left:0,opacity:0},this.appendChild(n),a.style={position:"absolute",width:this.screenAdaptate(139),height:this.screenAdaptate(139),top:this.screenAdaptate(57),left:this.screenAdaptate(61)},Ht(a,"image/BubbleRainResources/icon_ksad_bubble_rain_golden_red_packet.png"),n.appendChild(a),o.style={position:"absolute",width:this.screenAdaptate(86),height:this.screenAdaptate(38),top:this.screenAdaptate(83),left:this.screenAdaptate(88)},Wt(o,e,500,(t=>{t||o.setVisibility("hidden")})),n.appendChild(o),s.style={position:"absolute",width:this.screenAdaptate(259),height:this.screenAdaptate(259),top:0,left:0},Ht(s,"image/BubbleRainResources/icon_ksad_bubble_rain_golden_bubble.png"),n.appendChild(s)):(n.style={position:"absolute",width:this.screenAdaptate(204),height:this.screenAdaptate(204),top:0,left:0,opacity:0},this.appendChild(n),Ft(t)?(a.style={position:"absolute",width:this.screenAdaptate(110),height:this.screenAdaptate(110),top:this.screenAdaptate(47),left:this.screenAdaptate(47)},Ht(a,"image/BubbleRainResources/icon_ksad_bubble_rain_red_packet.png"),n.appendChild(a),o.style={position:"absolute",width:this.screenAdaptate(72),height:this.screenAdaptate(32),top:this.screenAdaptate(111),left:this.screenAdaptate(68)},Wt(o,e,500,(t=>{t||o.setVisibility("hidden")})),n.appendChild(o)):(l.style={position:"absolute",width:this.screenAdaptate(152),height:this.screenAdaptate(152),top:this.screenAdaptate(26),left:this.screenAdaptate(26)},Ht(l,t),n.appendChild(l)),s.style={position:"absolute",width:this.screenAdaptate(204),height:this.screenAdaptate(204),top:0,left:0},Ht(s,"image/BubbleRainResources/icon_ksad_bubble_rain_bubble.png"),n.appendChild(s)),n.addEventListener("tap",(t=>{this.vm.convert(1,{x:t.position.rawX,y:t.position.rawY},ae.BUBBLE_RAIN_CLICK,h)})),12==i){const t=this;Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_1"),n,"bubbleAnimation"+i+"_1",(e=>{if("end"==e){if(this.vm.isShowEnd)return;Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_2"),n,"bubbleAnimation"+i+"_2",(e=>{if("end"==e){if(this.vm.isShowEnd)return;Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_3"),n,"bubbleAnimation"+i+"_3",(e=>{if("end"==e){if(this.vm.isShowEnd)return;Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_4"),n,"bubbleAnimation"+i+"_4",(e=>{if("end"==e){if(this.vm.isShowEnd)return;t.onAnimateComplete&&t.onAnimateComplete()}}),"0.92 0.0 0.68 1.0")}}))}}),"0.51 0.57 0.69 0.94")}}),"0.0 0.0 0.0 0.99")}else Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_1"),n,"bubbleAnimation"+i+"_1",(t=>{if("end"==t){if(this.vm.isShowEnd)return;Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_2"),n,"bubbleAnimation"+i+"_2",(t=>{if("end"==t){if(this.vm.isShowEnd)return;Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_3"),n,"bubbleAnimation"+i+"_3",(t=>{if("end"==t){if(this.vm.isShowEnd)return;Qe.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_4"),n,"bubbleAnimation"+i+"_4",null,"0.92 0.0 0.68 1.0")}}))}}),"0.51 0.57 0.69 0.94")}}),"0.0 0.0 0.0 0.99");this.bubbles.push(n),this.appendChild(n)}}setBubbleAnimation1(){let t=new Array;t=[new Ge(1,.001),new je(90,.001),new je(-4.98,800),new Je(.126*-this.screenWidth,-813-this.differenceLength,.001),new Je(.118*-this.screenWidth,927-this.differenceLength,800)],this.animationMap.set("bubbleAnimation1_1",t);let e=new Array;e=[new Ge(1,.001),new je(-4.98,.001),new je(1,900),new Je(.118*-this.screenWidth,927-this.differenceLength,.001),new Je(.116*-this.screenWidth,829-this.differenceLength,900)],this.animationMap.set("bubbleAnimation1_2",e);let i=new Array;i=[new Ge(1,.001),new je(1,.001),new je(0,600),new Je(.116*-this.screenWidth,829-this.differenceLength,.001),new Je(.116*-this.screenWidth,835-this.differenceLength,600)],this.animationMap.set("bubbleAnimation1_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.116*-this.screenWidth,835-this.differenceLength,.001),new Je(.116*-this.screenWidth,1211-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation1_4",n)}setBubbleAnimation2(){let t=new Array;t=[new Ge(1,.001),new je(90,.001),new je(-4.98,800),new Je(.167*this.screenWidth,-425-this.differenceLength,.001),new Je(.258*this.screenWidth,789-this.differenceLength,800)],this.animationMap.set("bubbleAnimation2_1",t);let e=new Array;e=[new Ge(1,.001),new je(-4.98,.001),new je(1,900),new Je(.258*this.screenWidth,789-this.differenceLength,.001),new Je(.254*this.screenWidth,718-this.differenceLength,900)],this.animationMap.set("bubbleAnimation2_2",e);let i=new Array;i=[new Ge(1,.001),new je(1,.001),new je(0,600),new Je(.254*this.screenWidth,718-this.differenceLength,.001),new Je(.254*this.screenWidth,724-this.differenceLength,600)],this.animationMap.set("bubbleAnimation2_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.254*this.screenWidth,724-this.differenceLength,.001),new Je(.254*this.screenWidth,1281-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation2_4",n)}setBubbleAnimation3(){let t=new Array;t=[new Ge(1,.001),new je(-90,.001),new je(4.98,800),new Je(.587*this.screenWidth,-706-this.differenceLength,.001),new Je(.587*this.screenWidth,949-this.differenceLength,800)],this.animationMap.set("bubbleAnimation3_1",t);let e=new Array;e=[new Ge(1,.001),new je(4.98,.001),new je(-1,900),new Je(.587*this.screenWidth,949-this.differenceLength,.001),new Je(.587*this.screenWidth,855-this.differenceLength,900)],this.animationMap.set("bubbleAnimation3_2",e);let i=new Array;i=[new Ge(1,.001),new je(-1,.001),new je(0,600),new Je(.587*this.screenWidth,855-this.differenceLength,.001),new Je(.587*this.screenWidth,861-this.differenceLength,600)],this.animationMap.set("bubbleAnimation3_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.587*this.screenWidth,861-this.differenceLength,.001),new Je(.589*this.screenWidth,1318-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation3_4",n)}setBubbleAnimation4(){let t=new Array;t=[new Ge(1,.001),new je(-90,.001),new je(4.98,800),new Je(.71*this.screenWidth,-480-this.differenceLength,.001),new Je(.71*this.screenWidth,719-this.differenceLength,800)],this.animationMap.set("bubbleAnimation4_1",t);let e=new Array;e=[new Ge(1,.001),new je(4.98,.001),new je(-1,900),new Je(.71*this.screenWidth,719-this.differenceLength,.001),new Je(.71*this.screenWidth,654-this.differenceLength,900)],this.animationMap.set("bubbleAnimation4_2",e);let i=new Array;i=[new Ge(1,.001),new je(-1,.001),new je(0,600),new Je(.71*this.screenWidth,654-this.differenceLength,.001),new Je(.71*this.screenWidth,660-this.differenceLength,600)],this.animationMap.set("bubbleAnimation4_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.71*this.screenWidth,660-this.differenceLength,.001),new Je(.71*this.screenWidth,1008-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation4_4",n)}setBubbleAnimation5(){let t=this.screenAdaptate(130)-this.screenHeight+896,e=new Array;e=[new Ge(1,.001),new je(-90,.001),new je(4.98,800),new Je(.08*-this.screenWidth,-641-t,.001),new Je(.08*-this.screenWidth,604-t,800)],this.animationMap.set("bubbleAnimation5_1",e);let i=new Array;i=[new Ge(1,.001),new je(4.98,.001),new je(-1,900),new Je(.08*-this.screenWidth,604-t,.001),new Je(.08*-this.screenWidth,533-t,900)],this.animationMap.set("bubbleAnimation5_2",i);let n=new Array;n=[new Ge(1,.001),new je(-1,.001),new je(0,600),new Je(.08*-this.screenWidth,533-t,.001),new Je(.08*-this.screenWidth,538-t,600)],this.animationMap.set("bubbleAnimation5_3",n);let s=new Array;s=[new Ge(1,.001),new je(0,.001),new Je(.08*-this.screenWidth,538-t,.001),new Je(.08*-this.screenWidth,1210-t,2e3)],this.animationMap.set("bubbleAnimation5_4",s)}setBubbleAnimation6(){let t=new Array;t=[new Ge(1,.001),new je(90,.001),new je(-4.98,800),new Je(.483*this.screenWidth,-287-this.differenceLength,.001),new Je(.505*this.screenWidth,524-this.differenceLength,800)],this.animationMap.set("bubbleAnimation6_1",t);let e=new Array;e=[new Ge(1,.001),new je(-4.98,.001),new je(1,900),new Je(.505*this.screenWidth,524-this.differenceLength,.001),new Je(.505*this.screenWidth,477-this.differenceLength,900)],this.animationMap.set("bubbleAnimation6_2",e);let i=new Array;i=[new Ge(1,.001),new je(1,.001),new je(0,600),new Je(.505*this.screenWidth,477-this.differenceLength,.001),new Je(.505*this.screenWidth,481-this.differenceLength,600)],this.animationMap.set("bubbleAnimation6_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.505*this.screenWidth,481-this.differenceLength,.001),new Je(.505*this.screenWidth,1578-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation6_4",n)}setBubbleAnimation7(){let t=new Array;t=[new Ge(1,.001),new je(90,.001),new je(-4.98,800),new Je(.097*this.screenWidth,-776-this.differenceLength,.001),new Je(.053*this.screenWidth,376-this.differenceLength,800)],this.animationMap.set("bubbleAnimation7_1",t);let e=new Array;e=[new Ge(1,.001),new je(-4.98,.001),new je(1,900),new Je(.053*this.screenWidth,376-this.differenceLength,.001),new Je(.058*this.screenWidth,319-this.differenceLength,900)],this.animationMap.set("bubbleAnimation7_2",e);let i=new Array;i=[new Ge(1,.001),new je(1,.001),new je(0,600),new Je(.058*this.screenWidth,319-this.differenceLength,.001),new Je(.058*this.screenWidth,325-this.differenceLength,600)],this.animationMap.set("bubbleAnimation7_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.058*this.screenWidth,325-this.differenceLength,.001),new Je(.058*this.screenWidth,1470-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation7_4",n)}setBubbleAnimation8(){let t=new Array;t=[new Ge(1,.001),new je(90,.001),new je(-4.98,800),new Je(.529*this.screenWidth,-581-this.differenceLength,.001),new Je(.57*this.screenWidth,323-this.differenceLength,800)],this.animationMap.set("bubbleAnimation8_1",t);let e=new Array;e=[new Ge(1,.001),new je(-4.98,.001),new je(1,900),new Je(.57*this.screenWidth,323-this.differenceLength,.001),new Je(.57*this.screenWidth,271-this.differenceLength,900)],this.animationMap.set("bubbleAnimation8_2",e);let i=new Array;i=[new Ge(1,.001),new je(1,.001),new je(0,600),new Je(.57*this.screenWidth,271-this.differenceLength,.001),new Je(.57*this.screenWidth,275-this.differenceLength,600)],this.animationMap.set("bubbleAnimation8_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.57*this.screenWidth,275-this.differenceLength,.001),new Je(.57*this.screenWidth,1442-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation8_4",n)}setBubbleAnimation9(){let t=new Array;t=[new Ge(1,.001),new je(-90,.001),new je(4.98,800),new Je(.188*-this.screenWidth,-599-this.differenceLength,.001),new Je(.188*-this.screenWidth,199-this.differenceLength,800)],this.animationMap.set("bubbleAnimation9_1",t);let e=new Array;e=[new Ge(1,.001),new je(4.98,.001),new je(-1,900),new Je(.188*-this.screenWidth,199-this.differenceLength,.001),new Je(.188*-this.screenWidth,153-this.differenceLength,900)],this.animationMap.set("bubbleAnimation9_2",e);let i=new Array;i=[new Ge(1,.001),new je(-1,.001),new je(0,600),new Je(.188*-this.screenWidth,153-this.differenceLength,.001),new Je(.188*-this.screenWidth,158-this.differenceLength,600)],this.animationMap.set("bubbleAnimation9_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.188*-this.screenWidth,158-this.differenceLength,.001),new Je(.188*-this.screenWidth,1379-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation9_4",n)}setBubbleAnimation10(){let t=new Array;t=[new Ge(1,.001),new je(90,.001),new je(-4.98,800),new Je(.312*this.screenWidth,-513-this.differenceLength,.001),new Je(.312*this.screenWidth,136-this.differenceLength,800)],this.animationMap.set("bubbleAnimation10_1",t);let e=new Array;e=[new Ge(1,.001),new je(-4.98,.001),new je(1,900),new Je(.312*this.screenWidth,136-this.differenceLength,.001),new Je(.312*this.screenWidth,99-this.differenceLength,900)],this.animationMap.set("bubbleAnimation10_2",e);let i=new Array;i=[new Ge(1,.001),new je(1,.001),new je(0,600),new Je(.312*this.screenWidth,99-this.differenceLength,.001),new Je(.312*this.screenWidth,103-this.differenceLength,600)],this.animationMap.set("bubbleAnimation10_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.312*this.screenWidth,103-this.differenceLength,.001),new Je(.312*this.screenWidth,1386-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation10_4",n)}setBubbleAnimation11(){let t=new Array;t=[new Ge(1,.001),new je(-90,.001),new je(4.98,800),new Je(.036*-this.screenWidth,-425-this.differenceLength,.001),new Je(.036*-this.screenWidth,-17-this.differenceLength,800)],this.animationMap.set("bubbleAnimation11_1",t);let e=new Array;e=[new Ge(1,.001),new je(4.98,.001),new je(-1,900),new Je(.036*-this.screenWidth,-17-this.differenceLength,.001),new Je(.036*-this.screenWidth,-43-this.differenceLength,900)],this.animationMap.set("bubbleAnimation11_2",e);let i=new Array;i=[new Ge(1,.001),new je(-1,.001),new je(0,600),new Je(.036*-this.screenWidth,-43-this.differenceLength,.001),new Je(.036*-this.screenWidth,-36-this.differenceLength,600)],this.animationMap.set("bubbleAnimation11_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.036*-this.screenWidth,-36-this.differenceLength,.001),new Je(.036*-this.screenWidth,1566-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation11_4",n)}setBubbleAnimation12(){let t=new Array;t=[new Ge(1,.001),new je(90,.001),new je(-4.98,800),new Je(.792*this.screenWidth,-146-this.differenceLength,.001),new Je(.792*this.screenWidth,17-this.differenceLength,800)],this.animationMap.set("bubbleAnimation12_1",t);let e=new Array;e=[new Ge(1,.001),new je(-4.98,.001),new je(1,900),new Je(.792*this.screenWidth,17-this.differenceLength,.001),new Je(.792*this.screenWidth,7-this.differenceLength,900)],this.animationMap.set("bubbleAnimation12_2",e);let i=new Array;i=[new Ge(1,.001),new je(1,.001),new je(0,600),new Je(.792*this.screenWidth,7-this.differenceLength,.001),new Je(.792*this.screenWidth,10-this.differenceLength,600)],this.animationMap.set("bubbleAnimation12_3",i);let n=new Array;n=[new Ge(1,.001),new je(0,.001),new Je(.792*this.screenWidth,10-this.differenceLength,.001),new Je(.792*this.screenWidth,1526-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation12_4",n)}stopAllAnimation(){if(!Ft(this.bubbles))for(let t=0;t<this.bubbles.length;t++)this.bubbles[t].removeAllAnimation();this.removeAll()}}class Ci{constructor(t){this.currentPlaybackTimeMs=0,this.countDownTime=0,this.isTimerPaused=!1,this.mTimerInterval=500,this.mTotalStayTime=0,this.mTotalStayTime=t}setTotalPlayTime(t){t&&(this.mTotalStayTime=t)}setTimerInterval(t){t&&(this.mTimerInterval=t)}play(){this.startTimer()}paused(){this.isTimerPaused=!0}resume(){this.isTimerPaused=!1}stop(){this.stopTimer()}startTimer(){this.mTimer&&clearInterval(this.mTimer),this.mTimer=setInterval((()=>{this.isTimerPaused||(this.currentPlaybackTimeMs+=this.mTimerInterval,this.onCurrentPlaybackCallback&&this.onCurrentPlaybackCallback(this.currentPlaybackTimeMs),this.currentPlaybackTimeMs>=this.mTotalStayTime?(this.stopTimer(),this.onFinishCallback&&this.onFinishCallback()):this.currentPlaybackTimeMs<this.mTotalStayTime&&(this.countDownTime=(this.mTotalStayTime-this.currentPlaybackTimeMs)/1e3,this.countDownCallback&&this.countDownCallback(this.countDownTime)))}),this.mTimerInterval)}stopTimer(){this.mTimer&&clearInterval(this.mTimer)}}class fi extends TKView{constructor(t){super(),this.hasRemove=!1,this.vm=t,this.throughHitTest=!0,this.style={width:"100%",height:"100%",position:"absolute",top:0,left:0};const e=this;this.timePlay=new Ci(this.vm.getDelayTime()),this.timePlay.onFinishCallback=()=>{e.vm.hasShown=!0,e.vm.reportElementImpression(),e.setupViews()},fe().on(me,(t=>{this.vm.hasShown&&(this.vm.isShowEnd=!0)})),ze(this.vm.$attrsPath.isShowEnd,(t=>{t&&this.onDismiss()})),ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"showEnd":this.timePlay.play();break;case"pageInvisiable":this.timePlay.paused();break;case"pageVisiable":this.timePlay.resume();break;case"hideEnd":this.vm.isShowEnd=!0}}))}setupViews(){const t=this;this.preHeatView=new wi(this.vm,(()=>{t.rainFallView=new gi(this.vm),t.rainFallView.onAnimateComplete=()=>{t.onDismiss()},t.appendChild(this.rainFallView),t.rainFallView.bindBubbleRainAnim()})),this.appendChild(this.preHeatView)}onDismiss(){this.hasRemove||(this.hasRemove=!0,this.preHeatView&&this.preHeatView.stopAllAnimation(),this.rainFallView&&this.rainFallView.stopAllAnimation(),this.timePlay.stop(),this.style={visibility:"hidden"},this.onDismissComplete&&this.onDismissComplete())}}class vi extends TKView{constructor(t){super(),this.vm=t,this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute"},this.throughHitTest=!0,this.setPreloadData(),this.preloadView(),this.produceAnimation(),this.setupAction()}setPreloadData(){this.imageViews=new Array,this.animationMap=new Map,this.imageSrcs=new Array,this.levelsConfig=[8,10,9,7,5,4,13,12,11,6,3,2,1];for(let t=0;t<3;t++){let e="image/ksad-compose-image/GiftBox/ksad_gift_box_"+t+".png",i=this.vm.getGiftBoxIconUrls()[t];this.imageSrcs.push(Ft(i)?e:i)}}preloadView(){this.vm.callerContext.containerLimit.width;let t=this.vm.callerContext.containerLimit.height,e=this.vm.callerContext.containerLimit.width/375,i=[85*e,215.5*e,-28*e,100*e,-10*e,170*e,223*e,-59*e,27*e,-27*e,198.5*e,113.5*e,60*e],n=[0,0,0,1,0,0,1,0,1,0,2,2,0];3==this.vm.callerContext.adStyle||2==this.vm.callerContext.adStyle?Ut.isAndroid()?this.appendHeight=70*e/t:this.appendHeight=100*e/t:this.appendHeight=53*e/t;for(let s=0;s<13;s++){let t=new TKImage;t.style={position:"absolute",width:195*e,height:195*e,top:200*-e,left:i[s],right:0,opacity:1},Wt(t,this.imageSrcs[n[s]],500,(e=>{e||(this.hasLoadFailed=!0,Ht(t,"image/ksad-compose-image/GiftBox/ksad_gift_box_"+n[s]+".png"))})),this.imageViews.push(t)}}produceAnimation(){this.configGiftBoxAnimation1(),this.configGiftBoxAnimation2(),this.configGiftBoxAnimation3(),this.configGiftBoxAnimation4(),this.configGiftBoxAnimation5(),this.configGiftBoxAnimation6(),this.configGiftBoxAnimation7(),this.configGiftBoxAnimation8(),this.configGiftBoxAnimation9(),this.configGiftBoxAnimation10(),this.configGiftBoxAnimation11(),this.configGiftBoxAnimation12(),this.configGiftBoxAnimation13()}configGiftBoxAnimation1(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(0,500),new je(-18,600),new Je(0,0,0),new Je(0,1.025*t+t*this.appendHeight,500)],this.animationMap.set("animation0",e)}configGiftBoxAnimation2(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(-45,0),new je(-45,700),new je(-60,800),new Je(0,0,500),new Je(0,1.024*t+t*this.appendHeight,700)],this.animationMap.set("animation1",e)}configGiftBoxAnimation3(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(-60,0),new je(-60,750),new je(-40,850),new Je(0,0,550),new Je(0,1.034*t+t*this.appendHeight,750)],this.animationMap.set("animation2",e)}configGiftBoxAnimation4(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(-100,0),new Je(0,0,600),new Je(0,.93*t+t*this.appendHeight,750),new Je(0,.91*t+t*this.appendHeight,800),new Je(0,.945*t+t*this.appendHeight,850)],this.animationMap.set("animation3",e)}configGiftBoxAnimation5(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(-100,0),new je(-100,800),new je(-85,850),new Je(0,0,600),new Je(0,.95*t+t*this.appendHeight,800)],this.animationMap.set("animation4",e)}configGiftBoxAnimation6(){let t=this.vm.callerContext.containerLimit.height,e=new Array,i=new je(-15,0),n=new Je(0,0,800);e=[i,n,n,new Je(0,.925*t+t*this.appendHeight,1050)],this.animationMap.set("animation5",e)}configGiftBoxAnimation7(){let t=this.vm.callerContext.containerLimit.width,e=this.vm.callerContext.containerLimit.height,i=new Array;i=[new je(35,0),new je(35,1050),new je(105,1150),new Je(0,0,850),new Je(0,.825*e+e*this.appendHeight,1050),new Je(.1*t,.925*e+e*this.appendHeight,1150)],this.animationMap.set("animation6",i)}configGiftBoxAnimation8(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Je(0,0,900),new Je(0,.92*t+t*this.appendHeight,1200)],this.animationMap.set("animation7",e)}configGiftBoxAnimation9(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(-35,0),new je(-35,1400),new je(-25,1500),new Je(0,0,1100),new Je(0,.835*t+t*this.appendHeight,1400)],this.animationMap.set("animation8",e)}configGiftBoxAnimation10(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(-60,0),new je(-60,1850),new je(-40,1950),new Je(0,0,1650),new Je(0,.777*t+t*this.appendHeight,1850)],this.animationMap.set("animation9",e)}configGiftBoxAnimation11(){let t=this.vm.callerContext.containerLimit.width,e=this.vm.callerContext.containerLimit.height,i=new Array;i=[new je(70,0),new je(70,1950),new je(95,2150),new Je(0,0,1650),new Je(0,.803*e+e*this.appendHeight,1950),new Je(.05*t,.823*e+e*this.appendHeight,2150)],this.animationMap.set("animation10",i)}configGiftBoxAnimation12(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(8,0),new Je(0,0,1650),new Je(0,.795*t+t*this.appendHeight,1900)],this.animationMap.set("animation11",e)}configGiftBoxAnimation13(){this.vm.callerContext.containerLimit.width;let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new je(-15,0),new je(-15,2600),new je(-40,2750),new Je(0,0,2400),new Je(0,.682*t+t*this.appendHeight,2600),new Je(.02*-t,.702*t+t*this.appendHeight,2750)],this.animationMap.set("animation12",e)}setupAction(){const t=this;for(let e=0;e<this.imageViews.length;e++)this.appendChild(this.imageViews[this.levelsConfig[e]-1]),this.imageViews[this.levelsConfig[e]-1].addEventListener("tap",(e=>{this.hasClicked=!0,t.clickCallback&&t.clickCallback(),t.setVisibility("gone")}))}show(){console.log("giftbox multibox show"+this.imageViews.length);for(let e=0;e<this.imageViews.length;e++)Qe.bindAnimation(this.animationMap.get("animation"+(this.levelsConfig[e]-1)),this.imageViews[this.levelsConfig[e]-1],"showAnimation"+e);const t=this;setTimeout((()=>{t.dismiss()}),this.vm.getGiftBoxShowTime()-1500)}dismiss(){if(this.hasClicked||this.hasDismissed)return;let t=new Ge(1,0),e=new Ge(0,150);const i=this;Qe.bindAnimation([t,e],this,"dismissAnimation",(t=>{i.hasClicked||i.hasDismissed||"end"==t&&(i.autoDismissCallback&&i.autoDismissCallback(),i.hasDismissed=!0,i.setVisibility("gone"),console.log("giftbox multibox dismiss"))}))}}class yi extends TKView{constructor(t){super(),this.vm=t,this.setupViews(),this.setupData(),this.setupAction()}setupViews(){this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",visibility:"hidden"},this.throughHitTest=!0,this.guideView=new TKView,this.guideView.style={justifyContent:"center",alignItems:"center",opacity:0},this.appendChild(this.guideView),this.guideLabel=new TKText,this.guideLabel.style={height:36,paddingLeft:20,paddingRight:20,backgroundColor:"#0D0000B2",textAlign:"center",color:"#FFFFFF",borderRadius:18,fontWeight:"bold"},this.guideView.appendChild(this.guideLabel),this.guideImageView=new TKImage,this.guideImageView.style={width:12,height:6},this.guideView.appendChild(this.guideImageView),this.giftBoxImage=new TKImage,this.giftBoxImage.style={marginTop:-7,width:195,height:195,opacity:0},this.appendChild(this.giftBoxImage)}setupData(){let t="image/ksad-compose-image/GiftBox/ksad_gift_box_0.png",e=Ft(this.vm.getGiftBoxIconUrls()[0])?t:this.vm.getGiftBoxIconUrls()[0];Wt(this.giftBoxImage,e,500,(e=>{e||(Ht(this.giftBoxImage,t),this.hasLoadFailed=!0)})),this.guideLabel.setText(this.vm.getSingleBoxGuideText()),Ht(this.guideImageView,"icon_ksad_gift_box_guide_arrow.png")}setupAction(){const t=this;this.giftBoxImage.addEventListener("tap",(e=>{t.hasClicked=!0,t.clickCallback&&t.clickCallback(),t.dismiss()}))}autoDismiss(){this.hasClicked||(this.autoDismissCallback&&this.autoDismissCallback(),this.dismiss())}startShowAnimation(){const t=this,e=ni(this.giftBoxImage,300,!0);e.on("end",(()=>{t.startShakeAnimation()})),this.giftBoxImage.addAnimation(e,"giftBoxShowAnimation");const i=ni(this.guideView,300,!0);this.guideView.addAnimation(i,"guideShowAnimation")}startShakeAnimation(){const t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.giftBoxImage.style={transform:{rotate:20}},.16),()=>(t.giftBoxImage.style={transform:{rotate:0}},.32),()=>(t.giftBoxImage.style={transform:{rotate:-20}},.48),()=>(t.giftBoxImage.style={transform:{rotate:0}},.64),()=>(t.giftBoxImage.style={transform:{rotate:20}},.8),()=>(t.giftBoxImage.style={transform:{rotate:0}},1)]),e.duration=900,e.timingFunction="linear",e.on("end",(()=>{t.startHideAnimation()})),this.giftBoxImage.addAnimation(e,"shakeAnimation")}startHideAnimation(){const t=this,e=si(this.giftBoxImage,200,!0);e.on("end",(()=>{t.autoDismiss()})),this.giftBoxImage.addAnimation(e,"giftBoxHideAnimation");const i=si(this.guideView,200,!0);this.guideView.addAnimation(i,"guideHideAnimation")}show(){console.log("giftbox singlebox show"),this.style={visibility:"visible"},this.startShowAnimation()}dismiss(){this.style={visibility:"hidden"},this.setVisibility("gone")}}class Vi extends TKView{constructor(t){super(),this.lottieLoadFailed=!1,this.vm=t,this.setupViews(),this.setupData()}setupViews(){this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",visibility:"hidden"},this.throughHitTest=!0;const t=this,e=Math.ceil(812*Tachikoma.env.deviceWidth/375);Ut.supportMinimumTKVersion("5.0.0")&&(this.couponView=new TKLottieImageView,this.couponView.style={width:"100%",height:e,opacity:0},this.couponView.enabled=!1,this.couponView.setLoop(!1),this.couponView.onAnimationLoaded((e=>{e||(console.log("giftbox transition load animation failed"),t.lottieLoadFailed=!0)})),this.couponView.onAnimationEnd((()=>{t.convert()})),this.appendChild(this.couponView))}setupData(){this.couponView&&this.couponView.setUri(this.vm.getClickAnimationLottieUrl())}startShowAnimation(){this.style={visibility:"visible"},this.startCouponViewFallAnimation()}startCouponViewFallAnimation(){this.couponView&&(this.couponView.style={opacity:1},this.couponView.play())}convert(){this.hasConverted||(this.hasConverted=!0,this.vm.reportGiftBoxClick())}show(){this.vm.enableShowClickAnimation()&&!this.lottieLoadFailed?(console.log("giftbox transition show"),this.startShowAnimation(),setTimeout((()=>{this.convert()}),2300)):this.convert()}}class Ii{static reportGiftBoxShowEvent(t){try{ie({category:"ad_client_apm_log",biz:"TACHIKOMA",sub_biz:"OTHER",rate:t?.1:.001,suffixRatio:"",event_id:"ad_huge_scene_render_performance",primaryKey:"status",type:"OTHER",msg:{load_status:t?2:1,scene:"gift_box",status:1}})}catch(e){}}static reportGiftBoxClickEvent(t){try{ie({category:"ad_client_apm_log",biz:"TACHIKOMA",sub_biz:"OTHER",rate:t?.1:.001,suffixRatio:"",event_id:"ad_huge_scene_render_performance",primaryKey:"status",type:"OTHER",msg:{load_status:t?2:1,scene:"gift_box",status:2}})}catch(e){}}}class Ti extends TKView{constructor(t){super(),this.vm=t,this.setupViews();const e=this;ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{"showEnd"===t&&(2!=e.vm.callerContext.adStyle&&3!=e.vm.callerContext.adStyle||e.startDelayTimerIfNeeded()),"pageVisiable"===t&&e.startDelayTimerIfNeeded(),"pageInvisiable"===t&&e.stopDelayTimerIfNeeded()})),fe().on(me,(t=>{setTimeout((()=>{console.log("giftbox dismiss"),e.transitionView&&(e.transitionView.hasConverted=!0),e.dismissCallback&&e.dismissCallback()}),500)}))}setupViews(){this.style={width:"100%",height:"100%"},this.throughHitTest=!0;const t=this;this.singleBoxView=new yi(this.vm),this.singleBoxView.autoDismissCallback=()=>{console.log("giftbox singlebox auto dissmiss"),t.multiBoxView&&t.multiBoxView.show()},this.singleBoxView.clickCallback=()=>{console.log("giftbox singlebox click"),t.convert()},this.appendChild(this.singleBoxView),this.multiBoxView=new vi(this.vm),this.multiBoxView.clickCallback=()=>{console.log("giftbox multibox click"),t.convert()},this.multiBoxView.autoDismissCallback=()=>{t.dismissCallback&&t.dismissCallback()},this.appendChild(this.multiBoxView),this.transitionView=new Vi(this.vm),this.appendChild(this.transitionView)}show(){console.log("giftbox show"),this.vm.hasShown=!0,this.vm.showMultiBoxViewDirectly()?this.multiBoxView&&this.multiBoxView.show():this.singleBoxView&&this.singleBoxView.show(),this.vm.reportGiftBoxImpression();let t=this.singleBoxView.hasLoadFailed||this.multiBoxView.hasLoadFailed;Ii.reportGiftBoxShowEvent(t)}hide(){this.style={visibility:"gone"},this.dismissCallback&&this.dismissCallback()}convert(){this.transitionView&&this.transitionView.show();let t=this.singleBoxView.hasLoadFailed||this.multiBoxView.hasLoadFailed;Ii.reportGiftBoxClickEvent(t)}startDelayTimerIfNeeded(){if(this.vm.hasShown)return;if(this.vm.getGiftBoxDelayTime()<=0)return void this.show();if(this.delayTimer)return void this.delayTimer.resume();this.delayTimer=new Ci(this.vm.getGiftBoxDelayTime()),this.delayTimer.play();const t=this;this.delayTimer.onFinishCallback=()=>{t.show()}}stopDelayTimerIfNeeded(){this.vm.hasShown||this.delayTimer&&this.delayTimer.paused()}}class Si extends TKView{constructor(t){super(),this.vm=t,this.setupView(),ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{"showStart"===t&&(this.vm.enableShowRedPacketsRain()?this.vm.startRedPacketsRainTimer():this.vm.enableShowFestivalPendantView()&&this.createFestivalPendantView()),"pageInvisiable"==t&&this.festivalPendantView&&this.festivalPendantView.clearTimeoutIfConverted()})),He(this.vm,this.vm.$attrsPath.showRedPacketRain,(t=>{t&&this.redPackView&&this.redPackView.show()})),ze(this.vm.$attrsPath.callerContext.adHasConvert,(t=>{t&&(this.redPackView&&this.redPackView.hide(!0),this.festivalPendantView&&this.festivalPendantView.clearTimeoutIfConverted())}))}setupView(){if(this.throughHitTest=!0,this.style={position:"absolute",width:"100%",height:"100%",justifyContent:"center"},this.vm.enableShowGiftBoxView())this.createGiftBoxView();else if(this.vm.enableShowBubbleRain())this.bubbleRainView=new fi(this.vm.bubbleRainViewModel),this.bubbleRainView.onDismissComplete=()=>{this.removeChild(this.bubbleRainView)},this.appendChild(this.bubbleRainView);else if(this.vm.enableShowRedPacketsRain()){this.redPackView=new mi(this.vm.redPacketViewModel),this.appendChild(this.redPackView);const t=this;this.vm.redPacketViewModel.dismissCallback=()=>{t.vm.enableShowFestivalPendantView()&&t.createFestivalPendantView()}}}createFestivalPendantView(){this.festivalPendantView||(this.festivalPendantView=new ui(this.vm.festivalPendantViewModel),this.festivalPendantView.style={position:"absolute",left:this.vm.getFestivalPendantViewLeft(),top:this.vm.callerContext.isRotateAndSlideStyle()?"45%":this.vm.isNeedNewStyleTop()?this.vm.getFestivalPendantViewTop()-65:this.vm.getFestivalPendantViewTop()},this.vm.callerContext.isSpecialShapeStyle()&&this.vm.callerContext.isSpecialShapeFirstStyle()&&(this.festivalPendantView.style={left:this.vm.getFestivalPendantViewLeft()+32,top:this.vm.getFestivalPendantViewTop()-50}),this.vm.callerContext.isSpecialShapeStyle()&&!this.vm.callerContext.isSpecialShapeFirstStyle()&&(this.festivalPendantView.style={left:this.vm.getFestivalPendantViewLeft()+20,top:this.vm.getFestivalPendantViewTop()-60}),this.appendChild(this.festivalPendantView),this.festivalPendantView.createPendantClickAnimViewIfNeeded(this))}createGiftBoxView(){if(this.giftBoxView)return;const t=this;this.giftBoxView=new Ti(this.vm.giftBoxViewModel),this.giftBoxView.dismissCallback=()=>{t.removeChild(t.giftBoxView)},this.appendChild(this.giftBoxView)}}class bi extends TKView{constructor(t=!1){super(),this.style={width:"100%",height:"100%",position:"absolute",flexDirection:"column",justifyContent:"center",alignItems:"center"},t||(this.addEventListener("tap",(t=>{})),this.addEventListener("swipe",(t=>{})))}showDialog(t){t.removeChild(this),this.style={visibility:"visible"},t.appendChild(this),this.dialogContainer=t}isShowing(){return"visible"==this.style.visibility}dismiss(){this.style={visibility:"hidden"},this.dialogContainer&&this.dialogContainer.removeChild(this)}}class Ai extends TKView{constructor(t,e){if(super(),0==t.length&&(t="提示"),this.message=t,0==e.length){const t=this;e=[new xi("确定",1,(()=>{t.dismiss()}))]}this.actionList=e,this.setupView()}setupView(){this.style={width:"100%",height:"100%",backgroundColor:"#00000080",opacity:0},this.backgroundView=new TKView,this.backgroundView.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},this.appendChild(this.backgroundView);this.contentView=new TKView,this.contentView.style={width:280,backgroundColor:"#FFFFFF",borderRadius:12,flexDirection:"column-reverse"},this.backgroundView.appendChild(this.contentView);const t=(280-(this.actionList.length-1))/this.actionList.length;this.actionButtonsView=new TKView,this.actionButtonsView.style={width:"100%",height:49,backgroundColor:"#EAEAEA",paddingTop:1,flexDirection:"row",bottomLeftRadius:12,bottomRightRadius:12},this.contentView.appendChild(this.actionButtonsView);for(let e=0;e<this.actionList.length;e++){const i=this.actionList[e],n=new TKButton;n.style={width:t,height:48,marginRight:1,fontSize:17,color:1==i.style?"#FE3666":"#666666",backgroundColor:"#FFFFFF",textAlign:"center",textOverflow:"ellipsis",textLineClamp:1},0==e&&(n.style={bottomLeftRadius:12}),e==this.actionList.length-1&&(n.style={bottomRightRadius:12}),n.setText(i.title),n.addEventListener("tap",(()=>{this.dismiss(),i.handler&&i.handler(i)})),this.actionButtonsView.appendChild(n)}this.messageLabel=new TKText,this.messageLabel.style={minHeight:25,marginTop:32,marginLeft:27,marginRight:27,marginBottom:32,fontSize:17,fontWeight:"bold",color:"#303030",textAlign:"center"},this.messageLabel.setText(this.message),this.contentView.appendChild(this.messageLabel)}showInView(t){if(this.isDisplay)return;this.isDisplay=!0,t.appendChild(this);const e=this;this.executeOpacityAnimation(1,(()=>{e.viewDidAppearCallback&&e.viewDidAppearCallback(),e.containerView=t}))}dismiss(t){if(!this.isDisplay)return;this.isDisplay=!1;const e=this;this.executeOpacityAnimation(0,(()=>{t&&t(),e.containerView&&e.containerView.removeChild(e)}))}executeOpacityAnimation(t,e){this.removeAnimation("opacityAnimation"),t>0&&this.setVisibility("visible");let i=new TKBasicAnimation;i.setEndValue((()=>{this.style={opacity:t}})),i.duration=200,i.timingFunction="ease-in-out";const n=this;i.on("end",(()=>{0==t&&n.setVisibility("hidden"),e&&e()})),this.addAnimation(i,"opacityAnimation")}}class xi{constructor(t,e,i){this.title=t,this.style=e,this.handler=i}}class ki extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupAction()}setupView(){this.style={width:"100%",height:"100%",backgroundColor:"#000000B3",opacity:0,justifyContent:"center",alignItems:"center"},this.contentView=new TKView,this.contentView.style={width:271,backgroundColor:"#FFFFFF",borderRadius:12,alignItems:"center"},this.appendChild(this.contentView),this.iconImageView=new TKImage,this.iconImageView.style={width:54,height:54,marginTop:24,marginBottom:10,borderRadius:12,display:Dt(this.vm.getAdIcon())?"flex":"none"},this.iconImageView.setSrc(this.vm.getAdIcon()),this.contentView.appendChild(this.iconImageView),this.titleLabel=new TKText,this.titleLabel.style={marginLeft:32,marginBottom:10,marginRight:32,fontSize:16,color:"#222222",textAlign:"center",fontWeight:"medium"},this.titleLabel.setText(this.vm.getAdTitle()),this.contentView.appendChild(this.titleLabel),this.descriptionLabel=new TKText,this.descriptionLabel.style={marginLeft:32,marginRight:32,fontSize:14,color:"#666666",textAlign:"center",textLineClamp:2,textOverflow:"clip",display:Dt(this.vm.getAdDescription())?"flex":"none"},this.descriptionLabel.setText(this.vm.getAdDescription()),this.contentView.appendChild(this.descriptionLabel),this.actionView=new TKView,this.actionView.style={height:38,marginBottom:14,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.contentView.appendChild(this.actionView),this.actionLabel=new TKText,this.actionLabel.style={fontSize:14,color:"#FE3666",fontWeight:"medium"},this.actionLabel.setText(this.vm.getAdActionDesc()),this.actionView.appendChild(this.actionLabel),this.actionImageView=new TKImage,this.actionImageView.style={width:10,height:10,marginLeft:1},Ht(this.actionImageView,"icon_ksad_exit_poup_arrow3.png"),this.actionView.appendChild(this.actionImageView),this.stayButton=new TKButton,this.stayButton.style={width:207,height:46,marginBottom:9,borderRadius:23,fontSize:15,fontWeight:"medium",backgroundColor:"FE3666",color:"#FFFFFF"},this.stayButton.setText(this.vm.getStayButtonTitle()),this.contentView.appendChild(this.stayButton),this.leaveButton=new TKButton,this.leaveButton.style={height:24,marginBottom:20,fontSize:12,backgroundColor:"#FFFFFF00",color:"#9C9C9C"},this.leaveButton.setText(this.vm.getLeaveButtonTitle()),this.contentView.appendChild(this.leaveButton)}setupAction(){const t=this;this.iconImageView.addEventListener("tap",(e=>{t.vm.convert(2,Et(e,t.iconImageView),ae.CLOSE_BULLET_ICON_CLICK)})),this.titleLabel.addEventListener("tap",(e=>{t.vm.convert(2,Et(e,t.titleLabel),ae.CLOSE_BULLET_ICON_TITLE_CLICK)})),this.descriptionLabel.addEventListener("tap",(e=>{t.vm.convert(2,Et(e,t.descriptionLabel),ae.CLOSE_BULLET_ICON_DESCRIPTION_CLICK)})),this.actionView.addEventListener("tap",(e=>{t.vm.convert(1,Et(e,t.actionView),ae.CLOSE_BULLET_ACTION_BAR_CLICK)})),this.stayButton.addEventListener("tap",(()=>{t.stayActionCallback&&t.stayActionCallback()})),this.leaveButton.addEventListener("tap",(()=>{t.leaveActionCallback&&t.leaveActionCallback()}))}showInView(t){t.appendChild(this);const e=this;this.executeOpacityAnimation(1,(()=>{e.viewDidAppearCallback&&e.viewDidAppearCallback(),e.containerView=t}))}dismiss(t){const e=this;this.executeOpacityAnimation(0,(()=>{t&&t(),e.containerView&&e.containerView.removeChild(e)}))}executeOpacityAnimation(t,e){this.removeAnimation("opacityAnimation"),t>0&&this.setVisibility("visible");let i=new TKBasicAnimation;i.setEndValue((()=>{this.style={opacity:t}})),i.duration=200,i.timingFunction="ease-in-out";const n=this;i.on("end",(()=>{0==t&&n.setVisibility("hidden"),e&&e()})),this.addAnimation(i,"opacityAnimation")}}class Li extends bi{constructor(t){super(),this.vm=t,this.setupView()}setupView(){2==this.vm.getExitPopupStyle()?this.setupExitIntentPopupView():this.setupExitAlertView(),this.vm.recordHasShownOnce()}setupExitIntentPopupView(){const t=this;this.exitIntentPopupView=new ki(this.vm),this.exitIntentPopupView.showInView(this),this.exitIntentPopupView.leaveActionCallback=()=>{t.handleLeaveAction()},this.exitIntentPopupView.stayActionCallback=()=>{t.handleStayAction()},this.exitIntentPopupView.viewDidAppearCallback=()=>{t.vm.reportShowAction()}}setupExitAlertView(){const t=this,e=new xi(this.vm.getLeaveButtonTitle(),0,(()=>{t.handleLeaveAction()})),i=new xi(this.vm.getStayButtonTitle(),1,(()=>{t.handleStayAction()}));this.exitAlertView=new Ai(this.vm.getExitPopupMessage(),[e,i]),this.exitAlertView.viewDidAppearCallback=()=>{t.vm.reportShowAction()},this.exitAlertView.showInView(this)}handleLeaveAction(){this.dismissCallback&&this.dismissCallback(!0),this.vm.reportLeaveAction()}handleStayAction(){const t=this;2==this.vm.getExitPopupStyle()?this.exitIntentPopupView.dismiss((()=>{t.dismissCallback&&t.dismissCallback(!1)})):(this.exitAlertView.dismiss((()=>{})),this.dismissCallback&&this.dismissCallback(!1)),this.vm.reportStayAction()}}class _i extends TKView{constructor(t,e="#FFFFFF",i={width:264,height:48}){super(),this.showNumber=0,this.progressViewUpdate=!1,this.vm=t,this.hasAutoConverted=!1,this.isShowing=!1,this.color=e,this.progressViewSize=i,this.vm.convertNotify=t=>{this.setConverted(t)},this.vm.closeAutoCallCallback=()=>{this.cardDismiss()},this.setupViews(),this.setupActions()}setupActions(){this.addEventListener("tap",(t=>{})),this.closeBtn.addEventListener("tap",(t=>{this.reportCloseBtnTapped(),this.cardDismiss()}));const t=this,e=13==this.vm.adStyle&&2==this.vm.adDefaultMaterialType;He(this.vm,this.vm.$attrsPath.lifeStatus,(i=>{"showStart"==i?e&&t.startShowTimer():"hideEnd"==i?e&&t.stopShowTimer():"pageInvisiable"==i&&t.clearProgressTimer()}))}setupViews(){const t=this.oneLineStyle(),e=this.getCardWidth(),i=this.getCardHeight();this.style={right:15,height:i,width:e,flexDirection:"row",justifyContent:"space-between",alignItems:"center",position:"absolute",borderRadius:8,borderWidth:1,borderColor:"#FFFFFF66",visibility:"hidden"},this.isTopAutoCallAppCard()?this.style={top:0!=this.vm.cardTopMargin?this.vm.cardTopMargin:60}:this.style={bottom:0!=this.vm.cardBottomMargin?this.vm.cardBottomMargin:15};const n=new TKView;n.style={top:1,left:1,bottom:1,right:1,height:i-2,width:e-2,position:"absolute",borderRadius:8,backgroundColor:"#30303099"},this.appendChild(n),this.appIcon=new TKImage,this.appIcon.style={width:this.getAppIconWH(),height:this.getAppIconWH(),borderRadius:8,borderWidth:1,borderColor:"#EAEAEAFF",marginLeft:t?8:11,marginBottom:t?8:11,marginTop:t?8:11},this.appIcon.setSrc(this.getAppIconUrl()),this.appendChild(this.appIcon);const s=new TKView;s.style={marginLeft:8,marginRight:8,width:126,height:t?18:34,flexDirection:"column",alignItems:"flex-start",justifyContent:"space-around",alignSelf:"center",flexWrap:"no-wrap",flexShrink:1},this.appendChild(s),this.titleLabel=new TKText,this.titleLabel.style={fontSize:14,color:"#FFFFFF",flexWrap:"no-wrap",textLineClamp:1,width:"100%",textOverflow:"ellipsis"},this.titleLabel.setText(String(X(this.vm.styleDataInfo))+this.getTitle()),s.appendChild(this.titleLabel),t||(this.subTtileLabel=new TKText,this.subTtileLabel.style={fontSize:12,color:"#FFFFFF99",flexWrap:"no-wrap",textLineClamp:1,width:"100%",textOverflow:"ellipsis"},this.subTtileLabel.setText(this.getSubTitle()),s.appendChild(this.subTtileLabel)),this.closeBtn=new TKButton,this.closeBtn.style={marginRight:9,width:53,height:24,fontSize:12,textAlign:"center",backgroundColor:"#00000000",color:"#FFFFFFB3",borderRadius:12,borderWidth:1,borderColor:"#FFFFFF4D"},this.closeBtn.setText(this.getButtonTitle()),this.appendChild(this.closeBtn)}setConverted(t){this.converted=t,t&&this.cardDismiss()}refreshCardLayout(){this.isShowing&&(this.style={right:15})}handlePlayFailed(){this.cardDismiss()}handlePlayFinished(){this.autoConvertIfNeed()}handlePlayTime(t){const e=k(this.vm.adInfo);let i=Math.floor(t/1e3),n=this.getCardBeginShowTime()/1e3,s=(this.getCardShowTime()+this.getCardBeginShowTime())/1e3,a=13==this.vm.adStyle||e>n+5||f.isOriginLiveAd(this.vm.adInfo);a=!(!a||i!=n||!this.shouldShowCard());let o=s-i<1?1:s-i;if(2==this.vm.adStyle&&(s=J(this.vm.adInfo),o=s-i<1?1:s-i,a=!!(o==this.getCardShowTime()/1e3||this.isShowHalfPlay()&&o<this.getCardShowTime()/1e3)),a&&(this.isShowing||(this.isShowing=!0,this.addTranslateAction(),13==this.vm.adStyle&&Xt.cardImpression(),fe().emit("auto_call_show",{}),this.reportCardImpression())),this.isShowing)if(i>=s)this.autoConvertIfNeed();else{const t=this.isShowHalfPlay()?this.getAdTitle():"";this.titleLabel.setText(o+this.getTitle()+t),this.isShowHalfPlay()&&(this.updateProgress(o),this.progressViewUpdate=!0)}}isShowHalfPlay(){return!1}updateProgress(t){if(this.progressViewUpdate)return;if(!this.progressView)return;const e=this.getCardShowTime();let i=e-1e3*t;const n=this;this.progressTimer=setInterval((()=>{i+=100,i>e?n.clearProgressTimer():n.progressView.setProgress(i/e)}),100)}clearProgressTimer(){this.progressTimer&&(this.progressViewUpdate=!1,clearTimeout(this.progressTimer))}startShowTimer(){this.stopShowTimer(),this.showTimer=setInterval((()=>{this.showNumber++,this.handlePlayTime(500*this.showNumber)}),500)}stopShowTimer(){this.showNumber=0,this.showTimer&&clearInterval(this.showTimer),this.showTimer=0}getCardStyle(){let t=0;return t=this.vm.styleDataInfo.cardStyle,t}getCardHeight(){let t=60;return this.oneLineStyle()&&(t=47),t}getCardWidth(){let t=253;return this.oneLineStyle()&&(t=243),t}getAppIconWH(){let t=39;return this.oneLineStyle()&&(t=32),t}getAppIconUrl(){var t;let e=null;return e=null===(t=this.vm.styleDataInfo)||void 0===t?void 0:t.adAppUrl,Dt(e)||(e="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),e}getTitle(){let t=null;return t=this.vm.styleDataInfo.title,Dt(t)||(t="s后打开"),t}getAdTitle(){let t=null;return t=this.vm.styleDataInfo.adTitle,Dt(t)||(t="可爱的广告君"),t}getSubTitle(){let t=null;return t=this.vm.styleDataInfo.subTitle,Dt(t)||(t="可查看更多精彩"),t}getButtonTitle(){let t=null;return t=this.vm.styleDataInfo.buttonTitle,Dt(t)||(t="不用了"),t}oneLineStyle(){let t=!1,e=this.getCardStyle();return 1!=e&&3!=e||(t=!0),t}addTranslateAction(){this.style={right:-this.getCardWidth(),visibility:"visible"},this.animPosition={x:-this.getCardWidth()-15,y:0,z:0};let t=new TKBasicAnimation;t.duration=300,t.animValue={position:this.animPosition},t.on("end",(()=>{this.animateFinishCallback&&(this.animateFinishCallback(),this.animateFinishCallback=null)})),this.addAnimation(t,"translate")}isTopAutoCallAppCard(){let t=this.vm.styleDataInfo.cardStyle;return null==t&&(t=0),1==t||0==t}shouldShowCard(){return!this.converted}getCardShowTime(){let t=2==this.vm.adStyle?3e3:5e3;try{let e=this.vm.styleDataInfo.autoOpenTime;return(e<=0||null==e)&&(e=t),e}catch(e){return t}}getCardBeginShowTime(){let t=13==this.vm.adStyle?5e3:1e4;try{let e=this.vm.styleDataInfo.beginShowTime;return(e<=0||null==e)&&(e=t),e}catch(e){return t}}reportCardImpression(){let t=new r;if(t.template_show_type="auto_evocation_"+this.vm.styleDataInfo.cardStyle,u(this.vm.adInfo)&&this.vm.componentData){t.universe_feature_freq=this.vm.componentData.componentId;const e=this.vm.adInfo.adMatrixInfo.adDataV2.styleComponentInfo;let i={page_id:e.playCardInfo.pageId,combination_id:e.playCardInfo.combinationIds,component_id:this.vm.componentData.componentId};t.component_module=JSON.stringify(i)}else t.universe_feature_freq=13;let e={elementType:191,businessSceneType:10,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}reportCloseBtnTapped(){let t=new r;t.template_show_type="auto_evocation_"+this.vm.styleDataInfo.cardStyle;let e={elementType:69,businessSceneType:10,clientExtData:JSON.stringify(t)},i={actionType:141,payload:JSON.stringify(e)};Xt.sendLog(i)}autoConvertIfNeed(){if(!this.hasAutoConverted&&!this.converted&&this.isShowing){let t={},e=new r;this.externalClientExtData&&(e=this.externalClientExtData),e.template_show_type="auto_evocation_"+this.vm.styleDataInfo.cardStyle,u(this.vm.adInfo)&&this.vm.componentData&&(e.component_module=C(this.vm.adInfo,this.vm.componentData)),t.clientExtData=JSON.stringify(e),Te.convertWithTypeIfNeededNew(this.vm.adInfo,1,{x:0,y:0},ae.AUTO_CLICK_OTHER_AREA,8,t),this.hasAutoConverted=!0,this.converted=!0,this.cardDismiss()}}cardDismiss(){this.isShowing=!1,this.stopShowTimer(),this.dismissCallback&&(this.dismissCallback(),this.dismissCallback=null)}setExternalClientExtData(t){this.externalClientExtData=t}}class Ei extends TKView{constructor(t){super(),this.vm=t,this.isVertical=this.vm.isVertical(),this.size=this.isVertical?{width:188,height:46}:{width:98,height:24},this.setupView(),this.setupAction(),this.setupData();const e=this;He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{"showStart"===t&&e.startAnimation()}))}setupView(){this.style={position:"absolute",width:this.size.width+30,height:this.size.height+20,justifyContent:"center",alignItems:"center"},this.buttonView=new TKView,this.buttonView.style={position:"absolute",width:this.size.width,height:this.size.height,backgroundColor:"#0000004D",borderColor:"#FFFFFF66",borderWidth:1,borderRadius:.5*this.size.height,alignSelf:"center"},this.appendChild(this.buttonView),this.containerView=new TKView,this.containerView.style={flexDirection:"row",width:this.size.width,height:this.size.height,justifyContent:"center",alignItems:"center"},this.appendChild(this.containerView),this.iconView=new Di(this.vm),this.containerView.appendChild(this.iconView),this.titleText=new TKText,this.titleText.style={color:"#FFFFFF",fontSize:this.isVertical?16:10,fontWeight:"medium",marginLeft:6},this.containerView.appendChild(this.titleText)}setupData(){this.titleText.setText(this.vm.getLiveButtonTitle())}setupAction(){const t=this;this.addEventListener("tap",(e=>{t.clickCallback&&t.clickCallback(e)}))}startAnimation(){if(this.isAnimating)return;this.isAnimating=!0,this.iconView.startAnimation();const t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.buttonView.style={transform:{scale:1.02}},.6),()=>(t.buttonView.style={transform:{scale:1}},1)]),e.duration=1100,e.repeatCount=Number.MAX_SAFE_INTEGER,this.buttonView.addAnimation(e,"buttonViewAnimation")}}class Di extends TKView{constructor(t){super(),this.vm=t,this.isVertical=this.vm.isVertical(),this.size=this.isVertical?{width:13,height:13}:{width:9,height:8},this.setupView()}setupView(){this.style={width:this.size.width,height:this.size.height,flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end"},this.firstVerticalBar=this.createVerticalBar(this.size.height),this.appendChild(this.firstVerticalBar),this.secondVerticalBar=this.createVerticalBar(this.size.height-8),this.appendChild(this.secondVerticalBar),this.thirdVerticalBar=this.createVerticalBar(this.size.height-4),this.appendChild(this.thirdVerticalBar)}startAnimation(){const t=this.createVerticalBarAnimation(this.firstVerticalBar,this.size.height-4,this.size.height);this.firstVerticalBar.addAnimation(t,"firstVerticalBarAnimation");const e=this.createVerticalBarAnimation(this.secondVerticalBar,this.size.height,this.size.height-8);this.secondVerticalBar.addAnimation(e,"secondVerticalBarAnimation");const i=this.createVerticalBarAnimation(this.thirdVerticalBar,this.size.height-8,this.size.height-4);this.thirdVerticalBar.addAnimation(i,"thirdVerticalBarAnimation")}createVerticalBar(t){const e=new TKView;return e.style={width:this.vm.isVertical()?2:1,height:t,backgroundColor:"#FFFFFF",borderRadius:1},e}createVerticalBarAnimation(t,e,i){const n=new TKKeyframeAnimation;return n.setAnimations([()=>(t.style={height:e},.5),()=>(t.style={height:i},1)]),n.timingFunction="ease-in-out",n.duration=600,n.repeatCount=Number.MAX_SAFE_INTEGER,n}}class Ri extends TKView{constructor(){super(),this.style={alignItems:"center",justifyContent:"center"},this.imageView=new TKImage,this.appendChild(this.imageView)}setImageSize(t){this.imageView.style={width:t.width,height:t.height}}setImageSrc(t){Ht(this.imageView,t)}setImageSrcAndSize(t,e){this.setImageSize(e),this.setImageSrc(t)}configImage(t){t&&t(this.imageView)}}class Pi extends TKView{requestDraw(){}}let Bi;Bi="undefined"==typeof Canvas2DView?Pi:Canvas2DView;class Fi extends Bi{}class Mi extends Fi{constructor(t,e,i,n=!0){if(super(),this.hasDownEvent=!1,Ut.supportMinimumTKVersion("5.0.0")){const s=new Paint;s.setColor("#FFFFFF64"),s.setStrokeWidth(14),s.setStyle(1),s.setJoin(2),s.setCap(1);const a=new Path;let o=0,l=0,h=0,r=0,d=0,c=0;this.addEventListener("down",(t=>{h=t.position.x,r=t.position.y,d=h,c=r,a.reset(),a.moveTo(h,r),o=h,l=r,n&&this.requestDraw(),this.hasDownEvent=!0})),this.addEventListener("up",(s=>{let o=s.position.x,l=s.position.y;this.canConvertClick(d,c,o,l)?i(o,l):this.canHitSwipeEvent(d,c,h,r,t)&&this.hasDownEvent&&(this.hasDownEvent=!1,e(d,c,h,r)),setTimeout((()=>{n&&(a.reset(),this&&this.requestDraw())}),200)})),this.addEventListener("pan",(t=>{let e=0,i=0;Ut.isAndroid()?(e=t.translation.deltaX+h,i=t.translation.deltaY+r):(e=t.translation.deltaX+d,i=t.translation.deltaY+c),h=e,r=i;let s=Math.abs(e-o),p=Math.abs(i-l);(s>=5||p>=5)&&(a.quadTo(o,l,(e+o)/2,(i+l)/2),o=e,l=i,n&&this.requestDraw())})),this.onDraw=t=>{n&&t.drawPath(a,s)}}}canConvertClick(t,e,i,n){return Math.abs(i-t)>=0&&Math.abs(i-t)<10&&Math.abs(n-e)>=0&&Math.abs(n-e)<10}canHitSwipeEvent(t,e,i,n,s){const a=i-t,o=n-e;return!(Math.abs(a)<s&&Math.abs(o)<s)}}class Ki extends TKImage{constructor(t,e,i){super(),this.onImageSrc=t,this.offImageSrc=e,this.onImageUrl="icon_ksad_sound_on.png",this.offImageUrl="icon_ksad_sound_off.png",this.style={backgroundColor:"#30303099",width:i.width,height:i.height,borderRadius:.5*i.width,borderWidth:.5,borderColor:"#FFFFFF33"},this.setOn(!0),this.addEventListener("tap",(t=>{this.on=!this.on,this.setOn(this.on),this.changeCallback&&this.changeCallback()}))}setOn(t){this.on=t,Ht(this,t?this.onImageUrl:this.offImageUrl),Ht(this,t?this.onImageSrc:this.offImageSrc)}}class Oi{constructor(t,e,i){this.xDegree=t,this.yDegree=e,this.zDegree=i}}class Ni{constructor(t){this.radFlag=!1,this.xFlag=!1,this.yFlag=!1,this.zFlag=!1,this.antiXFlag=!1,this.antiYFlag=!1,this.antiZFlag=!1,this.bidirectionalSwitch=!1,this.NS2S=1e-9,this.rotateInfo=t,this.bidirectionalSwitch=function(t){try{return t.bidirectionalSwitch}catch(e){}return!1}(t)}beforeMonitor(){this.startTime=Ut.isAndroid()?0:Date.parse((new Date).toString())/1e3,this.maxSensorInfo=new Oi(0,0,0),this.xDegree=0,this.yDegree=0,this.zDegree=0}resetValues(){this.xDegree=0,this.yDegree=0,this.zDegree=0}canConvertRotate(t){try{if(!Ft(t)&&!Ft(t.values)){if(!this.radFlag){this.xOriginOmiga=0,this.yOriginOmiga=0,this.zOriginOmiga=0;let i=-1;try{i=Tt().abConfig.rotateProgressIncreaseCompatible}catch(e){}i>=0&&(t.values[0]>i&&(this.xOriginOmiga=t.values[0]),t.values[1]>i&&(this.yOriginOmiga=t.values[1]),t.values[2]>i&&(this.zOriginOmiga=t.values[2])),this.radFlag=!0}let i=!1,n=!1,s=!1,a=0;Ut.isAndroid()?(0!=this.startTime&&(a=(t.timestamp-this.startTime)*this.NS2S),this.startTime=t.timestamp):(a=t.timestamp/1e3-this.startTime,this.startTime=t.timestamp/1e3),this.xDegree+=a*(t.values[0]-this.xOriginOmiga)*180/Math.PI,this.yDegree+=a*(t.values[1]-this.yOriginOmiga)*180/Math.PI,this.zDegree+=a*(t.values[2]-this.zOriginOmiga)*180/Math.PI;let o=new Oi(this.xDegree,this.yDegree,this.zDegree);if(Math.abs(o.xDegree)>Math.abs(this.maxSensorInfo.xDegree)&&(this.maxSensorInfo.xDegree=o.xDegree),Math.abs(o.yDegree)>Math.abs(this.maxSensorInfo.yDegree)&&(this.maxSensorInfo.yDegree=o.yDegree),Math.abs(o.zDegree)>Math.abs(this.maxSensorInfo.zDegree)&&(this.maxSensorInfo.zDegree=o.zDegree),this.bidirectionalSwitch)return this.bidirectionRotateConvert(o);i=this.canConvertCurrentDegree(o.xDegree,this.rotateInfo.x),n=this.canConvertCurrentDegree(o.yDegree,this.rotateInfo.y),s=this.canConvertCurrentDegree(o.zDegree,this.rotateInfo.z);let l=i||n||s;return l&&(this.radFlag=!1),l}}catch(i){}return!1}bidirectionRotateConvert(t){t.xDegree>0&&!this.xFlag?this.xFlag=this.canConvertCurrentDegree(t.xDegree,this.rotateInfo.x):t.xDegree<0&&!this.antiXFlag&&(this.antiXFlag=this.canConvertCurrentDegree(t.xDegree,this.rotateInfo.x)),t.yDegree>0&&!this.yFlag?this.yFlag=this.canConvertCurrentDegree(t.yDegree,this.rotateInfo.y):t.yDegree<0&&!this.antiYFlag&&(this.antiYFlag=this.canConvertCurrentDegree(t.yDegree,this.rotateInfo.y)),t.zDegree>0&&!this.zFlag?this.zFlag=this.canConvertCurrentDegree(t.zDegree,this.rotateInfo.z):t.zDegree<0&&!this.antiZFlag&&(this.antiZFlag=this.canConvertCurrentDegree(t.zDegree,this.rotateInfo.z));let e=this.xFlag&&this.antiXFlag,i=this.yFlag&&this.antiYFlag,n=this.zFlag&&this.antiZFlag,s=e||i||n;return s&&(console.log("bidirection function canRotate, x:"+e+"===y:"+i+"===z:"+n),this.resetFlag()),s}resetFlag(){this.xFlag=!1,this.antiXFlag=!1,this.yFlag=!1,this.antiYFlag=!1,this.zFlag=!1,this.antiZFlag=!1,this.radFlag=!1}canConvertCurrentDegree(t,e){if(e.rotateDegree<0)return!1;let i=!0,n=0==e.rotateDegree?45:e.rotateDegree;switch(e.direction){case 1:i=t<0&&Math.abs(t)>=n;break;case 2:i=t>0&&Math.abs(t)>=n;break;default:i=Math.abs(t)>=n}return i&&this.bidirectionalSwitch&&this.resetValues(),i}maxRotateContent(){return JSON.stringify({x:Math.round(this.maxSensorInfo.xDegree),y:Math.round(this.maxSensorInfo.yDegree),z:Math.round(this.maxSensorInfo.zDegree)})}}class zi{constructor(t){this.xFlag=!1,this.yFlag=!1,this.zFlag=!1,this.antixFlag=!1,this.antiyFlag=!1,this.antizFlag=!1,this.canShakeCount=0,this.interactiveInfo=t}bidireationShakeConvert(t){let e=this.canBidireationShake(t);return _t()?this.canShakeCount>2&&(console.log("bidirection function android success convert, current canShakeCount:"+this.canShakeCount),this.canShakeCount=0,!0):e}canBidireationShake(t){t[0]>0&&!this.xFlag?this.xFlag=this.computeAcceleration(t[0]):t[0]<0&&!this.antixFlag&&(this.antixFlag=this.computeAcceleration(t[0])),t[1]>0&&!this.yFlag?this.yFlag=this.computeAcceleration(t[1]):t[1]<0&&!this.antiyFlag&&(this.antiyFlag=this.computeAcceleration(t[1])),t[2]>0&&!this.zFlag?this.zFlag=this.computeAcceleration(t[2]):t[2]<0&&!this.antizFlag&&(this.antizFlag=this.computeAcceleration(t[2]));let e=this.xFlag&&this.antixFlag,i=this.yFlag&&this.antiyFlag,n=this.zFlag&&this.antizFlag,s=e||i||n;return s&&(console.log("bidirection function canShake, x:"+e+"===y:"+i+"===z:"+n),this.canShakeCount++,this.resetFlag()),s}computeAcceleration(t){let e=Math.abs(t-9.81);return Math.abs(t)>=rt(this.interactiveInfo)&&e>=.05}resetFlag(){this.xFlag=!1,this.yFlag=!1,this.zFlag=!1,this.antixFlag=!1,this.antiyFlag=!1,this.antizFlag=!1}}class Hi{constructor(t){this.gravity=9.81,this.minError=.05,this.accelerationThreshold=rt(t),this.bidireationalSwitch=function(t){try{return t.bidirectionalSwitch}catch(e){}return!1}(t.shakeInfo),this.bidirectionalRotateShakeUtil=new zi(t),this.lastValue=new Array,this.lastValue[0]=0,this.lastValue[1]=0,this.lastValue[2]=0}beforeMonitor(){this.maxAcceleration=0}resetValues(){this.lastValue=new Array,this.lastValue[0]=0,this.lastValue[1]=0,this.lastValue[2]=0}canConvertShake(t){try{if(!Ft(t)&&!Ft(t.values)){if(t=this.noiseReduction(t),this.isInvalidValue(t.values))return!1;this.lastValue=t.values;let e=t.values[0],i=t.values[1],n=t.values[2];return this.bidireationalSwitch?(this.maxAcceleration=Math.max(Math.max(Math.abs(e),Math.abs(i)),Math.abs(n)),this.bidirectionalRotateShakeUtil.bidireationShakeConvert(t.values)):(this.maxAcceleration=Math.sqrt(e*e+i*i+n*n),this.maxAcceleration>=this.accelerationThreshold)}}catch(e){}return!1}isInvalidValue(t){let e=Math.abs(Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]));return!!(Math.abs(e-this.gravity)<=this.minError&&Ut.isAndroid())}noiseReduction(t){let e=.6;return 0==this.lastValue[0]&&0==this.lastValue[1]&&0==this.lastValue[2]&&(e=1),this.lastValue[0]=e*t.values[0]+(1-e)*this.lastValue[0],this.lastValue[1]=e*t.values[1]+(1-e)*this.lastValue[1],this.lastValue[2]=e*t.values[2]+(1-e)*this.lastValue[2],t.values[0]=this.lastValue[0],t.values[1]=this.lastValue[1],t.values[2]=this.lastValue[2],t}}class Wi{constructor(t,e,i){this.xDegree=t,this.yDegree=e,this.zDegree=i}}class Ui{constructor(t){this.rotationMatrix=new Array(9),this.simulatedGyroscopeValues=[],this.originRotateDegree=[],this.mRotateDegree=[],this.isInitValidValue=!1,this.rotateInfo=t,this.resetMaxRotateInfo()}resetMaxRotateInfo(){this.maxSensorInfo=new Wi(0,0,0)}handleImitateSensorData(t,e,i,n=(t=>{})){if(0!=e.length&&0!=t.length){if(this.getRotationMatrix(this.rotationMatrix,null,t,e),this.getOrientation(this.rotationMatrix,this.simulatedGyroscopeValues),this.mRotateDegree[0]=180*this.simulatedGyroscopeValues[0]/Math.PI,this.mRotateDegree[1]=180*this.simulatedGyroscopeValues[1]/Math.PI,this.mRotateDegree[2]=180*this.simulatedGyroscopeValues[2]/Math.PI,!this.isInitValidValue&&(0!=this.mRotateDegree[0]||0!=this.mRotateDegree[1]||0!=this.mRotateDegree[2])){this.isInitValidValue=!0;let t=new Array(3);t[0]=this.mRotateDegree[0],t[1]=this.mRotateDegree[1],t[2]=this.mRotateDegree[2],this.originRotateDegree=t}this.mRotateDegree[0]=this.mRotateDegree[0]-this.originRotateDegree[0],this.mRotateDegree[1]=this.mRotateDegree[1]-this.originRotateDegree[1],this.mRotateDegree[2]=this.mRotateDegree[2]-this.originRotateDegree[2],!Ft(this.mRotateDegree)&&n&&n(this.mRotateDegree),this.canConvertRotate(this.mRotateDegree)&&(i&&i(this.maxRotateContent()),this.resetMaxRotateInfo())}}canConvertRotate(t){try{if(!Ft(t)){let e=!1,i=!1,n=!1;return Math.abs(t[0])>Math.abs(this.maxSensorInfo.xDegree)&&(this.maxSensorInfo.xDegree=t[0]),Math.abs(t[1])>Math.abs(this.maxSensorInfo.yDegree)&&(this.maxSensorInfo.yDegree=t[1]),Math.abs(t[2])>Math.abs(this.maxSensorInfo.zDegree)&&(this.maxSensorInfo.zDegree=t[2]),e=this.canConvertCurrentDegree(t[0],this.rotateInfo.x),i=this.canConvertCurrentDegree(t[1],this.rotateInfo.y),n=this.canConvertCurrentDegree(t[2],this.rotateInfo.z),e||i||n}}catch(e){}return!1}canConvertCurrentDegree(t,e){if(e.rotateDegree<0)return!1;let i=!0,n=0==e.rotateDegree?45:e.rotateDegree;switch(e.direction){case 1:i=t<0&&Math.abs(t)>=n;break;case 2:i=t>0&&Math.abs(t)>=n;break;default:i=Math.abs(t)>=n}return i}maxRotateContent(){return JSON.stringify({x:Math.round(this.maxSensorInfo.xDegree),y:Math.round(this.maxSensorInfo.yDegree),z:Math.round(this.maxSensorInfo.zDegree),useImitateRotate:!0})}getRotationMatrix(t,e,i,n){try{let s=i[0],a=i[1],o=i[2],l=9.81;if(s*s+a*a+o*o<.01*l*l)return!1;let h=n[0],r=n[1],d=n[2],c=r*o-d*a,p=d*s-h*o,m=h*a-r*s,u=Math.sqrt(c*c+p*p+m*m);if(u<.1)return!1;let w=1/u;c*=w,p*=w,m*=w;let g=1/Math.sqrt(s*s+a*a+o*o);s*=g,a*=g,o*=g;let C=a*m-o*p,f=o*c-s*m,v=s*p-a*c;if(null!=t&&(9==t.length?(t[0]=c,t[1]=p,t[2]=m,t[3]=C,t[4]=f,t[5]=v,t[6]=s,t[7]=a,t[8]=o):16==t.length&&(t[0]=c,t[1]=p,t[2]=m,t[3]=0,t[4]=C,t[5]=f,t[6]=v,t[7]=0,t[8]=s,t[9]=a,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1)),null!=e){let t=1/Math.sqrt(h*h+r*r+d*d),i=(h*C+r*f+d*v)*t,n=(h*s+r*a+d*o)*t;9==e.length?(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=i,e[5]=n,e[6]=0,e[7]=-n,e[8]=i):16==e.length&&(e[0]=1,e[1]=0,e[2]=0,e[4]=0,e[5]=i,e[6]=n,e[8]=0,e[9]=-n,e[10]=i,e[3]=e[7]=e[11]=e[12]=e[13]=e[14]=0,e[15]=1)}}catch(s){return!1}return!0}getOrientation(t,e){try{9==t.length?(e[0]=Math.atan2(t[1],t[4]),e[1]=Math.asin(-t[7]),e[2]=Math.atan2(-t[6],t[8])):(e[0]=Math.atan2(t[1],t[5]),e[1]=Math.asin(-t[9]),e[2]=Math.atan2(-t[8],t[10]))}catch(i){}return e}}class Gi{constructor(t){this.rotateInfo=t}registerImitateRotateSensorListener(t,e=(t=>{})){if(!Ut.supportMinimumTKVersion("5.0.5")||!Ut.isAndroid())return;if(!KSAdSensorManager.supportSensor(3)||!KSAdSensorManager.supportSensor(5))return;this.imtateRotateHandler=new Ui(this.rotateInfo);let i=[],n=[];try{KSAdSensorManager.registerSensorListener(3,-3,(s=>{i=s.values,this.imtateRotateHandler.handleImitateSensorData(i,n,t,e)})),KSAdSensorManager.registerSensorListener(5,-3,(s=>{n=s.values,this.imtateRotateHandler.handleImitateSensorData(i,n,t,e)}))}catch(s){}}unRegisterImitateRotateSensorListener(){Ut.supportMinimumTKVersion("5.0.5")&&Ut.isAndroid()&&(KSAdSensorManager.unregisterSensorListener(3),KSAdSensorManager.unregisterSensorListener(5))}}class Yi{constructor(t){this.isListeningSeneor=!1,this.interactionInfo=t}startSensorListener(t,e){var i,n,s,a;this.isListeningSeneor||(this.isListeningSeneor=!0,(null===(n=null===(i=this.interactionInfo)||void 0===i?void 0:i.rotateInfo)||void 0===n?void 0:n.enable)&&this.startRotateListener(t,e),(null===(a=null===(s=this.interactionInfo)||void 0===s?void 0:s.shakeInfo)||void 0===a?void 0:a.enable)&&this.startShakeListener(t,e))}startRotateListener(t,e){var i,n;if("undefined"!=typeof KSAdSensorManager)if(this.initializeRotateHandler(this.interactionInfo.rotateInfo),this.rotateHandler.beforeMonitor(),KSAdSensorManager.supportSensor(2))try{KSAdSensorManager.registerSensorListener(2,-3,(i=>{try{if(e&&e(this.rotateHandler,this.shakeHandler,!1),this.rotateHandler&&this.rotateHandler.canConvertRotate(i)){t&&this.isListeningSeneor&&t(!1,0,this.rotateHandler.maxRotateContent()),this.stopSensorListener();try{KSAdSystemUtil.startVibrate(200)}catch(n){qt(xt(n))}}}catch(n){qt("outerError:"+xt(n))}}))}catch(s){}else{if(this.rotateHandler.bidirectionalSwitch)return;(null===(n=null===(i=this.interactionInfo)||void 0===i?void 0:i.rotateInfo)||void 0===n?void 0:n.useImitateRotate)&&(this.sensorImitateRotateUtil=new Gi(this.interactionInfo.rotateInfo),this.sensorImitateRotateUtil.registerImitateRotateSensorListener((e=>{try{if(!Ft(e)){t&&this.isListeningSeneor&&t(!1,0,e),this.stopSensorListener();try{KSAdSystemUtil.startVibrate(200)}catch(s){qt(xt(s))}}}catch(s){qt("outerError:"+xt(s))}}),(t=>{e&&t&&t.length>2&&(this.rotateHandler.xDegree=t[0],this.rotateHandler.yDegree=t[1],this.rotateHandler.zDegree=t[2],e(this.rotateHandler,null,!1))})))}}startShakeListener(t,e){if("undefined"!=typeof KSAdSensorManager){this.initializeShakeHandler(),this.shakeHandler.beforeMonitor();try{KSAdSensorManager.registerSensorListener(1,-3,(i=>{e&&e(this.rotateHandler,this.shakeHandler,!0),this.shakeHandler&&this.shakeHandler.canConvertShake(i)&&(KSAdSystemUtil.startVibrate(200),t&&this.isListeningSeneor&&t(!0,this.shakeHandler.maxAcceleration,""),this.stopSensorListener())}))}catch(i){}}}stopSensorListener(){this.isListeningSeneor=!1,this.stopRotateListener(),this.stopShakeListener()}stopRotateListener(){var t,e;"undefined"!=typeof KSAdSensorManager&&(null===(e=null===(t=this.interactionInfo)||void 0===t?void 0:t.rotateInfo)||void 0===e?void 0:e.enable)&&(this.sensorImitateRotateUtil?this.sensorImitateRotateUtil.unRegisterImitateRotateSensorListener():KSAdSensorManager.unregisterSensorListener(2))}stopShakeListener(){var t,e;"undefined"!=typeof KSAdSensorManager&&(null===(e=null===(t=this.interactionInfo)||void 0===t?void 0:t.shakeInfo)||void 0===e?void 0:e.enable)&&KSAdSensorManager.unregisterSensorListener(1)}initializeShakeHandler(){this.shakeHandler=new Hi(this.interactionInfo)}initializeRotateHandler(t){this.rotateHandler=new Ni(t)}getRotateHandler(){return this.rotateHandler}getShakeHandler(){return this.shakeHandler}static reportRotateSensorStatus(t){if(Ut.supportMinimumTKVersion("5.0.5")&&Ut.isAndroid())try{!function(t){ee({status:5001,ad_style:t})}(t),KSAdSensorManager.supportSensor(1)||function(t){ee({status:5011,ad_style:t})}(t);let e=!1;KSAdSensorManager.supportSensor(2)||(e=!0,function(t){ee({status:5002,ad_style:t})}(t));let i=!1;KSAdSensorManager.supportSensor(3)||(i=!0,function(t){ee({status:5003,ad_style:t})}(t));let n=!1;KSAdSensorManager.supportSensor(5)||(n=!0,function(t){ee({status:5004,ad_style:t})}(t));let s=!1;KSAdSensorManager.supportSensor(4)||(s=!0,function(t){ee({status:5008,ad_style:t})}(t)),i&&s&&function(t){ee({status:5009,ad_style:t})}(t),i&&n&&function(t){ee({status:5005,ad_style:t})}(t),e&&(i||n)&&function(t){ee({status:5007,ad_style:t})}(t),e&&(i||s)&&function(t){ee({status:5010,ad_style:t})}(t)}catch(e){!function(t,e){ee({status:5006,error_msg:t,ad_style:e})}(xt(e),t)}}}class ji extends TKView{constructor(t){super(),this.cardDynamicAllowed=!1,this.vm=t}getHeight(){return 0}stopActionAnimation(){}pauseActionAnimation(){}resumeActionAnimation(){}convert(t,e,i){this.vm.convert(1,t,e,i)}addContainerTranslateYAction(t,e,i,n=500){let s=new TKKeyframeAnimation;s.animType="position",s.keyframes=[{percent:0,value:{x:0,y:t},easing:"EaseInEaseOut"},{percent:1,value:{x:0,y:e},easing:"EaseInEaseOut"}],s.duration=n,this.addAnimation(s,i)}addContainerAlphaAction(t,e,i=500){let n=new TKKeyframeAnimation;n.animType="opacity",n.keyframes=[{percent:0,value:t!=_t()?1:0,easing:"EaseInEaseOut"},{percent:1,value:t?1:0,easing:"EaseInEaseOut"}],t&&n.on("end",(t=>{this.reportImpressionCallback()})),n.duration=i,this.addAnimation(n,e)}anteversionEffect(t,e,i){let n=new TKKeyframeAnimation,s=.8*t.getSize().width;n.setAnimations([()=>(t.style={transform:{rotate:{x:-15,y:0,z:0},perspective:s}},.225),()=>(t.style={transform:{rotate:{x:4,y:0,z:0},perspective:s}},.4375),()=>(t.style={transform:{rotate:{x:-4,y:0,z:0},perspective:s}},.7125),()=>(t.style={transform:{rotate:{x:0,y:0,z:0},perspective:s}},1)]),n.duration=800,n.timingFunction="linear",t.addAnimation(n,"anteversionAnim"),n.on("end",(()=>{Ut.supportMinimumTKVersion("5.0.0")&&setTimeout((()=>{this.addCardDynamicSweepAnimation(t,e,i)}),270)}))}breatheEffect(t,e,i){this.animationCardView?this.animationCardView=t:(this.animationCardView=new TKView,this.animationCardView.style=i,this.insertBefore(this.animationCardView,t));let n=ii(this.animationCardView,1.04,500,1,this.vm.supportNewAnimation());this.animationCardView.addAnimation(n,"breatheEffect1");const s=this;n.on("end",(()=>{s.breatheEffect2(this.animationCardView,e,i)}))}breatheEffect2(t,e,i){let n=ii(t,1.03,500,1,this.vm.supportNewAnimation());t.addAnimation(n,"breatheEffect2");const s=this;n.on("end",(()=>{Ut.supportMinimumTKVersion("5.0.0")?setTimeout((()=>{s.addCardDynamicSweepAnimation(t,e,i)}),270):setTimeout((()=>{s.breatheEffect(t,e,i)}),500)}))}addCardDynamicSweepAnimation(t,e,i){if(this.sweepLightView&&e&&e.removeChild(this.sweepLightView),Ut.supportMinimumTKVersion("5.0.0")){this.sweepLightView=new RoundRectView,this.sweepLightView.style={left:0,right:0,top:0,bottom:0,borderRadius:e.style.borderRadius,position:"absolute"},this.sweepLightView.throughHitTest=!0,e&&e.appendChild(this.sweepLightView);const n=e.getSize(),s=204*n.height/80;this.sweepLightImage=new TKImage,this.sweepLightImage.style={width:s,height:n.height,left:-s,top:0,position:"absolute"},Ht(this.sweepLightImage,"ksad_video_bottom_sweep_light.png"),this.sweepLightView.appendChild(this.sweepLightImage);let a=ei(500,Number(n.width)+2*s);this.sweepLightImage.addAnimation(a,"sweepAnim");const o=this;a.on("end",(()=>{o.addCardDynamicEffects(t,e,i)}))}}addCardDynamicEffects(t,e,i){if(this.vm.isShowCardDynamicEffects()){const n=this;setTimeout((()=>{1==n.vm.cardDynamicEffects&&n.breatheEffect(t,e,i),2==n.vm.cardDynamicEffects&&n.anteversionEffect(t,e,i),n.cardDynamicAllowed=!0}),600)}}showActionBarAnim(){}onGetMiddleMarginBottom(t){return Number(this.getHeight())}}class Xi extends TKView{constructor(t,e,i=null,n=null){super(),this.opType=0,this.supportShowPause=!1,this.downloadProgressBar=null,this.containerConfig=e,this.style={width:this.containerConfig.width,height:this.containerConfig.height,right:this.containerConfig.right,flexDirection:"column",borderRadius:this.containerConfig.borderRadius,backgroundColor:this.containerConfig.backgroundColor||"#FE3666"},this.supportShowPause=mt(t),this.supportShowPause&&(this.setupDownloadProgressView(),n&&n(this.downloadProgressBar)),this.setupActionButton(),i&&i(this.normalActionButton),this.setupCover()}setupDownloadProgressView(){this.downloadProgressBar=new ci(this.containerConfig),this.downloadProgressBar.style={backgroundColor:this.containerConfig.backgroundColor},this.downloadProgressBar.setProgressColor("#FFFFFF4D"),this.appendChild(this.downloadProgressBar)}setupActionButton(){this.normalActionButton=new TKButton,this.normalActionButton.style={fontSize:14,color:"#FFFFFF",backgroundColor:"#FFFFFF00",left:0,top:0,right:0,bottom:0,textAlign:"center",position:"absolute"},this.appendChild(this.normalActionButton)}setupCover(){this.coverView=new TKView,this.coverView.style={position:"absolute",backgroundColor:"#FFFFFF00",left:0,right:0,top:0,bottom:0},this.appendChild(this.coverView)}setOnTapListener(t){t&&this.coverView&&this.coverView.addEventListener("tap",t)}setOnSwipeListener(t){t&&this.coverView&&this.coverView.addEventListener("swipe",t)}setDownloadChange(t){console.log("jky AdActionButtonView setDownloadChange: "+JSON.stringify(t));let e=t.getProgress();this.downloadProgressBar&&e>=0&&(this.downloadProgressBar.setProgress(e),this.downloadProgressBar.style={visibility:0==e?"hidden":"visible"}),t.isDownloadFinish()&&this.downloadProgressBar&&this.downloadProgressBar.setVisibility("hidden")}setText(t){t&&this.normalActionButton&&this.normalActionButton.setText(t)}}const Ji="coupon_of_cash_equity";class $i extends ji{constructor(t){super(t),this.vm=t,this.setupView(),this.appendOutContainerView(),this.appendCouponContainerView(),this.setupData(),this.setupActions()}setupView(){this.width=this.vm.containerLimit.width-32,this.height=80*(this.width-16)/327,this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",bottom:-16,opacity:0},this.containerView=new TKView,this.containerView.style={width:this.width,height:this.getHeight(),left:16,flexDirection:"column",justifyContent:"center",alignItems:"center",position:"absolute",backgroundColor:"#FFFFFF",borderRadius:10},this.appendChild(this.containerView),this.setupLogoView()}appendOutContainerView(){this.couponTitleContainer=new TKView,this.couponTitleContainer.style={width:this.width-16,height:17,top:"7.7%",left:8,flexDirection:"row",alignItems:"center",position:"absolute"},this.containerView.appendChild(this.couponTitleContainer),this.bannerTitle=new TKText,this.bannerTitle.style={left:0,top:0,fontSize:12,color:"#FC4A5D",textLineClamp:1,fontWeight:"medium",position:"absolute",alignItems:"center",justifyContent:"center",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.bannerTitle),this.couponTips=new TKText,this.couponTips.style={right:0,fontSize:10,fontWeight:"medium",color:"#6666664D",textLineClamp:1,position:"absolute",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.couponTips)}appendCouponContainerView(){let t=Math.ceil(.064*this.getHeight());this.icon=new TKImage,this.icon.style={width:this.width-16,height:this.height,left:8,position:"absolute",resize:"stretch",bottom:t},this.containerView.appendChild(this.icon),this.couponViewContainer=new TKView,this.couponViewContainer.style={width:this.width-16,height:this.height,left:8,flexDirection:"row",justifyContent:"center",alignItems:"center",position:"absolute",bottom:"6.4%"},this.containerView.appendChild(this.couponViewContainer),this.priceContainer=new TKView,this.priceContainer.style={left:0,width:"26%",position:"absolute",alignItems:"center",justifyContent:"center",alignContent:"center",flexDirection:"row"},this.couponViewContainer.appendChild(this.priceContainer),this.price=new TKText,this.price.style={fontSize:_t()?38:32,color:"#FFFFFF",textLineClamp:1,fontWeight:"bold",textOverflow:"ellipsis",alignItems:"center",justifyContent:"center",textAlign:"center"},this.priceContainer.appendChild(this.price),this.titleContainer=new TKView,this.titleContainer.style={left:"30.8%",width:"36.7%",height:44,justifyContent:"flex-start",alignItems:"flex-start",position:"absolute"},this.couponViewContainer.appendChild(this.titleContainer),this.title=new TKText,this.title.style={top:_t()?0:2,fontSize:_t()?17:15,color:"#FFFFFF",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis",position:"absolute"},this.titleContainer.appendChild(this.title),this.contentDesc=new TKText,this.contentDesc.style={bottom:0,fontSize:_t()?14:12,color:"#FFCCCC",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis",position:"absolute"},this.titleContainer.appendChild(this.contentDesc),this.actionBtn=new Xi(this.vm.adInfo,{width:92*this.width/375,height:36*this.width/375,borderRadius:18*this.width/375},(t=>{t.style={fontSize:_t()?16:14,color:"#FF3A30",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"}}),(t=>{t.style={backgroundColor:"#FFFFFF"},t.setProgressColor("#FF133F33")})),this.actionBtn.style={flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#FFFFFF",right:10,position:"absolute"},this.couponViewContainer.appendChild(this.actionBtn),ze(this.vm.$attrsPath.actionText,(t=>{this.actionBtn&&this.actionBtn.setText(t)})),ze(this.vm.$attrsPath.downloadChangeEvent,(t=>{this.actionBtn&&this.actionBtn.setDownloadChange(t)}))}setupLogoView(){var t;const e=(null===(t=kt())||void 0===t?void 0:t.bottom)>0?43:27;this.logoView=new ai(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:16,bottom:this.getHeight()+e},this.logoView.enabled=!1,this.appendChild(this.logoView)}getHeight(){return this.height+44}onGetMiddleMarginBottom(t){var e;const i=(null===(e=kt())||void 0===e?void 0:e.bottom)>0?43:27;return Number(this.getHeight()+i)}setupData(){let t=this.vm.getCouponModel();this.bannerTitle.setText(t.bannerTitle),this.couponTips.setText(t.couponTips),this.title.setText(t.title),this.contentDesc.setText(t.contentDesc),this.actionBtn&&this.actionBtn.setText(t.actionBarDesc),this.addPriceSpan(),Ht(this.icon,this.vm.getCouponBackImageUrl())}setupActions(){const t=this;t.containerView.addEventListener("tap",(e=>{let i=new r;i.template_show_type=Ji;const n=Et(e,t.containerView);t.vm.convert(1,2,n,ae.CARD_ACTION_BAR_CLICK,i)})),t.actionBtn&&t.actionBtn.setOnTapListener((e=>{let i=new r;i.template_show_type=Ji;const n=Et(e,t.actionBtn);t.vm.convert(1,1,n,ae.CARD_ACTION_BAR_CLICK,i)}))}addPriceSpan(){let t=this.vm.getCouponModel(),e=t.priceTag+t.price;const i=e.search(t.priceTag);let n=new TKSpan,s=_t()?22:16;const a=new TKSpanItem;a.size=s,a.spanType="absoluteSize",a.start=i,a.end=i+t.priceTag.length,n.addSpan(a),this.price.setSpan(e,n)}}class Zi extends $i{setupView(){this.style={width:Kn.viewSize.width,height:.96*Kn.viewSize.width/4.25+19,left:0,bottom:-8,opacity:0};let t=new TKView;t.style={width:Kn.viewSize.width,height:"100%",flexDirection:"column",position:"absolute",bottom:0},this.appendChild(t),this.containerView=new TKView,this.containerView.style={width:Kn.viewSize.width,height:.96*Kn.viewSize.width/4.25+12,flexDirection:"column",position:"absolute",alignItems:"center",justifyContent:"center",backgroundColor:"#FFFFFF",bottomLeftRadius:8,bottomRightRadius:8,bottom:0},t.appendChild(this.containerView),this.couponTitleContainer=new TKView,this.couponTitleContainer.style={width:vt.matchParent,height:15,bottom:.96*Kn.viewSize.width/4.25+12,flexDirection:"row",alignItems:"center",position:"absolute"},t.appendChild(this.couponTitleContainer),this.logoView=new ai(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:0},this.logoView.enabled=!1,this.couponTitleContainer.appendChild(this.logoView),this.couponTips=new TKText,this.couponTips.style={right:"2%",fontSize:10,color:"#FFFFFF",textLineClamp:1,position:"absolute",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.couponTips),this.appendCouponContainerView()}appendOutContainerView(){}appendCouponContainerView(){this.icon=new TKImage,this.icon.style={width:.96*Kn.viewSize.width,height:.96*Kn.viewSize.width/4.25,position:"absolute",left:"2%",bottom:"7.5%",resize:"stretch"},this.containerView.appendChild(this.icon),this.couponViewContainer=new TKView,this.couponViewContainer.style={width:.96*Kn.viewSize.width,height:.96*Kn.viewSize.width/4.25,flexDirection:"row",justifyContent:"center",alignItems:"center",position:"absolute",left:"2%",bottom:"7.5%"},this.containerView.appendChild(this.couponViewContainer),this.priceContainer=new TKView,this.priceContainer.style={left:0,width:"25.6%",position:"absolute",alignItems:"center",justifyContent:"center",alignContent:"center",flexDirection:"row"},this.couponViewContainer.appendChild(this.priceContainer),this.price=new TKText,this.price.style={fontSize:_t()?38:32,color:"#FFFFFF",textLineClamp:1,fontWeight:"bold",textOverflow:"ellipsis",justifyContent:"center",textAlign:"center"},this.priceContainer.appendChild(this.price),this.titleContainer=new TKView,this.titleContainer.style={left:"30.8%",width:"41.3%",height:.96*Kn.viewSize.width*40/288,justifyContent:"flex-start",alignItems:"flex-start",position:"absolute"},this.couponViewContainer.appendChild(this.titleContainer),this.title=new TKText,this.title.style={left:0,top:_t()?0:2,fontSize:_t()?15:14,color:"#FFFFFF",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis",position:"absolute"},this.titleContainer.appendChild(this.title),this.contentDesc=new TKText,this.contentDesc.style={left:0,bottom:0,fontSize:_t()?13:12,color:"#FFCCCC",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis",position:"absolute"},this.titleContainer.appendChild(this.contentDesc),this.actionBtn=new Xi(this.vm.adInfo,{width:Math.ceil(.96*Kn.viewSize.width*62/288),height:Math.ceil(.96*Kn.viewSize.width*26/288),right:"4.2%",borderRadius:Math.ceil(.96*Kn.viewSize.width*13/288),backgroundColor:"#FFFFFF"},(t=>{t.style={fontSize:_t()?14:12,color:"#FF3A30",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"}})),this.actionBtn.style={flexDirection:"column",justifyContent:"center",alignItems:"center",position:"absolute",backgroundColor:"#FFFFFF"},this.containerView.appendChild(this.actionBtn)}setupData(){let t=this.vm.getCouponModel();this.couponTips.setText(t.couponTips),this.title.setText(t.title),this.contentDesc.setText(t.contentDesc),this.actionBtn.setText(t.actionBarDesc),this.addPriceSpan(),Ht(this.icon,"icon_ksad_inter_coupon.png")}}const qi="coupon_of_no_cash_equity";class Qi extends ji{constructor(t){super(t),this.bgColor="135, #FF786A, #FFF4E1",this.vm=t,this.setupView(),this.setupData(),this.setupActions(),this.addHighlightSpan()}setupView(){this.width=this.vm.containerLimit.width-32,this.height=80*(this.width-16)/327,this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",bottom:-16,opacity:0},this.containerView=new TKView,this.containerView.style={width:this.width,height:this.getHeight(),left:16,flexDirection:"column",position:"absolute",justifyContent:"center",alignItems:"center",gradientBgColor:this.bgColor,borderRadius:10},this.appendChild(this.containerView),this.appendOutContainerView(),this.appendCouponContainerView(),this.setupLogoView()}appendOutContainerView(){this.couponTitleContainer=new TKView,this.couponTitleContainer.style={width:this.width-16,height:17,left:8,top:"7.7%",flexDirection:"row",alignItems:"center",position:"absolute"},this.containerView.appendChild(this.couponTitleContainer),this.bannerTitle=new TKText,this.bannerTitle.style={left:0,top:0,fontSize:12,color:"#FC4A5D",textLineClamp:1,fontWeight:"medium",position:"absolute",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.bannerTitle),this.couponTips=new TKText,this.couponTips.style={right:0,fontSize:10,color:"#FFFFFF",textLineClamp:1,position:"absolute",fontWeight:"medium",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.couponTips)}appendCouponContainerView(){this.couponViewContainer=new TKView,this.couponViewContainer.style={width:this.width-16,height:this.height,flexDirection:"row",backgroundColor:"#FDFDFD",justifyContent:"center",alignItems:"center",position:"absolute",bottom:"6.4%",borderRadius:8},this.containerView.appendChild(this.couponViewContainer),this.icon=new TKImage,this.icon.style={width:68*this.width/343,height:68*this.width/343,left:"1.8%",borderRadius:6,position:"absolute"},this.couponViewContainer.appendChild(this.icon),this.titleContainer=new TKView,this.titleContainer.style={left:"27.5%",width:"40%",height:46,justifyContent:"flex-start",alignItems:"flex-start",position:"absolute"},this.couponViewContainer.appendChild(this.titleContainer),this.title=new TKText,this.title.style={top:_t()?0:2,fontSize:15,position:"absolute",color:"#040404",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"},this.titleContainer.appendChild(this.title),this.contentDesc=new TKText,this.contentDesc.style={bottom:0,fontSize:12,color:"#8C8C8C",textLineClamp:1,position:"absolute",fontWeight:"medium",textOverflow:"ellipsis"},this.titleContainer.appendChild(this.contentDesc),this.actionBtn=new Xi(this.vm.adInfo,{width:88*this.width/343,height:36*this.width/343,borderRadius:18*this.width/343},(t=>{t.style={fontSize:14,color:"#FFFFFF",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"}})),this.actionBtn.style={flexDirection:"column",justifyContent:"center",alignItems:"center",position:"absolute",backgroundColor:"#FE3666",right:10},this.couponViewContainer.appendChild(this.actionBtn),ze(this.vm.$attrsPath.actionText,(t=>{this.actionBtn&&this.actionBtn.setText(t)})),ze(this.vm.$attrsPath.downloadChangeEvent,(t=>{this.actionBtn&&this.actionBtn.setDownloadChange(t)}))}setupLogoView(){var t;const e=(null===(t=kt())||void 0===t?void 0:t.bottom)>0?43:27;this.logoView=new ai(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:16,bottom:this.getHeight()+e},this.logoView.enabled=!1,this.appendChild(this.logoView)}getHeight(){return this.height+44}onGetMiddleMarginBottom(t){var e;const i=(null===(e=kt())||void 0===e?void 0:e.bottom)>0?43:27;return Number(this.getHeight()+i)}setupData(){let t=this.vm.getCouponModel();this.bannerTitle.setText(t.bannerTitle),this.couponTips.setText(t.couponTips),this.icon.setSrc(t.icon),this.title.setText(t.title),this.contentDesc.setText(t.contentDesc),this.actionBtn&&this.actionBtn.setText(t.actionBarDesc)}setupActions(){const t=this;t.containerView.addEventListener("tap",(e=>{let i=new r;i.template_show_type=qi;const n=Et(e,t.containerView);t.vm.convert(1,2,n,ae.CARD_ACTION_BAR_CLICK,i)})),t.actionBtn&&t.actionBtn.setOnTapListener((e=>{let i=new r;i.template_show_type=qi;const n=Et(e,t.actionBtn);t.vm.convert(1,1,n,ae.CARD_ACTION_BAR_CLICK,i)}))}addHighlightSpan(){let t=this.vm.getCouponModel();const e=t.title.search(t.highlightTitle);if(-1==e||t.highlightTitle.length<=0)return void this.title.setText(t.title);let i=new TKSpan;const n=new TKSpanItem;n.color="#FE3666",n.spanType="foregroundColor",n.start=e,n.end=e+t.highlightTitle.length,i.addSpan(n),this.title.setSpan(t.title,i)}}class tn extends Qi{setupView(){this.style={width:Kn.viewSize.width,height:Kn.viewSize.height*Mn-8,left:0,bottom:-8,opacity:0};let t=new TKView;t.style={width:vt.matchParent,height:vt.matchParent,flexDirection:"column",position:"absolute",top:0},this.appendChild(t),this.containerView=new TKView,this.containerView.style={width:vt.matchParent,height:"85.1%",flexDirection:"row",justifyContent:"center",alignItems:"center",position:"absolute",backgroundColor:"#FFFFFF",bottomLeftRadius:8,bottomRightRadius:8,bottom:0},t.appendChild(this.containerView),this.couponTitleContainer=new TKView,this.couponTitleContainer.style={top:0,width:"100%",height:"14.9%",flexDirection:"row",alignItems:"center",position:"absolute"},t.appendChild(this.couponTitleContainer),this.logoView=new ai(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:0},this.logoView.enabled=!1,this.couponTitleContainer.appendChild(this.logoView),this.couponTips=new TKText,this.couponTips.style={right:"2%",fontSize:10,color:"#FFFFFF",textLineClamp:1,position:"absolute",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.couponTips),this.appendCouponContainerView()}appendCouponContainerView(){this.icon=new TKImage,this.icon.style={width:60*Kn.viewSize.height/533,height:60*Kn.viewSize.height/533,left:10*Kn.viewSize.height/533,top:10*Kn.viewSize.height/533,borderRadius:6*Kn.viewSize.height/533,position:"absolute"},this.containerView.appendChild(this.icon),this.titleContainer=new TKView,this.titleContainer.style={left:"26.7%",width:"44%",height:45.5*Kn.viewSize.height/533,justifyContent:"flex-start",alignItems:"flex-start",position:"absolute"},this.containerView.appendChild(this.titleContainer),this.title=new TKText,this.title.style={top:0,position:"absolute",fontSize:16,color:"#040404",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"},this.titleContainer.appendChild(this.title),this.contentDesc=new TKText,this.contentDesc.style={bottom:2,fontSize:14,color:"#8C8C8C",textLineClamp:1,fontWeight:"medium",position:"absolute",textOverflow:"ellipsis"},this.titleContainer.appendChild(this.contentDesc),this.actionBtn=new Xi(this.vm.adInfo,{width:Math.ceil(62*Kn.viewSize.width/300),height:Math.ceil(26*Kn.viewSize.height/533),right:"6%",borderRadius:Math.ceil(13*Kn.viewSize.height/533)},(t=>{t.style={fontSize:13,color:"#FFFFFF",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"}})),this.actionBtn.style={flexDirection:"column",justifyContent:"center",alignItems:"center",position:"absolute",backgroundColor:"#FE3666",right:10},this.containerView.appendChild(this.actionBtn)}setupData(){let t=this.vm.getCouponModel();this.icon.setSrc(t.icon),this.contentDesc.setText(t.contentDesc),this.actionBtn.setText(t.actionBarDesc),this.couponTips.setText(t.couponTips)}}class en extends TKView{constructor(t,e,i,n){super(),this.vm=t,this.style={height:e,backgroundColor:"#FE3666",borderRadius:e/2,alignItems:"center",justifyContent:"center"},this.label=new TKText,this.label.style={fontSize:i,textAlign:"center",fontWeight:"medium",color:"#FFFFFF",textLineClamp:1},this.appendChild(this.label),Ne(this.label,"text",this.vm.$attrsPath.callerContext.downloadText),ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"pageVisiable":n&&this.startAnimation();break;case"pageInvisiable":n&&this.stopAnimation()}}))}startAnimation(){this.stopAnimation();const t={1:{duration:1e3,delay:0},2:{duration:1500,delay:0},3:{duration:2e3,delay:500}}[this.vm.callerContext.expParam.interstitialButtonType];if(t){const e=t.duration,i=t.delay;this.timer=setInterval((()=>{this.addSingleAnimation(e)}),e+i)}}stopAnimation(){this.timer&&clearInterval(this.timer),this.removeAllAnimation(),this.lightView&&(this.removeChild(this.lightView),this.lightView=null)}addSingleAnimation(t){switch(this.vm.callerContext.expParam.interstitialButtonType){case 1:this.addAnimation(function(t){const e=new TKKeyframeAnimation;return e.animType="rotationZ",e.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.1,value:Ut.getRotateSemiCircle()/45,easing:"EaseInEaseOut"},{percent:.2,value:Ut.getRotateSemiCircle()/-45,easing:"EaseInEaseOut"},{percent:.3,value:Ut.getRotateSemiCircle()/-45,easing:"EaseInEaseOut"},{percent:.4,value:Ut.getRotateSemiCircle()/45,easing:"EaseInEaseOut"},{percent:.5,value:Ut.getRotateSemiCircle()/60,easing:"EaseInEaseOut"},{percent:.55,value:Ut.getRotateSemiCircle()/-60,easing:"EaseInEaseOut"},{percent:.6,value:Ut.getRotateSemiCircle()/-90,easing:"EaseInEaseOut"},{percent:.68,value:Ut.getRotateSemiCircle()/90,easing:"EaseInEaseOut"},{percent:.76,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}],e.repeatCount=0,e.duration=t,e}(t),"anim");break;case 2:this.addAnimation(function(t){const e=new TKKeyframeAnimation;return e.animType="scale",e.keyframes=[{percent:0,value:1,easing:"EaseInEaseOut"},{percent:.13,value:.8,easing:"EaseInEaseOut"},{percent:.1474,value:.813/.8,easing:"EaseInEaseOut"},{percent:.1648,value:.941/.813,easing:"EaseInEaseOut"},{percent:.1822,value:1.043/.941,easing:"EaseInEaseOut"},{percent:.1996,value:1.107/1.043,easing:"EaseInEaseOut"},{percent:.217,value:1.116/1.107,easing:"EaseInEaseOut"},{percent:.2344,value:1.048/1.116,easing:"EaseInEaseOut"},{percent:.2518,value:.985/1.048,easing:"EaseInEaseOut"},{percent:.2692,value:.941/.985,easing:"EaseInEaseOut"},{percent:.2866,value:.936/.941,easing:"EaseInEaseOut"},{percent:.304,value:.964/.936,easing:"EaseInEaseOut"},{percent:.3214,value:1.002/.964,easing:"EaseInEaseOut"},{percent:.3388,value:1.039/1.002,easing:"EaseInEaseOut"},{percent:.3736,value:1.026/1.039,easing:"EaseInEaseOut"},{percent:.391,value:1.003/1.026,easing:"EaseInEaseOut"},{percent:.4084,value:.978/1.003,easing:"EaseInEaseOut"},{percent:.4258,value:.975/.978,easing:"EaseInEaseOut"},{percent:.4432,value:.982/.975,easing:"EaseInEaseOut"},{percent:.4606,value:1.002/.982,easing:"EaseInEaseOut"},{percent:.478,value:1.012/1.002,easing:"EaseInEaseOut"},{percent:.4954,value:1.015/1.012,easing:"EaseInEaseOut"},{percent:.5128,value:1.008/1.015,easing:"EaseInEaseOut"},{percent:.5302,value:1/1.008,easing:"EaseInEaseOut"},{percent:.5476,value:.994,easing:"EaseInEaseOut"},{percent:.565,value:.991/.994,easing:"EaseInEaseOut"},{percent:.5824,value:.994/.991,easing:"EaseInEaseOut"},{percent:.5998,value:.999/.994,easing:"EaseInEaseOut"},{percent:.6172,value:1.003/.999,easing:"EaseInEaseOut"},{percent:.6346,value:1.005/1.003,easing:"EaseInEaseOut"},{percent:.6694,value:1.001/1.005,easing:"EaseInEaseOut"},{percent:.6868,value:.998/1.001,easing:"EaseInEaseOut"},{percent:.7564,value:1.001/.998,easing:"EaseInEaseOut"},{percent:.826,value:.999/1.001,easing:"EaseInEaseOut"},{percent:1,value:1/.999,easing:"EaseInEaseOut"}],e.repeatCount=0,e.duration=2e3,e}(),"anim");break;case 3:this.lightView&&this.removeChild(this.lightView),this.lightView=new TKImage;const e=this.getSize(),i=128*e.height/60;this.lightView.style={width:i,height:e.height,left:-i,top:0,position:"absolute"},Ht(this.lightView,"ksad_light.png"),this.appendChild(this.lightView),this.lightView.addAnimation(ei(t,Number(e.width)+2*i),"anim")}}}class nn extends TKView{constructor(t,e=!1){super(),this.vm=t,this.isEndCard=e,this.setupView(),this.setupData(),this.setupActions()}setupView(){const t=this.vm.callerContext.isVertical();let e={width:47,height:47};this.isEndCard&&(e=t?{width:115,height:120}:{width:68,height:68}),this.style={width:e.width,height:e.height,alignItems:"center",justifyContent:"center",alignSelf:"center"};const i=e.width-1;this.avatarLayerView=new TKView,this.avatarLayerView.style={borderWidth:1,borderColor:"#FE3666",width:i,height:i,borderRadius:.5*i,alignItems:"center",justifyContent:"center"},this.appendChild(this.avatarLayerView);let n=e.width-7;this.isEndCard&&(n=t?e.width-15:e.width-8),this.avatarImage=new TKImage,this.avatarImage.style={width:n,height:n,borderRadius:.5*n},this.avatarLayerView.appendChild(this.avatarImage);let s={width:46,height:16},a=10;this.isEndCard&&(s=t?{width:76,height:28}:{width:58,height:21},a=t?14:12),this.avatarText=new TKText,this.avatarText.style={position:"absolute",bottom:0,width:s.width,height:s.height,borderRadius:.5*s.height,backgroundColor:"#FE3666",fontSize:a,color:"#FFFFFF",textAlign:"center"},this.appendChild(this.avatarText)}setupData(){this.avatarImage.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.callerContext.adInfo)),this.avatarText.setText("直播中")}setupActions(){if(!this.vm.callerContext.enableFullScreenClick())return;const t=this;this.addEventListener("tap",(e=>{t.vm.callerContext.clickAd(1,Et(e,t),2,ae.CARD_ICON_CLICK)}))}}class sn extends hi{constructor(t){super(),this.callerContext=t}}class an extends TKView{constructor(t){super(),this.vm=t,this.isLiveAd=this.vm.callerContext.isLiveAd(),this.setupView(),this.setupData(),this.setupActions()}setupData(){this.icon.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.callerContext.adInfo)),this.titleLabel.setText(K(this.vm.callerContext.templateDataInfo,this.vm.callerContext.adInfo)),this.descLabel.setText(O(this.vm.callerContext.templateDataInfo,this.vm.callerContext.adInfo))}setupActions(){this.actionBtn.addEventListener("tap",(t=>{const e=Et(t,this.actionBtn);this.vm.callerContext.clickAd(1,e,1,ae.CARD_ACTION_BAR_CLICK)})),this.vm.callerContext.enableFullScreenClick()&&(this.addEventListener("tap",(t=>{const e=Et(t,this);this.vm.callerContext.clickAd(1,e,2,ae.CARD_OTHERAREA_CLICK)})),this.icon.addEventListener("tap",(t=>{const e=Et(t,this.icon);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_CLICK)})),this.titleLabel.addEventListener("tap",(t=>{const e=Et(t,this.titleLabel);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_NAME_CLICK)})),this.descLabel.addEventListener("tap",(t=>{const e=Et(t,this.descLabel);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_COMMENT_CLICK)})))}setupView(){this.style={flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#FFFFFF"},this.isLiveAd&&(this.avatarView=new nn(new sn(this.vm.callerContext)),this.avatarView.style={left:-2,marginRight:6},this.appendChild(this.avatarView));const t=new TKView;t.style={flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flexShrink:1,width:"100%"},this.appendChild(t);let e=new TKView;e.style={height:24,flexDirection:"row",flexWrap:"no-wrap",alignItems:"center"},t.appendChild(e),this.icon=new TKImage,this.icon.style={width:24,height:24,borderRadius:4,marginRight:6,display:this.isLiveAd?"none":"flex"},e.appendChild(this.icon),this.titleLabel=new TKText,this.titleLabel.style={fontWeight:"medium",color:"#333333",fontSize:16,textOverflow:"ellipsis",textLineClamp:1,marginRight:30},e.appendChild(this.titleLabel),this.descLabel=new TKText,this.descLabel.style={fontSize:12,color:"#333333",textOverflow:"ellipsis",textLineClamp:1,height:17,marginTop:this.isLiveAd?1:5},t.appendChild(this.descLabel),this.actionBtn=new en(this.vm.actionButtonViewModel,36,14,!1),this.actionBtn.style={width:88,marginLeft:6},this.appendChild(this.actionBtn),this.vm.callerContext.showPecCouponView=!0}}class on extends TKView{constructor(t,e=!1,i=0,n={width:28,height:28}){super(),this.vm=t,this.isEndCard=e,this.autoCloseCountDown=i,this.size=n,this.isEndCard?this.onLeft=1==this.vm.callerContext.getCloseButtonPosition():this.onLeft=1==this.vm.callerContext.getSkipButtonPosition(),this.setupView(),Yt.log("close action view setup view"),this.setupData(),Yt.log("close action view setup data"),this.setupAction(),Yt.log("close action view setup action")}setupView(){this.style={flexDirection:this.onLeft?"row":"row-reverse",justifyContent:"center",alignItems:"center"},this.closeButton=new Ri,this.closeButton.style={width:this.size.width,height:this.size.height,backgroundColor:"#30303099",borderRadius:.5*this.size.height,borderWidth:.5,borderColor:"#FFFFFF33",display:"none"},this.closeButton.setImageSrcAndSize("icon_ksad_close.png",{width:10,height:10}),this.closeButton.setImageSrc("image/ksad-interstitial-card/ic_force_close.png"),this.appendChild(this.closeButton),this.containerView=new TKView,this.containerView.style={flexDirection:this.onLeft?"row":"row-reverse",justifyContent:"center",alignItems:"center",paddingLeft:8,paddingRight:8,height:this.size.height,backgroundColor:"#30303099",borderRadius:.5*this.size.height,borderWidth:.5,borderColor:"#FFFFFF33",visibility:"hidden"},this.appendChild(this.containerView),this.containerView.addEventListener("tap",(t=>{})),this.closeImage=new TKImage,this.closeImage.style={width:10,height:10,display:"none"},this.onLeft?this.closeImage.style={marginRight:5}:this.closeImage.style={marginLeft:5},Ht(this.closeImage,"icon_ksad_close.png"),Ht(this.closeImage,"image/ksad-interstitial-card/ic_force_close.png"),this.containerView.appendChild(this.closeImage),this.skipText=new TKText,this.skipText.style={height:"100%",fontSize:12,color:"#FFFFFF",display:"none",textAlign:"center"},this.skipText.setText("跳过"),this.containerView.appendChild(this.skipText),this.lineView=new TKView,this.lineView.style={backgroundColor:"#FFFFFF",width:1,height:12,marginLeft:6,marginRight:6,display:"none"},this.containerView.appendChild(this.lineView),this.countdownText=new TKText,this.countdownText.style={height:"100%",fontSize:12,color:"#FFFFFF",display:"none",textAlign:"center"},this.containerView.appendChild(this.countdownText)}setupData(){const t=this;this.skipTime=this.vm.getSkipTime(),this.isEndCard?(this.showCloseButton(),this.autoCloseCountDown>0&&(this.showCountDown(this.autoCloseCountDown),this.updateCountDownText(1,this.autoCloseCountDown),this.startAutocCloseCountDownTimer())):this.vm.enableClosePlayViewDirectly()&&0==this.skipTime&&this.showCloseButton(),this.isEndCard||ze(this.vm.$attrsPath.callerContext.countdownTime,(e=>{t.showCountDown(e),t.updateCountDownText(t.vm.callerContext.countdownTimerType,e)})),ze(this.vm.$attrsPath.callerContext.lifeStatus,(e=>{switch(e){case"showEnd":t.showEnd();break;case"pageVisiable":t.pageVisiable();break;case"pageInvisiable":t.pageInvisiable()}}))}setupAction(){const t=this;this.closeButton.addEventListener("tap",(e=>{t.vm.callerContext.clickCloseButton=!0}))}showEnd(){this.configureCloseActionView()}pageVisiable(){this.isEndCard||this.startSkipTimer(),this.isEndCard&&this.startAutocCloseCountDownTimer()}pageInvisiable(){this.isEndCard||this.stopSkipTimer(),this.isEndCard&&this.stopAutocCloseCountDownTimer()}configureCloseActionView(){this.isEndCard||this.startSkipTimer()}showClose(){"flex"==this.countdownText.style.display?this.showCloseImage():this.showCloseButton()}showCloseButton(){"flex"!=this.closeButton.style.display&&(this.containerView.setVisibility("hidden"),this.closeButton.style={display:"flex"})}showCloseImage(){const t=this;"flex"!=this.closeImage.style.display&&(this.closeImage.style={display:"flex"},this.containerView.addEventListener("tap",(e=>{t.vm.callerContext.clickCloseButton=!0})))}showSkip(){const t=this;if(this.vm.callerContext.isValidPlayable())this.showCloseImage();else{if("flex"==this.skipText.style.display)return;this.skipText.style={display:"flex"},"flex"==this.countdownText.style.display&&(this.lineView.style={display:"flex"}),this.containerView.addEventListener("tap",(e=>{t.vm.skip(t.autoCloseCountDown)}))}this.containerView.setVisibility("visible")}showCountDown(t){if(t<=0)this.hideCountDown();else if("flex"!=this.countdownText.style.display){if(this.containerView.setVisibility("visible"),"flex"==this.closeButton.style.display){this.closeButton.style={display:"none"},this.closeImage.style={display:"flex"};const t=this;this.containerView.addEventListener("tap",(e=>{t.vm.callerContext.clickCloseButton=!0}))}this.countdownText.style={display:"flex"},"flex"==this.skipText.style.display&&(this.lineView.style={display:"flex"})}}hideCountDown(){"flex"==this.skipText.style.display&&(this.countdownText.style={display:"none"},this.lineView.style={display:"none"}),"flex"==this.closeImage.style.display&&this.showCloseButton()}updateCountDownText(t,e){e<=0||(1==t?(this.autoCloseCountDown=e,this.countdownText.setText(e+"秒后自动关闭")):2==t?this.countdownText.setText(e+"秒后进入试玩页面"):this.countdownText.setText(e+"s"))}startSkipTimer(){if(this.skipTimer>0)return;if(this.skipTime<=0)return void(this.vm.enableClosePlayViewDirectly()?this.showClose():this.showSkip());const t=this;this.skipTimer=setInterval((()=>{t.skipTime-=1,t.skipTime<=0&&(this.vm.enableClosePlayViewDirectly()?this.showClose():this.showSkip(),t.stopSkipTimer())}),1e3)}stopSkipTimer(){this.skipTimer&&(clearTimeout(this.skipTimer),this.skipTimer=0)}startAutocCloseCountDownTimer(){if(this.autoCloseCountDownTimer>0||this.autoCloseCountDown<=0)return;const t=this;this.autoCloseCountDownTimer=setInterval((()=>{t.autoCloseCountDown-=1,t.autoCloseCountDown<=0&&(t.vm.callerContext.closeAd(!0),t.hideCloseCountdownText(),t.stopAutocCloseCountDownTimer()),t.updateCountDownText(1,t.autoCloseCountDown)}),1e3)}hideCloseCountdownText(){this.countdownText.style={display:"none"},this.closeImage.style={marginLeft:0,marginRight:0}}stopAutocCloseCountDownTimer(){this.autoCloseCountDownTimer&&(clearTimeout(this.autoCloseCountDownTimer),this.autoCloseCountDownTimer=0)}setBorderColor(t){this.closeButton.style={borderColor:t},this.containerView.style={borderColor:t}}}class ln extends be{constructor(t){super(),this.vm=t,this.setupViews(),this.setupData()}setupData(){const t=this;He(this.vm,this.vm.$attrsPath.lifeStatus,(e=>{switch(e){case"showEnd":t.animationReplay(500),t.vm.reportCombination2ActionBarImpression();break;case"hideEnd":t.stopLottieAnimation();break;case"pageVisiable":t.resumeLottieAnimation(),t.vm.reportCombination2ActionBarImpression();break;case"pageInvisiable":t.pauseLottieAnimation()}}))}configStyleView(){this.containerView=new TKView,this.containerView.style={bottom:5,alignItems:"center",position:"absolute"},this.appendChild(this.containerView),Ut.supportMinimumTKVersion("5.0.0")&&(this.actionBarLottieView=new TKLottieImageView,this.actionBarLottieView.style={width:94,height:94,marginBottom:4}),this.titleLabel=new TKText,this.titleLabel.style={color:"#FFFFFFFF",fontSize:13,bottom:32,textAlign:"center",position:"absolute"},this.titleLabel.enabled=!1,this.titleLabel.setText(this.vm.getCombineStyleRotateTitle()),this.subtitleLabel=new TKText,this.subtitleLabel.style={color:"#FFFFFFFF",fontSize:11,height:12,textAlign:"center",shadow:"0 0 4 #00000099"},this.subtitleLabel.enabled=!1,Ne(this.subtitleLabel,"text",this.vm.$attrsPath.combineDownloadText),this.actionBarLottieView&&this.containerView.appendChild(this.actionBarLottieView),this.containerView.appendChild(this.titleLabel),this.containerView.appendChild(this.subtitleLabel),this.actionBarLottieView&&(this.actionBarLottieView.setUri("bundle://image/ksad-interstitial-card/lottie_ripple_btn.json"),this.actionBarLottieView.onAnimationEnd((()=>{this.animationReplay(500)})),this.actionBarLottieView.addEventListener("tap",(t=>{this.vm.clickActionBarConvert(t)})))}setupViews(){this.style={width:"100%",height:"100%",bottom:0,position:"absolute",overflow:"hidden",alignItems:"center"},this.clipChildren=!0,this.throughHitTest=!0,this.configStyleView()}animationReplay(t){this.actionBarLottieView&&setTimeout((()=>{this.actionBarLottieView.play()}),t)}stopLottieAnimation(){this.actionBarLottieView&&this.actionBarLottieView.stop()}pauseLottieAnimation(){this.actionBarLottieView&&this.actionBarLottieView.pause()}resumeLottieAnimation(){this.actionBarLottieView&&this.actionBarLottieView.resume()}setAlignSelf(){this.style={justifyContent:"center"},this.containerView.style={position:"relative"}}}class hn extends be{constructor(t,e=0){super(),this.playing=!1,this.vm=t,this.bottomSpaceHeight=e,this.setupViews(),this.setupData()}setupData(){He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":this.animationReplay(500);break;case"hideEnd":case"pageInvisiable":this.stopLottieAnimation();break;case"pageVisiable":this.animationReplay(200)}}))}setupViews(){this.style={width:"100%",height:"100%",bottom:0,alignItems:"center",position:"absolute"},this.throughHitTest=!0,this.appendActionBarLottieView()}appendActionBarLottieView(){const t=this.vm.isVertical()?74:50,e=this.vm.isVertical()?176.8:120;Ut.supportMinimumTKVersion("5.0.0")&&(this.cardLottieView=new TKLottieImageView,this.cardLottieView.style={position:"absolute",bottom:14.08+this.bottomSpaceHeight,width:t,height:e-2.08-12});let i=new TKText;i.style={color:"#FFFFFFFF",fontSize:14,position:"absolute",bottom:0+this.bottomSpaceHeight,left:0,right:0,textAlign:"center",height:17,shadow:"0 1 2 #00000066"},i.enabled=!1,i.setText(this.vm.getCombineStyleSlideTitle()),this.appendChild(i),this.cardLottieView&&(this.appendChild(this.cardLottieView),Ut.isAndroid()||(this.cardLottieView.enabled=!1),this.cardLottieView.setUri("bundle://image/ksad-interstitial-card/lottie_ver_slide.json"),this.cardLottieView.onAnimationEnd((()=>{this.playing=!1,this.animationReplay(500)})))}stopLottieAnimation(){this.cardLottieView&&(this.stopPendingTimer(),this.cardLottieView.stop(),this.playing=!1)}stopPendingTimer(){this.pendingTimer&&(clearTimeout(this.pendingTimer),this.pendingTimer=null)}animationReplay(t){if(!this.cardLottieView)return;this.stopPendingTimer();const e=this;this.pendingTimer=setTimeout((()=>{e.playing||e.cardLottieView.play(),e.playing=!0}),t)}}class rn extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupData(),this.setupActions()}setupData(){let t=D(this.vm.callerContext.adInfo);3==t?(this.icon.setSrc(this.vm.callerContext.adInfo.adProductInfo.icon),this.titleLabel.setText(this.vm.callerContext.adInfo.adProductInfo.name),this.originPrice.setText(function(t){let e=null;try{if(e=t.adProductInfo.originPrice,Dt(e))return e.startsWith("¥")?e:"¥"+e}catch(i){}return""}(this.vm.callerContext.adInfo)),this.price.setText(function(t){let e=null;try{if(e=t.adProductInfo.price,Dt(e))return e.startsWith("¥")?e:"¥"+e}catch(i){}return""}(this.vm.callerContext.adInfo))):2==t&&(this.icon.setSrc(this.vm.callerContext.adInfo.advertiserInfo.portraitUrl),this.titleLabel.setText(this.vm.callerContext.adInfo.advertiserInfo.rawUserName),this.follow&&this.follow.setText(N(this.vm.callerContext.adInfo)))}setupActions(){if(this.actionBtn.addEventListener("tap",(t=>{const e=Et(t,this.actionBtn);this.vm.callerContext.clickAd(1,e,1,ae.CARD_ACTION_BAR_CLICK)})),this.vm.callerContext.enableFullScreenClick()){this.addEventListener("tap",(t=>{const e=Et(t,this);this.vm.callerContext.clickAd(1,e,2,ae.CARD_OTHERAREA_CLICK)})),this.icon.addEventListener("tap",(t=>{const e=Et(t,this.icon);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_CLICK)})),this.titleLabel.addEventListener("tap",(t=>{const e=Et(t,this.titleLabel);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_NAME_CLICK)}));let t=D(this.vm.callerContext.adInfo);3==t?(this.originPrice.addEventListener("tap",(t=>{const e=Et(t,this.originPrice);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_COMMENT_CLICK)})),this.price.addEventListener("tap",(t=>{const e=Et(t,this.price);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_COMMENT_CLICK)}))):2==t&&this.followView&&this.followView.addEventListener("tap",(t=>{const e=Et(t,this.followView);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_COMMENT_CLICK)}))}}setupView(){this.style={flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#FFFFFF"};const t=new TKView;t.style={flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flexShrink:1},this.appendChild(t),this.topContainer=new TKView,this.topContainer.style={height:24,flexDirection:"row",flexWrap:"no-wrap"},t.appendChild(this.topContainer),this.icon=new TKImage,this.icon.style={width:24,height:24,borderRadius:4,position:"absolute",left:0,top:0},this.topContainer.appendChild(this.icon),this.titleLabel=new TKText,this.titleLabel.style={fontWeight:"medium",color:"#333333",fontSize:16,textOverflow:"ellipsis",textLineClamp:1,marginLeft:31},this.topContainer.appendChild(this.titleLabel);let e=D(this.vm.callerContext.adInfo);3==e?this.appendOrderPriceView(t):2==e&&this.appendFollowView(t),this.actionBtn=new en(this.vm.actionButtonViewModel,36,12,!1),this.actionBtn.style={width:86,marginLeft:6},this.appendChild(this.actionBtn)}appendOrderPriceView(t){this.priceContainer=new TKView,this.priceContainer.style={height:24,flexDirection:"row",flexWrap:"no-wrap"},this.price=new TKText,this.price.style={fontSize:12,color:"#FE3666",textOverflow:"ellipsis",textLineClamp:1,height:17,marginTop:5},this.originPrice=new TKText,this.originPrice.style={fontSize:10,color:"#666666",textOverflow:"ellipsis",textLineClamp:1,height:12,marginTop:7,marginLeft:4,textDecoration:"line-through"},this.priceContainer.appendChild(this.price),this.priceContainer.appendChild(this.originPrice),t.appendChild(this.priceContainer)}appendFollowView(t){if(this.followView=new TKView,this.followView.style={height:22,flexDirection:"row",flexWrap:"no-wrap"},!Dt(N(this.vm.callerContext.adInfo))){let e=new TKText;return e.style={fontSize:12,color:"#333333",marginTop:5},e.setText(this.vm.callerContext.adInfo.advertiserInfo.brief||""),this.followView.appendChild(e),void t.appendChild(this.followView)}let e=new TKText;e.style={fontSize:12,color:"#333333",marginTop:5},e.setText("已有"),this.follow=new TKText,this.follow.style={fontSize:12,color:"#FE3666",marginTop:5};let i=new TKText;i.style={fontSize:12,color:"#333333",marginTop:5},i.setText("人关注TA"),this.followView.appendChild(e),this.followView.appendChild(this.follow),this.followView.appendChild(i),t.appendChild(this.followView)}}class dn extends TKView{constructor(){super(),this.borderRadius=0,this.progress=0,this.color="#FFFFFF",this.clipChildren=!0,this.progressBar=new TKView,this.progressBar.style={width:0,height:"100%"},this.appendChild(this.progressBar)}setProgress(t){if(!t)return;if(t>1||t<0)return;this.progress=t;const e=String(Math.floor(100*this.progress))+"%";this.progressBar.style={width:e,borderRadius:this.borderRadius,backgroundColor:this.color}}setColor(t){this.color=t}setBorderRadius(t){this.style={borderRadius:t},this.borderRadius=t}}class cn{constructor(){this.tagViewStyle=0,this.height=18,this.tagBorderRadius=2,this.tagFontSize=12,this.tagFontWeight="normal",this.customBackgroundColor="#FFFFFF",this.customTextColor="#FE3666",this.customShadowColor="",this.tagPadding=8,this.tagDividerSize=8}static create(t){return Object.assign(new cn,t)}}class pn extends TKView{constructor(t,e){if(super(),t&&t.length>0){e||(e=new cn),this.style={display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",height:e.height,overflow:"hidden"},this.tagArray=new Array;let i=t.length>3?3:t.length,n="#FFFFFF",s="#FE3666",a="#FE3666",o="normal",l="";1==e.tagViewStyle&&(n="#FFE1E8",s="#FFFFFF00",a="#FE3666",o="medium"),2==e.tagViewStyle&&(n="#FFFFFF",s="#666666",a="#666666",o="normal"),3==e.tagViewStyle&&(n=e.customBackgroundColor,s="#FFFFFF00",a=e.customTextColor,o="normal",l=e.customShadowColor);let h=0;for(;h<i;++h){let o=new TKText;o.style={backgroundColor:n,textAlign:"center",height:e.height,paddingLeft:e.tagPadding,paddingRight:e.tagPadding,marginRight:h==i-1?0:e.tagDividerSize,color:a,borderWidth:1,fontSize:e.tagFontSize,fontWeight:e.tagFontWeight,borderColor:s,borderRadius:e.tagBorderRadius},o.setText(t[h].text),Dt(l)&&(o.style={shadow:l}),this.appendChild(o)}}}}class mn extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupActions(),this.isVertical=this.vm.callerContext.isVertical()}setupView(){var t;this.style={flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#FFFFFF"};const e=new TKView;e.style={flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flexShrink:1,width:"100%"},this.appendChild(e),this.topContainer=new TKView,this.topContainer.style={flexDirection:"row",width:"100%"},e.appendChild(this.topContainer),this.appendDifferentElements(),this.sloganText=new TKText,this.sloganText.style={color:"#222222",fontSize:12,textOverflow:"ellipsis",textLineClamp:1},this.sloganText.setText(null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.displayName),e.appendChild(this.sloganText);let i=86;this.vm.callerContext.enableShakeInteraction()&&!this.isVertical&&(i=Ut.isAndroid()?78:86),this.actionBtn=new en(this.vm.actionButtonViewModel,36,12,!1),this.actionBtn.style={width:i,marginLeft:6},this.appendChild(this.actionBtn)}appendDifferentElements(){var t;const e=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.showType;1==e?this.appendLowPriceElements():2==e?this.appendSeckillElements():3==e?this.appendHighSalesElements():4==e?this.appendCouponElements():5==e?this.appendRecommendationElements():this.appendOtherElements()}appendLowPriceElements(){this.lowPriceIconImage=new TKImage,this.lowPriceIconImage.style={width:31,height:33,marginBottom:6.5},Ht(this.lowPriceIconImage,"icon_ksad_ec_low_price.png"),this.topContainer.appendChild(this.lowPriceIconImage),this.lowPriceView=new un(this.vm),this.lowPriceView.style={top:8.5,marginLeft:6},this.topContainer.appendChild(this.lowPriceView)}appendSeckillElements(){var t,e,i,n;this.seckillIconImage=new TKImage,this.seckillIconImage.style={width:50,height:12,top:1,marginBottom:25},Ht(this.seckillIconImage,"icon_ksad_ec_seckill.png"),this.topContainer.appendChild(this.seckillIconImage),this.splitLineView=new TKView,this.splitLineView.style={backgroundColor:"#FE366650",top:2,width:.5,height:10,marginLeft:5},this.topContainer.appendChild(this.splitLineView),this.seckillCountdownView=new wn(this.vm),this.seckillCountdownView.style={height:14,marginLeft:5},this.seckillCountdownView.updateSeckillCountdown((t=>{})),this.topContainer.appendChild(this.seckillCountdownView),this.seckillCountdownTimer=setInterval((()=>{this.seckillCountdownView.updateSeckillCountdown((t=>{t&&clearInterval(this.seckillCountdownTimer)}))}),1);let s=new dn;s.style={backgroundColor:"#FE366630",position:"absolute",top:22,left:0,width:80,height:8},s.setColor("#FE3666"),s.setBorderRadius(4);const a=null===(e=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.seckillInfo)||void 0===e?void 0:e.soldStock,o=null===(n=null===(i=this.vm.callerContext.adProductInfo)||void 0===i?void 0:i.seckillInfo)||void 0===n?void 0:n.originalStock;let l=a/o;l>1&&(l=1),s.setProgress(l),this.topContainer.appendChild(s);let h=new TKText;h.style={fontSize:10,color:"#9C9C9C",position:"absolute",top:Ut.isAndroid()?19:20,left:84},h.setText("已抢"+a+"/"+o+"件"),this.topContainer.appendChild(h)}appendHighSalesElements(){var t,e;this.salesText=new TKText,this.salesText.style={fontWeight:"medium",color:"#FE3666",fontSize:14,marginBottom:20};let i=(null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.sales)?null===(e=this.vm.callerContext.adProductInfo)||void 0===e?void 0:e.sales:0;i>=1e4?this.salesText.setText((i/1e4).toFixed(1)+"万"):this.salesText.setText(""+i),this.topContainer.appendChild(this.salesText),this.titleText=new TKText,this.titleText.style={fontWeight:"medium",color:"#FE3666",fontSize:12,marginTop:Ut.isAndroid()?2.5:2},this.titleText.setText("人已下单，速来抢购！"),this.topContainer.appendChild(this.titleText),this.userAvatarView=new gn(this.vm),this.userAvatarView.style={position:"absolute",top:Ut.isAndroid()?23:21,left:0},this.userAvatarView.avatarCount<=0&&(this.salesText.style={marginBottom:8}),this.topContainer.appendChild(this.userAvatarView)}appendCouponElements(){var t,e;this.titleText=new TKText,this.titleText.style={fontWeight:"medium",color:"#FE3666",fontSize:12,marginBottom:24};let i=null===(e=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.couponList)||void 0===e?void 0:e.length;i=i>2?2:i,i>0?this.titleText.setText("恭喜你，获得"+i+"张优惠券~"):(this.titleText.setText("恭喜你，获得优惠券~"),this.titleText.style={marginBottom:8}),this.topContainer.appendChild(this.titleText),this.couponView=new Cn(this.vm,i),this.couponView.style={position:"absolute",top:Ut.isAndroid()?20:18,left:0,height:16},this.topContainer.appendChild(this.couponView)}appendRecommendationElements(){this.titleText=new TKText,this.titleText.style={fontWeight:"medium",color:"#FE3666",fontSize:12,marginBottom:24},this.titleText.setText("恭喜你发现好物，手慢无~"),this.topContainer.appendChild(this.titleText),this.tagView=new fn(this.vm),this.tagView.style={position:"absolute",top:Ut.isAndroid()?16:15,left:0,width:"100%",height:24},this.tagView.hasTags||(this.titleText.style={marginBottom:8}),this.topContainer.appendChild(this.tagView),this.vm.callerContext.enableFullScreenClick()&&this.tagView.addEventListener("tap",(t=>{const e=Et(t,this.tagView);this.vm.callerContext.clickAd(1,e,2,ae.CARD_RECOMMEND_REASON_CLICK)}))}appendOtherElements(){this.productNameText=new TKText,this.productNameText.style={fontWeight:"medium",color:"#222222",fontSize:16,textOverflow:"ellipsis",textLineClamp:1,marginBottom:8},this.productNameText.setText(this.vm.callerContext.getProductName()),this.topContainer.appendChild(this.productNameText)}setupActions(){this.actionBtn.addEventListener("tap",(t=>{const e=Et(t,this.actionBtn);this.vm.callerContext.clickAd(1,e,1,ae.CARD_ACTION_BAR_CLICK)})),this.vm.callerContext.enableFullScreenClick()&&this.addEventListener("tap",(t=>{const e=Et(t,this);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ACTION_BAR_CLICK)}))}}class un extends TKView{constructor(t,e=17,i=20,n=13){super(),this.vm=t,this.height=e,this.priceFontSize=i,this.originPriceFontSize=n,this.setupView()}setupView(){var t,e,i;this.style={height:this.height,flexDirection:"row"};let n=new TKText;n.style={fontWeight:"medium",fontSize:12,color:"#FE3666",height:14,marginTop:this.height-14},n.setText("最低价"),this.appendChild(n);let s=new TKText;s.style={fontWeight:"medium",fontSize:14,color:"#FE3666",height:16,marginTop:this.height-16,marginLeft:2},s.setText("￥"),this.appendChild(s);let a=new TKText;if(a.style={fontWeight:"medium",fontSize:this.priceFontSize,color:"#FE3666",textOverflow:"ellipsis",textLineClamp:1,marginLeft:-1,marginTop:Ut.isAndroid()?-5*this.height/17:-2*this.height/17},a.setText(null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.price),this.appendChild(a),Dt(null===(e=this.vm.callerContext.adProductInfo)||void 0===e?void 0:e.originPrice)){let t=new TKText;t.style={fontWeight:"medium",fontSize:this.originPriceFontSize,color:"#C6C6C6",height:this.originPriceFontSize+2,marginTop:this.height-(this.originPriceFontSize+2),marginLeft:2},t.setText("￥"),this.appendChild(t);let e=new TKText;e.style={fontWeight:"medium",fontSize:this.originPriceFontSize,color:"#C6C6C6",textOverflow:"ellipsis",textLineClamp:1,height:this.originPriceFontSize+2,marginTop:this.height-(this.originPriceFontSize+2),marginLeft:-1,textDecoration:"line-through"},e.setText(null===(i=this.vm.callerContext.adProductInfo)||void 0===i?void 0:i.originPrice),this.appendChild(e)}}}class wn extends TKView{constructor(t,e=14){super(),this.vm=t,this.height=e,this.setupView()}setupView(){this.style={height:this.height,flexDirection:"row",visibility:"hidden"},this.countdownText=new TKText,this.countdownText.style={fontWeight:"medium",fontSize:12,color:"#FE3666",marginTop:.5*(this.height-(Ut.isAndroid()?17:12))},this.countdownText.setText("距结束"),this.appendChild(this.countdownText),this.hourText=this.getCountdownText(),this.appendChild(this.hourText),this.hmSpiltText=this.getSpiltText(":"),this.appendChild(this.hmSpiltText),this.minuteText=this.getCountdownText(),this.appendChild(this.minuteText),this.msSpiltText=this.getSpiltText(":"),this.appendChild(this.msSpiltText),this.secondText=this.getCountdownText(),this.appendChild(this.secondText),this.smsSpiltText=this.getSpiltText(".",!0),this.appendChild(this.smsSpiltText),this.millisecondText=this.getCountdownText(!0),this.appendChild(this.millisecondText)}updateSeckillCountdown(t){var e,i;let n=new Date,s=new Date(null===(i=null===(e=this.vm.callerContext.adProductInfo)||void 0===e?void 0:e.seckillInfo)||void 0===i?void 0:i.endTime).getTime()-n.getTime(),a=Math.floor(s/36e5%24),o=Math.floor(s/6e4%60),l=Math.floor(s/1e3%60),h=Math.floor(s%1e3).toString();s>100?this.updateCountdownText(a,o,l,Number(h[0])):(this.updateCountdownText(0,0,0,0),this.removeChild(this.hourText),this.removeChild(this.hmSpiltText),this.removeChild(this.minuteText),this.removeChild(this.msSpiltText),this.removeChild(this.secondText),this.removeChild(this.smsSpiltText),this.removeChild(this.millisecondText),this.countdownText.setText("秒杀已结束"),t&&t(!0))}updateCountdownText(t,e,i,n){this.setVisibility("visible"),this.hourText.setText(t<10?"0"+t:""+t),this.minuteText.setText(e<10?"0"+e:""+e),this.secondText.setText(i<10?"0"+i:""+i),this.millisecondText.setText(""+n)}getCountdownText(t=!1){let e=new TKText;return e.style={backgroundColor:"#FE3666",fontWeight:"medium",textAlign:"center",fontSize:10,color:"#FFFFFF",borderRadius:2,width:t?12:14,height:this.height,marginLeft:2},e}getSpiltText(t,e=!1){let i=new TKText;return i.style={fontWeight:"medium",fontSize:14,color:"#FE3666",top:e?-4:-2.5,height:16,marginLeft:2},i.setText(t),i}}class gn extends TKView{constructor(t,e=12,i=-3){super(),this.vm=t,this.height=e,this.spacing=i,this.setupView()}setupView(){var t,e,i;if(this.style={height:this.height,flexDirection:"row",justifyContent:"center"},this.avatarCount=null===(e=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.boughtUserIconList)||void 0===e?void 0:e.length,this.avatarCount<=0)return void(this.style={height:0});let n=(this.avatarCount-1)*(this.height+this.spacing);this.style={width:n+this.height};for(let s=this.avatarCount-1;s>=0;s--){const t=null===(i=this.vm.callerContext.adProductInfo)||void 0===i?void 0:i.boughtUserIconList[s];let e=new TKImage;e.style={position:"absolute",top:0,left:n,width:this.height,height:this.height,borderRadius:.5*this.height,borderWidth:.5,borderColor:"#E6E6E6"},n-=this.height+this.spacing,e.setSrc(t),this.appendChild(e)}}}class Cn extends TKView{constructor(t,e,i=16,n=5,s=13,a=8){super(),this.vm=t,this.couponCount=e,this.height=i,this.spacing=n,this.couponValueFontSize=s,this.couponBaseFontSize=a,this.setupView()}setupView(){var t;this.style={flexDirection:"row",justifyContent:"center"};for(let e=0;e<this.couponCount;e++){const i=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.couponList[e];let n=this.getCouponView(i);n.style={marginRight:this.spacing},this.appendChild(n)}}getCouponView(t){let e=new TKView;e.style={flexDirection:"row",justifyContent:"center",height:this.height};let i=new TKView;i.style={flexDirection:"row",backgroundColor:"#FFE1E8",topLeftRadius:3,bottomLeftRadius:3,paddingLeft:1,paddingRight:1,height:this.height},e.appendChild(i);let n=new TKText;n.style={color:"#FE3666",fontSize:this.couponBaseFontSize,fontWeight:"bold",paddingTop:3*this.height/16},n.setText("￥"),i.appendChild(n);let s=new TKText;s.style={color:"#FE3666",fontSize:this.couponValueFontSize,fontWeight:"bold",marginLeft:-1,paddingTop:2*-this.height/16},s.setText(t.displayValue),i.appendChild(s);let a=new TKImage;a.style={width:3,height:this.height},Ht(a,"icon_ksad_ec_coupon_spilt.png"),e.appendChild(a);let o=new TKText;return o.style={backgroundColor:"#FFE1E8",topRightRadius:3,bottomRightRadius:3,color:"#FE3666",fontSize:this.couponBaseFontSize,fontWeight:"bold",paddingLeft:4,paddingRight:4,paddingTop:this.height*(Ut.isAndroid()?2.5:0)/16,height:this.height},o.setText("满"+t.displayBase+"可用"),e.appendChild(o),e}}class fn extends TKView{constructor(t,e=16,i=3,n=10){super(),this.vm=t,this.height=e,this.borderRadius=i,this.fontSize=n,this.setupView()}setupView(){this.style={padding:0,justifyContent:"center"};let t=null;this.hasTags=!1;try{t=this.vm.callerContext.adInfo.adMatrixInfo.adDataV2.dynamicAdStyleInfo.extraDisplayInfo.exposeTagInfoList.slice(0,2),this.hasTags=t&&t.length>0}catch(e){}if(this.hasTags){let e=new pn(t,cn.create({tagViewStyle:1,height:this.height,tagBorderRadius:this.borderRadius,tagFontSize:this.fontSize}));this.appendChild(e)}}}class vn extends TKView{constructor(t,e=32,i=!1){super(),this.vm=t;let n=32&e;const s=n?10:2&e?4:0,a=n?10:4&e?4:0,o=n?10:8&e?4:0,l=n?10:16&e?4:0;this.style={position:"absolute",padding:0,topLeftRadius:s,topRightRadius:a,bottomLeftRadius:o,bottomRightRadius:l,backgroundColor:i?"#00000000":"#0000001A"},this.enabled=!1,n=n||s&&a&&o&&l,this.fullScreenClickText=new TKText,this.fullScreenClickText.style={alignSelf:"center",textAlign:"center",marginLeft:i?0:8,marginRight:i?0:8,height:17,fontSize:10,color:i?"#66666680":n?"#FFFFFF99":"#FFFFFF"},this.fullScreenClickText.setText(this.vm.getFullScreenClikText()),this.appendChild(this.fullScreenClickText)}}class yn extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupData()}setupView(){this.isVertical=this.vm.isVertical(),this.isShakeStyle=this.vm.callerContext.enableShakeInteraction();const t=this.isShakeStyle?12:8,e=this.isShakeStyle?this.isVertical?12:0:8;this.style={position:"absolute",justifyContent:"flex-end",alignItems:"center"},this.enabled=!1,this.backgroundImage=new TKBlurImage,this.backgroundImage.style={position:"absolute",width:"100%",height:"100%",topLeftRadius:t,topRightRadius:t,bottomLeftRadius:e,bottomRightRadius:e},this.appendChild(this.backgroundImage);let i=this.isVertical?"90,FFFFFF 0.2, FFFFFF00 0.4":"90,FFFFFF 0.5, FFFFFF00 0.8";this.isShakeStyle&&(i=this.isVertical?"90,FFFFFF 0.35, FFFFFF00 0.5":"90,FFFFFF 0.5, FFFFFF00 0.8"),this.gradientView=new TKView,this.gradientView.style={position:"absolute",width:"100%",height:"100%",bottomLeftRadius:e,bottomRightRadius:e,gradientBgColor:i},this.appendChild(this.gradientView),this.isShakeStyle&&this.isVertical&&(this.appendGradientView=new TKView,this.appendGradientView.style={position:"absolute",width:"100%",height:"100%",bottomLeftRadius:e,bottomRightRadius:e,gradientBgColor:"90,00000033, 00000000 0.08"},this.appendChild(this.appendGradientView));this.avatarImage=new TKImage,this.avatarImage.style={marginBottom:12,width:74,height:74,borderRadius:37},this.appendChild(this.avatarImage)}setupData(){let t=b(this.vm.adInfo);Dt(t)?this.backgroundImage.setSrc(t):this.backgroundImage.setBackgroundColor("#FFFFFFFF"),this.avatarImage.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.adInfo))}showDataDetailViewIfNeeded(){this.dataView=new TKView;let t=this.isVertical?104:89;this.isShakeStyle&&(t=this.isVertical?152:24),this.dataView.style={marginBottom:t,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.appendChild(this.dataView),this.likeView=this.createDataDetailView("直播获赞",this.vm.getLiveLikeCount()),this.dataView.appendChild(this.likeView),this.audienceView=this.createDataDetailView("观看人数",this.vm.getLiveAudienceCount()),this.audienceView.style={marginLeft:60},this.dataView.appendChild(this.audienceView)}createDataDetailView(t,e){const i=new TKView;i.style={justifyContent:"center",alignItems:"center",display:Ft(e)?"none":"flex"};const n=new TKText;n.style={fontSize:16,color:"#222222",fontWeight:"medium",textAlign:"center"},n.setText(e),i.appendChild(n);const s=new TKText;return s.style={fontSize:16,color:"#222222",textAlign:"center"},s.setText(t),i.appendChild(s),i}}class Vn extends TKView{constructor(t){super(),this.vm=t,this.isVertical=this.vm.isVertical(),this.size={width:90,height:134},this.setupView(),this.setupAction(),this.setupData();const e=this;He(this.vm,this.vm.$attrsPath.liveShopCardChangeType,(t=>{2==t&&e.showLiveProductView(),3==t&&e.hideLiveProductView()}))}setupView(){this.style={position:"absolute",justifyContent:"flex-end",width:this.size.width,height:this.size.height+(this.isVertical?20:0)},this.enabled=!1,this.isVertical&&(this.logoView=new ai(this.vm.getLogoStyle(),this.vm.adInfo),this.logoView.style={position:"absolute",right:0,bottom:0},this.appendChild(this.logoView)),this.productView=new TKView,this.productView.style={backgroundColor:"#FFFFFF",borderRadius:4,width:this.size.width,height:this.size.height,alignItems:"center",opacity:0},this.appendChild(this.productView),this.coverImage=new TKImage,this.coverImage.style={marginTop:1,width:88,height:88,borderRadius:4},this.productView.appendChild(this.coverImage),this.titleText=new TKText,this.titleText.style={marginTop:3,width:84,height:18,fontSize:12,fontWeight:"medium",textOverflow:"ellipsis",textLineClamp:1,color:"#666666"},this.productView.appendChild(this.titleText),this.priceView=new TKView,this.priceView.style={flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginTop:3,width:86,height:20,borderRadius:4,backgroundColor:"#FE3666"},this.productView.appendChild(this.priceView),this.priceContainerView=new TKView,this.priceContainerView.style={width:62,marginBottom:2,alignSelf:"center",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end",paddingLeft:6,marginRight:3},this.priceView.appendChild(this.priceContainerView),this.priceSymbolText=new TKText,this.priceSymbolText.style={fontSize:10,fontWeight:"medium",color:"#FFFFFF"},this.priceContainerView.appendChild(this.priceSymbolText),this.priceText=new TKText,this.priceText.style={maxWidth:50,maxHeight:18,fontSize:14,fontWeight:"medium",color:"#FFFFFF",textLineClamp:1,textOverflow:"ellipsis"},this.priceContainerView.appendChild(this.priceText),this.dividingLineView=new TKView,this.dividingLineView.style={width:.5,height:12,marginRight:5,backgroundColor:"#FFFFFF",opacity:.5},this.priceView.appendChild(this.dividingLineView),this.grabImage=new TKImage,this.grabImage.style={width:14,height:14,marginRight:5},this.priceView.appendChild(this.grabImage)}setupData(){const t=this.vm.getLiveProductInfo();Ft(t)||(this.coverImage.setSrc(t.imageUrl),this.titleText.setText(t.title),this.priceSymbolText.setText("￥"),this.priceText.setText(t.price),Ht(this.grabImage,"icon_ksad_live_grab.png"))}setupAction(){const t=this;this.productView.addEventListener("tap",(e=>{t.vm.convert(2,Et(e,t.productView),ae.ACTIONBAR_ICON_CLICK)}))}showLiveProductView(){if(this.enabled)return;this.enabled=!0,this.setupData();const t=this.createProductViewZoomAnimation(!0);if(this.productView.addAnimation(t,"zoomInAnimation"),this.isVertical){const t=this.createLogoViewAnimation(!0);this.logoView.addAnimation(t,"logoViewUpAnimation")}}hideLiveProductView(){if(!this.enabled)return;this.enabled=!1;const t=this.createProductViewZoomAnimation(!1);if(this.productView.addAnimation(t,"zoomOutAnimation"),this.isVertical){const t=this.createLogoViewAnimation(!1);this.logoView.addAnimation(t,"logoViewDownAnimation")}}createProductViewZoomAnimation(t){const e=this,i=new TKKeyframeAnimation;return i.setAnimations([()=>(e.productView.style={transform:{translate:{x:t?e.size.width/2:0,y:t?e.size.height/2:0},scale:t?0:1},opacity:t?0:1},0),()=>(e.productView.style={transform:{translate:{x:t?0:e.size.width/2,y:t?0:e.size.height/2},scale:t?1:0},opacity:t?1:0},1)]),i.duration=500,i}createLogoViewAnimation(t){const e=this,i=new TKKeyframeAnimation,n=e.size.height+5;return i.setAnimations([()=>(e.logoView.style={transform:{translate:{y:t?-n:0}}},1)]),i.duration=500,i}}class In{constructor(t,e){this.enable=!0,this.mOnFailedCallback=(t,e)=>{this.isEnable()&&(this.vm.videoPlayFailed(t,e),fe().emit(de,{errorCode:t,errorReason:t}))},this.mOnFinishCallback=()=>{this.isEnable()&&(fe().emit(ce,{code:1}),this.vm.videoPlayFinished())},this.mOnFirstFrameCallback=()=>{this.isEnable()&&(this.vm.videoPlayStart(),this.mOuterFirstFrameCallback&&this.mOuterFirstFrameCallback())},this.mOnProgressCallback=(t,e,i)=>{this.isEnable()&&(this.vm.updateVideoProgress(t,e,i),Te.updateVideoPlayStatus("progress",0,"",1e3*t),fe().emit(pe,{currentTime:t,avaliableTime:e,totalTime:i}),this.mOuterProgressCallback&&this.mOuterProgressCallback(t,e,i))},this.mOnMuteChangeCallback=t=>{this.isEnable()&&(this.vm.isMuted=t,fe().emit(re,{muted:t}))},this.mOnStatusCallback=t=>{this.isEnable()&&(this.vm.playStatus=t)},this.enable=!0,this.vm=t,this.mName=e}destroy(){this.enable=!1,this.vm=null}isEnable(){return this.enable&&null!=this.vm}}class Tn extends In{constructor(t){super(t,"LivePlayerCallbacks"),this.mOnProgressCallback=(t,e,i)=>{this.isEnable()&&(this.liveVM.timerPaused||(fe().emit(pe,{currentTime:t,avaliableTime:e,totalTime:i}),this.vm.updateVideoProgress(t,e,i),Te.updateLivePlayStatus("progress",0,"",1e3*t)))},this.mOnLiveShopInfoCallback=t=>{if(!this.isEnable())return;let e=JSON.parse(t);var i;Ft(e)||(this.liveVM.shopCardChangeType=e.changeType),Ft(e)||1!=e.shopCardType||(this.liveVM.currentProductInfo=e.itemInfo,i=this.liveVM.currentProductInfo,Xt.callNativeWithCallback("updateLiveCurrentShopInfo",i))},this.mOnLiveEndCallback=t=>{this.isEnable()&&this.mOuterLiveEndCallback&&this.mOuterLiveEndCallback(t)},this.mOnLiveMessageDataCallback=t=>{if(!this.isEnable())return;let e=JSON.parse(t);this.liveVM.liveMessage=e},this.liveVM=t}}class Sn{constructor(t=5e3){this.mStartTimeoutMS=3e3,this.enable=!1,this.mTimer=0,this.startTimeoutCallback=()=>{},this.mStartTimeoutMS=t}onPlayerPrepare(){this.stopTimer(),this.enable=!0,this.mTimer=setTimeout((()=>{this.enable&&this.startTimeoutCallback&&this.startTimeoutCallback()}),this.mStartTimeoutMS)}onFirstFrame(){this.stopTimer()}stopTimer(){this.mTimer>0&&(clearTimeout(this.mTimer),this.enable=!1,this.mTimer=0)}}class bn{static initImagePlayer(t,e,i,n){let s=i.getView();n.mOuterProgressCallback=(t,e,i)=>{t%5==0&&bn.playerScaleAnimation(s)};let a=b(e.adInfo);i.setURLs([a]),i.setDuration(e.getVideoDuration()),s.style={width:"100%",height:"100%"},i.setOnProgress(n.mOnProgressCallback),i.setOnFirstFrame(n.mOnFirstFrameCallback),i.setOnFinish(n.mOnFinishCallback),i.setOnFailed(n.mOnFailedCallback),i.setOnStatusCallback(n.mOnStatusCallback),bn.setActions(s,e)}static setActions(t,e){let i=new r;i.material_click_area=2==e.adStyle?"neo_image":"fullscreen_image";const n=e.getActionBarStyle();i.template_show_type=10==n?"picture_template10":"picture_template9",e.isSlideEnable()&&(_t()?function(t,e){if(Ft(e))return;if(!_t())return void t.addEventListener("swipe",(t=>{e()}));let i=null,n=t=>{if("down"==t.type)i=t;else if("up"==t.type&&3==t.motionType&&null!=i){let n=t.position.x,s=t.position.y,a=i.position.x,o=i.position.y;(Math.abs(n-a)>=10||Math.abs(s-o)>=10)&&e()}};t.addEventListener("down",n),t.addEventListener("up",n)}(t,(()=>{e.convert(3,{x:0,y:0},ae.CARD_SWIPE_CONVERT,i)})):t.addEventListener("swipe",(t=>{e.convert(3,{x:0,y:0},ae.CARD_SWIPE_CONVERT,i)}))),t.addEventListener("tap",(n=>{const s=Et(n,t);e.convert(3,s,ae.CARD_PAGE_CLICK,i)}))}static playerScaleAnimation(t){let e=new TKKeyframeAnimation;e.duration=1600,e.timingFunction="Linear",e.setAnimations([()=>(t.style={transform:{scale:1.1}},.25),()=>(t.style={transform:{scale:1}},.5),()=>(t.style={transform:{scale:1.1}},.75),()=>(t.style={transform:{scale:1}},1)]),t.addAnimation(e,"playerScale")}}var An;!function(t){t.IMAGE="image",t.LIVE="live",t.VIDEO="video"}(An||(An={}));class xn{constructor(){try{Ut.supportMinimumTKVersion("5.0.3")&&(this.mDelegate=new TKImagePlayer)}catch(t){}}getView(){return Ut.supportMinimumTKVersion("5.0.3")?this.mDelegate:null}isImagePlayerAvailable(){return!!Ut.supportMinimumTKVersion("5.0.3")&&null!=this.mDelegate}setURLs(t){this.isImagePlayerAvailable()&&this.mDelegate.setURLs(t)}setDuration(t){this.isImagePlayerAvailable()&&this.mDelegate.setDuration(t)}setImageResize(t){this.isImagePlayerAvailable()&&this.mDelegate.setImageResize(t)}setVerticalGravity(t){this.isImagePlayerAvailable()&&this.mDelegate.setVerticalGravity(t)}setHorizontalGravity(t){this.isImagePlayerAvailable()&&this.mDelegate.setHorizontalGravity(t)}play(){this.isImagePlayerAvailable()&&this.mDelegate.play()}pause(){this.isImagePlayerAvailable()&&this.mDelegate.pause()}resume(){this.isImagePlayerAvailable()&&this.mDelegate.resume()}stop(){this.isImagePlayerAvailable()&&this.mDelegate.stop()}setEnableCache(t){this.isImagePlayerAvailable()&&this.mDelegate.setEnableCache(t)}setOnFirstFrame(t){this.isImagePlayerAvailable()&&this.mDelegate.setOnFirstFrame(t)}setOnProgress(t){this.isImagePlayerAvailable()&&this.mDelegate.setOnProgress(t)}setOnFinish(t){this.isImagePlayerAvailable()&&this.mDelegate.setOnFinish(t)}setOnFailed(t){this.isImagePlayerAvailable()&&this.mDelegate.setOnFailed(t)}setOnStatusCallback(t){this.isImagePlayerAvailable()&&this.mDelegate.setOnStatusCallback(t)}}class kn{constructor(t,e,i){this.mEnableRollbackToImage=!1,this.liveEndTimer=0,this.liveEndProgress=1,this.totalCountTime=-1,this.vm=t,this.liveVideoCardVM=e,this.mEnableRollbackToImage=i}static wrapInitLivePlayer(t,e,i){t&&(Ut.supportMinimumTKVersion("6.0.1")?t.initWithUserInfo(e,""+f.getAuthorId(i),f.getLiveStreamId(i),f.getLiveServiceToken(i),f.getLiveUserId(i)):t.initAdLivePlayer(e,""+f.getAuthorId(i),f.getLiveStreamId(i)))}setupPlayer(t,e,i){if(this.mEnableRollbackToImage){let e=function(t){try{let e=t.abConfig.videoRollbackToImageTimeout;return Math.floor(e)}catch(e){return 4e3}}(Tt());this.mTimeoutHelper=new Sn(e),this.mTimeoutHelper.startTimeoutCallback=()=>{this.rollbackToImage(t)}}Ut.supportMinimumTKVersion("5.0.0")&&(this.mRealPlayer=new TKLivePlayer,this.mRealPlayer.style={width:i?"100%":e,height:"100%"},this.mLivePlayerCallbacks=new Tn(this.vm),this.mLivePlayerCallbacks.mOuterFirstFrameCallback=()=>{var t;this.setMuted(this.vm.isMuted),this.mTimeoutHelper&&this.mTimeoutHelper.onFirstFrame(),t=An.LIVE,ft=t},this.initLivePlayer(t,this.mRealPlayer,this.mLivePlayerCallbacks),this.mTimeoutHelper&&this.mTimeoutHelper.onPlayerPrepare())}rollbackToImage(t){let e=this.mRealPlayer;this.mLivePlayerCallbacks.destroy(),this.mLivePlayerCallbacks=null,this.mRealPlayer=new xn,this.mImagePlayerCallbacks=new In(this.vm,"ImagePlayerCallbacks"),bn.initImagePlayer(t,this.vm,this.mRealPlayer,this.mImagePlayerCallbacks),this.mRealPlayer.play(),t.replaceChild(kn.obtainPlayerView(this.mRealPlayer),kn.obtainPlayerView(e)),e.stop(),e=null,this.vm.onDowngrade()}static obtainPlayerView(t){return t instanceof TKLivePlayer?t:t instanceof xn?t.getView():null}initLivePlayer(t,e,i){t.appendChild(e),kn.wrapInitLivePlayer(e,this.vm.deviceInfo.appId,this.vm.adInfo),e.setOnMuteChange((t=>{this.liveVideoCardVM.topBarVM.isMuted=t})),e.setForceGetAudioFocus(this.vm.configInfo.appConfig.forceGetAudioFocus),e.setOnFirstFrame(i.mOnFirstFrameCallback),e.setOnFailed(i.mOnFailedCallback),e.setOnLiveShopInfo(i.mOnLiveShopInfoCallback),e.setOnProgress(i.mOnProgressCallback),e.setOnFinish(i.mOnFinishCallback),i.mOuterLiveEndCallback=t=>{setTimeout((()=>{let e=JSON.parse(t);this.vm.livePushEndInfo=e,this.vm.isLiveEnd=!0,this.startLiveEndTimer()}),300)},e.setOnLiveEnd(i.mOnLiveEndCallback),e.setOnLiveMessageData(i.mOnLiveMessageDataCallback)}startLiveEndTimer(){this.stopLiveEndTimer(),this.liveEndTimer=setInterval((()=>{this.vm.timerPaused||(this.vm.updateVideoProgress(this.liveEndProgress,0,0),this.liveEndProgress==this.totalCountTime&&this.vm.isLiveEnd&&this.vm.videoPlayFinished(),this.liveEndProgress++)}),1e3)}stopLiveEndTimer(){this.liveEndTimer&&clearInterval(this.liveEndTimer),this.liveEndTimer=0}pause(){var t;this.vm.timerPaused=!0,null===(t=this.mRealPlayer)||void 0===t||t.pause()}resume(){var t;this.vm.timerPaused=!1,null===(t=this.mRealPlayer)||void 0===t||t.resume()}stop(){var t;this.vm.timerPaused=!0,null===(t=this.mRealPlayer)||void 0===t||t.stop()}setMuted(t){this.mRealPlayer instanceof TKLivePlayer&&this.mRealPlayer.setMuted&&this.mRealPlayer.setMuted(t)}}class Ln extends be{constructor(t,e,i,n="",s=""){super(),this.size=t,this.iconSize=e,this.url=i,this.title=n,this.subtitle=s,this.setViews()}setViews(){this.style={width:this.size.width,height:this.size.height,alignItems:"center"},this.throughHitTest=!0,Ut.supportMinimumTKVersion("5.0.0")&&(this.lottieImageView=new TKLottieImageView,this.lottieImageView.style={width:this.iconSize.width,height:this.iconSize.height},this.lottieImageView.enabled=!1,this.lottieImageView.setUri(this.url),this.lottieImageView.setLoop(!0),this.lottieImageView=this.lottieImageView,this.play(),this.appendChild(this.lottieImageView)),this.titleLabel=new TKText,this.titleLabel.style={color:"#FFFFFF",fontSize:20,marginTop:-15,textOverflow:"ellipsis"},this.titleLabel.enabled=!1,this.titleLabel.setText(this.title),this.appendChild(this.titleLabel),this.subtitleLabel=new TKText,this.subtitleLabel.style={color:"#FFFFFF",fontSize:14,marginTop:4,textOverflow:"ellipsis"},this.subtitleLabel.enabled=!1,this.subtitleLabel.setText(this.subtitle),this.appendChild(this.subtitleLabel);const t=this;this.addEventListener("tap",(e=>{t.clickCallback&&t.clickCallback(e)}))}play(){this.lottieImageView&&this.lottieImageView.play()}stop(){this.lottieImageView&&this.lottieImageView.stop()}pause(){this.lottieImageView&&this.lottieImageView.pause()}resume(){this.lottieImageView&&this.lottieImageView.resume()}}class _n extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupData(),this.setupActions();const e=this;ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"pageVisiable":e.startShakeAnimation();break;case"pageInvisiable":e.stopShakeAnimation()}}))}setupView(){this.style={alignItems:"center"},this.throughHitTest=!0,this.shakeView=new TKView,this.shakeView.style={width:92,height:92,borderRadius:46,marginBottom:5,justifyContent:"flex-end",backgroundColor:"#00000066"},this.appendChild(this.shakeView),this.shakeAnimationView=new TKView,this.shakeAnimationView.style={width:92,height:92,top:15,left:22,position:"absolute"},this.shakeImageView=new TKImage,this.shakeImageView.style={width:46,height:46},this.shakeAnimationView.appendChild(this.shakeImageView),this.shakeView.appendChild(this.shakeAnimationView),this.titleLabel=new TKText,this.titleLabel.style={color:"#FFFFFFFF",fontSize:13,textAlign:"center",marginBottom:10},this.titleLabel.enabled=!1,this.shakeView.appendChild(this.titleLabel),this.subtitleLabel=new TKText,this.subtitleLabel.style={color:"#FFFFFFFF",fontSize:11,textAlign:"center",shadow:"0 0 4 #00000099"},this.appendChild(this.subtitleLabel),this.touchView=new TKView,this.touchView.style={alignItems:"center",width:92,height:92,borderRadius:46,position:"absolute"},this.appendChild(this.touchView)}addShakeAnimation(){const t=function(){const t=new TKKeyframeAnimation;t.animType="rotationZ";const e=Ut.isAndroid()?.8:1;return t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}],t.duration=1200,t}();this.shakeAnimationView.addAnimation(t,"shakeAnimation")}startShakeAnimation(){this.stopShakeAnimation(),this.addShakeAnimation(),this.timer=setInterval((()=>{this.addShakeAnimation()}),1200)}stopShakeAnimation(){this.timer&&clearInterval(this.timer),this.shakeAnimationView&&this.shakeAnimationView.removeAllAnimation()}setupData(){this.shakeImageView.setSrc("image/ksad-interstitial-card/ic_shake_hand.png"),this.titleLabel.setText(this.vm.getShakeTitle()),1==this.vm.callerContext.adInfo.adBaseInfo.adOperationType?Ne(this.subtitleLabel,"text",this.vm.$attrsPath.callerContext.downloadText):this.subtitleLabel.setText(this.vm.getShakeSubtitle())}setupActions(){this.vm.getShakeClickEnable()&&(this.touchView.addEventListener("tap",(t=>{const e=Et(t,this.touchView);this.vm.callerContext.clickAd(1,e,1,ae.SHAKE_BIG_ICON_CLICK)})),this.subtitleLabel.addEventListener("tap",(t=>{const e=Et(t,this.touchView);this.vm.callerContext.clickAd(1,e,1,ae.SHAKE_BIG_ICON_CLICK)})))}}class En extends TKView{constructor(t){super(),this.vm=t,this.setupViews()}setupViews(){this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",opacity:0,transform:{translate:{y:10}}},0!=this.vm.dynamicEffectViewModel.getGuideBottom()&&(this.style={bottom:this.vm.dynamicEffectViewModel.getGuideBottom()}),this.throughHitTest=!0,1==this.vm.dynamicEffectViewModel.getEffectStyle()?this.vm.callerContext.isRotateAndSlideStyle()?this.setupRotateIcon():this.vm.callerContext.enableShakeInteraction()&&this.setupShakeIcon():2==this.vm.dynamicEffectViewModel.getEffectStyle()&&this.setupBreatheIcon()}setupRotateIcon(){this.rotateIcon=new ln(this.vm),this.rotateIcon.setAlignSelf(),this.appendChild(this.rotateIcon)}setupShakeIcon(){this.shakeIcon=new _n(this.vm.shakeViewModel),this.appendChild(this.shakeIcon)}setupBreatheIcon(){const t=this.vm.dynamicEffectViewModel.getGuideResourceUrl();this.breatheIcon=new Ln({width:100,height:146},{width:100,height:100},t,"点击任意"),this.breatheIcon.subtitleLabel&&Ne(this.breatheIcon.subtitleLabel,"text",this.vm.$attrsPath.callerContext.downloadText);const e=this;this.breatheIcon.clickCallback=t=>{const i=Et(t,e);this.vm.callerContext.clickAd(1,i,1,ae.CARD_ACTION_BAR_CLICK)},this.appendChild(this.breatheIcon)}startGuideShowAnimation(){const t=this.createGuideAnimation(!0);this.addAnimation(t,"guideShowAnimation")}startGuideHideAnimation(){const t=this.createGuideAnimation(!1);this.addAnimation(t,"guideHideAnimation")}createGuideAnimation(t){const e=new TKKeyframeAnimation;return e.setAnimations([()=>(this.style={transform:{translate:{y:t?-10:10}},opacity:t?1:0},1)]),e.duration=400,e.timingFunction="linear",e}}const Dn="shakeAnimation",Rn="breatheAnimation";let Pn=null;class Bn{constructor(t){this.vm=t}static shareHelper(t){return Pn||(Pn=new Bn(t)),Pn}startDynamicEffectIfNeed(t){if(!t)return;if(1!=this.vm.dynamicEffectViewModel.getEffectStyle()&&2!=this.vm.dynamicEffectViewModel.getEffectStyle())return;const e=this;ze(this.vm.$attrsPath.callerContext.lifeStatus,(i=>{"showStart"===i&&e.startDynamicEffect(t)})),ze(this.vm.$attrsPath.callerContext.isShowingCreditBalloonHint,(i=>{i&&(e.blockDynamicEffectAnimation=!0),!i&&e.blockDynamicEffectAnimation&&(e.blockDynamicEffectAnimation=!1,e.startDynamicEffect(t))})),ze(this.vm.$attrsPath.callerContext.adHasConvert,(i=>{i&&e.stopDynamicEffectAnimation(t)}))}startDynamicEffect(t){const e=this;setTimeout((()=>{e.startDynamicEffectAnimation(t)}),this.vm.dynamicEffectViewModel.getEffectDelayTime())}startDynamicEffectAnimation(t){if(this.blockDynamicEffectAnimation||this.vm.callerContext.adHasConvert)return;const e=this;setTimeout((()=>{e.showDynamicEffectMaskView()}),this.vm.dynamicEffectViewModel.getGuideDelayTime()),this.vm.dynamicEffectViewModel.reportDynamicEffectImpression(),1==this.vm.dynamicEffectViewModel.getEffectStyle()?this.startShakeAnimation(t):2==this.vm.dynamicEffectViewModel.getEffectStyle()&&this.startBreatheAnimation(t),setTimeout((()=>{e.stopDynamicEffectAnimation(t)}),this.vm.dynamicEffectViewModel.getEffectShowTime())}stopDynamicEffectAnimation(t){1==this.vm.dynamicEffectViewModel.getEffectStyle()?(t.removeAnimation(Dn),t.style={transform:{rotate:0}}):2==this.vm.dynamicEffectViewModel.getEffectStyle()&&(t.removeAnimation(Rn),t.style={transform:{scale:1}}),this.removeDynamicEffectMaskViewIfNeeded()}startShakeAnimation(t){const e=new TKKeyframeAnimation;e.setAnimations([()=>(t.style={transform:{rotate:2}},.22),()=>(t.style={transform:{rotate:0}},.3),()=>(t.style={transform:{rotate:-2}},.37),()=>(t.style={transform:{rotate:0}},.44),()=>(t.style={transform:{rotate:2}},.51),()=>(t.style={transform:{rotate:0}},.65)]),e.duration=1750,e.repeatCount=Number.MAX_SAFE_INTEGER,e.timingFunction="linear",t.addAnimation(e,Dn)}startBreatheAnimation(t){const e=new TKKeyframeAnimation;e.setAnimations([()=>(t.style={transform:{scale:.97}},.14),()=>(t.style={transform:{scale:1}},.28),()=>(t.style={transform:{scale:.97}},.42),()=>(t.style={transform:{scale:1}},.56)]),e.duration=1750,e.repeatCount=Number.MAX_SAFE_INTEGER,e.timingFunction="linear",t.addAnimation(e,Rn)}appendDynamicEffectMaskViewIfNeeded(t,e){if(!t)return;if(1!=this.vm.dynamicEffectViewModel.getEffectStyle()&&2!=this.vm.dynamicEffectViewModel.getEffectStyle())return;if(this.hasShownMaskView)return;this.hasShownMaskView=!0;const i=e?0:this.vm.callerContext.enableShakeInteraction()?12:8,n=e?"#00000066":"#000000B3";this.maskView=new TKView,this.maskView.style={width:"100%",height:"100%",borderRadius:i,backgroundColor:n,position:"absolute",opacity:0},this.maskView.throughHitTest=!0,t.appendChild(this.maskView)}showDynamicEffectMaskView(){if(!this.hasShownMaskView||this.vm.callerContext.adHasConvert)return;const t=ni(this.maskView,400,!0),e=this;t.on("end",(()=>{e.guideView&&this.hasShownMaskView&&!this.vm.callerContext.adHasConvert&&e.guideView.startGuideShowAnimation()})),e.vm.callerContext.controlInteractiveElementHide=!0,this.maskView&&this.maskView.addAnimation(t,"maskViewShowAnimation")}removeDynamicEffectMaskViewIfNeeded(){if(!this.hasShownMaskView)return;this.guideView&&(this.guideView.startGuideHideAnimation(),this.vm.callerContext.controlInteractiveElementHide=!1);const t=si(this.maskView,400,!0),e=this;t.on("end",(()=>{e.maskView=null})),this.maskView.addAnimation(t,"maskViewHideAnimation"),this.hasShownMaskView=!1}appendDynamicEffectGuideViewIfNeeded(t){this.hasShownMaskView&&(this.guideView=new En(this.vm),t.appendChild(this.guideView))}}let Fn=70;const Mn=94/533;class Kn extends TKView{constructor(t){super(),this.vm=t,Yt.log("big card initViewSize"),this.initViewSize(),Yt.log("big card setupView"),this.setupView(),Yt.log("big card setupCallback"),this.setupCallback();const e=this;He(this.vm,this.vm.$attrsPath.liveEnd,(t=>{t&&e.showLiveEndView()})),ze(this.vm.$attrsPath.callerContext.showPecCouponView,(t=>{t&&e.showCouponView()})),ze(this.vm.$attrsPath.callerContext.controlInteractiveElementHide,(t=>{e.combineActionBar&&(e.combineActionBar.style={visibility:t?"hidden":"visible"}),e.combineContentView&&(e.combineContentView.style={visibility:t?"hidden":"visible"})}))}setupCallback(){const t=this;this.vm.materialViewModel.videoMuteCallback=t=>{this.playerView&&this.playerView.setMuted(t),this.livePlayView&&this.livePlayView.setMuted(t),this.soundBtn&&this.soundBtn.setOn(!t)},this.playerView&&(this.playerView.setOnFirstFrame((()=>{this.playBtn&&this.realContainer.removeChild(this.playBtn),this.contentImage&&(this.contentImage.style={visibility:"hidden"}),te(this.vm.adInfo),this.vm.callerContext.playerLoadState=1,this.vm.callerContext.notifyUIErrorReport(),Te.updateVideoPlayStatus("start"),Te.log(399,null,null)})),this.playerView.setOnFinish((()=>{this.autocallView&&this.autocallView.handlePlayFinished(),this.vm.materialViewModel.videoPlayFinished(),this.showEndCard()})),this.playerView.setOnProgress(((t,e,i)=>{t<0&&(t=0),Te.updateVideoPlayStatus("progress",0,"",1e3*t),this.vm.callerContext.playDuration=1e3*t,this.autocallView&&this.autocallView.handlePlayTime(this.vm.callerContext.playDuration),this.vm.materialViewModel.checkNeedReportPlayNSecond(t,(e=>{e&&Te.playNSecond(Math.floor(t))})),this.vm.materialViewModel.updateCountDownByPlayer(t,i)})),Ut.supportMinimumTKVersion("4.0.9")&&this.playerView.setOnStatusCallback((t=>{this.contentImage&&(this.contentImage.style={visibility:"visible"})})),this.playerView.setOnMuteChange((t=>{this.soundBtn.setOn(!t)})),this.playerView.setOnFailed(((t,e)=>{this.autocallView&&this.autocallView.handlePlayFailed(),this.vm.callerContext.playerLoadState=2,this.vm.callerContext.notifyUIErrorReport(),Te.updateVideoPlayStatus("failed",t,e)})),this.soundBtn.changeCallback=()=>{this.playerView.setMuted(!this.soundBtn.on)},this.vm.materialViewModel.registerVideoPlayerListener((t=>{t||this.playBtn.setVisibility("visible")}))),this.livePlayView&&(this.livePlayView.setOnFirstFrame((()=>{this.playBtn&&this.realContainer.removeChild(this.playBtn),this.vm.callerContext.playerLoadState=1,this.vm.callerContext.notifyUIErrorReport(),Te.log(399,null,null)})),this.livePlayView.setOnFinish((()=>{Te.updateVideoPlayStatus("end"),this.vm.materialViewModel.playFinished=!0,this.autocallView&&this.autocallView.handlePlayFinished(),this.showEndCard(),Te.log(400,null,null)})),this.livePlayView.setOnProgress(((t,e,i)=>{t<0&&(t=0),Te.updateLivePlayStatus("progress",0,"",1e3*t),this.vm.callerContext.playDuration=1e3*t,this.autocallView&&this.autocallView.handlePlayTime(this.vm.callerContext.playDuration),this.vm.materialViewModel.checkNeedReportPlayNSecond(t,(e=>{e&&Te.playNSecond(Math.floor(t))})),this.vm.materialViewModel.countDownWithLivePlayer(this.livePlayView,t,e,i)})),this.livePlayView.setOnMuteChange((t=>{this.soundBtn.setOn(!t)})),this.livePlayView.setOnFailed((()=>{this.autocallView&&this.autocallView.handlePlayFailed(),this.vm.callerContext.playerLoadState=2,this.vm.callerContext.notifyUIErrorReport()})),this.livePlayView.setOnLiveEnd((t=>{setTimeout((()=>{let e=JSON.parse(t);this.vm.livePushEndInfo=e,this.vm.liveEnd=!0}),300)})),this.livePlayView.setOnLiveShopInfo((t=>{let e=JSON.parse(t);this.vm.liveRoomItemInfo=e.itemInfo,this.vm.liveShopCardChangeType=e.changeType})),this.livePlayView.setOnLiveMessageData((e=>{if(t.liveMessageView){let i=JSON.parse(e);t.liveMessageView.addLiveMessage(i)}})),this.soundBtn.changeCallback=()=>{this.livePlayView.setMuted(!this.soundBtn.on)},this.vm.materialViewModel.registerVideoPlayerListener((t=>{t||this.playBtn.setVisibility("visible")}))),this.vm.materialViewModel.videoCountDownCompletedCallback=e=>{t.playerView&&t.playerView.stop(),t.livePlayView&&t.livePlayView.stop(),this.vm.materialViewModel.playFinished=!0,this.showEndCard(),0!=e&&Te.log(400,null,null)},this.vm.closeActionViewModel.skipCallback=e=>{t.playerView&&(t.playerView.stop(),t.vm.materialViewModel.playFinished=!0),t.livePlayView&&(t.livePlayView.stop(),t.vm.materialViewModel.playFinished=!0),t.showEndCardCallback&&t.showEndCardCallback(e)}}setupDatas(){}initViewSize(){}setupView(){const t=this.vm.callerContext.interstitialContainerSize;Kn.viewSize={width:0,height:0};const e={width:0,height:0};if(this.vm.callerContext.isVertical()){let i=0,n=0;if(this.vm.callerContext.isVerticalMaterial()||this.vm.isRotateAndSlideStyle()){const e=.8;n=16/9,Kn.viewSize.width=t.width*e,Kn.viewSize.height=Kn.viewSize.width*n,Kn.viewSize.height>t.height&&(Kn.viewSize.height=t.height*e,Kn.viewSize.width=Kn.viewSize.height/n)}else n=9/16,Kn.viewSize.width=t.width,Kn.viewSize.height=Kn.viewSize.width*n,i=Fn;e.width=Kn.viewSize.width,e.height=Kn.viewSize.height,Kn.viewSize.height+=i}else{if(e.width=t.width,Kn.viewSize.width=t.width,Kn.viewSize.height=t.height,this.vm.callerContext.isVerticalMaterial()){let i=9/16;Kn.viewSize.height=t.height,e.height=t.height-Fn,e.width=e.height*i}else e.height=t.height-Fn+(Ut.isAndroid()?3:0);Kn.viewSize.height-=Ut.isAndroid()?16:0}this.vm.isEqualScalingCutRule()&&!this.vm.callerContext.isLiveAd()&&(e.width=this.vm.getEqualScalingMaterialSize().width,e.height=this.vm.getEqualScalingMaterialSize().height,this.vm.isVertical()||this.vm.isVerticalMaterial()||!this.vm.isRotateAndSlideStyle()||(Kn.viewSize.width=e.width,Kn.viewSize.height=e.height)),this.fullScreenClickTextHeight=0,this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()&&(this.vm.isVertical()&&this.vm.isVerticalMaterial()||this.vm.isLiveShopStyle())&&(this.fullScreenClickTextHeight=54),this.vm.isRotateAndSlideStyle()&&(Fn=0),this.style={justifyContent:"center",alignItems:"center",flexDirection:"column",width:Kn.viewSize.width,height:Kn.viewSize.height+this.fullScreenClickTextHeight},this.realContainer=new TKView,this.realContainer.style={width:"100%",height:Kn.viewSize.height,borderRadius:8,overflow:"hidden"},this.appendChild(this.realContainer);const i=1==S(this.vm.adInfo);if(t.width>t.height&&this.vm.isVerticalMaterial()||this.vm.isRotateAndSlideStyle()){this.blurBg=new TKBlurImage,this.blurBg.style={width:Kn.viewSize.width,height:Kn.viewSize.height,resize:"cover",position:"absolute",borderRadius:8,left:0,top:0},this.blurBg.setBlurRadius(10);let t=b(this.vm.adInfo);Dt(t)?this.blurBg.setSrc(t):this.blurBg.setBackgroundColor("#000000FF"),this.realContainer.appendChild(this.blurBg),this.vm.addMaterilTapEventIfNeeded(this.blurBg),this.vm.isRotateAndSlideStyle()&&(this.blurMaskView=new TKView,this.blurMaskView.style={position:"absolute",top:0,left:0,width:Kn.viewSize.width,height:Kn.viewSize.height,backgroundColor:"#0000004D",borderRadius:8},this.realContainer.appendChild(this.blurMaskView))}let n=this.vm.isVerticalMaterial();const s=!this.vm.isVertical()&&this.vm.isVerticalMaterial(),a=Math.abs(Kn.viewSize.width-e.width)<.5,o=Math.abs(Kn.viewSize.height-e.height)<.5,l=a?8:0,h=a&&o?8:0,r=this.vm.isRotateAndSlideStyle()?(Kn.viewSize.height-e.height)/2:0;this.contentImage=new TKImage,this.contentImage.style={position:"absolute",width:e.width,height:e.height,topLeftRadius:l,topRightRadius:l,bottomLeftRadius:h,bottomRightRadius:h,top:r,left:(Kn.viewSize.width-e.width)/2},this.realContainer.appendChild(this.contentImage),this.vm.addMaterilTapEventIfNeeded(this.contentImage),this.newStyleCardSize={width:Kn.viewSize.width,height:Kn.viewSize.height};let d=this.newStyleCardSize.width;if(this.newStyleMaterialSize={width:d,height:Kn.viewSize.height},i){this.playerView=new TKVideoPlayer,this.playerView.style={topLeftRadius:l,topRightRadius:l,bottomLeftRadius:h,bottomRightRadius:h,position:"absolute",width:e.width,height:e.height,top:r,left:(Kn.viewSize.width-e.width)/2},this.playerView.setURL(A(this.vm.adInfo)),this.playerView.setVideoGravity(2),Ut.isAndroid()&&this.playerView.prepareToPlay(),this.realContainer.appendChild(this.playerView),this.vm.callerContext.hasVideoPlayer=!0;const t=this;ze(this.vm.$attrsPath.callerContext.controlVideoPlayerStatus,(e=>{switch(e){case"play":t.playerView.play();break;case"stop":t.playerView.stop();break;case"resume":t.playerView.resume();break;case"pause":t.playerView.pause()}}));const i=28,n=12;this.soundBtn=new Ki("image/ksad-interstitial-card/ic_sound_on.png","image/ksad-interstitial-card/ic_sound_off.png",{width:i,height:i}),this.soundBtn.style={top:n,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.soundBtn.style={right:n}:this.soundBtn.style={left:n},this.playBtn=new Ri,this.playBtn.setImageSrcAndSize("image/ksad-interstitial-card/ic_play.png",{width:44,height:44}),this.playBtn.style={position:"absolute",top:e.height/2-22,left:(Kn.viewSize.width-e.width)/2+e.width/2-22,visibility:"hidden"},this.playBtn.addEventListener("tap",(t=>{this.playerView&&this.playerView.play(),this.livePlayView&&this.livePlayView.resume(),this.vm.materialViewModel.videoHasPlayed=!0,this.vm.materialViewModel.videoEnableAutoPlay=!0,this.realContainer.removeChild(this.playBtn)})),this.contentImage.setSrc(b(this.vm.adInfo)),this.playerView&&this.vm.addMaterilTapEventIfNeeded(this.playerView),this.livePlayView&&this.vm.addMaterilTapEventIfNeeded(this.livePlayView)}else if(this.vm.callerContext.isLiveAd()&&Ut.supportMinimumTKVersion("5.0.0")){this.livePlayView=new TKLivePlayer,this.livePlayView.style={topLeftRadius:s?0:8,topRightRadius:s?0:8,bottomLeftRadius:n?8:0,bottomRightRadius:n?8:0,position:"absolute",width:e.width,height:e.height,top:0,left:(Kn.viewSize.width-e.width)/2},kn.wrapInitLivePlayer(this.livePlayView,this.vm.deviceInfo.appId,this.vm.adInfo),this.realContainer.appendChild(this.livePlayView),this.vm.callerContext.hasLivePlayer=!0;const t=this;ze(this.vm.$attrsPath.callerContext.controlLivePlayerStatus,(e=>{switch(e){case"resume":t.livePlayView.resume();break;case"pause":t.livePlayView.pause()}}));const i=28,a=12;this.soundBtn=new Ki("image/ksad-interstitial-card/ic_sound_on.png","image/ksad-interstitial-card/ic_sound_off.png",{width:i,height:i}),this.soundBtn.style={top:a,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.soundBtn.style={right:a}:this.soundBtn.style={left:a},this.playBtn=new Ri,this.playBtn.setImageSrcAndSize("image/ksad-interstitial-card/ic_play.png",{width:44,height:44}),this.playBtn.style={position:"absolute",top:e.height/2-22,left:(Kn.viewSize.width-e.width)/2+e.width/2-22,visibility:"hidden"},this.playBtn.addEventListener("tap",(t=>{this.playerView&&this.playerView.play(),this.livePlayView&&this.livePlayView.resume(),this.vm.materialViewModel.videoHasPlayed=!0,this.vm.materialViewModel.videoEnableAutoPlay=!0,this.realContainer.removeChild(this.playBtn)}));let o=b(this.vm.adInfo);Dt(o)?this.contentImage.setSrc(o):this.contentImage.setBackgroundColor("#000000FF"),this.playerView&&this.vm.addMaterilTapEventIfNeeded(this.playerView),this.livePlayView&&this.vm.addMaterilTapEventIfNeeded(this.livePlayView)}else this.contentImage.setSrc(A(this.vm.adInfo));if(this.contentImage.setImageLoadCallback((t=>{this.vm.callerContext.contentLoadState=t?1:2,this.vm.callerContext.notifyUIErrorReport()})),this.vm.callerContext.isLiveAd()&&(this.liveEndView=new yn(this.vm),this.liveEndView.style={width:"100%",height:"100%",visibility:"hidden"},this.liveEndView.enabled=!1,this.realContainer.appendChild(this.liveEndView)),this.vm.isRotateAndSlideStyle()){let t=new TKImage;this.vm.isVertical()?Ht(t,"combine_ver_blur_container.png"):Ht(t,"combine_hor_blur_contianer.png"),t.style={width:Kn.viewSize.width,height:Kn.viewSize.height,bottom:0,bottomLeftRadius:8,bottomRightRadius:8,position:"absolute"},this.realContainer.appendChild(t),this.combineInteractionView=new Mi(this.vm.getSlideConvertDistance(),((t,e,i,n)=>{const s=i-t,a=n-e;Math.abs(s)>=Math.abs(a)?s>0?this.vm.handleSlideConvert(t,e,3,s):this.vm.handleSlideConvert(t,e,2,s):a>0?this.vm.handleSlideConvert(t,e,4,a):this.vm.handleSlideConvert(t,e,1,a)}),((t,e)=>{this.vm.enableFullScreenClick()&&this.vm.convert(2,{x:t,y:e},ae.CARD_OTHERAREA_CLICK)})),this.combineInteractionView.style={width:"100%",height:"100%",bottom:0},this.realContainer.appendChild(this.combineInteractionView)}(this.vm.callerContext.isLiveAd()||i)&&(this.realContainer.appendChild(this.soundBtn),this.realContainer.appendChild(this.playBtn));if(this.closeActionView=new on(this.vm.closeActionViewModel,!1),this.closeActionView.style={top:12,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.closeActionView.style={left:12}:this.closeActionView.style={right:12},this.realContainer.appendChild(this.closeActionView),this.logoView=new ai(this.vm.getLogoStyle(),this.vm.adInfo),this.logoView.style={position:"absolute",left:this.vm.isLiveShopStyle()&&!this.vm.isVertical()?0:8,bottom:(this.vm.isLiveShopStyle()&&!this.vm.isVertical()?0:6)+Fn,visibility:this.vm.isLiveShopStyle()&&this.vm.isVertical()?"hidden":"visible"},this.logoView.enabled=!1,this.realContainer.appendChild(this.logoView),(this.vm.isAdForLive()&&this.vm.isAddLiveButton()&&Ut.isAndroid()||this.vm.isLiveBaseStyle())&&!this.vm.isRotateAndSlideStyle()&&(this.liveButton=new Ei(this.vm.liveButtonViewModel),this.liveButton.style={bottom:this.vm.isVertical()?Fn+77:Fn+32,alignSelf:"center"},this.realContainer.appendChild(this.liveButton),this.liveButton.clickCallback=t=>{const e=Et(t,this.liveButton);this.vm.convert(1,e,ae.LIVE_BUTTON_CLICK)}),this.vm.isLiveShopStyle()&&Ut.supportMinimumTKVersion("5.0.0")){let t=this.vm.isVertical()?8:14;this.liveMessageView=new TkLiveMessage,this.liveMessageView.style={position:"absolute",height:144,width:Kn.viewSize.width-140,bottom:Fn+t-4,left:8},this.realContainer.appendChild(this.liveMessageView),this.liveProductView=new Vn(this.vm),this.liveProductView.style={bottom:Fn+t,right:8},this.realContainer.appendChild(this.liveProductView),this.liveMessageViewLayout=new TKView,this.liveMessageViewLayout.style={position:"absolute",height:144,width:Kn.viewSize.width-140,bottom:Fn+t-4,left:8,backgroundColor:"#00000000"},this.liveMessageViewLayout.addEventListener("tap",(t=>{this.vm.convert(2,Et(t,this.liveMessageViewLayout),ae.ACTIONBAR_ICON_COMMENT_CLICK)})),this.realContainer.appendChild(this.liveMessageViewLayout)}if(this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText())if(this.vm.isVertical()&&this.vm.isVerticalMaterial()||this.vm.isLiveShopStyle()){let t=new vn(this.vm.fullScreenClickTextViewModel,32);t.style={bottom:0},this.appendChild(t)}else{let t=new vn(this.vm.fullScreenClickTextViewModel,2);t.style={right:0,bottom:Fn},this.realContainer.appendChild(t)}const c=this.vm.bottombarViewModel.getCouponModel();if(0!=c.cardStyle&&this.vm.isVerticalMaterial()&&this.vm.isVertical()&&(this.canShowCouponView=!0),B(this.vm.adInfo)?this.vm.enableShowOrderAdNewStyle()?this.actionBar=new mn(this.vm.actionBarViewModel):this.actionBar=new rn(this.vm.actionBarViewModel):this.actionBar=new an(this.vm.actionBarViewModel),this.actionBar.style={height:Fn,paddingLeft:10,paddingRight:10,bottomLeftRadius:8,bottomRightRadius:8,position:"absolute",left:0,bottom:0,right:0},this.canShowCouponView){1==c.cardStyle?(this.couponView=new Zi(this.vm.bottombarViewModel),this.couponCardStyle="coupon_of_cash_equity"):(this.couponView=new tn(this.vm.bottombarViewModel),this.couponCardStyle="coupon_of_no_cash_equity");const t=new TKView,e={position:"absolute",bottom:0,overflow:"hidden"};e.width=Kn.viewSize.width;let i=Kn.viewSize.height*Mn;1==c.cardStyle&&(i=.96*Kn.viewSize.width/4.25+27),e.height=i,t.style=e,t.clipChildren=!0,this.realContainer.appendChild(t),t.appendChild(this.couponView)}if(this.vm.isRotateAndSlideStyle()){Yi.reportRotateSensorStatus(this.vm.adStyle),this.combineActionBar=new ln(this.vm);let t=new TKView,e=15,i=G(this.vm.adInfo,this.vm.buildAutocallViewModel().styleType);!this.vm.callerContext.enableShowAutoCall||!this.vm.isVertical()||this.vm.isLiveShopStyle()&&!this.vm.isVertical()||this.vm.callerContext.isLiveAd()&&!this.vm.isVertical()||this.vm.callerContext.isLiveAd()||1==i.cardStyle||0==i.cardStyle||(e+=6+Fn+14+47),t.style={position:"absolute",bottom:e,width:"100%",height:"100%"},t.throughHitTest=!0,t.appendChild(this.combineActionBar),this.realContainer.appendChild(t),this.combineContentView=new hn(this.vm);let n=new TKView,s=0;s=this.vm.isVertical()?178.2:130,!this.vm.callerContext.enableShowAutoCall||!this.vm.isVertical()||this.vm.isLiveShopStyle()&&!this.vm.isVertical()||this.vm.callerContext.isLiveAd()&&!this.vm.isVertical()||this.vm.callerContext.isLiveAd()||1==i.cardStyle||0==i.cardStyle||(s+=6+Fn+14+47),n.style={position:"absolute",bottom:s,width:"100%",top:"5%"},n.throughHitTest=!0,n.appendChild(this.combineContentView),this.realContainer.appendChild(n)}this.vm.isRotateAndSlideStyle()||this.realContainer.appendChild(this.actionBar),!this.vm.callerContext.enableShowAutoCall||this.vm.isLiveShopStyle()&&!this.vm.isVertical()||this.setupAutoCallView(),Bn.shareHelper(this.vm).appendDynamicEffectMaskViewIfNeeded(this.realContainer,!1)}showCouponView(){if(!this.canShowCouponView)return;const t=this.vm.bottombarViewModel.getCouponModel();He(this.vm,this.vm.$attrsPath.lifeStatus,(e=>{"showStart"===e&&(setTimeout((()=>{let t=new TKBasicAnimation;t.setEndValue((()=>{this.actionBar.style={height:_t()?Fn-8:Fn,transform:{translate:{y:_t()?0:8}},opacity:0},this.logoView.style={transform:{translate:{y:8}},opacity:0}})),t.duration=350,t.timingFunction="ease-in-out",this.actionBar.addAnimation(t,"zoomOutAnimation"),t.on("end",(t=>{this.reportCouponCardImpression(),this.actionBar.setVisibility("hidden")}))}),1e3*t.delayTime),setTimeout((()=>{let e=Kn.viewSize.height*Mn;1==t.cardStyle&&(e=.96*Kn.viewSize.width/4.25+27);let i=new TKBasicAnimation;i.setEndValue((()=>{this.couponView.style={height:e,transform:{translate:{y:-8}},opacity:1}})),i.duration=500,i.timingFunction="ease-in-out",this.couponView.addAnimation(i,"zoomInAnimation")}),1e3*t.delayTime+150))}))}setupAutoCallView(){this.autocallView=new _i(this.vm.buildAutocallViewModel()),this.autocallView.style={bottom:6+Fn+14,position:"absolute"},this.vm.callerContext.isLiveAd()&&!this.vm.isVertical()&&(this.autocallView.style={top:48}),this.realContainer.appendChild(this.autocallView),this.autocallView.dismissCallback=()=>{this.realContainer.removeChild(this.autocallView),this.autocallView=null},ze(this.vm.$attrsPath.callerContext.autocallHasConverted,(t=>{this.autocallView&&t&&this.autocallView.setConverted(t)}))}showEndCard(){this.showEndCardCallback&&this.showEndCardCallback(),this.soundBtn.setVisibility("hidden"),this.liveButton&&this.liveButton.setVisibility("hidden"),this.playerView&&this.playerView.setVisibility("hidden"),this.livePlayView&&this.livePlayView.setVisibility("hidden")}showLiveEndView(){this.liveEndView.enabled||(this.liveEndView.enabled=!0,this.liveEndView.style={visibility:"visible"},this.liveEndView.showDataDetailViewIfNeeded(),this.liveButton&&this.liveButton.setVisibility("hidden"),this.liveProductView&&this.liveProductView.hideLiveProductView(),this.liveMessageView&&Ut.supportMinimumTKVersion("5.0.0")&&(this.liveMessageView.style={visibility:"hidden"}))}reportCouponCardImpression(){let t=new r;t.template_show_type=this.couponCardStyle;let e={elementType:16,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}}class On extends _i{setupViews(){this.style={right:0,top:0,height:"100%",width:"100%",flexDirection:"row-reverse",alignItems:"center",position:"absolute",visibility:"hidden",borderRadius:.5*this.progressViewSize.height},Ut.supportMinimumTKVersion("5.0.0")&&(this.progressView=new ci({width:this.progressViewSize.width,height:this.progressViewSize.height,borderRadius:.5*this.progressViewSize.height}),this.appendChild(this.progressView)),this.closeBtn=new TKButton,this.closeBtn.style={marginRight:20,width:30,height:20,fontSize:14,textAlign:"center",opacity:.8,fontWeight:"400",backgroundColor:"#FFFFFF00",color:this.color},this.closeBtn.setText("取消"),this.appendChild(this.closeBtn),this.splitView=new TKView,this.splitView.style={marginRight:12,width:1,height:14,backgroundColor:this.color},this.appendChild(this.splitView),this.textContainer=new TKView,this.textContainer.style={left:10,right:72,height:"100%",alignItems:"center",justifyContent:"center",position:"absolute"},this.appendChild(this.textContainer),this.titleLabel=new TKText,this.titleLabel.style={width:"90%",color:this.color,fontWeight:"bold",textLineClamp:1,textAlign:"right",textOverflow:"ellipsis"};const t=String(X(this.vm.styleDataInfo))+this.getTitle()+this.getAdTitle();this.titleLabel.setText(t),this.textContainer.appendChild(this.titleLabel)}addTranslateAction(){let t=new TKBasicAnimation;t.duration=300,t.setStartValue((()=>{this.style={opacity:0,visibility:"hidden"}})),t.setEndValue((()=>{this.style={opacity:1,visibility:"visible"}})),t.on("start",(()=>{this.animateFinishCallback&&(this.animateFinishCallback(),this.animateFinishCallback=null)})),this.addAnimation(t,"translate")}isShowHalfPlay(){return!0}setTextColor(t){this.titleLabel.style={color:t},this.closeBtn.style={color:t},this.splitView.style={backgroundColor:t}}setProgressColor(t){this.progressView&&this.progressView.setProgressColor(t)}setFontSize(t){this.titleLabel.style={fontSize:t}}fitAutoCallViewHorizontal(){this.closeBtn.style={marginRight:8,width:26,fontSize:8},this.splitView.style={marginRight:3,width:1,height:8,backgroundColor:this.color},this.textContainer.style={left:4,right:40,height:"100%",alignItems:"center",justifyContent:"center",position:"absolute"}}}class Nn extends TKView{constructor(t,e){super(),this.setupView(t,e)}setupView(t,e){this.style={width:24,height:24},Ut.supportMinimumTKVersion("5.0.0")&&(this.progressLottieView=new TKLottieImageView,this.progressLottieView.style={width:30,height:9.5,position:"absolute",top:1,left:-3},this.appendChild(this.progressLottieView),this.progressLottieView.setUri(t),this.rotateLottieView=new TKLottieImageView,this.rotateLottieView.style={width:20,height:20,left:2,top:4,position:"absolute"},this.appendChild(this.rotateLottieView),this.rotateLottieView.setUri(e),this.rotateLottieView.setLoop(!0))}startRotate(){Ut.supportMinimumTKVersion("5.0.0")&&this.rotateLottieView.play()}stopRotate(){Ut.supportMinimumTKVersion("5.0.0")&&this.rotateLottieView.stop()}updateProgress(t){t=Math.max(0,Math.min(t,1)),Ut.supportMinimumTKVersion("5.0.0")&&this.progressLottieView.setProgress(t)}}var zn;!function(t){t[t.specialShapeStyle=0]="specialShapeStyle",t[t.redPacketStyle=1]="redPacketStyle",t[t.giftStyle=2]="giftStyle"}(zn||(zn={}));class Hn extends TKView{constructor(t,e,i){super(),this.vm=t,this.size=e,this.type=i,this.setupView(),this.setupData(),this.setupAction(),ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"pageVisiable":this.startInteractAnimation();break;case"pageInvisiable":this.stopInteractAnimation()}})),this.vm.callerContext.sensorUpdateCallback=(t,e,i)=>{var n,s,a,o,l;let h=null===(l=null===(o=null===(a=null===(s=null===(n=this.vm.callerContext.adInfo)||void 0===n?void 0:n.adMatrixInfo)||void 0===s?void 0:s.adDataV2)||void 0===a?void 0:a.interstitialCardInfo)||void 0===o?void 0:o.interactionInfo)||void 0===l?void 0:l.rotateInfo;if(!h)return;let r=Math.abs(t)/(h.x.rotateDegree||Number.MAX_VALUE),d=Math.abs(e)/(h.y.rotateDegree||Number.MAX_VALUE),c=Math.abs(i)/(h.z.rotateDegree||Number.MAX_VALUE),p=Math.max(r,d,c),m=p>1?1:p<0?0:p;this.updateRotateValue(m)}}setupView(){this.style={width:this.size.width,height:this.size.height,justifyContent:"center",alignItems:"center",borderRadius:.5*this.size.height},this.type==zn.specialShapeStyle?(this.actionButtonImageView=new TKImage,this.actionButtonImageView.style={position:"absolute",width:"100%",height:"100%",borderRadius:.5*this.size.height},this.appendChild(this.actionButtonImageView)):this.type==zn.redPacketStyle?this.style={backgroundColor:"#FFDFB8"}:this.type==zn.giftStyle&&(this.style={backgroundColor:"#141E52"}),this.contentView=new TKView,this.contentView.style={position:"absolute",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},this.appendChild(this.contentView),this.textColor=this.type==zn.redPacketStyle?"#8C381E":"#FFFFFF",this.vm.callerContext.enableShakeInteraction()||this.vm.callerContext.isRotateAndSlideStyle()?this.appendInteractView():(this.normalTitleLabel=new TKText,this.normalTitleLabel.style={padding:8,fontSize:16,color:this.textColor,textAlign:"center",fontWeight:"bold"},this.contentView.appendChild(this.normalTitleLabel)),this.vm.callerContext.enableShowAutoCall&&this.setupAutoCallView(this.size)}appendInteractView(){if(this.interactContainerView=new TKView,this.interactContainerView.style={marginTop:-4,height:this.type==zn.specialShapeStyle?32:30,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.contentView.appendChild(this.interactContainerView),this.interactAnimationView=new TKView,this.interactAnimationView.style={top:this.type==zn.specialShapeStyle?4:3,left:0,width:48,height:48,position:"absolute"},this.interactAnimationView.enabled=!1,this.interactContainerView.appendChild(this.interactAnimationView),this.vm.callerContext.isRotateAndSlideStyle()){const t=this.type==zn.redPacketStyle?"bundle://image/ksad-interstitial-card/rotate_arrow_brown.json":"bundle://image/ksad-interstitial-card/rotate_arrow.json",e=this.type==zn.redPacketStyle?"bundle://image/ksad-interstitial-card/rotate_icon_brown.json":"bundle://image/ksad-interstitial-card/rotate_icon.json";this.rotateView=new Nn(t,e),this.rotateView.style={width:24,height:24},this.interactAnimationView.appendChild(this.rotateView)}else this.shakeImageView=new TKImage,this.shakeImageView.style={width:24,height:24},this.interactAnimationView.appendChild(this.shakeImageView);this.interactTitleLabel=new TKText,this.interactTitleLabel.style={marginLeft:28,fontSize:16,fontWeight:"bold",color:this.textColor,textAlign:"center"},this.interactContainerView.appendChild(this.interactTitleLabel),this.interactSubtitleLabel=new TKText,this.interactSubtitleLabel.style={fontSize:10,color:this.textColor,textAlign:"center"},this.contentView.appendChild(this.interactSubtitleLabel)}setupAutoCallView(t){const e=this;this.autoCallView=new On(this.vm.autoCallViewModel,"#FFFFFF",{width:t.width,height:t.height}),this.type==zn.redPacketStyle&&(this.autoCallView.setTextColor(this.textColor),this.autoCallView.setProgressColor("#FF8C0040")),(this.type==zn.redPacketStyle||zn.giftStyle)&&this.autoCallView.setFontSize(16);let i=new r;i.interstitial_style=this.vm.callerContext.getInterstitialStyleNew(),this.autoCallView.setExternalClientExtData(i),this.appendChild(this.autoCallView),this.autoCallView.animateFinishCallback=()=>{e.autoCallView.addEventListener("tap",(t=>{this.vm.callerContext.clickAd(1,Et(t,e.autoCallView),1,ae.CARD_ACTION_BAR_CLICK)})),e.contentView.style={visibility:"hidden"}},this.autoCallView.dismissCallback=()=>{e.autoCallView&&e.removeChild(e.autoCallView),e.contentView.style={visibility:"visible"}},ze(this.vm.$attrsPath.callerContext.autocallHasConverted,(t=>{e.autoCallView&&t&&e.autoCallView.setConverted(t)})),fe().on(ce,(t=>{this.autoCallView&&this.autoCallView.handlePlayFinished()})),fe().on(pe,(t=>{this.autoCallView&&this.autoCallView.handlePlayTime(1e3*t.currentTime)})),fe().on(de,(t=>{this.autoCallView&&this.autoCallView.handlePlayFailed()}))}setupData(){if(this.normalTitleLabel&&(this.vm.callerContext.isGiftStyle()?(this.normalTitleLabel.style={fontSize:this.vm.callerContext.isVertical()?18:17},L(this.vm.callerContext.adInfo)?Ne(this.normalTitleLabel,"text",this.vm.$attrsPath.callerContext.downloadText):this.normalTitleLabel.setText("立即领取")):Ne(this.normalTitleLabel,"text",this.vm.$attrsPath.callerContext.downloadText)),this.vm.callerContext.isRotateAndSlideStyle())this.interactTitleLabel&&this.interactTitleLabel.setText(this.vm.callerContext.getCombineStyleRotateTitle()),this.interactSubtitleLabel&&Ne(this.interactSubtitleLabel,"text",this.vm.$attrsPath.callerContext.combineDownloadText);else{if(this.shakeImageView){const t=this.type==zn.redPacketStyle?"image/ksad-interstitial-card/ic_shake_red.png":"image/ksad-interstitial-card/ic_shake.png";this.shakeImageView.setSrc(t)}this.interactTitleLabel&&this.interactTitleLabel.setText(this.vm.callerContext.templateDataInfo.shakeInfo.subtitle),this.interactSubtitleLabel&&(1==this.vm.callerContext.adInfo.adBaseInfo.adOperationType?Ne(this.interactSubtitleLabel,"text",this.vm.$attrsPath.callerContext.downloadText):this.vm.callerContext.isGiftStyle()?this.interactSubtitleLabel.setText("立即领取"):this.interactSubtitleLabel.setText(this.vm.callerContext.templateDataInfo.shakeInfo.subtitle))}}setActionButtonImageUrl(t){this.actionButtonImageView&&(Ft(t)?this.actionButtonImageView.style={backgroundColor:"#FE3666"}:this.actionButtonImageView.setSrc(t))}setupAction(){const t=this;let e=ae.CARD_ACTION_BAR_CLICK;this.vm.callerContext.enableShakeInteraction()&&(e=ae.SHAKE_BIG_ICON_CLICK),this.addEventListener("tap",(i=>{const n=Et(i,t);this.vm.callerContext.clickAd(1,n,1,e)}))}updateRotateValue(t){this.rotateView&&this.rotateView.updateProgress(t)}startInteractAnimation(){this.vm.callerContext.isRotateAndSlideStyle()?this.startRotateAnimation():this.startShakeAnimation()}stopInteractAnimation(){this.vm.callerContext.isRotateAndSlideStyle()?this.stopRotateAnimation():this.stopShakeAnimation()}startRotateAnimation(){this.vm.callerContext.isRotateAndSlideStyle()&&this.rotateView&&this.rotateView.startRotate()}stopRotateAnimation(){this.vm.callerContext.isRotateAndSlideStyle()&&this.rotateView&&this.rotateView.stopRotate()}startShakeAnimation(){this.stopShakeAnimation(),this.addShakeAnimation(),this.shakeAnimationTimer=setInterval((()=>{this.addShakeAnimation()}),1200)}stopShakeAnimation(){this.shakeAnimationTimer&&clearInterval(this.shakeAnimationTimer),this.interactAnimationView&&this.interactAnimationView.removeAllAnimation()}addShakeAnimation(){let t=new TKKeyframeAnimation;t.animType="rotationZ";let e=Ut.isAndroid()?.8:1;t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}];t.duration=1200,this.interactAnimationView&&this.interactAnimationView.addAnimation(t,"addShakeRotate")}handlePlayTime(t){this.autoCallView&&this.autoCallView.handlePlayTime(t)}}class Wn extends TKView{constructor(t,e){super(),this.upMoveAnimTimer=0,this.downMoveAnimTimer=0,this.vm=t,this.isVertical=this.vm.isVertical(),this.containerSize=e,this.setupView(),this.setupData(),this.startTopTagViewgMoveAnimation(),this.startDownTagViewMoveAnimation(),He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{"hideEnd"===t&&(this.upMoveAnimTimer&&clearInterval(this.upMoveAnimTimer),this.downMoveAnimTimer&&clearInterval(this.downMoveAnimTimer))}))}setupView(){this.style={width:"100%",height:"100%"},this.bgImageView=new TKImage,this.bgImageView.style={width:this.containerSize.width,height:this.containerSize.height,borderRadius:24},this.appendChild(this.bgImageView),this.contentView=new TKView,this.contentView.style={position:"absolute",width:this.containerSize.width,height:this.containerSize.height,flexDirection:"column",alignItems:"center",borderRadius:24},this.appendChild(this.contentView),this.setUpTagView(),this.commonTitle=new TKText,this.commonTitle.style={fontSize:this.vm.isVertical()?24:Ut.isAndroid()?16:20,color:"#FC692C",fontWeight:"600",marginTop:this.vm.isVertical()?14:Ut.isAndroid()?6:7.5},this.contentView.appendChild(this.commonTitle),this.setUpGiftContentView(),this.giftDesc=new TKText,this.giftDesc.style={marginTop:this.vm.isGiftImgType()?this.vm.isVertical()?94:Ut.isAndroid()?60:75:this.vm.isVertical()?100:Ut.isAndroid()?62:77.5,textLineHeight:20,textAlign:"center",maxWidth:215,color:"#141E53",fontSize:this.vm.isVertical()?14:Ut.isAndroid()?9:11.25},this.contentView.appendChild(this.giftDesc)}setUpTagView(){let t=new TKView;t.style={width:this.vm.isVertical()?180:Ut.isAndroid()?110:137.5,height:this.vm.isVertical()?27:Ut.isAndroid()?18:22.5,alignItems:"center"},this.upTagText=new TKText,this.upTagText.style={position:"absolute",top:0,color:"#B66F59",fontSize:this.vm.isVertical()?12:Ut.isAndroid()?8:10,fontWeight:"500",includeFontPadding:!1,textAlign:"center",height:this.vm.isVertical()?27:Ut.isAndroid()?18:22.5,width:this.vm.isVertical()?180:Ut.isAndroid()?110:137.5,textLineClamp:1,textOverflow:"ellipsis"},t.appendChild(this.upTagText),this.downTagText=new TKText,this.downTagText.style={color:"#B66F59",fontSize:this.vm.isVertical()?12:Ut.isAndroid()?8:10,position:"absolute",top:27,includeFontPadding:!1,fontWeight:"500",textAlign:"center",height:this.vm.isVertical()?27:Ut.isAndroid()?18:22.5,width:this.vm.isVertical()?180:Ut.isAndroid()?110:137.5,textLineClamp:1,textOverflow:"ellipsis"},t.appendChild(this.downTagText),this.contentView.appendChild(t)}setUpGiftContentView(){if(this.vm.isGiftImgType())this.giftImage=new TKImage,this.giftImage.style={marginTop:this.vm.isVertical()?11:Ut.isAndroid()?4:5,width:this.vm.isVertical()?140:Ut.isAndroid()?100:125,height:this.vm.isVertical()?140:Ut.isAndroid()?100:125},this.contentView.appendChild(this.giftImage);else{let t=new TKView;t.style={width:"100%",height:this.vm.isVertical()?140:Ut.isAndroid()?94:117.5,marginTop:5,flexDirection:"column"},this.contentView.appendChild(t);let e=new TKView;e.style={width:"100%",height:"100%",left:0,top:0,position:"absolute",flexDirection:"column",alignItems:"center",justifyContent:"center"},t.appendChild(e),this.giftTitle=new TKText,this.giftTitle.style={color:"#FFFFFF",fontSize:this.vm.isVertical()?14:Ut.isAndroid()?9:11.25,opacity:.6,textLineClamp:1,textOverflow:"ellipsis",maxWidth:this.vm.isVertical()?240:Ut.isAndroid()?160:200},e.appendChild(this.giftTitle),this.giftContent=new TKText,this.giftContent.style={color:"#FFFFFF",fontSize:this.vm.isVertical()?20:Ut.isAndroid()?12:15,fontWeight:"700",marginTop:this.vm.isVertical()?7:Ut.isAndroid()?4:5,maxWidth:this.vm.isVertical()?240:Ut.isAndroid()?160:200,textLineClamp:1,textOverflow:"ellipsis"},e.appendChild(this.giftContent)}}setupData(){var t,e,i;this.bgImageView.setSrc(this.vm.isGiftImgType()?"image/ksad-interstitial-card/gift_bg_for_img.webp":"image/ksad-interstitial-card/gift_bg_for_text.webp"),this.upTagText.setText(this.getGiftOtherByIndex(0)),this.downTagText.setText(this.getGiftOtherByIndex(1)),this.commonTitle.setText("恭喜获得"),null===(t=this.giftImage)||void 0===t||t.setSrc(this.vm.getGiftContent()),this.giftDesc.setText(this.vm.getGiftDesc()),null===(e=this.giftTitle)||void 0===e||e.setText(this.vm.getGiftTitle()),null===(i=this.giftContent)||void 0===i||i.setText(this.vm.getGiftContent())}getGiftOtherByIndex(t){let e=this.vm.getGiftOtherGiftInfo();return(null==e?void 0:e.length)>0?((null==e?void 0:e.length)<=t&&(t%=null==e?void 0:e.length),e[t]):""}startTopTagViewgMoveAnimation(){var t;if((null===(t=this.vm.getGiftOtherGiftInfo())||void 0===t?void 0:t.length)<=1)return;this.animRunCount=0,this.isShowCurrentView=this.animRunCount%2==0;let e=this;this.downMoveAnimTimer=setInterval((()=>{let t=new TKKeyframeAnimation;t.duration=500,t.timingFunction="linear",t.setAnimations([()=>(e.upTagText.style={top:e.isShowCurrentView?0:e.vm.isVertical()?27:Ut.isAndroid()?18:22.5},0),()=>(e.upTagText.style={top:e.isShowCurrentView?e.vm.isVertical()?-27:Ut.isAndroid()?-18:-22.5:0},1)]),t.on("end",(()=>{e.upTagText.style={top:e.isShowCurrentView?e.vm.isVertical()?27:Ut.isAndroid()?18:22.5:0}})),e.upTagText.addAnimation(t,"tagTextTranslateAnimation")}),2e3)}startDownTagViewMoveAnimation(){var t;if((null===(t=this.vm.getGiftOtherGiftInfo())||void 0===t?void 0:t.length)<=1)return;this.animRunCount=0;let e=this;this.upMoveAnimTimer=setInterval((()=>{let t=new TKKeyframeAnimation;t.duration=500,t.timingFunction="linear",t.setAnimations([()=>(e.downTagText.style={top:e.isShowCurrentView?e.vm.isVertical()?27:Ut.isAndroid()?20:25:0},0),()=>(e.downTagText.style={top:e.isShowCurrentView?0:e.vm.isVertical()?-27:Ut.isAndroid()?-20:-25},1)]),t.on("end",(()=>{e.downTagText.style={top:e.isShowCurrentView?0:27},e.handleAnimEnd()})),e.downTagText.addAnimation(t,"tagDownTextTranslateAnimation")}),2e3)}handleAnimEnd(){let t=this;setTimeout((()=>{t.animRunCount++,t.isShowCurrentView=t.animRunCount%2==0,t.isShowCurrentView&&t.downTagText.setText(t.getGiftOtherByIndex(t.animRunCount+1)),t.isShowCurrentView||t.upTagText.setText(t.getGiftOtherByIndex(t.animRunCount+1))}),500)}}class Un extends TKView{constructor(t){super(),this.vm=t,this.fakePlayDuration=0,this.initViewSize(),this.setupView(),this.setupAction(),this.setupCallback();const e=this;He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{"showStart"===t&&e.showStart(),"pageVisiable"===t&&e.startFakePlayerTimerIfNeeded(),"pageInvisiable"===t&&e.stopFakePlayerTimerIfNeeded()}))}initViewSize(){if(this.containerViewSize={width:0,height:0},this.vm.isECCardStyle())this.vm.isVertical()?this.containerViewSize={width:273,height:342}:this.containerViewSize={width:181,height:228};else if(this.vm.callerContext.isRedPacketStyle()){let t=334;const e=549/t;this.vm.isVertical()?(this.containerViewSize.width=t,this.containerViewSize.height=this.containerViewSize.width*e):(t=Ut.isAndroid()?314:380,this.containerViewSize.height=t,this.containerViewSize.width=this.containerViewSize.height/e)}else{const t=295,e=370/t;this.vm.isVertical()?(this.containerViewSize.width=t,this.containerViewSize.height=this.containerViewSize.width*e):(this.containerViewSize.height=Ut.isAndroid()?240:300,this.containerViewSize.width=this.containerViewSize.height/e)}let t=1;this.vm.callerContext.isRedPacketStyle()&&(t=this.vm.isVertical()?82:Ut.isAndroid()?51:56),this.closeActionViewBottom=t}setupView(){let t=72;if(this.vm.isECCardStyle()?!this.vm.isVertical()&&Ut.isAndroid()&&(t=70):this.vm.callerContext.isRedPacketStyle()?!this.vm.isVertical()&&Ut.isAndroid()&&(t=68):!this.vm.isVertical()&&Ut.isAndroid()&&(t=63),!this.vm.isVertical()&&this.vm.callerContext.isRotateAndSlideStyle()&&(t+=3),this.bottomSpaceHeight=t,this.style={alignItems:"center",flexDirection:"column",width:this.containerViewSize.width,height:this.containerViewSize.height+t},this.rootSize={width:this.containerViewSize.width,height:this.containerViewSize.height+t},this.setupContainerView(),this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()){let t=new vn(this.vm.fullScreenClickTextViewModel,30),e=40;this.vm.callerContext.isRedPacketStyle()&&(e=this.vm.isVertical()?125:Ut.isAndroid()?94:99),!this.vm.isVertical()&&this.vm.callerContext.isRotateAndSlideStyle()&&(e+=3),t.style={bottom:e},this.appendChild(t)}this.closeActionView=new on(this.vm.closeActionViewModel,!1),this.closeActionView.setBorderColor("#FFFFFFCC"),this.closeActionView.style={position:"absolute",bottom:this.closeActionViewBottom,borderRadius:14},this.appendChild(this.closeActionView)}setupContainerView(){this.containerView=new TKView,this.containerView.style={width:this.containerViewSize.width,height:this.containerViewSize.height,borderRadius:8,justifyContent:"center",flexDirection:"column",alignItems:"center"},this.appendChild(this.containerView)}setupSlideContentView(){this.combineInteractionView=new Mi(this.vm.getSlideConvertDistance(),((t,e,i,n)=>{const s=i-t,a=n-e;Math.abs(s)>=Math.abs(a)?s>0?this.vm.handleSlideConvert(t,e,3,s):this.vm.handleSlideConvert(t,e,2,s):a>0?this.vm.handleSlideConvert(t,e,4,a):this.vm.handleSlideConvert(t,e,1,a)}),((t,e)=>{this.vm.enableFullScreenClick()&&this.vm.convert(2,{x:t,y:e},ae.CARD_OTHERAREA_CLICK)}),!0),this.combineInteractionView.style={width:"100%",height:"100%",position:"absolute",top:0,left:0},this.containerView.appendChild(this.combineInteractionView)}setupAction(){const t=this;this.vm.callerContext.isGiftStyle()&&this.containerView.addEventListener("tap",(e=>{t.vm.callerContext.clickAd(1,Et(e,t.containerView),2,ae.CARD_OTHERAREA_CLICK)}))}setupCallback(){const t=this;this.vm.closeActionViewModel.skipCallback=e=>{t.showEndCardCallback&&t.showEndCardCallback(e)}}showStart(){this.startFakePlayerTimerIfNeeded()}startFakePlayerTimerIfNeeded(){if(this.fakePlayerTimer)return;if(!this.vm.isVideoMaterial()||this.fakePlayDuration>=this.vm.getVideoDuration())return;const t=this;this.fakePlayerTimer=setInterval((()=>{t.fakePlayDuration+=1,t.updateFakePlayDuration(t.fakePlayDuration),t.fakePlayDuration>=t.vm.getVideoDuration()&&t.stopFakePlayerTimerIfNeeded()}),1e3)}updateFakePlayDuration(t){this.vm.isVideoMaterial()&&(this.vm.materialViewModel.videoHasPlayed=!0,this.vm.materialViewModel.updateCountDownByPlayer(t,this.vm.getVideoDuration()))}stopFakePlayerTimerIfNeeded(){this.fakePlayerTimer&&(clearInterval(this.fakePlayerTimer),this.fakePlayerTimer=null)}}class Gn extends Un{setupContainerView(){super.setupContainerView(),this.containerView.style={backgroundColor:"#FFFFFF",borderRadius:24},this.actionBarSize={width:215,height:48},this.actionBarBottom=58,this.setUpGiftContentView(),this.setupSlideContainer(),this.setupActionBar(),this.setupSlideView()}setUpGiftContentView(){this.giftContentView=new Wn(this.vm,this.containerViewSize),this.containerView.appendChild(this.giftContentView)}setupSlideContainer(){this.vm.callerContext.isRotateAndSlideStyle()&&(this.slideContainerView=new TKView,this.slideContainerView.style={width:"100%",height:"100%",position:"absolute",left:0,top:0},this.containerView.appendChild(this.slideContainerView),this.slideContainerView.addEventListener("swipe",(t=>{this.vm.handleSlideConvert(0,0,Gt(t),0)})),this.slideContainerView.addEventListener("tap",(t=>{this.vm.callerContext.clickAd(1,Et(t,this.slideContainerView),2,ae.CARD_OTHERAREA_CLICK)})))}setupActionBar(){this.actionButton=new Hn(this.vm.actionButtonViewModel,this.actionBarSize,zn.giftStyle),this.actionButton.style={bottom:this.actionBarBottom,position:"absolute"},this.containerView.appendChild(this.actionButton),this.vm.isVertical()||(this.actionButton.style={transform:{scale:{x:.7,y:.7}},bottom:Ut.isAndroid()?28:44});const t=this;ze(this.vm.$attrsPath.lifeStatus,(e=>{"showEnd"==e&&this.vm.callerContext.isRotateAndSlideStyle()&&t.vm.reportCombination2ActionBarImpression()}))}setupSlideView(){if(!this.vm.callerContext.isRotateAndSlideStyle())return;let t=0;t=this.vm.isVertical()?this.actionBarBottom+this.actionBarSize.height+this.bottomSpaceHeight+5:30,this.slideGuideView=new hn(this.vm,t),this.appendChild(this.slideGuideView)}updateFakePlayDuration(t){super.updateFakePlayDuration(t),this.actionButton.handlePlayTime(1e3*t)}}class Yn extends TKView{constructor(t,e){super(),this.vm=t,this.isOpened=e,this.isVertical=this.vm.isVertical(),this.setupView(),this.setupData(),this.setupAction()}setupView(){this.style={alignItems:"center"};const t=this.isOpened?"#8C381E":"#FAE3B7";this.informationView=new TKView,this.informationView.style={marginTop:this.isVertical?12:13,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.appendChild(this.informationView);const e=this.isVertical?20:12;this.iconImageView=new TKImage,this.iconImageView.style={width:e,height:e,borderRadius:this.isVertical?4:2.4,borderColor:"#FFFFFF",borderWidth:this.isVertical?1:.6},this.informationView.appendChild(this.iconImageView),this.titleLabel=new TKText,this.titleLabel.style={marginLeft:4,maxWidth:Ut.isAndroid()?110:120,color:t,fontSize:this.isVertical?12:7,fontWeight:"bold",textLineClamp:1,textOverflow:"ellipsis",minimumTextScaleFactor:.8},this.informationView.appendChild(this.titleLabel),this.descriptionLabel=new TKText,this.descriptionLabel.style={marginTop:this.isVertical?30:17,maxWidth:230,color:t,fontSize:this.isVertical?20:12,fontWeight:"bold",textLineClamp:1,textOverflow:"ellipsis",minimumTextScaleFactor:.8},this.appendChild(this.descriptionLabel);const i=this.isOpened?"#E85943":"#FAE3B7";this.unknownAccountLabel=new TKText,this.unknownAccountLabel.style={color:i,fontSize:this.isVertical?46:24,fontWeight:"600",marginTop:this.isVertical?45:25},this.appendChild(this.unknownAccountLabel),this.accountView=new TKView,this.accountView.style={marginLeft:this.isVertical?30:16,marginTop:this.isVertical?39:19,flexDirection:"row",alignItems:"flex-end",height:this.isVertical?67:41},this.appendChild(this.accountView),this.accountLabel=new TKText,this.accountLabel.style={color:i,fontSize:this.isVertical?56:34,fontWeight:"600",bottom:Ut.isAndroid()?8:0},this.accountView.appendChild(this.accountLabel),this.yuanLabel=new TKText,this.yuanLabel.style={marginRight:this.isVertical?35:20,marginBottom:this.isVertical||Ut.isAndroid()?12:9,color:i,fontSize:this.isVertical?18:10,fontWeight:"bold"},this.accountView.appendChild(this.yuanLabel);const n=this.isVertical?9:5,s=this.isVertical?6:3;this.tagLable=new TKText,this.tagLable.style={position:"absolute",height:this.isVertical?18:10,top:0,right:0,backgroundColor:this.isOpened?"#E8594333":"FAE3B7CC",topLeftRadius:n,topRightRadius:n,bottomRightRadius:n,paddingLeft:s,paddingRight:s,textAlign:"center",fontSize:this.isVertical?10:6,fontWeight:"bold",color:"#EB6552"},this.accountView.appendChild(this.tagLable)}setupData(){this.iconImageView.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.titleLabel.setText(K(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.descriptionLabel.setText(this.vm.getRedPacketAdDescription()),isNaN(Number(this.vm.getRedPacketMoney()))?(this.accountView.style={display:"none"},this.unknownAccountLabel.setText(this.vm.getRedPacketMoney())):(this.unknownAccountLabel.style={display:"none"},this.accountLabel.setText(this.vm.getRedPacketMoney())),this.yuanLabel.setText("元"),this.tagLable.setText("最高可得")}setupAction(){if(this.vm.enableFullScreenClick()){const t=this;this.iconImageView.addEventListener("tap",(e=>{t.vm.callerContext.clickAd(1,Et(e,t.iconImageView),2,ae.CARD_ICON_CLICK)})),this.titleLabel.addEventListener("tap",(e=>{t.vm.callerContext.clickAd(1,Et(e,t.titleLabel),2,ae.CARD_ICON_NAME_CLICK)})),this.descriptionLabel.addEventListener("tap",(e=>{t.vm.callerContext.clickAd(1,Et(e,t.descriptionLabel),2,ae.CARD_ICON_COMMENT_CLICK)}))}}}class jn extends Un{setupContainerView(){super.setupContainerView(),this.vm.isVertical()||(this.style={marginTop:Ut.isAndroid()?25:20}),this.actionBarSize={width:215,height:48},this.actionBarBottom=40,this.contentViewSize={width:0,height:0};let t=279;const e=376/279;this.vm.isVertical()?(this.contentViewSize.width=t,this.contentViewSize.height=this.contentViewSize.width*e):(t=Ut.isAndroid()?215:260,this.contentViewSize.height=t,this.contentViewSize.width=this.contentViewSize.height/e),this.setupInsideContentView(),this.setupOutsideContentView()}setupInsideContentView(){const t=this;this.insideBackgroundImageView=new TKImage,this.insideBackgroundImageView.style={position:"absolute",width:this.containerViewSize.width,height:this.containerViewSize.height},this.insideBackgroundImageView.enabled=!1,this.insideBackgroundImageView.setSrc("image/ksad-interstitial-card/img_red_packet_background.png"),this.containerView.appendChild(this.insideBackgroundImageView),this.insideView=new TKView,this.insideView.style={position:"absolute",width:this.contentViewSize.width,height:this.contentViewSize.height,alignItems:"center"},this.containerView.appendChild(this.insideView),this.insideView.addEventListener("tap",(e=>{t.vm.callerContext.clickAd(1,Et(e,t.insideView),2,ae.CARD_OTHERAREA_CLICK)})),this.insideContentView=new Yn(this.vm,!0),this.insideContentView.style={position:"absolute",width:"100%",height:"100%"},this.insideView.appendChild(this.insideContentView),this.setupSlideContainer(),this.setupActionBar(),this.setInsideViewVisibility("hidden")}setupSlideContainer(){this.vm.callerContext.isRotateAndSlideStyle()&&(this.slideContainerView=new TKView,this.slideContainerView.style={width:"100%",height:"100%",position:"absolute",left:0,top:0},this.insideContentView.appendChild(this.slideContainerView),this.slideContainerView.addEventListener("swipe",(t=>{this.vm.handleSlideConvert(0,0,Gt(t),0)})),this.slideContainerView.addEventListener("tap",(t=>{this.vm.callerContext.clickAd(1,Et(t,this.slideContainerView),2,ae.CARD_OTHERAREA_CLICK)})))}setupActionBar(){this.actionButton=new Hn(this.vm.actionButtonViewModel,this.actionBarSize,zn.redPacketStyle),this.actionButton.style={bottom:this.actionBarBottom,position:"absolute"},this.insideView.appendChild(this.actionButton),this.vm.isVertical()||(this.actionButton.style={transform:{scale:{x:.6,y:.6}},bottom:Ut.isAndroid()?17:24});const t=this;ze(this.vm.$attrsPath.lifeStatus,(e=>{"showEnd"==e&&this.vm.callerContext.isRotateAndSlideStyle()&&t.vm.reportCombination2ActionBarImpression()}))}setupSlideView(){if(!this.vm.callerContext.isRotateAndSlideStyle())return;if(this.slideGuideView)return;let t=0;t=this.vm.isVertical()?(this.containerViewSize.height-this.contentViewSize.height)/2+this.bottomSpaceHeight+610*this.contentViewSize.height/1680:this.closeActionViewBottom+30,this.slideGuideView=new hn(this.vm,t),this.appendChild(this.slideGuideView)}setupOutsideContentView(){const t=this;Ut.supportMinimumTKVersion("5.0.0")&&(this.outsideBackgroundImageView=new TKLottieImageView,this.outsideBackgroundImageView.style={position:"absolute",width:"100%",height:"100%"},this.outsideBackgroundImageView.enabled=!1,this.outsideBackgroundImageView.setUri("bundle://image/ksad-interstitial-card/lottie_red_packet_outside_background1.json"),this.containerView.appendChild(this.outsideBackgroundImageView)),this.outsideView=new TKView,this.outsideView.style={marginTop:this.vm.isVertical()?-60:Ut.isAndroid()?-32:-42,width:this.contentViewSize.width,height:this.contentViewSize.height,alignItems:"center"},this.containerView.appendChild(this.outsideView),this.outsideView.addEventListener("tap",(e=>{t.vm.callerContext.clickAd(1,Et(e,t.outsideView),2,ae.CARD_OTHERAREA_CLICK)})),this.outsideContentView=new Yn(this.vm,!1),this.outsideContentView.style={marginTop:12,width:"100%",height:"100%"},this.outsideView.appendChild(this.outsideContentView),this.animationGradientView=new TKView,this.animationGradientView.style={position:"absolute",width:"90%",height:this.vm.isVertical()?24:13,gradientBgColor:"90,EB655200 0,EB6552 1"},this.animationGradientView.setVisibility("hidden"),this.outsideView.appendChild(this.animationGradientView);let e=90;this.vm.isVertical()||(e=Ut.isAndroid()?51:63),this.hintLabel=new TKText,this.hintLabel.style={position:"absolute",bottom:e,color:"#FAE3B766",fontSize:this.vm.isVertical()?10:8},this.hintLabel.setText("*实际福利以活动详情为准"),this.containerView.appendChild(this.hintLabel),this.setOutsideViewVisibility("hidden")}startOutsideContentViewAnimation(){this.animationGradientView.setVisibility("visible"),setTimeout((()=>{this.animationGradientView.setVisibility("hidden")}),140);const t=this,e=new TKBasicAnimation;e.setEndValue((()=>{t.outsideContentView.style={top:this.vm.isVertical()?-195:Ut.isAndroid()?-120:-125}})),e.duration=160,e.timingFunction="linear",e.on("end",(()=>{this.setupSlideView(),t.setOutsideViewVisibility("hidden")})),setTimeout((()=>{t.setOutsideViewVisibility("hidden")}),200),this.outsideContentView.addAnimation(e,"outsideContentViewAnimation")}setInsideViewVisibility(t){this.insideBackgroundImageView.setVisibility(t),this.insideView.setVisibility(t)}setOutsideViewVisibility(t){this.outsideView.setVisibility(t),Ut.supportMinimumTKVersion("5.0.0")&&this.outsideBackgroundImageView.setVisibility(t)}showStart(){super.showStart(),Ut.supportMinimumTKVersion("5.0.0")&&this.outsideBackgroundImageView.play(),this.setOutsideViewVisibility("visible"),this.setInsideViewVisibility("visible");const t=this;setTimeout((()=>{t.startOutsideContentViewAnimation()}),Ut.isAndroid()?1e3:1100)}updateFakePlayDuration(t){super.updateFakePlayDuration(t),this.enableStartAutoCall&&this.actionButton.handlePlayTime(1e3*t),this.enableStartAutoCall||(this.enableStartAutoCall=!0)}}class Xn extends TKView{constructor(t,e,i=8,n=!0){super(),this.vm=t,this.materialViewSize=e,this.radius=i,this.showAutoCall=n,this.iconWH=this.vm.callerContext.isSpecialShapeStyle()?24:28,this.setupView(),Yt.log("material view setup view"),this.setupCallback(),Yt.log("material view setup callback"),this.setupData(),Yt.log("material view setup data"),this.setupAction(),Yt.log("material view setup action"),this.showAutoCall&&this.setupAutoCallView()}setupView(){this.style={top:0,width:this.materialViewSize.width,height:this.materialViewSize.height,justifyContent:"center",alignItems:"center",position:"absolute"};let t=this.radius,e=this.radius;!this.vm.callerContext.isVertical()&&this.vm.callerContext.isVerticalMaterial()&&(t=0,e=0),this.vm.callerContext.isSpecialShapeFirstStyle()||!this.vm.callerContext.isVertical()||this.vm.callerContext.isVerticalMaterial()||(e=0),(!this.vm.callerContext.isVertical()&&this.vm.callerContext.isVerticalMaterial()||this.vm.callerContext.isVertical()&&!this.vm.callerContext.isVerticalMaterial()&&this.vm.callerContext.isSpecialShapeAndRoatateAndSlideStyle())&&(this.placeholderImageView=new TKBlurImage,this.placeholderImageView.style={width:this.materialViewSize.width,height:this.materialViewSize.height,topLeftRadius:this.radius,topRightRadius:this.radius,bottomLeftRadius:this.radius,bottomRightRadius:this.radius,position:"absolute"},this.placeholderImageView.setBlurRadius(this.radius),this.appendChild(this.placeholderImageView),this.vm.isRotateAndSlideStyle()&&(this.placeholderMaskView=new TKView,this.placeholderMaskView.style={backgroundColor:"#0000004D",width:this.materialViewSize.width,height:this.materialViewSize.height,topLeftRadius:this.radius,topRightRadius:this.radius,bottomLeftRadius:this.radius,bottomRightRadius:this.radius,position:"absolute"},this.appendChild(this.placeholderMaskView)));let i=this.materialViewSize;if((this.vm.callerContext.isSpecialShapeStyle()||this.vm.callerContext.isSpecialShapeAndRoatateAndSlideStyle())&&(i=this.vm.materialViewModel.getSpecialShapeMaterialSize(!0)),this.contentImageView=new TKImage,this.contentImageView.style={width:i.width,height:i.height,topLeftRadius:t,topRightRadius:t,bottomLeftRadius:e,bottomRightRadius:e,position:"absolute"},this.appendChild(this.contentImageView),this.vm.callerContext.isVideoMaterial()){this.playerView=new TKVideoPlayer,this.playerView.style={width:i.width,height:i.height,topLeftRadius:t,topRightRadius:t,bottomLeftRadius:e,bottomRightRadius:e,position:"absolute"},this.playerView.setVideoGravity(2),this.appendChild(this.playerView),this.vm.callerContext.hasVideoPlayer=!0;const n=this;ze(this.vm.$attrsPath.callerContext.controlVideoPlayerStatus,(t=>{switch(t){case"play":n.playerView.play();break;case"stop":n.playerView.stop();break;case"resume":n.playerView.resume();break;case"pause":n.playerView.pause()}}))}this.vm.callerContext.isRotateAndSlideStyle()&&(this.combineInteractionView=new Mi(this.vm.getSlideConvertDistance(),((t,e,i,n)=>{const s=i-t,a=n-e;Math.abs(s)>=Math.abs(a)?s>0?this.vm.handleSlideConvert(t,e,3,s):this.vm.handleSlideConvert(t,e,2,s):a>0?this.vm.handleSlideConvert(t,e,4,a):this.vm.handleSlideConvert(t,e,1,a)}),((t,e)=>{this.vm.enableFullScreenClick()&&this.vm.convert(2,{x:t,y:e},ae.CARD_OTHERAREA_CLICK)})),this.combineInteractionView.style={width:"100%",height:"100%",bottom:0},this.appendChild(this.combineInteractionView));if(this.closeActionView=new on(this.vm.closeActionViewModel,!1,0,{width:this.iconWH,height:this.iconWH}),this.closeActionView.style={top:12,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.closeActionView.style={left:12}:this.closeActionView.style={right:12},this.appendChild(this.closeActionView),this.vm.callerContext.isVideoMaterial()){const t=12;this.soundButton=new Ki("image/ksad-interstitial-card/ic_sound_on.png","image/ksad-interstitial-card/ic_sound_off.png",{width:this.iconWH,height:this.iconWH}),this.soundButton.style={top:t,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.soundButton.style={right:t}:this.soundButton.style={left:t},this.appendChild(this.soundButton)}if(this.vm.callerContext.isVideoMaterial()){this.playButton=new Ri,this.playButton.setImageSrcAndSize("ic_play.png",{width:44,height:44});let t=-20;this.vm.callerContext.isVertical()&&this.vm.callerContext.isVerticalMaterial()&&(t=-40,this.vm.callerContext.enableShakeInteraction()&&this.vm.canShowAutoCall()&&(t=-this.vm.getAutoCallHeight())),this.playButton.style={position:"absolute",top:i.height/2+t,visibility:"hidden"},this.appendChild(this.playButton)}}setupData(){this.placeholderImageView&&this.placeholderImageView.setSrc(b(this.vm.callerContext.adInfo)),this.vm.callerContext.isVideoMaterial()?(this.playerView.setURL(A(this.vm.callerContext.adInfo)),Ut.isAndroid()&&this.playerView.prepareToPlay(),this.vm.materialViewModel.registerVideoPlayerListener((t=>{t||this.playButton.setVisibility("visible")})),this.contentImageView.setSrc(b(this.vm.callerContext.adInfo))):this.contentImageView.setSrc(A(this.vm.callerContext.adInfo)),this.contentImageView.setImageLoadCallback((t=>{this.vm.callerContext.contentLoadState=t?1:2,this.vm.callerContext.notifyUIErrorReport()}))}setupAction(){const t=this;!this.vm.callerContext.isVertical()&&this.vm.callerContext.isVerticalMaterial()&&this.vm.addMaterilTapEventIfNeeded(this.placeholderImageView),this.vm.callerContext.isVideoMaterial()&&(this.vm.addMaterilTapEventIfNeeded(this.playerView),this.soundButton.changeCallback=()=>{t.playerView.setMuted(!t.soundButton.on)},this.playButton.addEventListener("tap",(t=>{this.playerView&&this.playerView.play(),this.vm.materialViewModel.videoHasPlayed=!0,this.vm.materialViewModel.videoEnableAutoPlay=!0,this.playButton.setVisibility("hidden")}))),this.vm.addMaterilTapEventIfNeeded(this.contentImageView)}setupCallback(){const t=this;this.vm.callerContext.isVideoMaterial()&&(this.vm.materialViewModel.videoMuteCallback=e=>{t.playerView.setMuted(e),t.soundButton.setOn(!e)},this.setupVideoPlayerCallback()),this.vm.materialViewModel.videoCountDownCompletedCallback=e=>{t.vm.callerContext.isVideoMaterial()&&(t.playerView.stop(),t.vm.materialViewModel.playFinished=!0),t.showEndCard(),0!=e&&Te.log(400,null,null)},this.vm.closeActionViewModel.skipCallback=e=>{t.vm.callerContext.isVideoMaterial()&&(t.playerView.stop(),t.vm.materialViewModel.playFinished=!0),t.showEndCardCallback&&t.showEndCardCallback(e)}}setupVideoPlayerCallback(){const t=this;this.playerView.setOnFirstFrame((()=>{t.vm.materialViewModel.videoPlayStart(),this.vm.callerContext.playerLoadState=1,this.vm.callerContext.notifyUIErrorReport(),t.videoPlayStart()})),this.playerView.setOnFinish((()=>{t.vm.materialViewModel.videoPlayFinished(),t.videoPlayFinished()})),this.playerView.setOnProgress(((e,i,n)=>{t.vm.materialViewModel.updateVideoProgress(e,i,n),t.updateVideoProgress(e,i,n)})),this.playerView.setOnMuteChange((e=>{t.videoMuteChange(e)})),this.playerView.setOnFailed(((e,i)=>{t.vm.materialViewModel.videoPlayFailed(e,i),t.videoPlayFailed(e,i),this.vm.callerContext.playerLoadState=2,this.vm.callerContext.notifyUIErrorReport()}))}videoPlayStart(){this.playButton&&this.removeChild(this.playButton)}videoPlayFinished(){this.showEndCard(),fe().emit(ce,{})}updateVideoProgress(t,e,i){fe().emit(pe,{currentTime:t,avaliableTime:e,totalTime:i})}videoPlayFailed(t,e){fe().emit(de,{errorCode:t,errorReason:e})}videoMuteChange(t){this.soundButton.setOn(!t),fe().emit(re,{muted:t})}showEndCard(){this.showEndCardCallback&&this.showEndCardCallback(),this.vm.callerContext.isVideoMaterial()&&(this.playerView.setVisibility("hidden"),this.soundButton.setVisibility("hidden"))}setupAutoCallView(){if(this.vm.callerContext.enableShowAutoCall){this.autoCallView=new _i(this.vm.buildAutocallViewModel());let t=0;this.vm.callerContext.isVertical()&&this.vm.callerContext.isVerticalMaterial()&&(t=Ut.isAndroid()?-7:2),this.vm.callerContext.isVertical()&&!this.vm.callerContext.isVerticalMaterial()&&(t=-6),this.vm.callerContext.isVertical()||(t=Ut.isAndroid()?this.vm.callerContext.enableShakeInteraction()?-6:2:this.vm.callerContext.enableShakeInteraction()?6:14),this.autoCallView.style={marginRight:t,bottom:this.vm.materialViewModel.getAutoCallViewBottom(),position:"absolute"},this.appendChild(this.autoCallView),this.autoCallView.dismissCallback=()=>{this.autoCallView&&this.removeChild(this.autoCallView)},ze(this.vm.$attrsPath.callerContext.autocallHasConverted,(t=>{this.autoCallView&&t&&this.autoCallView.setConverted(t)})),fe().on(ce,(t=>{this.autoCallView&&this.autoCallView.handlePlayFinished()})),fe().on(pe,(t=>{this.autoCallView&&this.autoCallView.handlePlayTime(1e3*t.currentTime)})),fe().on(de,(t=>{this.autoCallView&&this.autoCallView.handlePlayFailed()}))}}}class Jn extends TKView{constructor(t){super(),this.vm=t,this.setupView(),Yt.log("special card setup view"),this.setupAction(),Yt.log("special card setup action")}setupView(){const t=this.vm.callerContext.interstitialContainerSize,e=this.vm.getSpecialShapeSize();this.containerView=new TKView,this.containerView.style={width:this.vm.callerContext.isSpecialShapeAndRoatateAndSlideStyle()?e.width:t.width,height:e.height,alignItems:"center"},!this.vm.callerContext.isSpecialShapeFirstStyle()&&this.vm.isVertical()&&(this.containerView.style={top:this.vm.isVerticalMaterial()?-20:-5}),this.appendChild(this.containerView);const i=this.vm.getSpecialShapeBehindImageSize();this.skinContainerView=new TKView,this.skinContainerView.style={width:"100%",height:i.height,alignItems:"center"},this.containerView.appendChild(this.skinContainerView),this.behindImageView=new TKImage,this.behindImageView.style={width:i.width,height:i.height},this.behindImageView.setSrc(this.vm.getSpecialShapeSkinImageUrl()),this.skinContainerView.appendChild(this.behindImageView);const n=this.vm.getSpecialShapeMaterialContainerSize();let s=10,a=10;!this.vm.isVertical()&&this.vm.isVerticalMaterial()&&(s=0,a=0),this.vm.callerContext.isSpecialShapeFirstStyle()||!this.vm.isVertical()||this.vm.isVerticalMaterial()||(a=0),this.materialView=new Xn(this.vm,n,10,!1),this.materialView.style={top:this.vm.getSpecialShapeMaterialTop()};const o=this;if(this.materialView.showEndCardCallback=t=>{o.showEndCardCallback&&o.showEndCardCallback(t)},this.skinContainerView.appendChild(this.materialView),this.vm.callerContext.isSpecialShapeFirstStyle()){const t=this.vm.getSpecialShapeFrontImageSize();this.frontImageView=new TKImage,this.frontImageView.style={bottom:0,width:t.width,height:t.height,position:"absolute"},this.frontImageView.setSrc(this.vm.getSpecialShapeSkinImageUrl(!1)),this.skinContainerView.appendChild(this.frontImageView)}this.appendContentView()}setupAction(){const t=this;this.vm.enableFullScreenClick()&&(this.frontImageView&&this.frontImageView.addEventListener("tap",(e=>{const i=Et(e,t.frontImageView);this.vm.callerContext.clickAd(1,i,2,ae.CARD_OTHERAREA_CLICK)})),this.behindImageView.addEventListener("tap",(e=>{const i=Et(e,t.behindImageView);this.vm.callerContext.clickAd(1,i,2,ae.CARD_OTHERAREA_CLICK)})))}}class $n extends Jn{appendContentView(){this.contentView=new TKView,this.contentView.style={bottom:0,position:"absolute",flexDirection:"column-reverse",alignItems:"center"},this.skinContainerView.appendChild(this.contentView),this.titleLabel=new TKText,this.titleLabel.style={marginBottom:18,maxWidth:this.vm.getSpecialShapeMaterialContainerSize().width-20,fontWeight:"bold",color:"#FFFFFF",textLineClamp:1,textAlign:"center"},this.titleLabel.setText(K(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.contentView.appendChild(this.titleLabel),this.iconImageView=new TKImage,this.iconImageView.style={marginBottom:8,width:62,height:62,borderRadius:16,borderColor:"#EAEAEA",borderWidth:.5},this.iconImageView.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.contentView.appendChild(this.iconImageView),this.actionButton=new Hn(this.vm.actionButtonViewModel,{width:230,height:58},zn.specialShapeStyle),this.actionButton.style={bottom:this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()?26:0,position:"absolute"},this.actionButton.setActionButtonImageUrl(this.vm.getSpecialShapeButtonImageUrl()),this.containerView.appendChild(this.actionButton),this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()&&(this.fullScreenClickTextView=new vn(this.vm.fullScreenClickTextViewModel,30),this.fullScreenClickTextView.style={bottom:0,position:"absolute"},this.containerView.appendChild(this.fullScreenClickTextView))}setupAction(){super.setupAction();const t=this;this.vm.enableFullScreenClick()&&(this.iconImageView.addEventListener("tap",(e=>{const i=Et(e,t.iconImageView);this.vm.callerContext.clickAd(1,i,2,ae.CARD_ICON_CLICK)})),this.titleLabel.addEventListener("tap",(e=>{const i=Et(e,t.titleLabel);this.vm.callerContext.clickAd(1,i,2,ae.CARD_ICON_NAME_CLICK)})))}}class Zn extends TKView{constructor(t,e=!1){super(),this.vm=t,this.isTextWhiteColor=e,this.setupView(),this.setupData(),this.setupActions();const i=this;ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"pageVisiable":i.startShakeAnimation();break;case"pageInvisiable":i.stopAllAnimation()}}))}setupData(){this.vm.callerContext.templateDataInfo&&(this.titleView.setText(this.vm.callerContext.templateDataInfo.shakeInfo.title),1==this.vm.callerContext.adInfo.adBaseInfo.adOperationType?Ne(this.descView,"text",this.vm.$attrsPath.callerContext.downloadText):this.descView.setText(this.vm.callerContext.templateDataInfo.shakeInfo.subtitle))}setupActions(){this.vm.getShakeClickEnable()&&this.touchView.addEventListener("tap",(t=>{const e=Et(t,this.touchView);this.vm.callerContext.clickAd(1,e,1,ae.SHAKE_BIG_ICON_CLICK)})),this.vm.callerContext.isVertical()&&!this.vm.callerContext.isVerticalMaterial()&&this.vm.callerContext.isPictureMaterial()&&this.vm.callerContext.enableFullScreenClick()&&this.addEventListener("tap",(t=>{const e=Et(t,this);this.vm.callerContext.clickAd(1,e,2,ae.CARD_OTHERAREA_CLICK)}))}setupView(){this.style={flexDirection:"column",justifyContent:"center",alignItems:"center"},this.appendActionBarShakeView()}appendActionBarShakeView(){this.outCircleView=new TKView,this.outCircleView.style={justifyContent:"center",width:184,height:48,borderRadius:24,borderColor:this.isTextWhiteColor?"#FFFFFF64":"#FE366664",borderWidth:1,overflow:"visible"},this.appendChild(this.outCircleView),this.shakeView=new TKView,this.shakeView.style={left:2,width:44,height:44,backgroundColor:"#FE3666",borderRadius:22,position:"absolute"},this.outCircleView.appendChild(this.shakeView),this.shakeAnimView=new TKView,this.shakeAnimView.style={top:5.5,left:5.5,width:64,height:64,position:"absolute"},this.shakeView.appendChild(this.shakeAnimView),this.shakeImg=new TKImage,this.shakeImg.style={width:32,height:32},this.shakeImg.setSrc("image/ksad-interstitial-card/ic_shake.png"),this.shakeAnimView.appendChild(this.shakeImg),this.actionBarContentView=new TKView,this.actionBarContentView.style={left:48,width:116,height:48,marginRight:0,alignItems:"center",justifyContent:"center",flexDirection:"column"},this.outCircleView.appendChild(this.actionBarContentView),this.titleView=new TKText,this.titleView.style={color:this.isTextWhiteColor?"FFFFFF":"#FE3666",fontSize:15,marginBottom:4,width:116,textOverflow:"ellipsis",textLineClamp:1,textAlign:"center",fontWeight:"medium"},this.actionBarContentView.appendChild(this.titleView),this.descView=new TKText,this.descView.style={color:this.isTextWhiteColor?"#FFFFFF95":"#FE366695",fontSize:10,width:116,textOverflow:"ellipsis",textLineClamp:1,textAlign:"center",fontWeight:"medium"},this.actionBarContentView.appendChild(this.descView),this.touchView=new TKView,this.touchView.style={width:184,height:48,borderRadius:24,position:"absolute"},this.outCircleView.appendChild(this.touchView)}startShakeAnimation(){this.stopShakeAnimation(),this.addShakeAnim(),this.timer=setInterval((()=>{this.addShakeAnim()}),1200),this.completedTransformAnim||this.startShakeExpandAnimation()}addShakeAnim(){const t=new TKKeyframeAnimation;t.animType="rotationZ";let e=Ut.isAndroid()?.8:1;t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}],t.duration=1500,t.repeatCount=0,this.shakeAnimView&&this.shakeAnimView.addAnimation(t,"shakeAnimation")}stopShakeAnimation(){this.timer&&clearInterval(this.timer),this.shakeAnimView&&this.shakeAnimView.removeAllAnimation()}startShakeExpandAnimation(){setTimeout((()=>{this.addShakeExpandAnim(),this.addShakeLargenAnim(),this.addTitleDescAnim(),this.completedTransformAnim=!0}),4e3)}addShakeExpandAnim(){const t=new TKKeyframeAnimation;t.setAnimations([()=>(this.shakeView.style={left:0,width:Ut.isAndroid()?183:184,height:48},1)]),setTimeout((()=>{this.shakeView.style={borderRadius:24}}),400),t.duration=800,t.timingFunction="EaseInEaseOut",this.shakeView&&this.shakeView.addAnimation(t,"shakeExpandAnimation")}addTitleDescAnim(){const t=new TKKeyframeAnimation;t.setAnimations([()=>(this.titleViewOpacity(.4),.5),()=>(this.titleViewOpacity(1),1)]),t.duration=800,t.timingFunction="EaseInEaseOut",this.titleView&&this.titleView.addAnimation(t,"titleAnimation");const e=new TKKeyframeAnimation;e.setAnimations([()=>(this.descViewOpacity(.4),.5),()=>(this.descViewOpacity(1),1)]),e.duration=800,e.timingFunction="EaseInEaseOut",this.descView&&this.descView.addAnimation(e,"descAnimation"),setTimeout((()=>{this.isTextWhiteColor||(this.titleView.style={color:"#FFFFFF"},this.descView.style={color:"#FFFFFF95"})}),150)}titleViewOpacity(t){this.isTextWhiteColor||(this.titleView.style={opacity:t})}descViewOpacity(t){this.isTextWhiteColor||(this.descView.style={opacity:t})}addShakeLargenAnim(){const t=new TKKeyframeAnimation;t.setAnimations([()=>(this.shakeAnimView.style={transform:{scale:1.25},top:12.5,left:17.5},1)]),t.duration=800,t.timingFunction="EaseInEaseOut",this.shakeAnimView&&this.shakeAnimView.addAnimation(t,"shakeLargenAnimation")}stopAllAnimation(){this.stopShakeAnimation(),this.shakeView&&this.shakeView.removeAllAnimation(),this.titleView&&this.titleView.removeAllAnimation(),this.descView&&this.descView.removeAllAnimation()}}class qn extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupData(),this.setupActions();const e=this;ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"pageVisiable":e.startActionAnimation();break;case"pageInvisiable":e.stopRotateAnimation()}}))}setupData(){this.vm.callerContext.templateDataInfo&&(this.titleView.setText(this.vm.callerContext.templateDataInfo.shakeInfo.title),1==this.vm.callerContext.adInfo.adBaseInfo.adOperationType?Ne(this.descView,"text",this.vm.$attrsPath.callerContext.downloadText):this.descView.setText(this.vm.callerContext.templateDataInfo.shakeInfo.subtitle))}setupActions(){this.vm.getShakeClickEnable()&&(this.touchView.addEventListener("tap",(t=>{const e=Et(t,this.touchView);this.vm.callerContext.clickAd(1,e,1,ae.SHAKE_BIG_ICON_CLICK)})),this.actionBar.addEventListener("tap",(t=>{const e=Et(t,this.touchView);this.vm.callerContext.clickAd(1,e,1,ae.SHAKE_BIG_ICON_CLICK)})),this.descView.addEventListener("tap",(t=>{const e=Et(t,this.touchView);this.vm.callerContext.clickAd(1,e,1,ae.SHAKE_BIG_ICON_CLICK)})))}setupView(){this.style={flexDirection:"column",alignItems:"center"},this.throughHitTest=!0,this.appendShakeView()}appendShakeView(){this.outCircleView=new TKView,this.outCircleView.style={flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:21,width:90,height:90,borderRadius:45,borderColor:"#FFFFFF32",borderWidth:1,backgroundColor:"#00000064"},this.appendChild(this.outCircleView),this.shakeView=new TKView,this.shakeView.style={flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",width:76,height:76,borderColor:"#FFFFFF96",borderRadius:38,borderWidth:1},this.outCircleView.appendChild(this.shakeView),this.shakeAnimView=new TKView,this.shakeAnimView.style={width:92,height:92,marginLeft:15,marginTop:15},this.shakeImg=new TKImage,this.shakeImg.style={width:46,height:46},this.shakeImg.setSrc("image/ksad-interstitial-card/ic_shake.png"),this.shakeAnimView.appendChild(this.shakeImg),this.shakeView.appendChild(this.shakeAnimView),this.actionBarContentView=new TKView,this.actionBarContentView.style={width:"100%",height:67,position:"absolute",left:0,top:94,alignItems:"center",flexDirection:"column"},this.actionBarContentView.throughHitTest=!0,this.appendChild(this.actionBarContentView),this.actionBar=new TKView,this.actionBar.style={width:76,height:32,backgroundColor:"#FE3666",borderRadius:16,alignItems:"center",justifyContent:"center",flexDirection:"column"},this.actionBarContentView.appendChild(this.actionBar),this.titleView=new TKText,this.titleView.style={color:"#FFFFFF",fontSize:15,textOverflow:"ellipsis",textLineClamp:1,fontWeight:"medium"},this.actionBar.appendChild(this.titleView),this.descView=new TKText,this.descView.style={color:"#FFFFFFC8",fontSize:10,marginTop:5,textOverflow:"ellipsis",textLineClamp:1,textAlign:"center",shadow:"0 0 4 #00000099"},this.actionBarContentView.appendChild(this.descView),this.touchView=new TKView,this.touchView.style={marginTop:21,alignItems:"center",width:90,height:90,borderRadius:45,position:"absolute"},this.appendChild(this.touchView)}addShakeAnim(){let t=new TKKeyframeAnimation;t.animType="rotationZ";let e=Ut.isAndroid()?.8:1;t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}];t.duration=1200,this.addActionRotateAnim(t)}startActionAnimation(){this.stopRotateAnimation(),this.addShakeAnim(),this.timer=setInterval((()=>{this.addShakeAnim()}),1200)}addActionRotateAnim(t){this.shakeAnimView&&this.shakeAnimView.addAnimation(t,"rotate")}stopRotateAnimation(){this.timer&&clearInterval(this.timer),this.shakeAnimView&&this.shakeAnimView.removeAllAnimation()}}class Qn extends Jn{constructor(t){super(t);const e=this;ze(this.vm.$attrsPath.callerContext.controlInteractiveElementHide,(t=>{e.shakeView&&(e.shakeView.style={visibility:t?"hidden":"visible"}),e.shakeActionBar&&(e.shakeActionBar.style={visibility:t?"hidden":"visible"}),e.combineActionBar&&(e.combineActionBar.style={visibility:t?"hidden":"visible"}),e.combineContentView&&(e.combineContentView.style={visibility:t?"hidden":"visible"})}))}appendContentView(){if(Ut.supportMinimumTKVersion("5.0.0")?this.actionBarContainerView=new RoundRectView:this.actionBarContainerView=new TKView,this.actionBarContainerView.style={width:this.vm.getSpecialShapeMaterialContainerSize().width,bottom:this.vm.getActionBarContainerBottom(),height:85,position:"absolute",bottomLeftRadius:10,bottomRightRadius:10,flexDirection:"column-reverse"},this.actionBarContainerView.throughHitTest=!0,this.skinContainerView.appendChild(this.actionBarContainerView),this.vm.callerContext.isRotateAndSlideStyle()){let t=this.vm.isVertical()?20:-15;this.vm.callerContext.isVertical()&&this.vm.callerContext.enableShowAutoCall&&(t+=this.vm.getAutoCallHeight()),this.combineActionBar=new ln(this.vm),this.combineActionBar.style={bottom:t,transform:{scale:this.vm.isVertical()?1:.9}},t+=105+(this.vm.isVertical()?39:Ut.isAndroid()?0:8),this.materialView.appendChild(this.combineActionBar),this.combineContentView=new hn(this.vm),this.combineContentView.style={bottom:t,transform:{scale:this.vm.isVertical()?1:.9}},this.materialView.appendChild(this.combineContentView)}else this.actionBar=new an(this.vm.actionBarViewModel),this.actionBar.style={height:64,paddingLeft:10,paddingRight:10,bottomLeftRadius:8,bottomRightRadius:8},this.actionBarContainerView.appendChild(this.actionBar);this.tagView=new TKView,this.tagView.style={width:"100%",height:"100%"},this.tagView.throughHitTest=!0,this.actionBarContainerView.appendChild(this.tagView),this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()&&(this.fullScreenClickTextView=new vn(this.vm.fullScreenClickTextViewModel,2),this.fullScreenClickTextView.style={bottom:0,right:-1,position:"absolute"},this.tagView.appendChild(this.fullScreenClickTextView)),this.logoView=new ai(1,this.vm.adInfo),this.logoView.style={borderRadius:0},this.logoView.style={left:-1,bottom:0,topRightRadius:4,bottomRightRadius:0,position:"absolute"},this.logoView.enabled=!1,this.tagView.appendChild(this.logoView),this.vm.callerContext.enableShakeInteraction()&&(this.vm.isVertical()?this.appendCircleShakeView():this.appendRectangleShakeView()),this.setupAutoCallView()}appendCircleShakeView(){this.shakeView=new qn(this.vm.shakeViewModel),this.shakeView.style={position:"absolute",height:143,alignSelf:"center"},this.vm.isVerticalMaterial()?(this.shakeView.style={width:this.vm.getSpecialShapeMaterialContainerSize().width,bottom:75+this.vm.getAutoCallHeight()},this.materialView.appendChild(this.shakeView)):(this.shakeView.style={width:this.vm.getSpecialShapeSize().width,bottom:0},this.appendChild(this.shakeView))}appendRectangleShakeView(){this.shakeActionBar=new Zn(this.vm.shakeViewModel,!0),this.shakeActionBar.style={alignSelf:"center",height:48,marginBottom:Ut.isAndroid()?28:20},this.appendChild(this.shakeActionBar)}setupAutoCallView(){if(this.vm.callerContext.enableShowAutoCall){this.autoCallView=new _i(this.vm.autoViewModel);let t=0;t=this.vm.callerContext.isVertical()?this.vm.callerContext.isVerticalMaterial()||this.vm.callerContext.isRotateAndSlideStyle()?Ut.isAndroid()?-7:2:-6:Ut.isAndroid()?this.vm.callerContext.enableShakeInteraction()?-6:2:this.vm.callerContext.isRotateAndSlideStyle()||this.vm.callerContext.enableShakeInteraction()?6:14,this.autoCallView.style={marginRight:t,bottom:this.vm.materialViewModel.getAutoCallViewBottom(),position:"absolute"},this.materialView.appendChild(this.autoCallView);const e=this;this.autoCallView.dismissCallback=()=>{e.autoCallView&&e.materialView.removeChild(e.autoCallView)},ze(this.vm.$attrsPath.callerContext.autocallHasConverted,(t=>{e.autoCallView&&t&&e.autoCallView.setConverted(t)})),fe().on(ce,(t=>{e.autoCallView&&e.autoCallView.handlePlayFinished()})),fe().on(pe,(t=>{e.autoCallView&&e.autoCallView.handlePlayTime(1e3*t.currentTime)})),fe().on(de,(t=>{e.autoCallView&&e.autoCallView.handlePlayFailed()}))}}}class ts extends TKView{constructor(t){super(),this.vm=t,this.fakePlayDuration=0,this.touchPoint={x:0,y:0},this.initViewSize(),this.setupView(),this.setupCallback();const e=this;He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{"showStart"===t&&e.startFakePlayerTimerIfNeeded(),"pageVisiable"===t&&e.startFakePlayerTimerIfNeeded(),"pageInvisiable"===t&&e.stopFakePlayerTimerIfNeeded()})),this.reportShowWebView()}initViewSize(){const t=this.vm.callerContext.interstitialContainerSize;this.containerViewSize={width:0,height:0};const e=16/9;this.containerViewSize.width=.8*t.width,this.containerViewSize.height=this.containerViewSize.width*e,this.containerViewSize.height>t.height&&(this.containerViewSize.height=.8*t.height,this.containerViewSize.width=this.containerViewSize.height/e),this.fullScreenTextHeight=this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()?54:0}setupView(){if(this.style={justifyContent:"center",alignItems:"center",flexDirection:"column",width:this.containerViewSize.width,height:this.containerViewSize.height+this.fullScreenTextHeight},this.containerView=new TKView,this.containerView.style={width:"100%",height:this.containerViewSize.height,borderRadius:8,backgroundColor:"#FFFFFF"},this.appendChild(this.containerView),Ut.supportMinimumTKVersion("4.0.11")){this.touchInterceptView=new KSAdTouchInterceptView,this.touchInterceptView.style={width:"100%",height:"100%"},this.containerView.appendChild(this.touchInterceptView);const t=this;this.touchInterceptView.setTouchDownInterceptor((e=>{if(e.x!=t.touchPoint.x||e.y!=t.touchPoint.y)return t.touchPoint=e,t.reportClickWebView(t.touchPoint),!1}))}Ut.supportMinimumTKVersion("4.0.11")&&(this.webView=new KSAdWebView,this.webView.style={width:"100%",height:"100%",borderRadius:8},this.webView.setScrollEnabled(!0),this.touchInterceptView.appendChild(this.webView),this.webView.loadUrl(this.vm.adInfo.adConversionInfo.h5Url));if(this.closeActionView=new on(this.vm.closeActionViewModel,!1),this.closeActionView.style={position:"absolute",top:12},1==this.vm.callerContext.getSkipButtonPosition()?this.closeActionView.style={left:12}:this.closeActionView.style={right:12},this.containerView.appendChild(this.closeActionView),this.logoView=new ai(this.vm.getLogoStyle(),this.vm.adInfo),this.logoView.style={position:"absolute",left:8,bottom:6},this.logoView.enabled=!1,this.containerView.appendChild(this.logoView),this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()){let t=new vn(this.vm.fullScreenClickTextViewModel,32);t.style={bottom:0},this.appendChild(t)}this.vm.callerContext.enableShowAutoCall&&this.setupAutoCallView(),Bn.shareHelper(this.vm).appendDynamicEffectMaskViewIfNeeded(this.containerView,!1)}setupAutoCallView(){this.autocallView=new _i(this.vm.buildAutocallViewModel()),this.autocallView.style={position:"absolute",bottom:20},this.containerView.appendChild(this.autocallView);const t=this;this.autocallView.dismissCallback=()=>{t.containerView.removeChild(t.autocallView),t.autocallView=null},ze(this.vm.$attrsPath.callerContext.autocallHasConverted,(t=>{this.autocallView&&t&&this.autocallView.setConverted(t)}))}setupCallback(){const t=this;this.vm.closeActionViewModel.skipCallback=e=>{t.showEndCardCallback&&t.showEndCardCallback(e)}}reportShowWebView(){Te.exposeElement(207)}reportClickWebView(t){let e={itemClickType:ae.DIRECT_H5_PAGE_CLICK};Te.log(2,t,e),Ut.supportMinimumTKVersion("4.0.11")&&Xt.callNativeWithCallback("notifyClickAd")}startFakePlayerTimerIfNeeded(){if(this.fakePlayerTimer)return;if(!this.vm.isVideoMaterial()||this.fakePlayDuration>=this.vm.getVideoDuration())return;const t=this;this.fakePlayerTimer=setInterval((()=>{t.fakePlayDuration+=1,t.updateFakePlayDuration(),t.fakePlayDuration>=t.vm.getVideoDuration()&&t.stopFakePlayerTimerIfNeeded()}),1e3)}updateFakePlayDuration(){this.autocallView&&this.autocallView.handlePlayTime(1e3*this.fakePlayDuration)}stopFakePlayerTimerIfNeeded(){this.fakePlayerTimer&&(clearInterval(this.fakePlayerTimer),this.fakePlayerTimer=null)}}class es extends TKView{constructor(t,e,i){super(),this.vm=t,this.cardSize=e,this.materialSize=i,this.setupView(),this.setupData(),this.setupActions()}setupData(){this.iconImage.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.adTitle.setText(K(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.descText.setText(O(this.vm.callerContext.templateDataInfo,this.vm.adInfo))}setupView(){this.style={flexDirection:"column",justifyContent:"flex-start",alignItems:"center",width:this.cardSize.width,backgroundColor:"#FFFFFF",height:this.cardSize.height-this.materialSize.height,bottomLeftRadius:12,bottomRightRadius:12},this.appendContent()}appendContent(){this.iconImage=new TKImage,this.iconImage.style={width:54,height:54,marginTop:Ut.isAndroid()?32:36,borderRadius:16,marginBottom:Ut.isAndroid()?8:12},this.appendChild(this.iconImage),this.adTitle=new TKText,this.adTitle.style={fontSize:16,color:"#222222",fontWeight:"medium"},this.appendChild(this.adTitle),this.descText=new TKText,this.descText.style={fontSize:14,color:"#666666",marginTop:Ut.isAndroid()?8:12,marginLeft:16,marginRight:16,marginBottom:8,textLineClamp:1,textOverflow:"ellipsis",textAlign:"center"},this.appendChild(this.descText)}setupActions(){this.vm.enableFullScreenClick()&&(this.addEventListener("tap",(t=>{const e=Et(t,this);this.vm.callerContext.clickAd(1,e,2,ae.CARD_OTHERAREA_CLICK)})),this.iconImage.addEventListener("tap",(t=>{const e=Et(t,this.iconImage);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_CLICK)})),this.adTitle.addEventListener("tap",(t=>{const e=Et(t,this.adTitle);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_NAME_CLICK)})),this.descText.addEventListener("tap",(t=>{const e=Et(t,this.descText);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_COMMENT_CLICK)})))}}class is extends TKView{constructor(t,e,i,n){super(),this.vm=t,this.cornerStyle=n,this.materialSize=i,this.cardSize=e,this.setupView(),this.setupActions();const s=this;He(this.vm,this.vm.$attrsPath.liveEnd,(t=>{t&&s.showLiveEndView()}))}setupActions(){const t=this;this.playerView&&(this.vm.materialViewModel.videoMuteCallback=t=>{this.playerView&&this.playerView.setMuted(t),this.soundBtn&&this.soundBtn.setOn(!t)},this.playerView.setOnFirstFrame((()=>{this.playBtn&&this.removeChild(this.playBtn),te(this.vm.adInfo),this.vm.callerContext.playerLoadState=1,this.vm.callerContext.notifyUIErrorReport(),Te.updateVideoPlayStatus("start"),Te.log(399,null,null)})),this.playerView.setOnFinish((()=>{this.autocallView&&this.autocallView.handlePlayFinished(),this.vm.materialViewModel.videoPlayFinished(),this.showEndcard()})),this.playerView.setOnProgress(((t,e,i)=>{t<0&&(t=0),Te.updateVideoPlayStatus("progress",0,"",1e3*t),this.vm.callerContext.playDuration=1e3*t,this.autocallView&&this.autocallView.handlePlayTime(this.vm.callerContext.playDuration),this.vm.materialViewModel.checkNeedReportPlayNSecond(t,(e=>{e&&Te.playNSecond(Math.floor(t))})),this.vm.materialViewModel.updateCountDownByPlayer(t,i)})),this.playerView.setOnMuteChange((t=>{this.soundBtn.setOn(!t)})),this.playerView.setOnFailed(((t,e)=>{this.autocallView&&this.autocallView.handlePlayFailed(),this.vm.callerContext.playerLoadState=2,this.vm.callerContext.notifyUIErrorReport(),Te.updateVideoPlayStatus("failed",t,e)})),this.soundBtn.changeCallback=()=>{this.playerView.setMuted(!this.soundBtn.on)},this.vm.materialViewModel.registerVideoPlayerListener((t=>{t||this.playBtn.setVisibility("visible")}))),this.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&(this.vm.materialViewModel.videoMuteCallback=t=>{this.livePlayView&&this.livePlayView.setMuted(t),this.soundBtn&&this.soundBtn.setOn(!t)},this.livePlayView.setOnFirstFrame((()=>{this.playBtn&&this.removeChild(this.playBtn),this.vm.callerContext.playerLoadState=1,this.vm.callerContext.notifyUIErrorReport(),Te.log(399,null,null)})),this.livePlayView.setOnFinish((()=>{Te.updateVideoPlayStatus("end"),this.vm.materialViewModel.playFinished=!0,this.autocallView&&this.autocallView.handlePlayFinished(),this.showEndcard(),Te.log(400,null,null)})),this.livePlayView.setOnProgress(((t,e,i)=>{t<0&&(t=0),this.vm.callerContext.playDuration=1e3*t,this.autocallView&&this.autocallView.handlePlayTime(this.vm.callerContext.playDuration),this.vm.materialViewModel.checkNeedReportPlayNSecond(t,(e=>{e&&Te.playNSecond(Math.floor(t))})),this.vm.materialViewModel.countDownWithLivePlayer(this.livePlayView,t,e,i)})),this.livePlayView.setOnMuteChange((t=>{this.soundBtn.setOn(!t)})),this.livePlayView.setOnFailed((()=>{this.autocallView&&this.autocallView.handlePlayFailed(),this.vm.callerContext.playerLoadState=2,this.vm.callerContext.notifyUIErrorReport()})),this.livePlayView.setOnLiveEnd((t=>{setTimeout((()=>{let e=JSON.parse(t);this.vm.livePushEndInfo=e,this.vm.liveEnd=!0}),300)})),this.livePlayView.setOnLiveShopInfo((t=>{let e=JSON.parse(t);this.vm.liveRoomItemInfo=e.itemInfo,this.vm.liveShopCardChangeType=e.changeType})),this.livePlayView.setOnLiveMessageData((t=>{let e=JSON.parse(t);this.addLiveMessageCallback&&this.addLiveMessageCallback(e)})),this.soundBtn.changeCallback=()=>{this.livePlayView.setMuted(!this.soundBtn.on)},this.vm.materialViewModel.registerVideoPlayerListener((t=>{t||this.playBtn.setVisibility("visible")}))),this.vm.materialViewModel.videoCountDownCompletedCallback=e=>{this.playerView&&this.playerView.stop(),t.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&t.livePlayView.stop(),this.vm.materialViewModel.playFinished=!0,this.showEndcard(),0!=e&&Te.log(400,null,null)},this.vm.closeActionViewModel.skipCallback=e=>{t.playerView&&(t.playerView.stop(),t.vm.materialViewModel.playFinished=!0),t.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&(t.livePlayView.stop(),t.vm.materialViewModel.playFinished=!0),t.showNewEndCardCallback&&t.showNewEndCardCallback(e)}}setupView(){this.style={flexDirection:"column",justifyContent:"center",alignItems:"center",width:this.cardSize.width,height:this.materialSize.height};const t=1==S(this.vm.adInfo);if(!this.vm.isVertical()&&this.vm.isVerticalMaterial()){this.blurBg=new TKBlurImage,this.blurBg.style={width:this.cardSize.width,height:this.materialSize.height,resize:"cover",position:"absolute",topLeftRadius:12,topRightRadius:12,left:0,top:0},this.blurBg.setBlurRadius(50);let t=b(this.vm.adInfo);Dt(t)?this.blurBg.setSrc(t):this.blurBg.setBackgroundColor("#000000FF"),this.blurBg.setSrc(b(this.vm.adInfo)),this.appendChild(this.blurBg),this.vm.addMaterilTapEventIfNeeded(this.blurBg)}this.contentImage=new TKImage;let e=3==this.cornerStyle||1==this.cornerStyle,i=3==this.cornerStyle||4==this.cornerStyle;if(this.contentImage.style={position:"absolute",left:(this.cardSize.width-this.materialSize.width)/2,top:0,width:this.materialSize.width,height:this.materialSize.height-(Ut.isAndroid()?2:1),topLeftRadius:e?12:0,topRightRadius:e?12:0,bottomLeftRadius:i?12:0,bottomRightRadius:i?12:0,resize:"cover"},this.appendChild(this.contentImage),this.vm.addMaterilTapEventIfNeeded(this.contentImage),t){this.playerView=new TKVideoPlayer,this.playerView.style={position:"absolute",width:this.materialSize.width,height:this.materialSize.height,topLeftRadius:e?12:0,topRightRadius:e?12:0,bottomLeftRadius:i?12:0,bottomRightRadius:i?12:0,top:0,left:(this.cardSize.width-this.materialSize.width)/2},this.playerView.setURL(A(this.vm.adInfo)),this.playerView.setVideoGravity(2),Ut.supportMinimumTKVersion("4.0.9")&&this.playerView.setVideoAdaptStrategy(0),Ut.isAndroid()&&this.playerView.prepareToPlay(),this.appendChild(this.playerView),this.vm.callerContext.hasVideoPlayer=!0;const t=this;ze(this.vm.$attrsPath.callerContext.controlVideoPlayerStatus,(e=>{switch(e){case"play":t.playerView.play();break;case"stop":t.playerView.stop();break;case"resume":t.playerView.resume();break;case"pause":t.playerView.pause()}}));const n=28,s=12;this.soundBtn=new Ki("image/ksad-interstitial-card/ic_sound_on.png","image/ksad-interstitial-card/ic_sound_off.png",{width:n,height:n}),this.soundBtn.style={top:s,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.soundBtn.style={right:s}:this.soundBtn.style={left:s},this.appendChild(this.soundBtn),this.playBtn=new Ri,this.playBtn.setImageSrcAndSize("ic_play.png",{width:44,height:44}),this.playBtn.style={position:"absolute",top:this.materialSize.height/2-22,left:(this.cardSize.width-this.materialSize.width)/2+this.materialSize.width/2-22,visibility:"hidden"},this.appendChild(this.playBtn),this.playBtn.addEventListener("tap",(t=>{this.playerView&&this.playerView.play(),this.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&this.livePlayView.resume(),this.vm.materialViewModel.videoHasPlayed=!0,this.vm.materialViewModel.videoEnableAutoPlay=!0,this.removeChild(this.playBtn)})),this.contentImage.setSrc(b(this.vm.adInfo)),this.playerView&&this.vm.addMaterilTapEventIfNeeded(this.playerView),this.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&this.vm.addMaterilTapEventIfNeeded(this.livePlayView)}else if(this.vm.callerContext.isLiveAd()){if(Ut.supportMinimumTKVersion("5.0.0")){this.livePlayView=new TKLivePlayer,this.livePlayView.style={position:"absolute",width:this.materialSize.width,height:this.materialSize.height,topLeftRadius:e?12:0,topRightRadius:e?12:0,bottomLeftRadius:i?12:0,bottomRightRadius:i?12:0,top:0,left:(this.cardSize.width-this.materialSize.width)/2},kn.wrapInitLivePlayer(this.livePlayView,this.vm.deviceInfo.appId,this.vm.adInfo),this.appendChild(this.livePlayView),this.vm.callerContext.hasLivePlayer=!0;const t=this;ze(this.vm.$attrsPath.callerContext.controlLivePlayerStatus,(e=>{switch(e){case"resume":t.livePlayView.resume();break;case"pause":t.livePlayView.pause()}}))}const t=28,n=12;this.soundBtn=new Ki("image/ksad-interstitial-card/ic_sound_on.png","image/ksad-interstitial-card/ic_sound_off.png",{width:t,height:t}),this.soundBtn.style={top:n,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.soundBtn.style={right:n}:this.soundBtn.style={left:n},this.appendChild(this.soundBtn),this.playBtn=new Ri,this.playBtn.setImageSrcAndSize("ic_play.png",{width:44,height:44}),this.playBtn.style={position:"absolute",top:this.materialSize.height/2-22,left:(this.cardSize.width-this.materialSize.width)/2+this.materialSize.width/2-22,visibility:"hidden"},this.appendChild(this.playBtn),this.playBtn.addEventListener("tap",(t=>{this.playerView&&this.playerView.play(),this.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&this.livePlayView.resume(),this.vm.materialViewModel.videoHasPlayed=!0,this.vm.materialViewModel.videoEnableAutoPlay=!0,this.removeChild(this.playBtn)}));let s=b(this.vm.adInfo);Dt(s)?this.contentImage.setSrc(s):this.contentImage.setBackgroundColor("#000000FF"),this.contentImage.setSrc(b(this.vm.adInfo)),this.playerView&&this.vm.addMaterilTapEventIfNeeded(this.playerView),this.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&this.vm.addMaterilTapEventIfNeeded(this.livePlayView)}else this.contentImage.setSrc(A(this.vm.adInfo));if(this.contentImage.setImageLoadCallback((t=>{this.vm.callerContext.contentLoadState=t?1:2,this.vm.callerContext.notifyUIErrorReport()})),this.vm.callerContext.isLiveAd()&&(this.liveEndView=new yn(this.vm),this.liveEndView.style={width:"100%",height:"100%",visibility:"hidden"},this.liveEndView.enabled=!1,this.appendChild(this.liveEndView)),this.logoView=new ai(this.vm.getLogoStyle(),this.vm.adInfo),this.logoView.style={position:"absolute",left:8,bottom:8,visibility:this.vm.isLiveShopStyle()?"hidden":"visible"},this.logoView.enabled=!1,this.appendChild(this.logoView),this.vm.callerContext.enableShowAutoCall&&this.setupAutoCallView(),this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()&&(!this.vm.isLiveShopStyle()||!this.vm.isVertical())){let t=new vn(this.vm.fullScreenClickTextViewModel,2);t.style={right:0,bottom:0},this.appendChild(t)}}setupAutoCallView(){this.autocallView=new _i(this.vm.buildAutocallViewModel()),this.autocallView.style={bottom:20,position:"absolute"},this.vm.callerContext.isLiveAd()&&!this.vm.isVertical()&&(this.autocallView.style={top:48}),this.appendChild(this.autocallView),this.autocallView.dismissCallback=()=>{this.removeChild(this.autocallView),this.autocallView=null},ze(this.vm.$attrsPath.callerContext.autocallHasConverted,(t=>{this.autocallView&&t&&this.autocallView.setConverted(t)}))}showEndcard(){this.showNewEndCardCallback&&this.showNewEndCardCallback(),this.soundBtn.setVisibility("hidden"),this.playerView&&this.playerView.setVisibility("hidden"),this.livePlayView&&Ut.supportMinimumTKVersion("5.0.0")&&this.livePlayView.setVisibility("hidden")}showLiveEndView(){this.liveEndView.enabled||(this.liveEndView.enabled=!0,this.liveEndView.style={visibility:"visible"},this.liveEndView.showDataDetailViewIfNeeded(),this.showLiveEndViewCallback&&this.showLiveEndViewCallback())}}class ns extends TKView{constructor(t){super(),this.vm=t,this.initShakeViewSize(),this.setupView();const e=this;ze(this.vm.$attrsPath.callerContext.controlInteractiveElementHide,(t=>{e.shakeView&&(e.shakeView.style={visibility:t?"hidden":"visible"})}))}initShakeViewSize(){if(this.shakeActionBarMarginTop=16,this.interstitialShakeOuterActionBarHeight=0,this.actionBarHeight=this.enableShowECNewStyle()?70:0,this.statusBarHeight=Ut.isAndroid()?25:0,this.fullScreenClickTextHeight=0,this.vm.isVertical())if(this.vm.isVerticalMaterial()){const t=533/300,e=Ut.isAndroid()?72:75;if(this.shakeMaterialSize={width:this.vm.containerLimit.width-e,height:(this.vm.containerLimit.width-e)*t-this.actionBarHeight},this.shakeMaterialSize.height>this.vm.containerLimit.height){const e=.8;this.shakeMaterialSize.height=this.vm.containerLimit.height*e,this.shakeMaterialSize.width=this.shakeMaterialSize.height/t}this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()&&this.vm.isLiveShopStyle()&&(this.fullScreenClickTextHeight=22),this.shakeCardSize={width:this.shakeMaterialSize.width,height:this.shakeMaterialSize.height+this.actionBarHeight+this.fullScreenClickTextHeight}}else if(this.vm.isPictureMaterial()){let t,e=this.vm.containerLimit.width-20;t=e*(201/355),this.shakeMaterialSize={width:e,height:t},this.shakeCardSize={width:e,height:455*t/201}}else{let t=this.vm.containerLimit.width,e=212*t/375;this.shakeMaterialSize={width:t,height:e},this.shakeCardSize=this.shakeMaterialSize,this.interstitialShakeOuterActionBarHeight=128+this.shakeActionBarMarginTop}else{this.actionBarHeight=(this.vm.containerLimit.height-this.statusBarHeight)/this.vm.containerLimit.height*70;let t=193/this.vm.containerLimit.height*((this.vm.containerLimit.height-this.statusBarHeight)/this.vm.containerLimit.height),e=343/193;this.vm.isVerticalMaterial()?this.shakeMaterialSize={height:(this.vm.containerLimit.height-this.statusBarHeight)*t,width:this.vm.callerContext.adDefaultMaterialSize.width*(this.vm.containerLimit.height-this.statusBarHeight)*t/this.vm.callerContext.adDefaultMaterialSize.height}:this.shakeMaterialSize={height:(this.vm.containerLimit.height-this.statusBarHeight)*t,width:(this.vm.containerLimit.height-this.statusBarHeight)*t*this.vm.callerContext.adDefaultMaterialSize.width/this.vm.callerContext.adDefaultMaterialSize.height},this.shakeCardSize={width:this.shakeMaterialSize.height*e,height:this.shakeMaterialSize.height+this.actionBarHeight-(Ut.isAndroid()?4.5:0)},this.shakeActionBarMarginTop=6,this.interstitialShakeOuterActionBarHeight=48+this.shakeActionBarMarginTop}}setupView(){this.style={alignItems:"center",flexDirection:"column",width:this.shakeCardSize.width,height:this.shakeCardSize.height+this.interstitialShakeOuterActionBarHeight},this.realContainer=new TKView,this.realContainer.style={width:"100%",height:this.shakeCardSize.height,borderRadius:12,overflow:"hidden"},this.appendChild(this.realContainer),this.appendInterstitialChild();if(this.closeActionView=new on(this.vm.closeActionViewModel,!1),this.closeActionView.style={top:12,position:"absolute"},1==this.vm.callerContext.getSkipButtonPosition()?this.closeActionView.style={left:12}:this.closeActionView.style={right:12},this.realContainer.appendChild(this.closeActionView),this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()&&this.vm.isLiveShopStyle()&&this.vm.isVertical()){let t=new vn(this.vm.fullScreenClickTextViewModel,32);t.style={bottom:0},this.appendChild(t)}Bn.shareHelper(this.vm).appendDynamicEffectMaskViewIfNeeded(this.realContainer,!1)}appendInterstitialChild(){this.appendMaterialView(),this.appendContentView(),this.appendActionBtnView(),this.appendLiveSubviews()}appendMaterialView(){this.materiaView=new is(this.vm,this.shakeCardSize,this.shakeMaterialSize,this.showMaterialCornerStyle()),this.realContainer.appendChild(this.materiaView);const t=this;this.materiaView.showNewEndCardCallback=e=>{t.showNewEndCard(e)},this.materiaView.showLiveEndViewCallback=()=>{t.vm.isLiveShopStyle()&&t.vm.isVertical()&&(t.shakeView.style={bottom:0+t.actionBarHeight+t.vm.getAutoCallHeight()+t.fullScreenClickTextHeight}),this.liveButton&&this.liveButton.setVisibility("hidden"),t.liveProductView&&t.liveProductView.hideLiveProductView(),t.liveMessageView&&Ut.supportMinimumTKVersion("5.0.0")&&(t.liveMessageView.style={visibility:"hidden"})}}showNewEndCard(t){this.showEndCardCallback&&this.showEndCardCallback(t)}appendContentView(){this.conentView=new es(this.vm,this.shakeCardSize,this.shakeMaterialSize),this.realContainer.appendChild(this.conentView)}appendLiveSubviews(){if(this.vm.isAdForLive()&&this.vm.isAddLiveButton()&&Ut.isAndroid()||this.vm.isLiveBaseStyle()||this.vm.isLiveShopStyle()&&!this.vm.isVertical()){this.liveButton=new Ei(this.vm.liveButtonViewModel),this.liveButton.style={bottom:this.vm.isVertical()?154:this.actionBarHeight+32,alignSelf:"center"};const t=this;this.liveButton.clickCallback=e=>{const i=Et(e,t.liveButton);t.vm.convert(1,i,ae.LIVE_BUTTON_CLICK)},this.realContainer.appendChild(this.liveButton)}this.vm.isLiveShopStyle()&&this.vm.isVertical()&&(this.liveProductView=new Vn(this.vm),this.liveProductView.style={bottom:10+this.fullScreenClickTextHeight,right:8},this.realContainer.appendChild(this.liveProductView),Ut.supportMinimumTKVersion("5.0.0")&&(this.liveMessageView=new TkLiveMessage,this.liveMessageView.style={height:144,position:"absolute",width:this.shakeCardSize.width-140,bottom:6+this.fullScreenClickTextHeight,left:8},this.materiaView.addLiveMessageCallback=t=>{this.liveMessageView&&this.liveMessageView.addLiveMessage(t)},this.realContainer.appendChild(this.liveMessageView)),this.liveMessageViewLayout=new TKView,this.liveMessageViewLayout.style={height:144,position:"absolute",width:this.shakeCardSize.width-140,bottom:6+this.fullScreenClickTextHeight,left:8,backgroundColor:"#00000000"},this.liveMessageViewLayout.addEventListener("tap",(t=>{this.vm.convert(2,Et(t,this.liveMessageViewLayout),ae.ACTIONBAR_ICON_COMMENT_CLICK)})),this.realContainer.appendChild(this.liveMessageViewLayout))}appendActionBtnView(){this.isShowShakeActionBar()?(this.shakeActionBar=new Zn(this.vm.shakeViewModel),this.shakeActionBar.style={position:"absolute",bottom:Ut.isAndroid?32:36,left:0,width:this.shakeCardSize.width,height:48},this.realContainer.appendChild(this.shakeActionBar)):(this.shakeView=new qn(this.vm.shakeViewModel),this.shakeView.style={position:"absolute",bottom:0+this.actionBarHeight+this.vm.getAutoCallHeight()+(this.vm.isLiveShopStyle()&&this.vm.isVertical()?139+this.fullScreenClickTextHeight:0),left:0,width:this.shakeCardSize.width,height:161},this.realContainer.appendChild(this.shakeView))}enableShowECNewStyle(){if(!this.vm.enableShowOrderAdNewStyle())return!1;let t=!1;return this.vm.isVertical()?this.vm.isVerticalMaterial()&&(t=!0):t=!0,t}showMaterialCornerStyle(){return 1}isShowShakeActionBar(){return!0}}class ss extends ns{}class as extends ns{appendActionBtnView(){this.shakeView=new qn(this.vm.shakeViewModel),this.shakeView.style={position:"absolute",bottom:0,left:0,width:this.shakeCardSize.width,height:143},this.appendChild(this.shakeView)}showMaterialCornerStyle(){return 3}}class os extends ns{appendContentView(){this.vm.enableShowOrderAdNewStyle()&&(this.actionBar=new mn(this.vm.actionBarViewModel),this.actionBar.style={width:this.shakeCardSize.width,height:this.actionBarHeight,bottomLeftRadius:12,bottomRightRadius:12,paddingLeft:10,paddingRight:10},this.realContainer.appendChild(this.actionBar))}isShowShakeActionBar(){return!1}showMaterialCornerStyle(){return this.vm.enableShowOrderAdNewStyle()?1:3}}class ls extends TKView{constructor(t){super(),this.vm=t,this.isLiveAd=this.vm.callerContext.isLiveAd(),this.setupView(),this.setupData(),this.setupActions()}setupData(){this.icon.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.titleLabel.setText(K(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.descLabel.setText(O(this.vm.callerContext.templateDataInfo,this.vm.adInfo))}setupView(){this.style={flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF"},this.isLiveAd&&(this.avatarView=new nn(new sn(this.vm.callerContext)),this.avatarView.style={width:47,height:47,marginRight:6},this.appendChild(this.avatarView)),this.icon=new TKImage,this.icon.style={width:42,height:42,marginRight:10,borderRadius:6,display:this.isLiveAd?"none":"flex"},this.appendChild(this.icon);const t=new TKView;t.style={flexDirection:"column",justifyContent:"center",flexShrink:1},this.appendChild(t),this.titleLabel=new TKText,this.titleLabel.style={fontWeight:"medium",color:"#222222",fontSize:14,textLineClamp:1,textOverflow:"ellipsis"},t.appendChild(this.titleLabel),this.descLabel=new TKText,this.descLabel.style={fontSize:12,color:"#666666",textOverflow:"ellipsis",textLineClamp:1,marginTop:4},t.appendChild(this.descLabel)}setupActions(){this.vm.enableFullScreenClick()&&(this.addEventListener("tap",(t=>{const e=Et(t,this);this.vm.callerContext.clickAd(1,e,2,ae.CARD_OTHERAREA_CLICK)})),this.icon.addEventListener("tap",(t=>{const e=Et(t,this.icon);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_CLICK)})),this.titleLabel.addEventListener("tap",(t=>{const e=Et(t,this.titleLabel);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_NAME_CLICK)})),this.descLabel.addEventListener("tap",(t=>{const e=Et(t,this.descLabel);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_COMMENT_CLICK)})))}}class hs extends ns{constructor(t){super(t);const e=this;ze(this.vm.$attrsPath.callerContext.controlInteractiveElementHide,(t=>{e.shakeActionBar&&(e.shakeActionBar.style={visibility:t?"hidden":"visible"})}))}appendContentView(){this.vm.enableShowOrderAdNewStyle()?this.actionBar=new mn(this.vm.actionBarViewModel):this.actionBar=new ls(this.vm),this.actionBar.style={width:this.shakeCardSize.width,height:this.actionBarHeight*((this.vm.containerLimit.height-this.statusBarHeight)/this.vm.containerLimit.height),bottomLeftRadius:12,bottomRightRadius:12,paddingLeft:10,paddingRight:10},this.realContainer.appendChild(this.actionBar)}appendActionBtnView(){this.shakeActionBar=new Zn(this.vm.shakeViewModel,!0),this.shakeActionBar.style={width:this.shakeCardSize.width,height:48,marginTop:this.shakeActionBarMarginTop},this.appendChild(this.shakeActionBar)}showMaterialCornerStyle(){return this.vm.isVerticalMaterial()?2:1}}class rs extends TKView{constructor(t,e,i,n,s=!1){super(),this.vm=t,this.cardSize=e,this.materialSize=i,this.isShowHorView=n,this.showTagsView=s,this.setupView(),this.setupData(),this.setupActions()}setupData(){this.iconImage.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.adTitle.setText(K(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.descText.setText(O(this.vm.callerContext.templateDataInfo,this.vm.adInfo))}setupActions(){this.vm.enableFullScreenClick()&&(this.addEventListener("tap",(t=>{const e=Et(t,this);this.vm.callerContext.clickAd(1,e,2,ae.CARD_OTHERAREA_CLICK)})),this.iconImage.addEventListener("tap",(t=>{const e=Et(t,this.iconImage);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_CLICK)})),this.adTitle.addEventListener("tap",(t=>{const e=Et(t,this.adTitle);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_NAME_CLICK)})),this.descText.addEventListener("tap",(t=>{const e=Et(t,this.descText);this.vm.callerContext.clickAd(1,e,2,ae.CARD_ICON_COMMENT_CLICK)})))}setupView(){this.style={flexDirection:"column",justifyContent:"flex-start",alignItems:"center",width:this.cardSize.width,marginBottom:16},this.isShowHorView?this.appendHorIconAndTitle():this.appendVerticalIconAndTitle(),this.descText=new TKText,this.descText.style={fontSize:16,color:"#666666",marginTop:Ut.isAndroid()?8:12,marginLeft:16,marginRight:16,textLineClamp:2,textOverflow:"ellipsis",textAlign:"center"},this.appendChild(this.descText)}appendVerticalIconAndTitle(){this.iconImage=new TKImage,this.iconImage.style={width:70,height:70,marginTop:20,borderRadius:16,marginBottom:Ut.isAndroid()?8:12},this.appendChild(this.iconImage),this.adTitle=new TKText,this.adTitle.style={fontSize:21,color:"#222222",textLineClamp:1,marginLeft:8,marginRight:8,fontWeight:"medium",textOverflow:"ellipsis"},this.appendChild(this.adTitle),this.showTagsView&&this.addTagView(this)}appendHorIconAndTitle(){this.iconAndTitleContainer=new TKView,this.iconAndTitleContainer.style={marginTop:20,paddingLeft:16,paddingRight:16,height:70,width:"100%",alignItems:"center",flexDirection:"row"},this.appendChild(this.iconAndTitleContainer),this.iconImage=new TKImage,this.iconImage.style={width:70,height:70,borderRadius:16},this.iconAndTitleContainer.appendChild(this.iconImage),this.descContainer=new TKView,this.descContainer.style={marginLeft:12,height:70,justifyContent:"center",width:230,flexDirection:"column"},this.iconAndTitleContainer.appendChild(this.descContainer),this.adTitle=new TKText,this.adTitle.style={fontSize:21,color:"#222222",fontWeight:"medium",textLineClamp:1},this.descContainer.appendChild(this.adTitle),this.addTagView(this.descContainer)}addTagView(t){let e=null,i=!1;try{e=this.vm.callerContext.templateDataInfo.exposeTagInfoList,i=e&&e.length>0}catch(n){}if(i){let i=new pn(e);i.style={marginTop:8},t.appendChild(i),this.vm.enableFullScreenClick()&&i.addEventListener("tap",(t=>{const e=Et(t,i);this.vm.callerContext.clickAd(1,e,2,ae.CARD_RECOMMEND_REASON_CLICK)}))}}}class ds extends TKView{constructor(t){super(),this.vm=t,this.initNewStyleViewSize(),this.setupView(),this.setupDatas()}initNewStyleViewSize(){let t=0;switch(this.vm.getInterstitialStyle()){case 5:t=988;break;case 6:t=884}this.newStyleCardSize={width:this.vm.containerLimit.width-20,height:Math.floor((this.vm.containerLimit.width-20)*t/710)};let e=1*this.newStyleCardSize.width;this.newStyleMaterialSize={width:e,height:400*e/710}}setupDatas(){this.actionBtnTouchView.addEventListener("tap",(t=>{const e=Et(t,this.actionBtnTouchView);this.vm.callerContext.clickAd(2,e,1,ae.CARD_ACTION_BAR_CLICK)})),this.vm.enableFullScreenClick()&&this.realContainer.addEventListener("tap",(t=>{const e=Et(t,this.realContainer);this.vm.callerContext.clickAd(2,e,2,ae.CARD_OTHERAREA_CLICK)}))}setupView(){const t=this.newStyleCardSize;if(this.style={justifyContent:"center",alignItems:"center",flexDirection:"column",width:t.width,height:t.height},this.realContainer=new TKView,this.realContainer.style={width:"100%",height:t.height,alignItems:"center",flexDirection:"column",borderRadius:8,backgroundColor:"#FFFFFF",overflow:"hidden"},this.appendChild(this.realContainer),this.appendInterstitialChild(),this.logoView=new ai(this.vm.getLogoStyle(),this.vm.adInfo),this.logoView.style={position:"absolute",left:6,bottom:6},this.logoView.enabled=!1,this.realContainer.appendChild(this.logoView),this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()){let t=new vn(this.vm.fullScreenClickTextViewModel,1,!0);t.style={right:7,bottom:6},this.realContainer.appendChild(t)}Bn.shareHelper(this.vm).appendDynamicEffectMaskViewIfNeeded(this.realContainer,!1)}appendInterstitialChild(){this.appendMaterialView(),this.appendContentView(),this.appendActionBtnView()}appendMaterialView(){this.materialView=new Xn(this.vm,this.newStyleMaterialSize,8),this.materialView.style={position:"relative"};const t=this;this.materialView.showEndCardCallback=e=>{t.showEndCardCallback&&t.showEndCardCallback(e)},this.realContainer.appendChild(this.materialView)}appendContentView(){this.contentView=new rs(this.vm,this.newStyleCardSize,this.newStyleMaterialSize,this.isShowHorContent()),this.realContainer.appendChild(this.contentView)}appendActionBtnView(){this.actionBtn=new en(this.vm.actionButtonViewModel,44,16,!0),this.actionBtn.style={marginTop:4,width:275,height:44},this.realContainer.appendChild(this.actionBtn),this.actionBtnTouchView=new TKView,this.actionBtnTouchView.style={marginTop:-44,width:275,height:44},this.realContainer.appendChild(this.actionBtnTouchView)}isShowHorContent(){return!1}}class cs extends ds{}class ps extends ds{isShowHorContent(){return!0}}class ms extends TKView{constructor(t,e){super(),this.vm=t,this.size=e,this.setupView(),this.setupData(),this.setupAction(),this.vm.addPageStatusListener((t=>{switch(t){case"pageVisiable":this.startShakeAnimation();break;case"pageInvisiable":this.stopShakeAnimation()}}))}setupView(){this.style={width:this.size.width,height:this.size.height,justifyContent:"center",alignItems:"center",borderRadius:.5*this.size.height},this.actionbarBgImageView=new TKImage,this.actionbarBgImageView.style={width:this.size.width,height:this.size.height},Ht(this.actionbarBgImageView,this.vm.isVertical()?"ec_card_actionbar_big_bg.png":"ec_card_actionbar_hor_bg.png"),this.appendChild(this.actionbarBgImageView),this.contentView=new TKView,this.contentView.style={position:"absolute",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},this.appendChild(this.contentView),this.textColor="#FFFFFF",this.vm.callerContext.enableShakeInteraction()||this.vm.enableRotateForECCard()?this.appendShakeView():(this.normalTitleLabel=new TKText,this.normalTitleLabel.style={padding:8,fontSize:this.vm.isVertical()?20:14,color:this.textColor,textAlign:"center",fontWeight:"bold"},this.contentView.appendChild(this.normalTitleLabel)),this.vm.callerContext.enableShowAutoCall&&this.setupAutoCallView(this.size)}appendShakeView(){if(this.shakeContainerView=new TKView,this.shakeContainerView.style={marginTop:-4,height:this.vm.isVertical()?30:20,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.contentView.appendChild(this.shakeContainerView),this.shakeAnimationView=new TKView,this.shakeAnimationView.style={top:3,left:0,width:this.vm.isVertical()?50:32,height:this.vm.isVertical()?48:32,position:"absolute"},this.shakeAnimationView.enabled=!1,this.shakeContainerView.appendChild(this.shakeAnimationView),this.shakeImageView=new TKImage,this.shakeImageView.style={width:this.vm.isVertical()?24:16,height:this.vm.isVertical()?24:16,marginLeft:2},!this.vm.callerContext.enableShakeInteraction()){let t=new TKImage;t.style={position:"absolute",top:-1,left:this.vm.isVertical()?0:1,width:this.vm.isVertical()?28:18,height:this.vm.isVertical()?28:18},t.setSrc("image/ksad-interstitial-card/ic_rotate_arrow.png"),this.shakeAnimationView.appendChild(t)}this.shakeAnimationView.appendChild(this.shakeImageView),this.shakeTitleLabel=new TKText,this.shakeTitleLabel.style={marginLeft:this.vm.isVertical()?28:20,fontSize:this.vm.isVertical()?16:10,fontWeight:"bold",color:this.textColor,textAlign:"center"},this.shakeContainerView.appendChild(this.shakeTitleLabel),this.shakeSubtitleLabel=new TKText,this.shakeSubtitleLabel.style={fontSize:10,color:this.textColor,textAlign:"center"},this.contentView.appendChild(this.shakeSubtitleLabel)}setupAutoCallView(t){const e=this;this.autoCallView=new On(this.vm.buildAutocallViewModel(),"#FFFFFF",{width:t.width,height:t.height}),this.autoCallView.setFontSize(this.vm.isVertical()?16:10),this.vm.isVertical()||this.autoCallView.fitAutoCallViewHorizontal();let i=new r;i.interstitial_style=this.vm.callerContext.getInterstitialStyleNew(),this.autoCallView.setExternalClientExtData(i),this.appendChild(this.autoCallView),this.autoCallView.animateFinishCallback=()=>{e.autoCallView.addEventListener("tap",(t=>{this.vm.callerContext.clickAd(1,Et(t,e.autoCallView),1,ae.CARD_ACTION_BAR_CLICK)})),e.contentView.style={visibility:"hidden"}},this.autoCallView.dismissCallback=()=>{e.autoCallView&&e.removeChild(e.autoCallView),e.contentView.style={visibility:"visible"}},ze(this.vm.$attrsPath.callerContext.autocallHasConverted,(t=>{e.autoCallView&&t&&e.autoCallView.setConverted(t)}))}setupData(){if(this.normalTitleLabel&&(L(this.vm.callerContext.adInfo)?Ne(this.normalTitleLabel,"text",this.vm.ecCardViewModel.$attrsPath.actionBarText):this.normalTitleLabel.setText(this.vm.ecCardViewModel.getActionbarDesc())),this.shakeImageView){const t="image/ksad-interstitial-card/ic_shake.png",e="image/ksad-interstitial-card/ic_rotate_phone.png";this.shakeImageView.setSrc(this.vm.callerContext.enableShakeInteraction()?t:e)}this.shakeTitleLabel&&(this.vm.callerContext.enableShakeInteraction()?this.shakeTitleLabel.setText(this.vm.callerContext.templateDataInfo.shakeInfo.title):this.shakeTitleLabel.setText(this.vm.getCombineStyleRotateTitle())),this.shakeSubtitleLabel&&(L(this.vm.callerContext.adInfo)?Ne(this.shakeSubtitleLabel,"text",this.vm.ecCardViewModel.$attrsPath.actionBarText):this.shakeSubtitleLabel.setText(this.vm.ecCardViewModel.getActionbarDesc()))}setupAction(){const t=this;let e=ae.CARD_ACTION_BAR_CLICK;this.vm.callerContext.enableShakeInteraction()?e=ae.SHAKE_BIG_ICON_CLICK:this.vm.enableRotateForECCard()&&(e=ae.ROTATE_BIG_ICON_CLICK),this.addEventListener("tap",(i=>{const n=Et(i,t);this.vm.callerContext.clickAd(1,n,1,e)}))}addShakeAnimation(){let t=new TKKeyframeAnimation;t.animType="rotationZ";let e=Ut.isAndroid()?.8:1;t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}];t.duration=1200,this.shakeAnimationView&&this.shakeAnimationView.addAnimation(t,"addShakeRotate")}startShakeAnimation(){this.stopShakeAnimation(),this.addShakeAnimation(),this.shakeAnimationTimer=setInterval((()=>{this.addShakeAnimation()}),1200)}stopShakeAnimation(){this.shakeAnimationTimer&&clearInterval(this.shakeAnimationTimer),this.shakeAnimationView&&this.shakeAnimationView.removeAllAnimation()}handlePlayFinished(){this.autoCallView&&this.autoCallView.handlePlayFinished()}handlePlayFailed(){this.autoCallView&&this.autoCallView.handlePlayFailed()}handlePlayTime(t){this.autoCallView&&this.autoCallView.handlePlayTime(t)}}class us extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupAction(),this.fitHorizontalScreenView(),this.vm.getActionBarRect=()=>({x:this.actionbarView.getOrigin().x,y:this.actionbarView.getOrigin().y,width:169,height:48}),ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{"hideEnd"==t&&this.sweepTimer&&clearInterval(this.sweepTimer)}))}setupView(){this.setupRootView(),this.setupCountDownView(),this.setupBgView(),this.setupCardInfoView(),this.setupCouponInfoView(),this.setupActionbarView(),this.setupCloseView(),this.tryReportImpression()}setupAction(){this.actionbarView&&this.actionbarView.addEventListener("tap",(t=>{const e=Et(t,this.actionbarView);this.vm.convert(e,1,ae.CARD_ACTION_BAR_CLICK),this.vm.enableShowCloseView()&&this.onCloseClick&&this.onCloseClick(3)})),this.closeImage&&this.closeImage.addEventListener("tap",(t=>{this.onCloseClick&&this.onCloseClick(1)})),this.vm.isSplashScene()||this.vm.isInterstitialScene()||this.bgContainerView.addEventListener("tap",(t=>{const e=Et(t,this.bgContainerView);this.vm.convert(e,2,ae.CARD_OTHERAREA_CLICK),this.onCloseClick&&this.onCloseClick(3)}))}setupRootView(){this.actionBarSize=this.getActionBarSize(),this.style={width:"100%",height:"100%",backgroundColor:"#00000099",flexDirection:"column",alignItems:"center",justifyContent:"center"},this.rootContainerView=new TKView,this.rootContainerView.style={width:"100%",height:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:52},this.vm.enableShowCloseView()&&(this.rootContainerView.style={transform:{scale:0},opacity:0}),this.appendChild(this.rootContainerView)}setupCountDownView(){if(!this.vm.enableShowCountDownView())return;let t=new TKView;t.style={shadow:"0 0 26 #FFDF8E99"},this.countDownTextView=new TKText,this.countDownTextView.style={fontSize:22,marginBottom:8,fontWeight:"600",color:Ut.isAndroid()?"#FFE296":"#FFF7E0",gradientTextColor:"270,FFFFFF,FFE296"},t.appendChild(this.countDownTextView),this.countDownTextView.setText("限时福利 "+this.vm.getRightsCardStayTime()+"s 后消失"),this.rootContainerView.appendChild(t)}setupBgView(){this.bgContainerView=new TKView,this.bgContainerView.style={width:273,height:263,flexDirection:"column",alignItems:"center"},this.rootContainerView.appendChild(this.bgContainerView),this.bgImageView=new TKImage,this.bgImageView.style={width:273,height:263,bottomLeftRadius:60,bottomRightRadius:60},this.bgImageView.setSrc(this.vm.getBgUrl()),this.bgContainerView.appendChild(this.bgImageView),this.setupIPView(),this.bgBottomImageView=new TKImage,this.bgBottomImageView.style={width:273,height:263,position:"absolute",left:0,top:0},Ht(this.bgBottomImageView,this.vm.getBottomImageViewName()),this.bgContainerView.appendChild(this.bgBottomImageView),this.setupTipsView()}setupTipsView(){let t=this.vm.getBottomTipsText();if(Ft(t))return;let e=new TKText;e.style={maxWidth:"249",height:"15",fontSize:10,color:"#B8AB3B",includeFontPadding:!1,textAlign:"center",position:"absolute",bottom:10},e.setText(t),this.bgContainerView.appendChild(e)}setupCardInfoView(){this.cardInfoView=new TKView,this.cardInfoView.style={position:"absolute",left:40,width:84,top:34,flexDirection:"column"},this.bgContainerView.appendChild(this.cardInfoView),this.cardTitleText=new TKText,this.cardTitleText.style={fontSize:20,fontWeight:"900",color:"#FFFFFF"},this.cardTitleText.setText("恭喜获得"),this.cardInfoView.appendChild(this.cardTitleText),this.cardDescText=new TKText,this.cardDescText.style={color:"#FFFFFF",fontSize:11,marginTop:2,width:"100%",textLineClamp:1,textOverflow:"ellipsis"},this.cardDescText.setText(this.vm.getTitleDesc()),this.cardInfoView.appendChild(this.cardDescText)}setupIPView(){this.ipImageView=new TKImage,this.ipImageView.style={position:"absolute",right:12,top:1,width:134,height:134},this.ipImageView.setSrc(this.vm.getUserIcon()),this.bgContainerView.appendChild(this.ipImageView)}setupCouponInfoView(){this.couponInfoView=new TKView,this.couponInfoView.style={position:"absolute",left:31,bottom:38,width:211,height:69,flexDirection:"row",alignItems:"center"},this.bgContainerView.appendChild(this.couponInfoView),this.priceView=new TKView,this.priceView.style={paddingLeft:8,height:69,width:"36%",flexDirection:"row",alignItems:"center"},this.couponInfoView.appendChild(this.priceView);const t=this.getMeatureSize(this.vm.isVertical()?30:20);this.priceSymbolText=new TKText,this.priceSymbolText.style={fontSize:16,fontWeight:"500",color:"#FFFFFF",marginRight:-4,marginTop:(30==t?8:6)*t/30},this.priceSymbolText.setText("￥"),this.priceView.appendChild(this.priceSymbolText),this.priceText=new TKText,this.priceText.style={fontSize:t,color:"#FFFFFF",fontWeight:"600",width:54,textLineClamp:1,textOverflow:"ellipsis"},this.priceText.setText(this.vm.getPriceAmount()),this.priceView.appendChild(this.priceText),this.couponDescView=new TKView,this.couponDescView.style={flexDirection:"column",height:69,width:"64%",paddingRight:10,justifyContent:"center"},this.couponInfoView.appendChild(this.couponDescView),this.couponTitleText=new TKText,this.couponTitleText.style={fontSize:15,color:"#FFFFFF",textLineClamp:1,textOverflow:"ellipsis",fontWeight:"600"},this.couponTitleText.setText(this.vm.getCouponTitle()),this.couponDescView.appendChild(this.couponTitleText),this.couponDescText=new TKText,this.couponDescText.style={fontSize:10,color:"#FFFFFF",marginTop:4,textLineClamp:1,textOverflow:"ellipsis"},this.couponDescText.setText(this.vm.getCouponDesc()),this.couponDescView.appendChild(this.couponDescText)}setupActionbarView(){this.vm.enableShowActionbarView()&&(this.actionbarView=new TKView,this.actionbarView.style={width:169,height:48,borderRadius:this.actionBarSize.height/2,marginTop:16},this.rootContainerView.appendChild(this.actionbarView),this.actionbarBgImageView=new TKImage,this.actionbarBgImageView.style={width:169,height:48},Ht(this.actionbarBgImageView,"ec_card_actionbar_bg.png"),this.actionbarView.appendChild(this.actionbarBgImageView),this.actionbarText=new TKText,this.actionbarText.style={position:"absolute",left:0,top:-1,fontWeight:"600",width:169,height:48,paddingLeft:10,paddingRight:10,textLineClamp:1,minimumTextScaleFactor:.5,textOverflow:"ellipsis",textAlign:"center",color:"#FFFFFF",fontSize:20},this.actionbarView.appendChild(this.actionbarText),1==this.vm.callerContext.adInfo.adBaseInfo.adOperationType?Ne(this.actionbarText,"text",this.vm.$attrsPath.actionBarText):this.actionbarText.setText(this.vm.getActionbarDesc()),this.tryShowSweepAnimation())}tryShowSweepAnimation(){this.vm.enableAnimation()&&Ut.supportMinimumTKVersion("5.0.0")&&(this.sweepTimer&&clearInterval(this.sweepTimer),this.addSweepAnimation(),this.sweepTimer=setInterval((()=>{this.addSweepAnimation()}),2e3))}addSweepAnimation(){if(this.sweepView&&this.actionbarView.removeChild(this.sweepView),Ut.supportMinimumTKVersion("5.0.0")){this.sweepView=new RoundRectView,this.sweepView.style={width:this.actionBarSize.width,height:this.actionBarSize.height,borderRadius:this.actionBarSize.height/2,left:0,top:0,position:"absolute"};const t=128*this.actionBarSize.height/60;this.sweepImage=new TKImage,this.sweepImage.style={width:t,height:this.actionBarSize.height,left:-t,top:0,position:"absolute"},this.sweepView.appendChild(this.sweepImage),Ht(this.sweepImage,"ksad_light.png"),this.actionbarView.appendChild(this.sweepView),this.sweepImage.addAnimation(ei(1e3,this.actionBarSize.width+t),"anim")}}setupCloseView(){this.vm.enableShowCloseView()&&(this.closeImage=new TKImage,this.closeImage.style={width:40,height:40,marginTop:10},Ht(this.closeImage,"ec_card_close.png"),this.rootContainerView.appendChild(this.closeImage))}show(){this.startShowAnimation()}updateCountdown(t){this.countDownTextView&&this.countDownTextView.setText(`限时福利 ${t}s 后消失`)}startShowAnimation(){let t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.rootContainerView.style={transform:{scale:0},opacity:0},0),()=>(t.rootContainerView.style={transform:{scale:1},opacity:1},1)]),e.duration=600,e.timingFunction="linear",this.rootContainerView.addAnimation(e,"ecShowAnimation")}getMeatureSize(t){try{let e=new TKText;if(e.style={fontSize:t,width:54,fontWeight:"600"},e.setText(this.vm.getPriceAmount()),e.measureText(54,2).height>1.5*t){if((t-=2)<=18)return t;t=this.getMeatureSize(t)}}catch(e){return t}return t}tryReportImpression(){this.vm.logSplashCardImpression()}getActionBarSize(){return{width:169,height:48}}fitHorizontalScreenView(){}}class ws extends us{constructor(t){super(t)}fitHorizontalScreenView(){this.rootContainerView.style={paddingBottom:0},this.bgContainerView.style={width:181,height:175},this.bgImageView.style={width:181,height:175},this.bgBottomImageView.style={width:181,height:175},this.countDownTextView&&(this.countDownTextView.style={fontSize:16,marginBottom:4}),this.cardInfoView.style={left:26,top:26,width:60},this.cardTitleText.style={fontSize:14},this.cardDescText.style={fontSize:8},this.ipImageView.style={width:83,height:83,right:8,top:1},this.couponInfoView.style={left:21,bottom:25,width:140,height:46},this.priceView.style={paddingLeft:4,height:40},this.priceSymbolText.style={fontSize:10,marginRight:-2},this.priceText.style={width:32},this.couponDescView.style={height:40},this.couponTitleText.style={fontSize:10},this.couponDescText.style={fontSize:7,marginTop:2},this.actionbarView&&(this.actionbarView.style={width:113,height:32,marginTop:10},this.actionbarBgImageView.style={width:113,height:32},this.actionbarText.style={width:113,height:32,fontSize:14},this.closeImage&&(this.closeImage.style={width:32,height:32,marginTop:6}))}getMeatureSize(t){try{let e=new TKText;if(e.style={fontSize:t,width:32,fontWeight:"600"},e.setText(this.vm.getPriceAmount()),e.measureText(32,2).height>1.5*t){if((t-=2)<=12)return t;t=this.getMeatureSize(t)}}catch(e){return t}return t}getActionBarSize(){return{width:112,height:32}}}class gs extends Un{setupContainerView(){super.setupContainerView(),this.setUpGiftContentView(),this.setupActionBar(),this.setupSlideView()}setupAction(){super.setupAction(),this.slideView&&(this.slideView.addEventListener("swipe",(t=>{this.vm.handleSlideConvert(0,0,1,0)})),this.slideView.addEventListener("tap",(t=>{this.vm.callerContext.clickAd(1,Et(t,this.slideView),2,ae.CARD_OTHERAREA_CLICK)}))),this.giftContentView.addEventListener("tap",(t=>{this.vm.callerContext.clickAd(1,Et(t,this.giftContentView),2,ae.CARD_OTHERAREA_CLICK)}))}setUpGiftContentView(){this.vm.isVertical()?this.giftContentView=new us(this.vm.ecCardViewModel):(this.giftContentView=new ws(this.vm.ecCardViewModel),this.giftContentView.style={paddingBottom:38}),this.giftContentView.style={backgroundColor:"#00000000"},this.containerView.appendChild(this.giftContentView)}setupActionBar(){this.actionButton=new ms(this.vm,{width:this.vm.isVertical()?215:129,height:this.vm.isVertical()?48:32}),this.actionButton.style={bottom:0,position:"absolute"},this.containerView.appendChild(this.actionButton)}updateFakePlayDuration(t){super.updateFakePlayDuration(t),this.actionButton.handlePlayTime(1e3*t)}setupSlideView(){if(!this.vm.enableSlideAction())return;this.slideView=new TKView,this.slideView.style={position:"absolute",width:273,height:279,top:16,flexDirection:"column-reverse",alignItems:"center"},this.appendChild(this.slideView);let t=new TKText;t.style={position:"absolute",height:17,fontSize:12,fontWeight:"500",textLineHeightClamp:17,color:"#FFFFFF"},t.setText("轻滑试试"),this.slideView.appendChild(t),Ut.supportMinimumTKVersion("5.0.0")&&(this.slideLottie=new TKLottieImageView,this.slideLottie.style={position:"absolute",width:72,height:186},this.slideView.appendChild(this.slideLottie),this.slideLottie.setUri("https://p1-lm.adukwai.com/kos/nlav111362/ksad/lottie_ver_slide.json"),this.playLottieAnimation())}playLottieAnimation(){this.slideLottie.setLoop(!0),this.slideLottie.play()}}class Cs extends TKView{constructor(t,e){super(),this.vm=t,this.setupView()}setupView(){if(this.vm.isECCardStyle())Yt.log("init KSAdInterstitialECCardView"),this.industryCustomCardView=new gs(this.vm);else if(this.vm.isWebStyle())Yt.log("init KSAdInterstitialWebViewCardView"),this.webViewCardView=new ts(this.vm);else if(this.vm.callerContext.isSpecialShapeStyle())this.vm.callerContext.isSpecialShapeFirstStyle()?(Yt.log("init KSAdInterstitialSpecialShapeFirstCardView"),this.specialShapeCardView=new $n(this.vm)):(Yt.log("init KSAdInterstitialSpecialShapeSecondCardView"),this.specialShapeCardView=new Qn(this.vm));else if(this.vm.callerContext.isIndustryCustomStyle())this.vm.callerContext.isRedPacketStyle()?(Yt.log("init KSAdInterstitialRedPacketCardView"),this.industryCustomCardView=new jn(this.vm)):(Yt.log("init KSAdInterstitialGiftCardView"),this.industryCustomCardView=new Gn(this.vm));else if(this.vm.isRotateAndSlideStyle())Yt.log("init KSAdInterstitialBigCardView1"),this.bigInterstitialView=new Kn(this.vm);else if(this.vm.callerContext.enableShakeInteraction())this.vm.isVertical()?this.vm.isVerticalMaterial()?(Yt.log("init KSAdShakeScreenVerticalAndMaterialVertical"),this.interstitialShakeView=new os(this.vm)):this.vm.isPictureMaterial()?(Yt.log("init KSAdShakeScreenVerticalAndPicHorizontal"),this.interstitialShakeView=new ss(this.vm)):(Yt.log("init KSAdShakeScreenVerticalAndVideoHorizontal"),this.interstitialShakeView=new as(this.vm)):(Yt.log("init KSAdShakeScreenHorizontal"),this.interstitialShakeView=new hs(this.vm));else if(!this.vm.isVertical()||this.vm.isVerticalMaterial())Yt.log("init KSAdInterstitialBigCardView2"),this.bigInterstitialView=new Kn(this.vm);else try{switch(this.vm.getInterstitialStyle()){case 5:Yt.log("init KSAdNewStyleView5"),this.interstitialNewStyleView=new cs(this.vm);break;case 6:Yt.log("init KSAdNewStyleView6"),this.interstitialNewStyleView=new ps(this.vm);break;default:Yt.log("init KSAdInterstitialBigCardView3"),this.bigInterstitialView=new Kn(this.vm)}}catch(e){Yt.log("init KSAdInterstitialBigCardView4"),this.bigInterstitialView=new Kn(this.vm)}Yt.log("init play card done");const t=this;this.webViewCardView?(this.appendChild(this.webViewCardView),this.webViewCardView.showEndCardCallback=e=>{t.handleShowEndCardCallback(e)}):this.industryCustomCardView?(this.appendChild(this.industryCustomCardView),this.industryCustomCardView.showEndCardCallback=e=>{t.handleShowEndCardCallback(e)}):this.specialShapeCardView?(this.appendChild(this.specialShapeCardView),this.specialShapeCardView.showEndCardCallback=e=>{t.handleShowEndCardCallback(e)}):this.interstitialShakeView?(this.appendChild(this.interstitialShakeView),this.interstitialShakeView.showEndCardCallback=e=>{t.handleShowEndCardCallback(e)}):this.interstitialNewStyleView?(this.appendChild(this.interstitialNewStyleView),this.interstitialNewStyleView.showEndCardCallback=e=>{t.handleShowEndCardCallback(e)}):(this.appendChild(this.bigInterstitialView),this.bigInterstitialView.showEndCardCallback=e=>{t.handleShowEndCardCallback(e)}),Yt.log("append play card done"),Bn.shareHelper(this.vm).startDynamicEffectIfNeed(this),Yt.log("play card start dynamic effect")}handleShowEndCardCallback(t){this.showEndCardCallback&&this.showEndCardCallback(t)}}class fs extends TKView{constructor(t,e=2){super(),this.vm=t,this.interactiveStyle=e,this.setupView(),this.setupAction();const i=this;ze(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"pageVisiable":i.startInteractionAnimation();break;case"pageInvisiable":i.stopInteractionAnimation()}}))}setupView(){const t=40;this.style={width:t,height:t,borderRadius:20,borderColor:"#FFFFFF",borderWidth:1,backgroundColor:"#30303099",justifyContent:"center",alignItems:"center"},2==this.interactiveStyle?(this.shakeAnimationView=new TKView,this.shakeAnimationView.style={position:"absolute",top:7,left:7,width:56,height:56},this.appendChild(this.shakeAnimationView),this.shakeImage=new TKImage,this.shakeImage.style={width:28,height:28},this.shakeImage.setSrc("image/ksad-interstitial-card/ic_shake.png"),this.shakeAnimationView.appendChild(this.shakeImage)):(this.rotateArrowImage=new TKImage,this.rotateArrowImage.style={position:"absolute",top:6,left:6,width:28,height:28},this.rotateArrowImage.setSrc("image/ksad-interstitial-card/ic_rotate_arrow.png"),this.appendChild(this.rotateArrowImage),this.rotatePhoneImage=new TKImage,this.rotatePhoneImage.style={position:"absolute",top:6,left:6,width:28,height:28},this.rotatePhoneImage.setSrc("image/ksad-interstitial-card/ic_rotate_phone.png"),this.appendChild(this.rotatePhoneImage)),this.touchView=new TKView,this.touchView.style={width:"100%",height:"100%"},this.appendChild(this.touchView)}setupAction(){const t=2==this.interactiveStyle?ae.SHAKE_BIG_ICON_CLICK:ae.CARD_BLANK_AREA_CLICK;if(this.vm.getShakeClickEnable()){const e=this;this.touchView.addEventListener("tap",(i=>{const n=Et(i,e.touchView);e.vm.callerContext.clickAd(2,n,1,t)}))}}startInteractionAnimation(){this.stopInteractionAnimation(),2==this.interactiveStyle?this.addShakeAnim():this.addRotateAnim();const t=this;this.interactionAnimationTimer=setInterval((()=>{2==t.interactiveStyle?t.addShakeAnim():t.addRotateAnim()}),2==this.interactiveStyle?1200:2380)}addShakeAnim(){const t=new TKKeyframeAnimation;t.animType="rotationZ";let e=Ut.isAndroid()?.8:1;t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-Ut.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:Ut.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}],t.duration=1200,t.repeatCount=0,this.shakeAnimationView&&this.shakeAnimationView.addAnimation(t,"shakeAnimation")}addRotateAnim(){if(!this.rotatePhoneImage)return;const t=new TKKeyframeAnimation,e=this;t.setAnimations([()=>(e.rotatePhoneImage.style={transform:{rotate:-23}},.4),()=>(e.rotatePhoneImage.style={transform:{rotate:20}},.8),()=>(e.rotatePhoneImage.style={transform:{rotate:-10}},.9),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},1)]),t.duration=1080,t.timingFunction="linear",setTimeout((()=>{this.rotatePhoneImage.addAnimation(t,"rotateAnimation")}),1300)}stopInteractionAnimation(){this.interactionAnimationTimer&&(clearInterval(this.interactionAnimationTimer),this.interactionAnimationTimer=0),this.shakeAnimationView&&this.shakeAnimationView.removeAllAnimation(),this.rotatePhoneImage&&this.rotatePhoneImage.removeAllAnimation()}}class vs extends TKView{constructor(t){super(),this.vm=t,this.isVertical=0==this.vm.screenOrientation.screenOrientation,this.isVertical?this.elementMarginBottom=16:this.vm.callerContext.enableShakeInteraction()?this.elementMarginBottom=Ut.isAndroid()?10:12:this.elementMarginBottom=Ut.isAndroid()?12:16,this.setupView(),this.setupAction(),this.sendLog()}setupView(){var t;let e=this.isVertical?50:70;this.style={flexDirection:"column-reverse",alignItems:"center",paddingLeft:e,paddingRight:e,opacity:0};const i=new TKKeyframeAnimation;var n;let s;i.setAnimations([()=>(this.style={opacity:1},1)]),i.duration=500,i.timingFunction="EaseInEaseOut",this.addAnimation(i,"animation"),this.throughHitTest=!0,this.logoView=new ai(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:8,bottom:8},this.logoView.enabled=!1,this.appendChild(this.logoView),n=this.isVertical?{width:160,height:48}:{width:120,height:42},this.actionBtn=new en(this.vm.actionButtonViewModel,n.height,16,!1),s=this.isVertical?56:this.vm.callerContext.enableShakeInteraction()?Ut.isAndroid()?15:38:Ut.isAndroid()?25:38,this.actionBtn.style={marginBottom:s,width:n.width,height:n.height},this.appendChild(this.actionBtn),this.sloganText=new TKText,this.sloganText.style={color:"#222222",fontSize:14,textOverflow:"ellipsis",textLineClamp:2,textAlign:"center",marginBottom:this.elementMarginBottom},this.sloganText.setText(null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.displayName),this.appendChild(this.sloganText),this.topContainer=new TKView,this.topContainer.style={alignItems:"center",marginBottom:this.elementMarginBottom-(Ut.isAndroid()?4:0)},this.appendChild(this.topContainer),this.appendDifferentElements()}appendDifferentElements(){var t;const e=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.showType;1==e?this.appendLowPriceElements():2==e?this.appendSeckillElements():3==e?this.appendHighSalesElements():4==e?this.appendCouponElements():5==e?this.appendRecommendationElements():this.appendOtherElements()}appendLowPriceElements(){var t;this.lowPriceIconImage=new TKImage,t=this.isVertical?{width:94,height:99}:{width:60,height:64},this.lowPriceIconImage.style={width:t.width,height:t.height,marginBottom:this.elementMarginBottom},Ht(this.lowPriceIconImage,"icon_ksad_ec_low_price.png"),this.topContainer.appendChild(this.lowPriceIconImage),this.lowPriceView=new un(this.vm.actionBarViewModel,26,30,15),this.topContainer.appendChild(this.lowPriceView)}appendSeckillElements(){var t,e,i,n,s;this.seckillIconImage=new TKImage,s=this.isVertical?{width:140,height:35}:{width:100,height:25},this.seckillIconImage.style={width:s.width,height:s.height,marginBottom:this.elementMarginBottom},Ht(this.seckillIconImage,"icon_ksad_ec_seckill.png"),this.topContainer.appendChild(this.seckillIconImage),this.seckillCountdownView=new wn(this.vm.actionBarViewModel),this.seckillCountdownView.style={height:14,marginBottom:this.elementMarginBottom},this.seckillCountdownView.updateSeckillCountdown((t=>{})),this.topContainer.appendChild(this.seckillCountdownView),this.seckillCountdownTimer=setInterval((()=>{this.seckillCountdownView.updateSeckillCountdown((t=>{t&&clearInterval(this.seckillCountdownTimer)}))}),1200),this.seckillProgressBar=new dn,this.seckillProgressBar.style={backgroundColor:"#FE366630",width:163,height:8,marginBottom:6},this.seckillProgressBar.setColor("#FE3666"),this.seckillProgressBar.setBorderRadius(4);const a=null===(e=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.seckillInfo)||void 0===e?void 0:e.soldStock,o=null===(n=null===(i=this.vm.callerContext.adProductInfo)||void 0===i?void 0:i.seckillInfo)||void 0===n?void 0:n.originalStock;let l=a/o;l>1&&(l=1),this.seckillProgressBar.setProgress(l),this.topContainer.appendChild(this.seckillProgressBar),this.seckillProgressText=new TKText,this.seckillProgressText.style={fontSize:10,color:"#9C9C9C",height:12},this.seckillProgressText.setText("已抢"+a+"/"+o+"件"),this.topContainer.appendChild(this.seckillProgressText)}appendHighSalesElements(){var t,e;this.salesText=new TKText,this.salesText.style={fontWeight:"medium",color:"#FE3666",fontSize:20,textLineClamp:2,textAlign:"center",minimumTextScaleFactor:.5,marginBottom:this.elementMarginBottom};let i=(null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.sales)?null===(e=this.vm.callerContext.adProductInfo)||void 0===e?void 0:e.sales:0;const n="人已下单，\n速来抢购";i>=1e4?this.salesText.setText((i/1e4).toFixed(1)+"万"+n):this.salesText.setText(""+i+n),this.topContainer.appendChild(this.salesText),this.userAvatarView=new gn(this.vm.actionBarViewModel,30,-10),this.userAvatarView.avatarCount<=0&&(this.salesText.style={marginBottom:0}),this.topContainer.appendChild(this.userAvatarView)}appendCouponElements(){var t,e;this.titleText=new TKText,this.titleText.style={fontWeight:"medium",color:"#FE3666",fontSize:20,textLineClamp:2,textAlign:"center",marginBottom:this.elementMarginBottom};let i=null===(e=null===(t=this.vm.callerContext.adProductInfo)||void 0===t?void 0:t.couponList)||void 0===e?void 0:e.length;i=i>2?2:i,i>0?this.titleText.setText("恭喜你\n获得"+i+"张优惠券"):(this.titleText.setText("恭喜你\n获得优惠券"),this.titleText.style={marginBottom:0}),this.topContainer.appendChild(this.titleText);this.couponView=new Cn(this.vm.actionBarViewModel,i,22,10,18,12),this.couponView.style={paddingLeft:10},this.topContainer.appendChild(this.couponView)}appendRecommendationElements(){this.titleText=new TKText,this.titleText.style={fontWeight:"medium",color:"#FE3666",fontSize:20,textLineClamp:2,textAlign:"center",marginBottom:this.elementMarginBottom},this.titleText.setText("恭喜你\n发现好物，手慢无~"),this.topContainer.appendChild(this.titleText),this.tagView=new fn(this.vm.actionBarViewModel,22,5,12),this.tagView.style={paddingLeft:8},this.tagView.hasTags||(this.titleText.style={marginBottom:0}),this.topContainer.appendChild(this.tagView),this.vm.enableFullScreenClick()&&this.tagView.addEventListener("tap",(t=>{const e=Et(t,this.tagView);this.vm.callerContext.clickAd(2,e,2,ae.CARD_RECOMMEND_REASON_CLICK)}))}appendOtherElements(){this.productNameText=new TKText,this.productNameText.style={fontWeight:"medium",color:"#222222",fontSize:20,height:26,textOverflow:"ellipsis",textLineClamp:1,textAlign:"center"},this.productNameText.setText(this.vm.callerContext.getProductName()),this.topContainer.appendChild(this.productNameText)}setupAction(){this.actionBtn&&this.actionBtn.addEventListener("tap",(t=>{const e=Et(t,this.actionBtn);this.vm.callerContext.clickAd(2,e,1,ae.PLAY_END_ACTION_BAR_CLICK)}))}sendLog(){if(!this.hasReportExpose){this.hasReportExpose=!0;let t=new r;t.template_show_type=this.vm.callerContext.getOrderAdNewStyleReportShowType();let e={clientExtData:JSON.stringify(t)},i={actionType:531,payload:JSON.stringify(e)};Xt.sendLog(i)}}}class ys extends TKView{constructor(t){super(),this.vm=t,this.isLiveAd=this.vm.callerContext.isLiveAd(),this.setupView(),this.setupData(),this.setupAction()}setupView(){this.style={width:"100%",height:"100%",alignItems:"center",flexDirection:"column-reverse"},this.throughHitTest=!0;let t=this.vm.isVertical()?101:30,e=160,i=48;this.actionButton=new en(this.vm.actionButtonViewModel,i,16,!1),this.actionButton.style={width:e,marginBottom:t,opacity:0},this.appendChild(this.actionButton);let n=this.vm.isVertical()?20:15,s=this.vm.isVertical()?38:82,a=Ut.isAndroid()?5:10;3!=R(this.vm.adInfo)&&(this.descriptionLabel=new TKText,this.descriptionLabel.style={fontSize:16,color:"#222222",textAlign:"center",textLineClamp:2,textOverflow:"ellipsis",marginBottom:n,marginLeft:s,marginRight:s,textLineSpace:a,opacity:0},this.appendChild(this.descriptionLabel));let o=this.vm.isVertical()?12:8;this.titleLabel=new TKText,this.titleLabel.style={fontSize:24,fontWeight:"bold",color:"#222222",textLineClamp:1,textOverflow:"ellipsis",marginLeft:s,marginRight:s,marginBottom:o,opacity:0,textAlign:"center"},this.appendChild(this.titleLabel),this.isLiveAd&&(this.avatarViewMarginBottom=5,this.avatarView=new nn(new sn(this.vm.callerContext),!0),this.avatarView.style={marginRight:6,marginBottom:this.avatarViewMarginBottom-30,opacity:0},this.appendChild(this.avatarView));let l=this.vm.isVertical()?120:60;this.iconImageMarginBottom=this.vm.isVertical()?12:8;let h=this.vm.isVertical()?24:12;this.iconImage=new TKImage,this.iconImage.style={width:l,height:l,borderRadius:h,marginBottom:this.iconImageMarginBottom-30,borderWidth:1,borderColor:"#EAEAEA",opacity:0,display:this.isLiveAd?"none":"flex"},this.appendChild(this.iconImage)}setupData(){if(B(this.vm.adInfo)){let t=R(this.vm.adInfo);3==t?(this.iconImage.setSrc(this.vm.adInfo.adProductInfo.icon),this.titleLabel.setText(this.vm.adInfo.adProductInfo.name)):2==t&&(this.iconImage.setSrc(this.vm.adInfo.advertiserInfo.portraitUrl),this.titleLabel.setText(this.vm.adInfo.advertiserInfo.rawUserName)),this.descriptionLabel&&this.descriptionLabel.setText(this.vm.adInfo.adBaseInfo.adDescription)}else this.iconImage.setSrc(M(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.titleLabel.setText(K(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.descriptionLabel&&this.descriptionLabel.setText(O(this.vm.callerContext.templateDataInfo,this.vm.adInfo)),this.actionButton&&Ne(this.actionButton.label,"text",this.vm.$attrsPath.callerContext.downloadText)}setupAction(){const t=this;this.actionButton&&this.actionButton.addEventListener("tap",(e=>{const i=Et(e,t.actionButton);t.vm.callerContext.clickAd(2,i,1,ae.PLAY_END_CALL_CLICK)})),this.vm.enableFullScreenClick()&&(this.iconImage.addEventListener("tap",(e=>{const i=Et(e,t.iconImage);t.vm.callerContext.clickAd(2,i,2,ae.PLAY_END_ICON_CLICK)})),this.titleLabel.addEventListener("tap",(e=>{const i=Et(e,t.titleLabel);t.vm.callerContext.clickAd(2,i,2,ae.PLAY_END_ICON_TITLE_CLICK)})),this.descriptionLabel&&this.descriptionLabel.addEventListener("tap",(e=>{const i=Et(e,t.descriptionLabel);t.vm.callerContext.clickAd(2,i,2,ae.PLAY_END_ICON_DESCRIPTION_CLICK)})))}startShowAnimation(){this.isLiveAd?this.addAvatarViewAnimation():this.addIconImageAnimation()}addAvatarViewAnimation(){const t=this.createIconShowAnimation(this.avatarView,this.avatarViewMarginBottom);this.avatarView.addAnimation(t,"avatarViewAnimation")}addIconImageAnimation(){const t=this.createIconShowAnimation(this.iconImage,this.iconImageMarginBottom);this.iconImage.addAnimation(t,"iconImageAnimation")}createIconShowAnimation(t,e){const i=this,n=new TKBasicAnimation;return n.setEndValue((()=>{t.style={marginBottom:e,opacity:1}})),n.duration=200,n.timingFunction="EaseInEaseOut",n.on("end",(()=>{i.iconImageAnimationCompletion&&i.iconImageAnimationCompletion(),i.addContentAnimation()})),n}addContentAnimation(){this.titleLabel&&this.titleLabel.addAnimation(this.createContentAnimation(this.titleLabel),"titleLabelAnimation"),this.actionButton&&this.actionButton.addAnimation(this.createContentAnimation(this.actionButton),"actionButtonAnimation"),this.descriptionLabel&&this.descriptionLabel.addAnimation(this.createContentAnimation(this.descriptionLabel),"descriptionLabelAnimation")}createContentAnimation(t){let e=new TKBasicAnimation;return e.setEndValue((()=>{t.style={opacity:1}})),e.duration=200,e.timingFunction="EaseInEaseOut",e}}class Vs extends TKView{constructor(t,e){super(),this.vm=t,this.autoCloseCountDown=e,B(this.vm.adInfo)&&this.vm.enableShowOrderAdNewStyle()&&(this.isECNewEndCard=!0),this.vm.enableFullScreenClick()&&!this.vm.isRotateAndSlideStyle()&&this.addEventListener("tap",(t=>{const e=this.isECNewEndCard?ae.PLAY_END_ACTION_BAR_CLICK:ae.CARD_BLANK_AREA_CLICK;this.vm.callerContext.clickAd(2,Et(t,this),2,e)})),this.setupView(),this.setupData()}setupView(){const t=this.vm.callerContext.interstitialContainerSize;if(this.containerSize={width:0,height:0},t.width>t.height)this.containerSize.width=t.width,this.containerSize.height=t.height;else{const e=.8,i=16/9;this.containerSize.width=t.width*e,this.containerSize.height=this.containerSize.width*i,this.containerSize.height>t.height&&(this.containerSize.height=t.height*e,this.containerSize.width=this.containerSize.height/i)}this.style={justifyContent:"flex-start",width:this.containerSize.width,height:this.containerSize.height,borderRadius:8},this.backgroundImage=new TKImage;const e=this.vm.getMaterialSize(),i=e.width<e.height;this.backgroundImage.style={width:"100%",height:!i&&this.vm.isVertical()?"60%":"100%",borderRadius:8},this.appendChild(this.backgroundImage);let n=this.vm.isVertical()?"90,FFFFFF 0.55, FFFFFF00 0.8":"90,FFFFFF 0.55, FFFFFF40 1";Ut.isAndroid()&&(n=this.vm.isVertical()?"90,FFFFFF 0.6, FFFFFF00 0.8":"90,FFFFFF 0.55, FFFFFF40 1"),this.containerView=new TKView,this.containerView.style={width:this.containerSize.width,height:this.containerSize.height,alignItems:"center",top:0,left:0,position:"absolute",gradientBgColor:n,flexDirection:"column-reverse",borderRadius:8},this.appendChild(this.containerView),this.vm.isRotateAndSlideStyle()&&(this.combineInteractionView=new Mi(this.vm.getSlideConvertDistance(),((t,e,i,n)=>{const s=i-t,a=n-e;Math.abs(s)>=Math.abs(a)?s>0?this.vm.handleSlideConvert(t,e,3,s):this.vm.handleSlideConvert(t,e,2,s):a>0?this.vm.handleSlideConvert(t,e,4,a):this.vm.handleSlideConvert(t,e,1,a)}),((t,e)=>{if(this.vm.enableFullScreenClick()){const i=this.isECNewEndCard?ae.PLAY_END_ACTION_BAR_CLICK:ae.CARD_BLANK_AREA_CLICK;this.vm.convert(2,{x:t,y:e},i)}})),this.combineInteractionView.style={width:"100%",height:"100%",bottom:0,position:"absolute"},this.containerView.appendChild(this.combineInteractionView));if(this.closeActionView=new on(this.vm.closeActionViewModel,!0,this.autoCloseCountDown),this.closeActionView.style={top:12,position:"absolute"},1==this.vm.callerContext.getCloseButtonPosition()?this.closeActionView.style={left:12}:this.closeActionView.style={right:12},this.appendChild(this.closeActionView),this.isECNewEndCard||(this.logoView=new ai(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:8,bottom:8,opacity:0},this.logoView.enabled=!1,this.appendChild(this.logoView)),this.vm.callerContext.enableShakeInteraction()||this.vm.isRotateAndSlideStyle()){const t=this.vm.callerContext.enableShakeInteraction()?2:1;this.interactionView=new fs(this.vm.shakeViewModel,t),this.interactionView.style={position:"absolute",top:46,right:10,opacity:this.isECNewEndCard?1:0},this.appendChild(this.interactionView)}if(this.vm.fullScreenClickTextViewModel.enableShowFullScreenClickText()){let t=new vn(this.vm.fullScreenClickTextViewModel,1,!0);t.style={right:7,bottom:6},this.appendChild(t)}this.isECNewEndCard?this.appendECNewEndCard():this.appendNewEndCard()}appendNewEndCard(){this.newEndCard=new ys(this.vm),this.containerView.insertBefore(this.newEndCard,this.containerView),this.newEndCard.iconImageAnimationCompletion=()=>{this.addContentAnimation()},setTimeout((()=>{this.newEndCard.startShowAnimation()}),200)}appendECNewEndCard(){this.ecNewEndCard=new vs(this.vm),this.ecNewEndCard.style={width:this.containerSize.width,height:this.containerSize.height},this.containerView.insertBefore(this.ecNewEndCard,this.containerView),this.interactionView&&this.interactionView.startInteractionAnimation()}setupData(){if(this.vm.isVideoMaterial()?this.backgroundImage.setSrc(b(this.vm.adInfo)):this.backgroundImage.setSrc(A(this.vm.adInfo)),this.vm.callerContext.isLiveAd()){let t=b(this.vm.adInfo);Dt(t)?this.backgroundImage.setSrc(t):this.backgroundImage.setBackgroundColor("#FFFFFFFF")}}addContentAnimation(){if(this.logoView&&this.logoView.addAnimation(this.createContentAnimation(this.logoView),"logoViewAnimation"),this.interactionView){let t=this.createContentAnimation(this.interactionView);t.on("end",(()=>{this.interactionView.startInteractionAnimation()})),this.interactionView.addAnimation(t,"interactionViewAnimation")}}createContentAnimation(t){let e=new TKBasicAnimation;return e.setEndValue((()=>{t.style={opacity:1}})),e.duration=200,e.timingFunction="EaseInEaseOut",e}}class Is extends TKView{constructor(t,e){super(),this.vm=t,this.autoCloseCountDown=e,this.setupView()}setupView(){this.style={justifyContent:"center",alignItems:"center"},this.newEndCardView=new Vs(this.vm,this.autoCloseCountDown),this.newEndCardView.style={transform:{scale:.8},opacity:0},this.appendChild(this.newEndCardView);let t=new TKBasicAnimation;t.setEndValue((()=>{this.newEndCardView.style={transform:{scale:1},opacity:1}})),t.duration=200,t.timingFunction="EaseInEaseOut",this.newEndCardView.addAnimation(t,"zoomInAnimation")}}class Ts extends be{constructor(t){super(),this.showHintView=-1,this.converted=!1,this.hintTimer=0,this.hintCount=0,this.hasDestoryHint=!1,this.vm=t,this.setupView(),this.bindSensorListener()}setupView(){Yt.log("interstitial setupview"),this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},this.setupPrivacyView(),this.setupLogoView(),this.setupPlayCard(),this.setupDynamicEffectView(),this.setupTopView(),this.setupDownloadPopup(),this.setupEndCard(),He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":this.handleBalloonCard();break;case"hideEnd":default:break;case"pageVisiable":this.setCreditBalloon();break;case"pageInvisiable":this.hideCreditBalloon()}})),ze(this.vm.$attrsPath.callerContext.adHasConvert,(t=>{t&&this.destoryCreditBalloon()}))}setupPlayCard(){const t=this;Yt.log("init play card"),this.playCardView=new Cs(this.vm),Yt.log("add play card"),this.appendChild(this.playCardView),this.playCardView.showEndCardCallback=e=>{t.handleShowEndCardCallback(t.playCardView,e)}}setupDynamicEffectView(){Bn.shareHelper(this.vm).appendDynamicEffectMaskViewIfNeeded(this,!0),Bn.shareHelper(this.vm).appendDynamicEffectGuideViewIfNeeded(this)}setupTopView(){this.vm.topViewModel.enableInitTopView()&&(this.interstitialTopFloorView=new Si(this.vm.topViewModel),this.appendChild(this.interstitialTopFloorView))}removeTopViewIfNeeded(){this.interstitialTopFloorView&&this.removeChild(this.interstitialTopFloorView)}setupDownloadPopup(){pt(this.vm.adInfo)&&(this.downloadPopup=new ti(this.vm.downloadPopupVM,this),0==this.vm.screenOrientation.screenOrientation?this.downloadPopup.setMarginTop(60):this.downloadPopup.setMarginTop(10))}bindSensorListener(){var t,e,i,n,s,a,o;try{(null===(s=null===(n=null===(i=null===(e=null===(t=this.vm.callerContext.adInfo.adMatrixInfo)||void 0===t?void 0:t.adDataV2)||void 0===e?void 0:e.interstitialCardInfo)||void 0===i?void 0:i.interactionInfo)||void 0===n?void 0:n.shakeInfo)||void 0===s?void 0:s.enable)&&(Ut.supportMinimumTKVersion("5.0.0")?He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.vm.startSensorListener();break;case"hideEnd":case"pageInvisiable":this.vm.stopSensorListener()}})):Xt.registerShakeListener((t=>{})))}catch(l){}try{Ut.supportMinimumTKVersion("5.0.0")&&(null===(o=null===(a=this.vm.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo)||void 0===a?void 0:a.rotateInfo)||void 0===o?void 0:o.enable)&&He(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.vm.startSensorListener();break;case"hideEnd":case"pageInvisiable":this.vm.stopSensorListener()}}))}catch(l){}}handleBalloonCard(){let t=st(this.vm.adInfo);if(null==t||0==(null==t?void 0:t.hintStyle)||this.converted||!this.vm.isVertical())return;let e=new di(t,this.vm.adInfo,{width:this.vm.containerLimit.width,height:this.vm.containerLimit.height});this.floatBalloonView=new li(e),this.floatBalloonView.style={width:this.vm.containerLimit.width,height:this.vm.containerLimit.height,position:"absolute",opacity:1},this.floatBalloonView.throughHitTest=!0,this.appendChild(this.floatBalloonView),this.hintView=new pi(e),this.hintView.style={position:"absolute",width:this.vm.containerLimit.width,height:this.vm.containerLimit.height,alignSelf:"center",justifyContent:"center",alignItems:"center",bottom:0,top:0,left:0,opacity:0,backgroundColor:2==(null==t?void 0:t.hintStyle)?"#0000004D":void 0},this.hintView.throughHitTest=!0,this.hintView.setVisibility("hidden"),this.appendChild(this.hintView),this.hintView.bindClickListener((()=>{this.floatBalloonView.isShowPopView()||-1==this.showHintView||(this.reportCreditHintClick(6),this.boomCreditBalloon(t))}))}hideCreditBalloon(){null!=this.floatBalloonView&&this.floatBalloonView.isShowPopView()&&this.removeChild(this.floatBalloonView),this.hintTimer&&clearInterval(this.hintTimer)}setCreditBalloon(){let t=st(this.vm.adInfo);null==t||0==(null==t?void 0:t.hintStyle)||this.converted||!this.vm.isVertical()||null!=this.floatBalloonView&&this.floatBalloonView.isShowPopView()||(this.vm.callerContext.isShowingCreditBalloonHint=0!=(null==t?void 0:t.hintStyle),-1!=t.autoTriggerDelayTime?1!=this.showHintView?this.hintTimer=setInterval((()=>{if(this.converted||1==this.showHintView||this.hasDestoryHint)return clearInterval(this.hintTimer),void(this.hintCount=0);1e3*++this.hintCount>t.hintDelayTime&&(clearInterval(this.hintTimer),this.hintView.setVisibility("visible"),this.hintTimer=0,this.hintCount=0,this.showHintView=1,this.showHintViewAnimation(),this.hintTimer=setInterval((()=>{if(this.converted||this.floatBalloonView.isShowPopView())return clearInterval(this.hintTimer),this.hintTimer=0,void(this.hintCount=0);this.hintCount++,this.hintView.updateHintText(),100*this.hintCount>t.autoTriggerDelayTime+400&&(clearInterval(this.hintTimer),this.reportCreditHintClick(8),this.boomCreditBalloon(t))}),100))}),1e3):this.hintTimer=setInterval((()=>{if(this.converted||this.hasDestoryHint)return clearInterval(this.hintTimer),this.hintTimer=0,void(this.hintCount=0);this.hintCount++,this.hintView.updateHintText(),100*this.hintCount>t.autoTriggerDelayTime+400&&(clearInterval(this.hintTimer),this.reportCreditHintClick(8),this.boomCreditBalloon(t))}),100):1!=this.showHintView&&(this.hintTimer=setInterval((()=>{if(this.converted||1==this.showHintView||this.hasDestoryHint)return clearInterval(this.hintTimer),void(this.hintCount=0);1e3*++this.hintCount>t.hintDelayTime&&(clearInterval(this.hintTimer),this.hintView.setVisibility("visible"),this.hintTimer=0,this.showHintViewAnimation(),this.hintCount=0,this.showHintView=1)}),1e3)))}showHintViewAnimation(){let t=st(this.vm.adInfo);if(!(null==t||0==(null==t?void 0:t.hintStyle)||this.converted||!this.vm.isVertical()||null!=this.floatBalloonView&&this.floatBalloonView.isShowPopView())){if(1==t.hintStyle){let t=new Ge(1,130),e=new Je(0,-53,400);Qe.bindAnimation([t],this.hintView,"hintViewAppear"),Qe.bindAnimation([e],this.hintView.creditContainer,"hintViewHintViewAppear"),this.adjustContentView(new Xe(.9,.9,200),new Ge(0,500))}else if(2==t.hintStyle){let t=new Ge(1,130),e=new Xe(0,0,0),i=new Xe(1,1,400);Qe.bindAnimation([t],this.hintView,"hintViewAppear"),Qe.bindAnimation([e,i],this.hintView.creditView,"hintViewCreditViewAppear")}this.hintView.reportCreditHintImpress(),this.hintView.playAnimation(),this.hintView.setVisibility("visible")}}destoryCreditBalloon(){this.hasDestoryHint=!0,this.hintView&&(this.disappearHintView(),this.removeChild(this.hintView)),this.hintTimer&&(clearInterval(this.hintTimer),this.hintTimer=0),this.floatBalloonView&&this.removeChild(this.floatBalloonView)}boomCreditBalloon(t){this.floatBalloonView.configBallowView(),this.disappearHintView(),t.creditsShowDuration=t.creditsShowDuration<5300?5300:t.creditsShowDuration,setTimeout((()=>{this.floatBalloonView.disapperBallowView()}),t.creditsShowDuration)}disappearHintView(){let t=st(this.vm.adInfo);if(null==t||0==(null==t?void 0:t.hintStyle)||this.converted||!this.vm.isVertical())return;const e=this;if(1==t.hintStyle){this.adjustContentView(new Xe(1,1,200),new Ge(1,500));let t=new Ge(1,150),i=new Ge(0,550),n=new Je(0,0,100),s=new Je(0,50,500);Qe.bindAnimation([t,i,n,s],this.hintView,"hintViewDisapper",(t=>{"end"==t&&e.hintView.setVisibility("hidden")}))}else if(2==t.hintStyle){let t=new Ge(1,150),i=new Ge(0,550);Qe.bindAnimation([t,i],this.hintView,"hintViewDisapper",(t=>{"end"==t&&e.hintView.setVisibility("hidden")}))}this.vm.callerContext.isShowingCreditBalloonHint=!1}adjustContentView(t,e){null!=this.newEndCardComponent?Qe.bindAnimation([t],this.newEndCardComponent,"newEndCardComponent"):(this.playCardView&&Qe.bindAnimation([t],this.playCardView,"playCardView"),Qe.bindAnimation([e],this.privacyMaskView,"privacyMaskView"))}reportCreditHintClick(t){let e={elementType:222,triggerType:t},i={actionType:141,payload:JSON.stringify(e)};Xt.sendLog(i)}setupPrivacyView(){this.privacyMaskView=new TKView;const t=this.vm.isVertical()&&this.vm.showPrivacy?"90, #00000080, #00000000":"90, #00000000, #00000000";if(this.privacyMaskView.style={width:"100%",height:80,left:0,bottom:0,position:"absolute",gradientBgColor:t,flexDirection:"column-reverse"},this.appendChild(this.privacyMaskView),!this.vm.showPrivacy)return;let e=this.vm.containerLimit.width-42;this.vm.isVertical()?(this.privacyView=new oi(this.vm.adInfo,this.vm.screenOrientation.screenOrientation,e,"#00000000","#8D8D8D"),this.privacyView.style={marginLeft:6,marginRight:6,marginBottom:-2},this.privacyMaskView.appendChild(this.privacyView)):(this.privacyView=new oi(this.vm.adInfo,this.vm.screenOrientation.screenOrientation),this.privacyView.style={left:12,top:8,position:"absolute",width:134},this.appendChild(this.privacyView)),this.privacyView.clickCallback=(t,e)=>{Xt.openURL(t,e)}}setupLogoView(){(this.vm.callerContext.isSpecialShapeFirstStyle()||this.vm.callerContext.isIndustryCustomStyle())&&(this.logoView=new ai(3,this.vm.adInfo),this.logoView.style={right:16,bottom:this.vm.showPrivacy?43:8,position:"absolute"},this.logoView.enabled=!1,this.privacyMaskView.appendChild(this.logoView))}setupEndCard(){const t=this;this.vm.showExitPopupCallback=()=>{t.showExitPopup()}}handleShowEndCardCallback(t,e){var i;ne(1);try{if(this.logoView){const t=si(this.logoView,500,!0);this.logoView.addAnimation(t,"logoViewHideAnimation")}Bn.shareHelper(this.vm).removeDynamicEffectMaskViewIfNeeded(),this.autoCloseCountDown=e,null===(i=this.vm.autoViewModel)||void 0===i||i.closeAutoCall(),this.prepareShowEndCard(t),this.removeTopViewIfNeeded()}catch(n){ne(3,xt(n))}}prepareShowEndCard(t){this.executeZoomAnimation(t)}showEndCard(){try{if(this.newEndCardComponent=new Is(this.vm,this.autoCloseCountDown),this.newEndCardComponent.style={width:this.vm.containerLimit.width,height:this.vm.containerLimit.height,position:"absolute"},null!=this.floatBalloonView){let t=st(this.vm.adInfo);if(!this.floatBalloonView.isShowPopView()&&1==this.showHintView&&!this.hasDestoryHint&&null!=t&&1==(null==t?void 0:t.hintStyle)){let t=new Xe(.9,.9,0);Qe.bindAnimation([t],this.newEndCardComponent,"newEndCardComponent")}this.insertBefore(this.newEndCardComponent,this.floatBalloonView)}else this.appendChild(this.newEndCardComponent);null!=this.downloadPopup&&this.downloadPopup.isShow&&(this.newEndCardComponent&&this.removeChild(this.newEndCardComponent),this.insertBefore(this.newEndCardComponent,this.downloadPopup)),ne(2)}catch(t){ne(3,xt(t))}}executeZoomAnimation(t){try{let e=new TKBasicAnimation;e.setEndValue((()=>{t.style={transform:{scale:.6},opacity:0}})),e.duration=100,e.timingFunction="ease-in-out";const i=this;setTimeout((()=>{i.showEndCard(),t.setVisibility("hidden")}),100),t.addAnimation(e,"zoomAnimation")}catch(e){ne(3,xt(e))}}showExitPopup(){const t=this;this.exitPopupView=new Li(this.vm.exitPopupViewModel),this.exitPopupView.dismissCallback=e=>{t.removeChild(this.exitPopupView),e?t.vm.callerContext.closeAd():t.vm.closeExitPopup()},this.appendChild(this.exitPopupView)}}class Ss{constructor(){this.downloadStats=0,this.downloadProgress=-1,this.totalBytes=0}static newInstance(t,e,i){let n=new Ss;return n.downloadStats=t,n.downloadProgress=e,n.totalBytes=i,n}obtainActionButtonText(t){let e,i=mt(t);switch(this.downloadStats){case 0:case 1:case 4:e=t.adBaseInfo.adActionDescription;break;case 2:e=i?"暂停":`${(100*this.downloadProgress).toFixed(0)}%`;break;case 3:e="继续下载";break;case 5:e=Dt(t.adBaseInfo.installAppLabel)?t.adBaseInfo.installAppLabel:"点击安装";break;case 6:e=Dt(t.adBaseInfo.openAppLabel)?t.adBaseInfo.openAppLabel:"立即打开"}return e}getProgress(){return this.downloadProgress}getDownloadState(){return this.downloadStats}getTotalBytes(){return this.totalBytes}isDownloadFinish(){return 5==this.downloadStats||6==this.downloadStats}isDownloading(){return 2==this.downloadStats}}class bs{constructor(t,e,i,n,s,a){this.lifeStatus="none",this.adInfo=t,this.adStyle=e,this.configInfo=i,this.containerLimit=n,this.screenOrientation=s,this.originContainerLimit=a}getOriginWidth(){return this.originContainerLimit?this.originContainerLimit.width:0}isCurvedScreen(){return this.containerLimit.width/this.containerLimit.height<1.8}getOriginHeight(){return this.originContainerLimit?this.originContainerLimit.height:0}}class As extends bs{constructor(t,e,i,n,s){super(t,e,i,n,s),this.templateDataInfo=null,this.expParam=null,this.adProductInfo=null,this.interstitialContainerSize={width:0,height:0},this.adDefaultMaterialSize={width:0,height:0},this.adDefaultMaterialType=0,this.adDefaultMaterialVideoDuration=0,this.playDuration=0,this.isClosing=!1,this.countdownTimerType=0,this.enableShowAutoCall=!1,this.hasVideoPlayer=!1,this.hasLivePlayer=!1,this.hasReportUIError=!1,this.playerLoadState=0,this.contentLoadState=0,this.adHasConvert=!1,this.downloadText="",this.combineDownloadText="",this.countdownTime=0,this.clickCloseButton=!1,this.showPecCouponView=!1,this.autocallHasConverted=!1,this.controlVideoPlayerStatus="unknown",this.controlLivePlayerStatus="unknown",this.isShowingCreditBalloonHint=!1,this.controlInteractiveElementHide=!1,this.templateDataInfo=F(this.adInfo),this.expParam=I(this.adInfo),this.adProductInfo=function(t){let e;try{return e=t.adProductInfo,e}catch(i){}return null}(this.adInfo),this.adDefaultMaterialSize=x(this.adInfo),this.adDefaultMaterialType=S(this.adInfo),this.adDefaultMaterialVideoDuration=k(this.adInfo)}isVertical(){return 0==this.screenOrientation}isVerticalMaterial(){return this.adDefaultMaterialSize.width<this.adDefaultMaterialSize.height}enableFullScreenClick(){return 1==this.configInfo.appConfig.interstitialAdFullClick}isVideoMaterial(){return 1==this.adDefaultMaterialType}isPictureMaterial(){return 2==this.adDefaultMaterialType}getSkipButtonPosition(){return this.templateDataInfo.skipButtonPosition}getCloseButtonPosition(){return this.templateDataInfo.closeButtonPosition}getInterstitialStyleNew(){let t;try{t=this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interstitialStyle}catch(e){}return t=Ft(t)?0:t,t}isRotateAndSlideStyle(){try{return 10==this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.interactiveStyle}catch(t){}return!1}enableShakeInteraction(){var t,e,i,n,s;return 2==(null===(s=null===(n=null===(i=null===(e=null===(t=this.adInfo)||void 0===t?void 0:t.adMatrixInfo)||void 0===e?void 0:e.adDataV2)||void 0===i?void 0:i.interstitialCardInfo)||void 0===n?void 0:n.interactionInfo)||void 0===s?void 0:s.interactiveStyle)}isSpecialShapeStyle(){return 7==this.getInterstitialStyleNew()||8==this.getInterstitialStyleNew()}isSpecialShapeFirstStyle(){return 7==this.getInterstitialStyleNew()}isSpecialShapeAndRoatateAndSlideStyle(){return 8==this.getInterstitialStyleNew()&&this.isRotateAndSlideStyle()}isECCardStyle(){return 11==this.getInterstitialStyleNew()}isIndustryCustomStyle(){return this.isRedPacketStyle()||this.isGiftStyle()}isRedPacketStyle(){return 9==this.getInterstitialStyleNew()}isGiftStyle(){return 10==this.getInterstitialStyleNew()}isLiveAd(){return f.isOriginLiveAd(this.adInfo)}enableShowOrderAdNewStyle(){return!!(P(this.adInfo)&&this.adProductInfo&&this.configInfo.abConfig.interstitialOrderNewStyleSwitch)}isValidPlayable(){if(!Dt(this.adInfo.adConversionInfo.playableUrl))return!1;let t=this.adInfo.adConversionInfo.playableStyleInfo.playableOrientation;return!(0==this.screenOrientation&&2==t||1==this.screenOrientation&&1==t)}getPlayableCountDown(){let t=this.configInfo.appConfig.interstitialPlayableTime;this.isVideoMaterial()?t=0==t?this.adDefaultMaterialVideoDuration:Math.min(t,this.adDefaultMaterialVideoDuration):(0==t||t>60)&&(t=60);let e=this.getAutoCloseCountDown();return e>0&&(t=Math.min(t,e)),t}getAutoCloseCountDown(){let t=0;try{t=this.adInfo.adInsertScreenInfo.autoCloseTime}catch(e){}return this.isVideoMaterial()&&(t=Math.min(t,this.adDefaultMaterialVideoDuration)),t}getProductName(){return this.adInfo.adBaseInfo.productName}closeAd(t=!1){q(this.adInfo)&&Te.reportLivePlaySecond(this.playDuration/1e3),Xt.closePassData({closeType:t?2:1,playDuration:this.playDuration})}notifyUIErrorReport(){if(!(this.hasReportUIError||(this.isVideoMaterial()||this.isLiveAd())&&(0==this.playerLoadState||0==this.contentLoadState)||this.isPictureMaterial()&&0==this.contentLoadState)){this.hasReportUIError=!0;try{let t=JSON.stringify({interstitialAdLoadProcessChange:this.configInfo.abConfig.interstitialAdLoadProcessChange});if(this.isVideoMaterial()||this.isLiveAd()){let e=this.isVideoMaterial()?1:3;2==this.playerLoadState&&(2==this.contentLoadState?Qt(e,2,t):Qt(e,1,t))}else 2==this.contentLoadState&&Qt(2,3,t)}catch(t){}}}clickAd(t,e,i,n){let s={photoSizeStyle:this.getReportPhotoSizeStyle()},a=new r;this.enableShowOrderAdNewStyle()&&(a.template_show_type=this.getOrderAdNewStyleReportShowType()),a.interstitial_style=this.getInterstitialStyleNew(),Te.convertIfNeeded(t,this.adInfo,i,e,n,a,s)}getReportPhotoSizeStyle(){return this.isVertical()?he.vertical:he.horizontal}getOrderAdNewStyleReportShowType(){return"insert_screen"+this.adProductInfo.showType}getCombineStyleRotateTitle(){try{return this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.rotateInfo.title}catch(t){}return""}getCombineStyleSlideTitle(){let t="";try{t=this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.slideInfo.title}catch(e){}return Dt(t)?t:"滑一滑"}notifySensorUpdate(t,e,i){this.sensorUpdateCallback&&this.sensorUpdateCallback(t,e,i)}}class xs extends hi{constructor(t,e,i,n,s){if(super(),this.lifeStatus="none",this.styleDataInfo=void 0,this.slotId=-1,this.componentData=void 0,this.needShowFlag=!0,this.cardTopMargin=0,this.cardBottomMargin=0,this.adInfo=t,this.adStyle=e,this.configInfo=i,this.styleType=n,s&&(this.slotId=s),u(this.adInfo)){let t=w(this.adInfo,"auto-call-app",this.slotId);t&&(this.styleDataInfo=g(t),this.componentData=t)}else this.styleDataInfo=G(this.adInfo,this.styleType);this.adDefaultMaterialType=S(this.adInfo)}isValidSDKVersion(){return!!Ut.supportMinimumTKVersion("4.0.6")}isValidCardInfo(){return null!=this.styleDataInfo}shouldShowAutoCallAppCard(t=void 0){this.isValidCardInfo()?t&&t(!0):t&&t(!1)}setConverted(t){this.convertNotify&&this.convertNotify(t)}closeAutoCall(){this.closeAutoCallCallback&&this.closeAutoCallCallback()}enableShowAutoCallOnInInterstitial(){return!!(this.isValidSDKVersion()&&this.needShowFlag&&this.isValidCardInfo())}updateLifeStatus(t){this.lifeStatus=t}}var ks;!function(t){t[t.SHOW_WHEN_PAUSE=1]="SHOW_WHEN_PAUSE",t[t.SHOW_WHEN_STATE_SWITCH=2]="SHOW_WHEN_STATE_SWITCH"}(ks||(ks={}));class Ls extends hi{constructor(t,e,i,n){super(),this.downloadState=0,this.descText="",this.showPopupView=!1,this.showControlStrategy=null,this.adInfo=t,this.adStyle=e,this.configInfo=i,this.screenOrientation=n;let s=mt(this.adInfo);this.needDownloadingState=!!s&&(3!=e&&2!=e&&1!=e)}onCloseClick(){this.showControlStrategy=ks.SHOW_WHEN_PAUSE,mt(this.adInfo)?this.needDownloadingState?this.showControlStrategy=ks.SHOW_WHEN_STATE_SWITCH:this.showControlStrategy=ks.SHOW_WHEN_PAUSE:pt(this.adInfo)&&(this.showControlStrategy=ks.SHOW_WHEN_PAUSE)}pageVisibleChange(t){t&&this.updateState(this.downloadState)}updateDownloadProgress(t){1==t.getDownloadState()&&0==t.getProgress()&&(this.showPopupView=!1),t.getTotalBytes()>0&&(this.downloadProgress=t.getProgress(),this.updateDesc(t.getDownloadState(),t.getProgress()),this.updateState(t.getDownloadState()))}updateDesc(t,e){if(this.needDownloadingState){let i=3==t;this.descText=i?"继续下载应用":`下载中${(100*e).toFixed(0)}%`}else this.descText="继续下载应用"}updateState(t){if(0==t)return void(this.downloadState=t);let e=this.downloadState;if(this.downloadState=t,this.showControlStrategy)this.handleShowControlStrategy(e,this.downloadState);else switch(this.downloadState){case 0:case 1:case 4:case 6:break;case 2:this.needDownloadingState?this.showPopupView=!0:this.showPopupView=!1,3==e&&Xt.showToast(this.getContinueToast());break;case 3:this.needDownloadingState||(this.showPopupView=!0),Xt.showToast(this.getPauseToast());break;case 5:this.showPopupView=!1}}handleShowControlStrategy(t,e){this.showControlStrategy==ks.SHOW_WHEN_PAUSE?3==e&&(this.showPopupView=!0,this.showControlStrategy=null):this.showControlStrategy==ks.SHOW_WHEN_STATE_SWITCH&&(3==e&&2==t||2==e&&3==t)&&(this.showPopupView=!0,this.showControlStrategy=null)}isDownloadPaused(){return 3==this.downloadState}isNeedShowDownloading(){return this.needDownloadingState}convert(t,e,i,n,s=null,a){Te.convertIfNeeded(t,this.adInfo,e,i,n,s,a)}getDesText(){return this.descText}getContinueToast(){return"继续下载中"}getDeleteToast(){return"取消安装,已删除安装包"}getPauseToast(){return"已暂停下载"}}class _s extends hi{constructor(t,e,i,n,s){super(),this.lifeStatus="none",this.adInfo=t,this.adStyle=e,this.configInfo=i,this.containerLimit=n,this.screenOrientation=s}updateLifeStatus(t){this.lifeStatus=t}isVertical(){return 0==this.screenOrientation}getLiveButtonTitle(){return Ft(this.adInfo.adBaseInfo.universeLiveGuideText)?"点击进入直播间":this.adInfo.adBaseInfo.universeLiveGuideText}}class Es extends hi{constructor(){super(...arguments),this.actionText="",this.downloadChangeEvent=new Ss,this.lifeStatus="none",this.hasExtraReward=!1,this.widthDp=0,this.slotId=-1,this.componentData=void 0}obtainScreenWidthDp(){return this.widthDp>0?this.widthDp:375}isScreenPortrait(){return 0==this.screenOrientation}checkDataValid(){return!!this.adInfo}getBottomBarStyle(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailWebCardInfo.style}catch(t){}return 0}getShortVideoFollowPlaycardStyle(){return this.configInfo.abConfig.shortVideoFollowRewardPlayStyle}isEcFollow(){return 3==E(this.adInfo)}getNeoActionBarCardType(){return 2==this.adStyle?f.getNeoActionBarCardType(this.adInfo):3==this.adStyle?f.getFullscreenActionBarCardType(this.adInfo):null}getActionBarStyle(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailWebCardInfo.cardType}catch(t){}return 0}getLightInteractionType(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailCommonInfo.rewardInteractionType}catch(t){}return 0}getLightInteractionShowTime(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailCommonInfo.rewardInteractionShowTime}catch(t){}return 2}getLightInteractionDuration(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailCommonInfo.rewardInteractionDuration}catch(t){}return 6}getAdAttributeType(){return this.adInfo.adBaseInfo.adAttributeType||0}isDownloadAd(){return 1==this.adInfo.adBaseInfo.adOperationType}getDownloadAppIcon(){let t;try{t=this.adInfo.adBaseInfo.appIconUrl}catch(e){}return Dt(t)||(t="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),t}getAdTitle(){var t;return z(this.adInfo)&&xe(null===(t=this.adInfo.adProductInfo)||void 0===t?void 0:t.name)?this.adInfo.adProductInfo.name:_(this.adInfo)}getAppScore(){return this.adInfo.adBaseInfo.appScore||0}getAppDownloadCountDesc(){return this.adInfo.adBaseInfo.appDownloadCountDesc||null}getAdDescription(){return this.adInfo.adBaseInfo.appDescription||this.adInfo.adBaseInfo.adDescription||null}getAdActionDesc(){return this.adInfo.adBaseInfo.adActionDescription||""}supportSlideClick(){var t;return(null===(t=this.adInfo.adMatrixInfo.adDataV2.dynamicAdStyleInfo)||void 0===t?void 0:t.slideClick)||!1}getAdIcon(){var t,e;return z(this.adInfo)&&Dt(null===(e=null===(t=this.adInfo)||void 0===t?void 0:t.adProductInfo)||void 0===e?void 0:e.icon)?this.adInfo.adProductInfo.icon:T(this.adInfo)}isVerticalMaterial(){let t=x(this.adInfo);return t.width<t.height}getMaterialSize(){return x(this.adInfo)}getVideoDuration(){return k(this.adInfo)}isAdForLive(){return Z(this.adInfo)}isAddLiveButton(){return 1==this.adInfo.adBaseInfo.universeLiveStyle}isShortLive(){return 6==E(this.adInfo)}isECOrderAd(){return function(t,e){if(z(e))return!1;let i=!1;try{i=1==t.abConfig.ecRewardAdKwaishopStyle}catch(n){return!1}return i&&P(e)}(this.configInfo,this.adInfo)}isLiveSubscribe(){return function(t){let e=null;try{e=t.adMatrixInfo.adDataV2.merchantLiveReservationInfo}catch(i){return!1}if(Ft(e))return!1;if(Ft(e.title)||Ft(e.liveStartTime)||Ft(e.bookUserCount))return!1;try{return 2==t.adStyleConfInfo.innerAdType}catch(i){return!1}}(this.adInfo)}isClickReward(){return function(t){try{let e=!0;const i=It();if(Ut.isAndroid()&&It()&&(e=i.sdkApiVersionCode>=3032401),t.adBaseInfo.extraClickReward&&e)return!0}catch(e){}return!1}(this.adInfo)}isCommercialProductStyle(){return z(this.adInfo)}getAdTagList(){try{const t=this.adInfo.adMatrixInfo.adDataV2.dynamicAdStyleInfo.extraDisplayInfo.exposeTagInfoList;if(t.length>0)return t}catch(t){}return null}getPlayableStyle(){return tt(this.adInfo,this.adStyle,this.screenOrientation)}isHorizontalPlayable(){return 0!=this.getPlayableStyle()&&1==this.screenOrientation}convert(t,e,i,n,s=null,a,o){u(this.adInfo)&&this.componentData&&(s||(s=new r),s.component_module=C(this.adInfo,this.componentData)),Te.convertIfNeeded(t,this.adInfo,e,i,n,s,a,o)}getECOrderData(){return this.mCardModel||(this.mCardModel=Rs.newInstance(this.adInfo)),this.mCardModel}getDirectEcData(){return this.directEcCardModel||(this.directEcCardModel=Ps.newInstance(this.adInfo,this.configInfo)),this.directEcCardModel}getNormalModel(){return this.normalCardModel||(this.normalCardModel=Fs.newInstance(this.adInfo,this.configInfo.appConfig)),this.normalCardModel}getLiveSubscribeModel(){return null==this.liveSubscribeModel&&(this.liveSubscribeModel=Ms.newLiveSubscribeCarInstance(this.adInfo,this.componentData)),this.liveSubscribeModel}getCouponModel(){return this.couponCardModel||(null!=Bs.newInstance(this.adInfo,this.styleType,this.configInfo)?this.couponCardModel=Bs.newInstance(this.adInfo,this.styleType,this.configInfo):this.couponCardModel=new Bs),this.couponCardModel}getKSAdLiveButtonViewModel(){return this.adLiveButtonModel=new _s(this.adInfo,this.adStyle,this.configInfo,this.containerLimit,this.screenOrientation),this.adLiveButtonModel}getCouponBackImageUrl(){return"icon_ksad_video_coupon.png"}supportNewAnimation(){return Ut.supportMinimumTKVersion("4.0.0")}showPlayable(t){Te.clickElement(67),Xt.showPlayable(t)}isDiscountNewStyle(){let t=!1;try{t=1==this.adInfo.adProductInfo.discountStyle}catch(e){}return Ut.isAndroid()||Ut.supportMinimumTKVersion("4.0.3")||(t=!1),0==this.getDiscountType()&&(t=!1),t}isAutoChooseReward(){try{return 1==this.adInfo.adProductInfo.autoChoose}catch(t){}return!1}getAutoChooseRewardCountDown(){try{return this.configInfo.appConfig.interactiveStyleConfig.chooseRewardTime}catch(t){}return 20}getGuideChooseRewardCountDown(){try{return this.configInfo.appConfig.interactiveStyleConfig.superDiscountTime}catch(t){}return 60}getGuideChooseRewardRemainingTime(){try{return this.configInfo.appConfig.interactiveStyleConfig.transitReceiveTime}catch(t){}return 10}getDiscountType(){try{return this.adInfo.adProductInfo.discountType}catch(t){}return 0}enableShowGuidanceRedPacket(){return this.getVideoDuration()-this.getAutoChooseRewardCountDown()>=this.getGuideChooseRewardRemainingTime()}getDiscountInfos(){try{return this.adInfo.adProductInfo.fakeDiscountInfos}catch(t){}return[]}getRedPacketValueString(t){const e=this.getDiscountInfos();if(0==t){if(e.length>1)return e.length>2?e[2]:e[1]}else if(1==t){if(e.length>0)return e[0]}else if(2==t&&e.length>2)return e[1];return""}getRedPacketImageUrl(t,e){let i="";if(t){if(i=1==this.getDiscountType()?"icon_ksad_discounts_red_packet_open_coupon.png":"icon_ksad_discounts_red_packet_open.png",Ft(this.getRedPacketValueString(e)))return"icon_ksad_discounts_red_packet_open_surprise.png"}else i=1==e?"icon_ksad_discounts_red_packet_close_most.png":"icon_ksad_discounts_red_packet_close.png";return i}setStyleType(t){this.styleType=t}isValidBottomCouponCardInfo(){return null!=this.bottomCouponInfo}getCouponBottomBusinessType(){let t;try{t=null==this.bottomCouponInfo?0:this.bottomCouponInfo.businessType}catch(e){t=0}return t}getCouponBottomDuration(){let t;try{t=null==this.bottomCouponInfo?0:this.bottomCouponInfo.couponDuration}catch(e){t=0}return t}getCouponCardViewBg(){let t;try{t=null==this.bottomCouponInfo?"ksad_bottom_bar_coupon_bg.png":this.bottomCouponInfo.couponIcon}catch(e){t="ksad_bottom_bar_coupon_bg.png"}return Dt(t)||(t="ksad_bottom_bar_coupon_bg.png"),t}getCouponBottomPriceRMB(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.priceTag}catch(e){t=""}return Dt(t)||(t=""),t}getCouponBottomPrice(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.price}catch(e){t=""}return Dt(t)||(t=""),t}getCouponBottomTitle(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.title}catch(e){t=""}return Dt(t)||(t=""),t}getCouponBottomActionBtn(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.actionBarDesc}catch(e){t=""}return Dt(t)||(t=""),t}getProductShortTitle(){let t;try{t=this.adInfo.adProductInfo.shortTitle}catch(e){}return Dt(t)||(t=""),t}getProductSellingPoint(){let t;try{t=this.adInfo.adProductInfo.sellingPoint}catch(e){}return Dt(t)||(t="优惠好物 诚心推荐"),t}getDiscountFinalViewWidth(){return 0==this.screenOrientation?Tachikoma.env.deviceWidth:324}getRedPacketViewSize(t,e){let i=Tachikoma.env.deviceWidth-80;1!=t&&(i=0==this.screenOrientation?Tachikoma.env.deviceWidth-76-60:200);let n=i/3.15,s=1.15*n;return{width:1==e?s:n,height:1==e?s/.77:n/.77}}getDiscountNeoExtData(t){const e=this.getDiscountType();let i=new d;return 1==e?i.neoAwardType="union_coupon":2==e?i.neoAwardType="union_spike":3==e&&(i.neoAwardType="union_discount"),t&&t.length>0&&(i.neoAwardAmount=t.join(",")),i}getDiscountTemplateShowType(t){return 1==t?"neo_award_card_1":2==t?"neo_award_card_2":3==t?"neo_award_card_3":""}reportDiscountViewImpression(t){let e=new r;e.neo_ext_data=this.getDiscountNeoExtData(this.getDiscountInfos()),e.template_show_type=this.getDiscountTemplateShowType(t);let i,n={clientExtData:JSON.stringify(e)};1==t?i=929:2==t?i=930:3==t&&(i=931);let s={actionType:i,payload:JSON.stringify(n)};Xt.sendLog(s)}reportDiscountInitialViewClose(t){let e=new r;e.template_show_type=this.getDiscountTemplateShowType(t);let i={elementType:69,clientExtData:JSON.stringify(e)},n={actionType:141,payload:JSON.stringify(i)};Xt.sendLog(n)}getCouponTemplateShowType(t){return 1==t?"coupon_of_cash_equity":2==t?"coupon_of_no_cash_equity":""}reportEquityCardImpression(t){let e=new r;e.template_show_type=this.getCouponTemplateShowType(t);let i={elementType:16,clientExtData:JSON.stringify(e)},n={actionType:140,payload:JSON.stringify(i)};Xt.sendLog(n)}isDeepVideoStyle(){if(1==this.screenOrientation)return!1;if(Ft(this.deepVideoModel)&&(this.deepVideoModel=new Ks(this.adInfo)),Ft(this.deepVideoModel.deepVideoInfo)){try{let t;t=2==this.adStyle?this.adInfo.adMatrixInfo.adDataV2.neoTKInfo.templateId:this.adInfo.adMatrixInfo.adDataV2.fullScreenInfo.templateId;let e=ct(et(t,this.adInfo));if(!Ft(e)&&e.merchantPlayCardStyle>0)return this.deepVideoModel.deepVideoInfo=e,!0}catch(t){}return!1}return!0}isShowCardDynamicEffects(){return 2==this.adStyle?this.cardDynamicEffects=j(this.adInfo,12):3==this.adStyle&&(this.cardDynamicEffects=j(this.adInfo,3)),!Ft(this.cardDynamicEffects)&&!(2==this.cardDynamicEffects&&!Ut.supportMinimumTKVersion("6.0.0"))}getLiveCutRoomInfo(){return function(t,e){let i=W(e,3==t?3:12);try{let t=JSON.parse(i.data);return Ft(t)||Ft(t.neoLiveRoomInfoData)?null:t}catch(n){}return null}(this.adStyle,this.adInfo)}reportConductCardImpression(t){let e=new r;e.template_show_type=t;let i={elementType:19,clientExtData:JSON.stringify(e)},n={actionType:140,payload:JSON.stringify(i)};Xt.sendLog(n)}getDownloadCardTemplateShowType(){var t,e;return 1==(null===(t=this.downloadCardDataInfo)||void 0===t?void 0:t.style)?"white_download_card":2==(null===(e=this.downloadCardDataInfo)||void 0===e?void 0:e.style)?"black_download_card":void 0}isValidDownloadCardInfo(){return 2==this.adStyle?this.downloadCardDataInfo=Y(this.adInfo,12):3==this.adStyle&&(this.downloadCardDataInfo=Y(this.adInfo,3)),!(Ft(this.downloadCardDataInfo)||!Dt(this.getAppDownloadCountDesc()))}reportDownloadCardImpression(){let t=new r;t.template_show_type=this.getDownloadCardTemplateShowType(),this.isShowCardDynamicEffects()&&(t.dynamic_show_type=this.cardDynamicEffects);let e={elementType:19,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}reportOptimalCardImpression(){let t=new r;t.template_show_type=this.getOptimalCardShowType(),this.isShowCardDynamicEffects()&&(t.dynamic_show_type=this.cardDynamicEffects);let e={elementType:19,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}getOptimalCardShowType(){switch(this.getActionBarStyle()){case 1:return"basic_smallcard";case 2:return"gradient_card";case 4:return"immersion_bigcard";default:return""}}}class Ds{constructor(t){if(this.hour="0",this.minute="0",this.second="0",t>0){let e=t/1e3;this.hour=Math.floor(e/3600).toString(),e%=3600,this.minute=Math.floor(e/60).toString(),e%=60,this.second=Math.floor(e).toString()}}getFormattedHour(){return this.formatTime(this.hour)}getFormattedMinute(){return this.formatTime(this.minute)}getFormattedSecond(){return this.formatTime(this.second)}formatTime(t){return Ft(t)?"":t.length>1?t:"0"+t}}class Rs{static newInstance(t){let e,i=new Rs,n=t.adProductInfo,s=n.seckillInfo;return i.hasCounpon=!Mt(n.couponList),i.name=Ft(n.name)?"可爱的广告君":n.name,i.icon=n.icon,i.price=n.price,i.originalPrice=n.originPrice,Ft(s)||(i.spikeTimestamp=s.endTime,i.spikeSoldStock=s.soldStock,i.spikeOriginalStock=s.originalStock),i.hasSpike=i.spikeTimestamp>0,i.volume=n.volume,i.rating=n.rating,i.btnClickText="立即抢购",i.volume&&i.rating?i.volumeAndRating=i.volume+" | "+i.rating:i.volume?i.volumeAndRating=i.volume:i.rating&&(i.volumeAndRating=i.rating),i.adInfo=t,e=i.hasSpike&&i.hasCounpon?"spikeAndCoupon":i.hasSpike?"spike":i.hasCounpon?"coupon":"noSpikeAndNoCoupon",i.cardStyle=e,i}getSpikeTime(){let t=Date.parse((new Date).toString());return new Ds(this.spikeTimestamp-t)}getAdDesc(){let t;return t=this.hasSpike?"已抢"+this.spikeSoldStock+"/"+this.spikeOriginalStock+"件":Ft(this.rating)||Ft(this.volume)?Ft(this.rating)?Ft(this.volume)?"":this.volume:this.rating:this.volume+"·"+this.rating,t}getPricePrefix(){let t;return t=this.hasCounpon?"券后价":this.hasSpike?"秒杀价":"惊喜价",t}getHeaderIcon(){return this.hasCounpon?"icon_ksad_ec_order_coupon.png":"icon_ksad_ec_order_gift.png"}getHeaderTips(){return this.hasCounpon?"恭喜你，获取一张优惠券":"恭喜你发现好价，手慢无～"}getCardStyleLog(){let t;if(Ft(this.cardStyle))return t="5",t;switch(this.cardStyle){case"spikeAndCoupon":t="1";break;case"spike":t="2";break;case"coupon":t="3";break;case"noSpikeAndNoCoupon":t="4";break;default:t="5"}return t}}class Ps{static newInstance(t,e){let i=new Ps;i.cardStyle=0|e.appConfig.h5UrlNewStyle;let n=t.adProductInfo;if(i.hasCounpon=!Mt(n.couponList),i.hasCounpon){const t=n.couponList[0];i.couponTitle="￥ "+t.displayValue}if(i.name=Ft(n.name)?"可爱的广告君":n.name,i.icon=n.icon,i.price=Dt(n.price)?n.price:"惊喜价",i.originalPrice=n.originPrice,!Mt(n.couponList)){let t=n.couponList[0];i.spikeIntervalMs=1e3,i.spikeTimestamp=Dt(t.leftFetchTime)?Number(t.leftFetchTime):0}return i.hasSpike=i.spikeTimestamp>0&&2==i.cardStyle,i.volume=n.volume,i.rating=n.rating,i.btnClickText="立即抢购",i.volume&&i.rating?i.volumeAndRating=i.volume+" | "+i.rating:i.volume?i.volumeAndRating=i.volume:i.rating&&(i.volumeAndRating=i.rating),i.adInfo=t,i}getSpikeTime(){this.spikeTimestamp<0&&(this.spikeTimestamp=0);const t=new Ds(this.spikeTimestamp);return this.spikeTimestamp-=this.spikeIntervalMs,t}}class Bs{constructor(){this.cardStyle=0,this.delayTime=2}static newInstance(t,e,i){return function(t,e){let i=W(t,e);if(Ft(i)||Ft(i.data))return;let n=JSON.parse(i.data);return Ft(n.couponInfo)?void 0:(null==n.couponInfo.delayTime&&(n.couponInfo.delayTime=2),n.couponInfo)}(t,e)}}class Fs{bindBaseData(t){this.iconUrl=T(t),this.name=_(t),this.actionText=Q(t),this.desc=t.adBaseInfo.adDescription}static newInstance(t,e){let i=new Fs;return i.bindBaseData(t),i.extraActionText=e.rewardContentExtraRewardNotClickedDesc,Ft(i.extraActionText)&&(i.extraActionText="立即点击，可再得1份奖励"),i.extraActionTextClicked=e.rewardContentExtraRewardClickedDesc,Ft(i.extraActionTextClicked)&&(i.extraActionTextClicked="立即打开"),i}}class Ms extends Fs{static newLiveSubscribeCarInstance(t,e){let i=new Ms;if(u(t)&&e){let t=g(e);t&&(i.name=t.title,i.desc=t.liveStartTime,i.iconUrl=t.userHeadUrl,i.subscribeCount=this.formatCount(t.bookUserCount))}else{let e=t.adMatrixInfo.adDataV2.merchantLiveReservationInfo;e&&(i.name=e.title,i.desc=e.liveStartTime,i.iconUrl=e.userHeadUrl,i.subscribeCount=this.formatCount(e.bookUserCount))}return i}static formatCount(t){let e="";if(t>=50&&t<1e4)e=t.toFixed(2);else if(t>=1e4){e=(t/1e4).toFixed(1)+"万"}return e}}class Ks{constructor(t){this.deepVideoInfo=void 0,this.adInfo=t}getDeepVideCardStyle(){return this.deepVideoInfo.merchantPlayCardStyle}getDeepVideoTransformTime(){try{if(this.deepVideoInfo.showNewStyleDelaySeconds>0)return this.deepVideoInfo.showNewStyleDelaySeconds}catch(t){}return 5}getDeepVideoGoodsIcon(){return Dt(this.deepVideoInfo.icon)?this.deepVideoInfo.icon:T(this.adInfo)}getDeepVideoGoodsIconlabel(){return this.deepVideoInfo.iconLabel}getDeepVideoGoodsTitle(){return this.deepVideoInfo.itemTitle}getDeepVideoAuthorName(){return this.deepVideoInfo.authorName}isDeepVideoShowLowPrice(){var t;return null!==(t=this.deepVideoInfo.showLowPrice)&&void 0!==t&&t}getDeepVideoPrice(){return this.deepVideoInfo.price}getDeepVideoOrderList(){return this.deepVideoInfo.itemTradeInfoList}getActionBarDesc(){return this.deepVideoInfo.actionBarDesc}isShowComments(){return this.deepVideoInfo.showComments}getCommentList(){try{return this.deepVideoInfo.confCommentList}catch(t){return null}}}class Os extends hi{constructor(t,e,i,n=1,s){if(super(),this.paramValid=!1,this.animMinTime=50,this.dismissCallbackCompleted=!1,this.lastAnimedArray=[],this.slotId=-1,this.componentData=void 0,this.containerSize=t,this.adInfo=e,this.adStyle=i,this.animType=n,this.currentRandomParams=this.getRedPacketRandomParam(),this.initLastAnimedArray(),s&&(this.slotId=s),2==n)this.redPacketInfo=ot(this.adInfo,this.adStyle);else if(u(this.adInfo)){let t=w(this.adInfo,"red-packet",this.slotId);t&&(this.redPacketInfo=g(t),this.componentData=t)}else this.redPacketInfo=it(this.adInfo,this.adStyle)}initLastAnimedArray(){this.lastAnimedArray=[5,2]}getAnimType(){return this.animType}getRowNum(){return 2==this.animType?5:3}getAnimMinTime(){return this.animMinTime}getOriginShowTime(){let t=6;return!Ft(this.redPacketInfo)&&!Ft(this.redPacketInfo.showTime)&&this.redPacketInfo.showTime>0&&(t=u(this.adInfo)?this.redPacketInfo.showTime/1e3:this.redPacketInfo.showTime),t}getScaleType(t,e){return this.currentRandomParams[e*this.getRowNum()+t].scaleType}dismissCallbackOnlyOnce(){this.dismissCallbackCompleted||(this.dismissCallbackCompleted=!0,this.dismissCallback&&this.dismissCallback())}enableShowRedPacketView(){return!Ft(this.redPacketInfo)}getRedPacketViewDelayShowTime(){return Ft(this.redPacketInfo)?1:u(this.adInfo)?this.redPacketInfo.delayTime/1e3:this.redPacketInfo.delayTime}isShowRedPacketViewRightNow(){return!Ft(this.redPacketInfo)&&0==this.redPacketInfo.delayTime}checkParam(){return!Ft(this.redPacketInfo)&&(!Mt(this.redPacketInfo.iconUrls)&&(this.paramValid=!0,!0))}isParamValid(){return this.paramValid}getShowTime(t){let e=this.getOriginShowTime();return 2==this.animType||Ft(this.currentRandomParams[t].iconShowTime)||(e=this.currentRandomParams[t].iconShowTime*this.getTimeCoefficient()),e}getIconDelayTime(t){return Math.floor(this.currentRandomParams[t].delayTime*this.getTimeCoefficient())*this.animMinTime}getDelayTime(){let t=1;return Ft(this.redPacketInfo)||Ft(this.redPacketInfo.delayTime)||(t=this.redPacketInfo.delayTime),t}getTimeCoefficient(){return 2==this.animType?1:this.getOriginShowTime()/4*1.1}getRotateTimeCoefficient(){return this.getOriginShowTime()/6}getRotateAnimDelayTime(t){return 2==this.animType||Ft(this.currentRandomParams[t].rotateDelayTime)?-1:Math.floor(this.currentRandomParams[t].rotateDelayTime*this.getRotateTimeCoefficient())*this.getAnimMinTime()}isCanShowRotateAnim(t){return-1!=this.getRotateAnimDelayTime(t)}getLastAnimIconIndex(){return this.lastAnimedArray[this.currentRandomParamIndex]}getAnimedCount(){return 2==this.animType?15:9}isCanClick(){return this.redPacketInfo.clickSwitch}getRedPacketIconUrl(){let t=Math.floor(Math.random()*this.redPacketInfo.iconUrls.length);return this.redPacketInfo.iconUrls[t]}reportRedPacketImpression(){if(1!=this.animType)return;let t=new r;if(u(this.adInfo)&&this.componentData){t.universe_feature_freq=this.componentData.componentId;const e=this.adInfo.adMatrixInfo.adDataV2.styleComponentInfo;let i={page_id:e.playCardInfo.pageId,combination_id:e.playCardInfo.combinationIds,component_id:this.componentData.componentId};t.component_module=JSON.stringify(i)}else t.universe_feature_freq=1;let e={elementType:201,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}convert(t,e,i,n=null,s){if(u(this.adInfo)&&this.componentData){n||(n=new r);const t=this.adInfo.adMatrixInfo.adDataV2.styleComponentInfo;let e={page_id:t.playCardInfo.pageId,combination_id:t.playCardInfo.combinationIds,component_id:this.componentData.componentId};n.component_module=JSON.stringify(e)}Te.convertIfNeeded(0,this.adInfo,t,e,i,n,s)}getRedPacketRandomParam(){let t=[];return t=2==this.animType?[[{delayTime:0,scaleType:.85},{delayTime:4.5,scaleType:.7},{delayTime:8.25,scaleType:.7},{delayTime:13.5,scaleType:1},{delayTime:18,scaleType:.7},{delayTime:2.25,scaleType:.7},{delayTime:7.5,scaleType:1},{delayTime:11.25,scaleType:.85},{delayTime:16.5,scaleType:1},{delayTime:21,scaleType:.85},{delayTime:0,scaleType:.85},{delayTime:4.5,scaleType:.7},{delayTime:9,scaleType:.7},{delayTime:14.25,scaleType:.85},{delayTime:18.75,scaleType:.85}]]:[[{delayTime:5,scaleType:.7,iconShowTime:2},{delayTime:15,rotateDelayTime:10,scaleType:.85,iconShowTime:2},{delayTime:22,scaleType:1,iconShowTime:2},{delayTime:0,rotateDelayTime:16,scaleType:1,iconShowTime:2.3},{delayTime:8,scaleType:.85,iconShowTime:2.5},{delayTime:20,scaleType:.7,iconShowTime:2.5},{delayTime:3,scaleType:.7,iconShowTime:1.9},{delayTime:11,scaleType:.7,iconShowTime:1.9},{delayTime:22,rotateDelayTime:13,scaleType:.85,iconShowTime:1.95}],[{delayTime:0,rotateDelayTime:12,scaleType:1,iconShowTime:2.3},{delayTime:10,scaleType:.85,iconShowTime:2.3},{delayTime:20,rotateDelayTime:16,scaleType:1,iconShowTime:2.7},{delayTime:2,scaleType:.7,iconShowTime:2},{delayTime:12,scaleType:1,iconShowTime:2.3},{delayTime:22,scaleType:.7,iconShowTime:2.1},{delayTime:0,scaleType:.85,iconShowTime:1.8},{delayTime:6,rotateDelayTime:18,scaleType:.85,iconShowTime:2.4},{delayTime:21,scaleType:1,iconShowTime:2.4}]],this.currentRandomParamIndex=Math.floor(Math.random()*t.length),t[this.currentRandomParamIndex]}}class Ns extends hi{constructor(t,e,i,n){super(),this.lifeStatus="none",this.adInfo=t,this.adStyle=e,this.configInfo=i,this.containerLimit=n,this.setupData(),this.setupViewModels()}setupData(){this.pendantInfo=function(t,e){let i=null,n=ht(t,e);return n&&(i=at(t,n)),i}(this.adInfo,this.adStyle),this.pendantViewAnimInfo=ot(this.adInfo,this.adStyle)}setupViewModels(){this.pendantAnimViewModel=new Os(this.containerLimit,this.adInfo,this.adStyle,2)}updateLifeStatus(t){this.lifeStatus=t}enableShowPendant(){return!Ft(this.getPendantInfo())&&!Ft(this.getPendantImageUrl())}getPendantInfo(){return this.pendantInfo}getPendantViewAnimInfo(){return this.pendantViewAnimInfo}getPendantTitleText(){try{return this.pendantInfo.guideMsg}catch(t){}return""}getPendantImageUrl(){try{return this.pendantInfo.icon}catch(t){}return""}enableShowGuidanceImage(){try{return 1==this.pendantInfo.gestureType}catch(t){}return!1}getPendantType(){try{return this.pendantInfo.type}catch(t){}return 0}getPendantSize(){return 13==this.adStyle?{width:140,height:140}:{width:184,height:170}}getPendantImageWH(){return 13==this.adStyle?105:150}getPendantTitleFontSize(){return 13==this.adStyle?12:16}getPendantTitleMarginLR(){return this.adStyle,8}getGuidanceImageWH(){return 13==this.adStyle?43:63}getGuidanceImageMarginTop(){return 13==this.adStyle?-this.getGuidanceImageWH()-10:-this.getGuidanceImageWH()-12}getGuidanceImageMarginLeft(){return 13==this.adStyle?this.getGuidanceImageWH()+34:this.getGuidanceImageWH()+42}enableClickPendant(){return $(this.adInfo,1)}reportPendantImpression(){let t=new r;t.template_show_type=this.getPendantTemplateShowType(),t.universe_feature_freq=2;let e={elementType:13,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}reportPendantClick(t){let e=new r;e.template_show_type=this.getPendantTemplateShowType(),Te.convertIfNeeded(1,this.adInfo,1,{x:t.position.rawX,y:t.position.rawY},ae.PLAY_END_GIFT_CLICK,e)}getPendantTemplateShowType(){return"pendant_active_red_packet"+this.getPendantType()}enableShowPendantClickAnim(){return!Ft(this.pendantViewAnimInfo)&&!Ft(this.pendantViewAnimInfo.iconUrls)&&this.pendantViewAnimInfo.iconUrls.length>0}getPendantClickAnimDuration(){return 1300}}class zs extends hi{constructor(t,e){super(),this.hasShown=!1,this.isShowEnd=!1,this.slotId=-1,this.componentData=void 0,this.callerContext=t,e&&(this.slotId=e);if(u(this.callerContext.adInfo)&&-1!=this.slotId){let t=w(this.callerContext.adInfo,"bubble-rain",this.slotId);t&&(this.bubbleRainInfo=g(t),this.componentData=t)}else this.bubbleRainInfo=function(t,e){let i,n=ht(t,e);if(n){let e=W(t,n);if(null==e)return;i=JSON.parse(e.data).bubbleRainInfo}return i}(this.callerContext.adInfo,this.callerContext.adStyle)}enableShowBubbleRainView(){return 1!=this.callerContext.screenOrientation&&!Ft(this.bubbleRainInfo)}enableCountDown(){return 2==this.callerContext.adStyle||3==this.callerContext.adStyle}isSplash(){return 4==this.callerContext.adStyle}getBubbleActionDes(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.bubbleActionDescription)&&void 0!==e?e:"立即开启大促"}getIndustryTopIcon(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.industryTopIcon)&&void 0!==e?e:""}getRedPacketUrl(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.redPacketUrl)&&void 0!==e?e:""}getSpecialRedPacketUrl(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.specialRedPacketUrl)&&void 0!==e?e:""}getRedPacketIndustryIcon(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.redPacketIndustryIcon)&&void 0!==e?e:""}getDelayTime(){var t;const e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.delayTime;return e>0?e:0}getShowTime(){var t;return null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.showTime}reportElementImpression(){let t=new r;if(u(this.callerContext.adInfo)&&this.componentData){t.universe_feature_freq=this.componentData.componentId;const e=this.callerContext.adInfo.adMatrixInfo.adDataV2.styleComponentInfo;let i={page_id:e.playCardInfo.pageId,combination_id:e.playCardInfo.combinationIds,component_id:this.componentData.componentId};t.component_module=JSON.stringify(i)}else t.universe_feature_freq=20;let e={elementType:238};e.clientExtData=JSON.stringify(t),Te.log(140,{x:0,y:0},e)}convert(t,e,i,n=null,s){u(this.callerContext.adInfo)&&this.componentData&&(n||(n=new r),n.component_module=C(this.callerContext.adInfo,this.componentData)),Te.convertIfNeeded(0,this.callerContext.adInfo,t,e,i,n,s)}}class Hs extends hi{constructor(t){super(),this.hasShown=!1,this.callerContext=t,this.setupData()}setupData(){this.giftBoxInfo=lt(this.callerContext.adInfo,this.callerContext.adStyle)}isVertical(){return 0==this.callerContext.screenOrientation||Ft(this.callerContext.screenOrientation)}getGiftBoxInfo(){return this.giftBoxInfo}getGiftBoxIconUrls(){try{return this.giftBoxInfo.iconUrls}catch(t){}return[]}getGiftBoxDelayTime(){try{return this.giftBoxInfo.delayTime}catch(t){}return 1e3}getGiftBoxShowTime(){try{return this.giftBoxInfo.showTime}catch(t){}return 6e3}enableShowClickAnimation(){let t=!1;try{t=this.giftBoxInfo.showClickAnimation}catch(e){}return Ft(this.getClickAnimationLottieUrl())&&(t=!1),Ut.supportMinimumTKVersion("5.0.0")||(t=!1),t}getClickAnimationLottieUrl(){let t="";try{t=this.giftBoxInfo.clickAnimationLottieUrl}catch(e){}return Ft(t)&&(t=Ut.isAndroid()?"image/ksad-compose-image/GiftBox/ksad_lottie_gift_box_transition_android.json":"image/ksad-compose-image/GiftBox/ksad_lottie_gift_box_transition_ios.json"),t}getSingleBoxGuideText(){return"点击盒子，领取惊喜"}enableShowGiftBox(){const t=this.isVertical()&&!Ft(this.giftBoxInfo)&&!Ft(this.getGiftBoxIconUrls())&&this.getGiftBoxIconUrls().length>0;return console.log("giftbox enableshow"+t),t}showMultiBoxViewDirectly(){return!0}reportGiftBoxClick(){Te.convertIfNeeded(1,this.callerContext.adInfo,1,{x:0,y:0},ae.SURPRISE_BOX_CLICK)}reportGiftBoxImpression(){let t=new r;t.universe_feature_freq=21;let e={elementType:237,clientExtData:JSON.stringify(t)};Te.log(140,null,e)}}class Ws extends hi{constructor(t){super(),this.showRedPacketRain=!1,this.callerContext=t,this.setupViewModels(),ze(this.$attrsPath.callerContext.lifeStatus,(t=>{this.festivalPendantViewModel.updateLifeStatus(t)}))}setupViewModels(){this.redPacketViewModel=new Os(this.callerContext.containerLimit,this.callerContext.adInfo,this.callerContext.adStyle),this.festivalPendantViewModel=new Ns(this.callerContext.adInfo,this.callerContext.adStyle,this.callerContext.configInfo,this.callerContext.containerLimit),this.bubbleRainViewModel=new zs(this.callerContext),this.giftBoxViewModel=new Hs(this.callerContext)}isVertical(){return 0==this.callerContext.screenOrientation}enableShowBubbleRain(){return this.bubbleRainViewModel.enableShowBubbleRainView()}enableShowRedPacketsRain(){if(!Ut.supportMinimumTKVersion("4.0.8")&&!Ut.isAndroid())return!1;return!Ft(it(this.callerContext.adInfo,this.callerContext.adStyle))}getRedPacketViewDelayShowTime(){return this.redPacketViewModel.getDelayTime()}isVerticalMaterial(){return this.callerContext.adDefaultMaterialSize.width<this.callerContext.adDefaultMaterialSize.height}enableShowFestivalPendantView(){return this.isVertical()&&this.isVerticalMaterial()&&this.festivalPendantViewModel.enableShowPendant()}getFestivalPendantViewTop(){let t=(this.callerContext.containerLimit.height-this.festivalPendantViewModel.getPendantSize().height)/2+(Ut.isAndroid()?70:100);return this.enableShowAutoCall()&&(t-=80),t}getFestivalPendantViewLeft(){const t=.8*this.callerContext.containerLimit.width;return(this.callerContext.containerLimit.width-t)/2}isAdForLive(){return Z(this.callerContext.adInfo)}isAddLiveButton(){return 1==this.callerContext.adInfo.adBaseInfo.universeLiveStyle}isNeedNewStyleTop(){return this.isAdForLive()&&this.isAddLiveButton()&&Ut.isAndroid()}startRedPacketsRainTimer(){let t=this;setTimeout((()=>{t.showRedPacketRain=!0}),1e3*this.getRedPacketViewDelayShowTime())}enableShowAutoCall(){return!Ft(F(this.callerContext.adInfo).autoCallAppInfo)}enableShowGiftBoxView(){return this.giftBoxViewModel.enableShowGiftBox()}enableInitTopView(){return this.enableShowGiftBoxView()||this.enableShowBubbleRain()||this.enableShowRedPacketsRain()||this.enableShowFestivalPendantView()}}class Us{constructor(t){this.key=t,this.checkDate()}getCurrentCount(){return console.log("tkloadcontroller currentcount:"+this.currentCount),this.currentCount}increaseCurrentCount(){this.checkDate(),this.currentCount+=1,console.log("tkloadcontroller increase currentcount:"+this.currentCount),t.saveLocal(this.getCountKey(),this.currentCount)}checkDate(){let e=t.getLocalString(this.getDateKey());const i=(new Date).toDateString();console.log("tkloadcontroller t:"+e+":"+i),e!==i?(t.saveLocal(this.getDateKey(),i),t.saveLocal(this.getCountKey(),0),this.currentCount=0):this.currentCount=t.getLocalInt(this.getCountKey())}getDateKey(){return console.log("tkloadcontroller key:"+this.key+"_date"),this.key+"_date"}getCountKey(){return console.log("tkloadcontroller key:"+this.key+"_count"),this.key+"_count"}}class Gs extends hi{constructor(t){super(),this.hasShownOnce=!1,this.callerContext=t,this.setupData()}setupData(){this.adDailyShowMinCountController=new Us("KSAdExitPopupAdDailyShowCountKey"),this.templateDataInfo=F(this.callerContext.adInfo)}getExitPopupStyle(){let t=0;try{t=this.callerContext.adInfo.adInsertScreenInfo.retainWindowStyle}catch(e){}return t=Ft(t)?0:t,t}recordAdDailyShowCount(){this.adDailyShowMinCountController.increaseCurrentCount()}reachAdDailyShowCountCondition(){return this.adDailyShowMinCountController.getCurrentCount()>this.getAdDailyShowMinCount()}getAdDailyShowMinCount(){let t=0;try{t=this.callerContext.adInfo.adInsertScreenInfo.retainWindowBasedAdShowCount}catch(e){}return t=Ft(t)?0:t,t}useTKExitPopup(){let t=!1;return this.callerContext.configInfo.abConfig.interstitialUseTKExitPopup&&(t=Ut.isAndroid()||!Ut.isAndroid()&&Ut.supportMinimumTKVersion("5.0.3")),t}enableShowExitPopup(){let t=0!=this.getExitPopupStyle()&&this.reachAdDailyShowCountCondition();return t&&(this.hasShownOnce||this.callerContext.adHasConvert)&&(t=!1),t}getExitPopupMessage(){let t;try{t=this.callerContext.adInfo.adInsertScreenInfo.retainWindowText}catch(e){}return t=Ft(t)?"提示":t,t}getLeaveButtonTitle(){return"残忍离开"}getStayButtonTitle(){return"留下看看"}getAdIcon(){return M(this.templateDataInfo,this.callerContext.adInfo)}getAdTitle(){return K(this.templateDataInfo,this.callerContext.adInfo)}getAdDescription(){return O(this.templateDataInfo,this.callerContext.adInfo)}getAdActionDesc(){return Q(this.callerContext.adInfo)}recordHasShownOnce(){this.hasShownOnce=!0}convert(t,e,i){let n={retain_code_type:this.getRetainCodeType()};Te.convertIfNeeded(6,this.callerContext.adInfo,t,e,i,null,n)}reportShowAction(){let t=new r;t.universe_feature_freq=12;let e={elementType:149,clientExtData:JSON.stringify(t),retain_code_type:this.getRetainCodeType()};Te.log(140,null,e)}reportLeaveAction(){let t={elementType:151,retain_code_type:this.getRetainCodeType()};Te.log(141,null,t)}reportStayAction(){let t={retain_code_type:this.getRetainCodeType()};Te.log(451,null,t)}getRetainCodeType(){return 2==this.getExitPopupStyle()?l.RETAIN_CARD_TYPE_2:l.RETAIN_CARD_TYPE_1}}class Ys extends hi{constructor(t){super(),this.callerContext=t,this.videoPlayReportSeconds=function(t){let e=[];if(t.adBaseInfo.videoPlayedNS){let n=t.adBaseInfo.videoPlayedNS.split(",");if(n.length>0)for(var i=0;i<n.length;i++){let t=Number(n[i]);e.push(t)}else e=[3]}return e.sort(),e}(this.callerContext.adInfo),this.playabelCountDown=this.callerContext.getPlayableCountDown(),this.autoCloseCountDown=this.callerContext.getAutoCloseCountDown();const e=this;1!=S(this.callerContext.adInfo)&&(this.callerContext.isValidPlayable()||this.callerContext.getAutoCloseCountDown()>0)&&Xt.registerTimerListener((t=>{t&&t.data&&e.updateCountDown(t.data.timerName,t.data.time)}))}updateCountDown(t,e){this.callerContext.countdownTimerType=t,this.callerContext.countdownTime=e}getAutoCallViewBottom(){let t=12;return this.callerContext.isRotateAndSlideStyle()?t=30:this.callerContext.isSpecialShapeStyle()&&(t=this.callerContext.isVertical()&&this.callerContext.isVerticalMaterial()?80:30),t}getSpecialShapeMaterialSize(t=!1){let e={width:0,height:0};const i=this.callerContext.isSpecialShapeFirstStyle()?232:269,n=this.callerContext.isSpecialShapeFirstStyle()?277:324;let s=this.callerContext.isSpecialShapeFirstStyle()?155:this.callerContext.enableShakeInteraction()?153:163;return this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()&&(s=222),this.callerContext.isVertical()?this.callerContext.isVerticalMaterial()||!t&&this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()?(e.width=this.callerContext.interstitialContainerSize.width*i/375,e.height=16*e.width/9):(e.width=this.callerContext.interstitialContainerSize.width*n/375,e.height=9*e.width/16):this.callerContext.isVerticalMaterial()?(e.height=this.callerContext.interstitialContainerSize.width*s/375,e.width=9*e.height/16):(e.height=this.callerContext.interstitialContainerSize.width*s/375,e.width=16*e.height/9),e}videoPlayStart(){te(this.callerContext.adInfo),Te.updateVideoPlayStatus("start"),Te.log(399,null,null)}updateVideoProgress(t,e,i){t<0&&(t=0),Te.updateVideoPlayStatus("progress",0,"",1e3*t),this.callerContext.playDuration=1e3*t,this.checkNeedReportPlayNSecond(t,(e=>{e&&Te.playNSecond(Math.floor(t))})),this.updateCountDownByPlayer(t,i)}updateCountDownByPlayer(t,e){if(!this.videoHasPlayed)return;let i=Ut.isAndroid()?Math.ceil(t):Math.floor(t);if(this.enableDisplayCountDown()){let t=this.callerContext.adDefaultMaterialVideoDuration-i;this.updateCountDown(0,t)}if(this.callerContext.isValidPlayable()){let n=Math.floor(Math.min(this.playabelCountDown,e))-i;n<=0||t>=e?(this.videoCountDownCompletedCallback&&this.videoCountDownCompletedCallback(2),this.callerContext.isClosing||Xt.showPlayable()):this.updateCountDown(2,n)}else if(this.callerContext.getAutoCloseCountDown()>0){let n=Math.floor(Math.min(this.autoCloseCountDown,e))-i;n<=0||t>=e?(this.videoCountDownCompletedCallback&&this.videoCountDownCompletedCallback(1),this.callerContext.closeAd(!0)):this.updateCountDown(1,n)}}countDownWithLivePlayer(t,e,i,n){let s=Ut.isAndroid()?Math.ceil(e):Math.floor(e);if(this.enableDisplayCountDown()){let t=this.callerContext.adDefaultMaterialVideoDuration-s;this.updateCountDown(0,t)}if(this.callerContext.isValidPlayable()){let t=this.playabelCountDown-s;t<=0?(this.videoCountDownCompletedCallback&&this.videoCountDownCompletedCallback(2),Xt.showPlayable()):this.updateCountDown(2,t)}else if(this.callerContext.getAutoCloseCountDown()>0){let t=this.autoCloseCountDown-s;t<=0?(this.videoCountDownCompletedCallback&&this.videoCountDownCompletedCallback(1),this.callerContext.closeAd(!0)):this.updateCountDown(1,t)}}enableDisplayCountDown(){return!!this.callerContext.configInfo.appConfig.interstitialAdSkipCloseType&&!(this.callerContext.isValidPlayable()||this.callerContext.getAutoCloseCountDown()>0||this.callerContext.isIndustryCustomStyle()||this.callerContext.isECCardStyle())}checkNeedReportPlayNSecond(t,e){if(this.callerContext.adInfo&&Math.floor(t)!=this.lastVideoPlayReportSecond)for(var i=0;i<this.videoPlayReportSeconds.length;i++)if(Math.floor(t)==this.videoPlayReportSeconds[i]){this.lastVideoPlayReportSecond=this.videoPlayReportSeconds[i],e&&e(!0);break}}videoPlayFinished(){this.playFinished||(this.playFinished=!0,dt(this.callerContext.adInfo,this.callerContext.configInfo)&&Xt.callNativeWithCallback("showActivityMiddlePage"),Te.log(400,null,null),Te.updateVideoPlayStatus("end"))}videoPlayFailed(t,e){Te.updateVideoPlayStatus("failed",t,e)}registerVideoPlayerListener(t){(1==S(this.callerContext.adInfo)||this.callerContext.isLiveAd())&&(Xt.registerVideoMuteStateListener((t=>{if(t.data){let e=1==t.data.muted;this.videoMuteCallback&&this.videoMuteCallback(e)}})),Xt.registerVideoAutoPlayListener((e=>{e.data&&(this.videoEnableAutoPlay=1==e.data.autoPlay,t&&t(this.videoEnableAutoPlay))})))}}class js extends hi{constructor(t){super(),this.callerContext=t}enableClosePlayViewDirectly(){let t=!1;if(this.callerContext.isVideoMaterial()||this.callerContext.isLiveAd())try{t=1==this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.videoEnableCloseDirectly}catch(e){}else if(this.callerContext.isPictureMaterial())try{t=1==this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.pictureEnableCloseDirectly}catch(e){}return t}getSkipTime(){let t=0;if(this.callerContext.isVideoMaterial()||this.callerContext.isLiveAd())try{t=this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.videoSkipSecond}catch(e){}else if(this.callerContext.isPictureMaterial())try{t=this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.pictureSkipSecond}catch(e){}return t=Ft(t)?0:t,t}skip(t){Te.skip(),this.skipCallback&&this.skipCallback(t),Ut.supportMinimumTKVersion("4.0.7")&&Xt.skipVideo(!1,!1,0)}}class Xs extends hi{constructor(t){super(),this.callerContext=t}enableShowFullScreenClickText(){return!Ft(this.getFullScreenClikText())}getFullScreenClikText(){let t;try{t=this.callerContext.templateDataInfo.fullScreenClickText}catch(e){}return Dt(t)||(t=""),t}}class Js extends hi{constructor(t){super(),this.callerContext=t}getShakeClickEnable(){if(this.callerContext.enableFullScreenClick())return!0;try{return!this.callerContext.templateDataInfo.shakeInfo.clickDisabled}catch(t){}return!0}getShakeTitle(){try{return this.callerContext.templateDataInfo.shakeInfo.title}catch(t){}return""}getShakeSubtitle(){try{return this.callerContext.templateDataInfo.shakeInfo.subtitle}catch(t){}return""}}class $s extends hi{constructor(t){super(),this.callerContext=t}}class Zs extends hi{constructor(t){super(),this.callerContext=t}}class qs extends hi{constructor(t){super(),this.callerContext=t}getEffectStyle(){let t=0;try{t=this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.dynamicEffectInfo.effectStyle}catch(e){}return t}getEffectDelayTime(){let t=2e3;try{t=this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.dynamicEffectInfo.effectDelayTime}catch(e){}return t}getGuideDelayTime(){let t=2e3;try{t=this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.dynamicEffectInfo.guideDelayTime}catch(e){}return t}getEffectShowTime(){let t=4e3;try{t=this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.dynamicEffectInfo.effectShowTime}catch(e){}return t=t<=0?4e3:t,t}getGuideResourceUrl(){let t="";try{t=this.callerContext.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.dynamicEffectInfo.guideResourceUrl}catch(e){}return t}getGuideBottom(){let t=0;return this.callerContext.isVertical()&&!this.callerContext.isVerticalMaterial()&&this.callerContext.isVideoMaterial()&&this.callerContext.enableShakeInteraction()&&0==this.callerContext.getInterstitialStyleNew()&&(t=70),this.callerContext.isVertical()&&8==this.callerContext.getInterstitialStyleNew()&&(this.callerContext.isVerticalMaterial()||!this.callerContext.isVerticalMaterial()&&this.callerContext.isRotateAndSlideStyle())&&(t=-40),!this.callerContext.isVertical()&&this.callerContext.isRotateAndSlideStyle()&&(t=8==this.callerContext.getInterstitialStyleNew()?-50:-10),t}reportDynamicEffectImpression(){let t=new r;t.universe_feature_freq=23;let e=240;2==this.getEffectStyle()&&(t.universe_feature_freq=24,e=241);let i={elementType:e,clientExtData:JSON.stringify(t)};Te.log(140,null,i)}}class Qs extends hi{constructor(t,e,i=null){super(),this.reportFreQ=!1,this.clickType=0,this.getActionBarRect=()=>({x:0,y:0,width:0,height:0}),this.callerContext=t,this.industryInfo=e,Ft(i)?this.templateShowType=this.obtainTemplateShowType():this.templateShowType=i}obtainTemplateShowType(){let t="ecommerce_coupon";if(this.industryInfo){switch(this.industryInfo.merchantStyleType){case o.PRODUCT:t="benefit_card_item";break;case o.COUPON:t="ecommerce_coupon";break;case o.EVENT:t="benefit_card_activity";break;case o.DEFAULT:t="benefit_card_default"}}return t}updateProgressListener(t){if(t.result&&Ut.isSupportDownloadProgressListen()&&L(this.callerContext.adInfo)){const{status:e,progress:i,totalBytes:n}=t.data,s=Number((100*i).toFixed(0))>100?"100":(100*i).toFixed(0);switch(e){case 0:case 1:case 4:this.actionBarText=this.callerContext.adInfo.adBaseInfo.adActionDescription;break;case 2:this.actionBarText=`${s}%`;break;case 3:this.actionBarText="继续下载";break;case 5:this.actionBarText=Dt(this.callerContext.adInfo.adBaseInfo.installAppLabel)?this.callerContext.adInfo.adBaseInfo.installAppLabel:"点击安装";break;case 6:this.actionBarText=Dt(this.callerContext.adInfo.adBaseInfo.openAppLabel)?this.callerContext.adInfo.adBaseInfo.openAppLabel:"立即打开"}}}isCouponLegacy(){return!1}getBottomTipsText(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.riskPromptText)||"具体活动或金额以实际活动为准"}supportHorizontal(){return!1}enableShowCard(){return!Ft(this.industryInfo)}getRightsCardStayTime(){var t,e;let i=7;try{let n=null!==(e=null===(t=this.industryInfo)||void 0===t?void 0:t.rightsCardShowTime)&&void 0!==e?e:7e3;i=Math.ceil(n/1e3)}catch(n){}return i}enableInteractCard(){return this.getInteractShowTime()>0}getInteractShowTime(){var t,e;return null!==(e=null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardShowTime)&&void 0!==e?e:2e3}getInteractTitle(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardTitle)||""}getInteractSubTitle(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardSubTitle)||""}getInteractIcon(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardIcon)||""}getInteractCustomerInfo(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardCustomer)||[]}getDelayShowTime(){var t,e;let i=5;try{let n=null!==(e=null===(t=this.industryInfo)||void 0===t?void 0:t.delayTime)&&void 0!==e?e:2e3;i=Math.ceil(n/1e3)}catch(n){i=5}return i}isVertical(){return 0==this.callerContext.screenOrientation}isSplashScene(){return 4==this.callerContext.adStyle}isInterstitialScene(){return 13==this.callerContext.adStyle}logInteractionImp(){let t=new r;t.template_show_type="interaction_card_ecom";let e={elementType:191,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}logInteractionClick(t){let e=new r;e.click_area=t,e.template_show_type="interaction_card_ecom";let i={elementType:191,clientExtData:JSON.stringify(e)},n={actionType:141,payload:JSON.stringify(i)};Xt.sendLog(n)}logRightsImp(t,e){let i=new r;i.template_show_type=t,this.reportFreQ||(i.universe_feature_freq=e),this.reportFreQ=!0;let n={elementType:191,clientExtData:JSON.stringify(i)},s={actionType:140,payload:JSON.stringify(n)};Xt.sendLog(s)}convert(t,e,i,n){let s=new r;return s.template_show_type=this.templateShowType,Te.convertIfNeeded(1,this.callerContext.adInfo,e,t,i,s,n)}logSplashCardImpression(){if(this.isSplashScene()){let t={elementType:239};Te.log(140,null,t)}}}class ta{}class ea extends Qs{constructor(t,e){super(t,e),this.couponInfo=this.industryInfo,this.actionBarText=this.callerContext.adInfo.adBaseInfo.adActionDescription,this.mScreenWidthDp=function(t){if(null==t)return-1;let e=t.screenWidth;return _t()&&(e=Tachikoma.px2Dp(e)),e}(It()),this.mScreenScaleX=this.mScreenWidthDp/414}getCardSize(){let t=new ta;return t.width=Math.ceil(406*this.mScreenScaleX),t.height=Math.ceil(372*t.width/406),t}getRootBgColor(){return null}getCouponBarSize(){let t=new ta;return t.width=Math.ceil(264*this.mScreenScaleX),t.height=Math.ceil(92*t.width/264),t.left=Math.ceil((this.mScreenWidthDp-t.width)/2),t.bottom=Math.ceil(68*t.height/92),t}getFullCardBgUrl(){return"ec_card_coupon_anim_bg.png"}getFullCardHeight(){return 497*this.mScreenWidthDp/414}getRightsCardTitle(){return""}needCouponBarBg(){return!0}getBottomTipsMarginBottom(){return Math.ceil(45*this.mScreenScaleX)}getBottomImageViewName(){return null}useLegacyAnim(){return!1}getBgUrl(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardBgUrl)||""}getUserIcon(){return""}getTitleDesc(){return""}getCouponTitle(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardTitle)||""}getCouponDesc(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardDescription)||""}getPriceAmount(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardAmount)||""}enableAnimation(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle||4==this.callerContext.adStyle}enableShowCloseView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowCountDownView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowActionbarView(){return 13!=this.callerContext.adStyle}enableHandBreathAnim(){return!0}getActionbarDesc(){return this.couponInfo.merchantCardActionDescription||"立即领取"}logECCardImpression(){let t=new r;t.template_show_type="ecommerce_coupon";let e={clientExtData:JSON.stringify(t)};Te.exposeElement(191,e)}}class ia extends ea{constructor(t){var e;super(t,null),this.merchantCardInfo=nt(this.callerContext.adInfo,this.callerContext.adStyle),this.actionBarText=(null===(e=this.merchantCardInfo)||void 0===e?void 0:e.merchantCardActionDescription)||"立即领取"}getCardSize(){let t=new ta;return t.width=263,t.height=273,t}getRootBgColor(){return"#00000099"}getCouponBarSize(){let t=new ta;return t.width=211,t.height=69,t.left=31,t.bottom=38,t}getFullCardBgUrl(){return null}supportHorizontal(){return!0}getRightsCardTitle(){return"恭喜获得"}needCouponBarBg(){return!1}getBottomTipsText(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.riskPromptText)||"具体活动或金额以实际活动为准"}getBottomImageViewName(){return"ec_card_view_bg.png"}useLegacyAnim(){return!0}getBgUrl(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardBgUrl)||""}getUserIcon(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardUserIcon)||""}getTitleDesc(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardTitleDescription)||""}getCouponTitle(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardTitle)||""}getCouponDesc(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardDescription)||""}getPriceAmount(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardAmount)||""}getRightsCardStayTime(){let t=10;try{t=Math.ceil(this.merchantCardInfo.merchantCardStayTime/1e3)}catch(e){t=10}return t}getDelayShowTime(){let t=5;try{t=Math.ceil(this.merchantCardInfo.merchantCardShowTime/1e3)}catch(e){t=5}return t}enableInteractCard(){return!1}isCouponLegacy(){return!Ft(this.merchantCardInfo)}enableShowCard(){return!Ft(this.merchantCardInfo)}enableAnimation(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle||4==this.callerContext.adStyle}enableShowCloseView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowCountDownView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowActionbarView(){return 13!=this.callerContext.adStyle}enableHandBreathAnim(){return!1}getActionbarDesc(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardActionDescription)||"立即领取"}}class na extends hi{constructor(){super(),this.hasRegisterVideoMuteAndAutoPlayListener=!1,this.hasReportExpose=!1,this.liveShopCardChangeType=1,this.liveEnd=!1,this.lifeStatus="none",this.downloadState=0,this.inShowingOtherVC=!1,this.isShowingExitPopup=!1}registerLifeCycleListener(){Xt.registerLifecycleListener((t=>{if(t.result&&t.data){const e=t.data.lifeStatus;"pageVisiable"==e?(this.inShowingOtherVC=!1,this.callerContext.isClosing=!1):"pageInvisiable"==e&&(this.inShowingOtherVC=!0),e!==this.lifeStatus&&this.updateLifeStatus(e),Array.isArray(this.lifeCycleListeners)&&this.lifeCycleListeners.map(((t,i)=>{t&&t(e)}))}}))}updateLifeStatus(t){this.lifeStatus=t,this.callerContext.lifeStatus=t,this.liveButtonViewModel.updateLifeStatus(t),this.autoViewModel.updateLifeStatus(t)}addPageStatusListener(t){this.lifeCycleListeners=this.lifeCycleListeners||[],t&&this.lifeCycleListeners.push(t)}removePageStatusListener(t){Array.isArray(this.lifeCycleListeners)&&(this.lifeCycleListeners=this.lifeCycleListeners.filter((e=>e!=t)))}registerProgressListener(){!Ut.isSupportDownloadProgressListen()||B(this.adInfo)||this.callerContext.isLiveAd()||Xt.registerProgressListener((t=>{try{this.ecCardViewModel&&this.ecCardViewModel.updateProgressListener(t);let e=this.callerContext.templateDataInfo.texts.adActionDescription;if(t.result){const{status:i,progress:n,totalBytes:s}=t.data,a=Number((100*n).toFixed(0))>100?"100":(100*n).toFixed(0);let o="";switch(this.downloadReslut={status:i,downloadProgress:a},this.downloadPopupVM.updateDownloadProgress(Ss.newInstance(i,n,s)),i){case 0:case 1:case 4:o=e;break;case 2:o=`${a}%`;break;case 3:o="继续下载";break;case 5:o=Dt(this.callerContext.templateDataInfo.texts.installAppLabel)?this.callerContext.templateDataInfo.texts.installAppLabel:"点击安装";break;case 6:o=Dt(this.callerContext.templateDataInfo.texts.openAppLabel)?this.callerContext.templateDataInfo.texts.openAppLabel:"立即打开"}this.callerContext.downloadText=o}else this.callerContext.downloadText=e;this.combineDownloadText=this.getCombineStyleRotateSubTitle(),this.callerContext.combineDownloadText=this.combineDownloadText}catch(e){Yt.log(xt(e))}})),Ut.isSupportDownloadProgressListen()&&B(this.adInfo)&&(this.callerContext.downloadText=function(t,e){let i=null,n=D(t);if(3==n){try{if(i=e.appConfig.buyNowTips,Dt(i))return i}catch(s){}return"立即抢购"}if(2==n)return t.advertiserInfo.followed?(i=e.appConfig.viewHomeTips,Dt(i)?i:"查看TA的主页"):(i=e.appConfig.attentionTips,Dt(i)?i:"去关注TA")}(this.adInfo,this.configInfo))}getData(t){let e=this.getDataTypes(),i=[],n=0;for(;n<e.length;++n){const s=e[n];let a=this.funcForName(s);if(!a)return void t(!1);i.push(a())}Promise.all(i).then((i=>{try{for(let t=0;t<e.length;++t){this[e[t]]=i[t].data}this.adImpInfo&&(this.adInfo=this.adImpInfo.impAdInfo[0].adInfo[0],this.adStyle=this.adImpInfo.impAdInfo[0].adStyle,this.adImpInfo=null),yt(this.deviceInfo),this.initCallerContenxt(),Yt.log("init callercontext done"),this.additionalInit(),Yt.log("additional init done:"+(t?1:0)),t&&t(!0),Yt.log("interstitial style:"+this.callerContext.getInterstitialStyleNew()+",is video:"+this.callerContext.isVideoMaterial()+",is rotate:"+this.isRotateAndSlideStyle()+",is shake:"+this.callerContext.enableShakeInteraction()+",is order:"+B(this.adInfo)+",is live:"+this.callerContext.isLiveAd())}catch(n){Yt.log(xt(n)),t&&t(!1)}}))}getDataTypes(){return["adImpInfo","deviceInfo","configInfo","containerLimit","screenOrientation"]}funcForName(t){return sa[t]}checkDataValid(){return!!this.adInfo}additionalInit(){this.callerContext.downloadText=this.adInfo.adBaseInfo.adActionDescription,this.downloadReslut={status:0,progress:0},this.combineDownloadText=this.getCombineStyleRotateSubTitle(),this.callerContext.combineDownloadText=this.combineDownloadText,this.initContainerSize(),Yt.log("init container size done"),this.setupViewModels(),Yt.log("setup viewmodels done"),this.registerBridges(),Yt.log("register bridges done")}initContainerSize(){if(this.actionBtnSize={width:this.containerLimit.width-20,height:68},this.showPrivacy=function(t){var e;try{return Ut.isAndroid()&&1==t.adBaseInfo.adOperationType&&(null===(e=t.downloadSafeInfo.complianceInfo)||void 0===e?void 0:e.titleBarTextSwitch)>0}catch(i){}return!1}(this.adInfo),this.containerLimit.width>this.containerLimit.height)this.callerContext.interstitialContainerSize={width:this.containerLimit.height,height:.749*this.containerLimit.height},Yt.log("hori container done");else if(this.showPrivacy){let t=44;this.callerContext.interstitialContainerSize={width:this.containerLimit.width,height:this.containerLimit.height-t/2},Yt.log("showprivacy done")}else this.callerContext.interstitialContainerSize=this.containerLimit,Yt.log("default container")}initCallerContenxt(){this.callerContext=new As(this.adInfo,this.adStyle,this.configInfo,this.containerLimit,this.screenOrientation.screenOrientation);const t=this;ze(this.$attrsPath.callerContext.clickCloseButton,(e=>{e&&t.clickCloseButton()}))}setupViewModels(){this.autoViewModel=new xs(this.adInfo,13,this.configInfo,2),this.autoViewModel.needShowFlag=!(this.callerContext.getAutoCloseCountDown()>0),this.callerContext.enableShowAutoCall=this.autoViewModel.enableShowAutoCallOnInInterstitial(),this.downloadPopupVM=new Ls(this.adInfo,this.adStyle,this.configInfo),this.liveButtonViewModel=new _s(this.adInfo,this.adStyle,this.configInfo,this.containerLimit,this.screenOrientation.screenOrientation),this.bottombarViewModel=new Es,this.bottombarViewModel.styleType=2,this.bottombarViewModel.adInfo=this.adInfo,this.bottombarViewModel.adStyle=this.adStyle,this.ecCardViewModel=new ia(this.callerContext),this.topViewModel=new Ws(this.callerContext),this.exitPopupViewModel=new Gs(this.callerContext),this.materialViewModel=new Ys(this.callerContext),this.closeActionViewModel=new js(this.callerContext),this.fullScreenClickTextViewModel=new Xs(this.callerContext),this.shakeViewModel=new Js(this.callerContext),this.actionButtonViewModel=new Zs(this.callerContext),this.actionButtonViewModel.autoCallViewModel=this.autoViewModel,this.actionBarViewModel=new $s(this.callerContext),this.actionBarViewModel.actionButtonViewModel=this.actionButtonViewModel,this.dynamicEffectViewModel=new qs(this.callerContext)}registerBridges(){this.registerLifeCycleListener(),this.registerProgressListener(),fe().on(me,(t=>{this.callerContext.adHasConvert=!0,this.callerContext.autocallHasConverted=!0})),Ut.supportMinimumTKVersion("4.0.6")&&Xt.registerConvertStatusListener((t=>{try{this.callerContext.autocallHasConverted=t.data.hasConverted}catch(e){console.log("error return value")}}))}isVertical(){return this.callerContext.isVertical()}isVerticalMaterial(){return this.callerContext.isVerticalMaterial()}getMaterialSize(){return this.callerContext.adDefaultMaterialSize}registerPlayStateResetListener(t){Ut.supportMinimumTKVersion("4.0.2")&&Xt.registerPlayStateResetListener((e=>{t&&t()}))}getLogoStyle(){return this.isNewHorizontalStyle()?this.callerContext.enableShakeInteraction()?1:0:1}getInterstitialStyle(){return this.callerContext.expParam.interstitialStyleId}isWebStyle(){if(!Ut.supportMinimumTKVersion("4.0.11"))return!1;let t=!1;try{t=this.isVertical()&&this.callerContext.templateDataInfo.isWebStyle}catch(e){}return t}isBigCardStyle(){return 0==this.getInterstitialStyle()}isNewHorizontalStyle(){return 5==this.getInterstitialStyle()||6==this.getInterstitialStyle()}isECCardStyle(){return this.callerContext.isECCardStyle()}getRedPacketAdDescription(){let t="";try{t=this.callerContext.templateDataInfo.industryRedPacketInfo.adDescription}catch(e){}return t}getRedPacketMoney(){let t="";try{t=this.callerContext.templateDataInfo.industryRedPacketInfo.money}catch(e){}return Ft(t)?"神秘金额":t}getGiftTitle(){let t="";try{t=this.callerContext.templateDataInfo.industryGiftInfo.giftTitle}catch(e){}return t||""}getGiftContent(){let t="";try{t=this.callerContext.templateDataInfo.industryGiftInfo.gift}catch(e){}return t}getGiftDesc(){let t="";try{t=this.callerContext.templateDataInfo.industryGiftInfo.giftDesc}catch(e){}return t||""}isGiftImgType(){let t=!1;try{t=this.callerContext.templateDataInfo.industryGiftInfo.giftType==we.picStyle}catch(e){}return t}getGiftOtherGiftInfo(){let t=[];try{t=this.callerContext.templateDataInfo.industryGiftInfo.otherGiftInfo}catch(e){}return t}getSpecialShapeMaterialContainerSize(){let t=this.materialViewModel.getSpecialShapeMaterialSize();if(!this.isVertical()&&this.isVerticalMaterial()){let e=this.callerContext.isSpecialShapeFirstStyle()?155:this.callerContext.enableShakeInteraction()?153:163;this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()&&(e=222),t.height=this.callerContext.interstitialContainerSize.width*e/375,t.width=16*t.height/9}return t}getSpecialShapeBehindImageSize(){let t=this.getSpecialShapeMaterialContainerSize(),e=0,i=0,n=0;return this.isVertical()&&this.isVerticalMaterial()||this.isVertical()&&this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()?(e=this.callerContext.isSpecialShapeFirstStyle()?Ut.isAndroid()?88:96:Ut.isAndroid()?51:55,i=321,n=this.callerContext.isSpecialShapeFirstStyle()?500:622,t.width=t.width+e,t.height=t.width*n/i):(e=this.callerContext.isSpecialShapeFirstStyle()?Ut.isAndroid()?78:86:!this.isVertical()&&this.callerContext.enableShakeInteraction()?Ut.isAndroid()?35:39:!this.isVertical()&&this.callerContext.isRotateAndSlideStyle()?10:Ut.isAndroid()?40:42,i=this.callerContext.isSpecialShapeFirstStyle()?357:370,n=this.callerContext.isSpecialShapeFirstStyle()?227:370,this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()&&(i=500,n=401),t.width=t.width+e,t.height=t.width*n/i),t}getSpecialShapeSize(){let t=this.getSpecialShapeBehindImageSize();if(this.callerContext.isSpecialShapeFirstStyle()){const e=78,i=this.fullScreenClickTextViewModel.enableShowFullScreenClickText()?22:0;t.height=t.height+e+i}else this.isVertical()&&!this.isVerticalMaterial()&&this.callerContext.enableShakeInteraction()&&(t.height+=123);return t}getSpecialShapeFrontImageSize(){let t=this.getSpecialShapeSize();return t.height=146*t.width/357,this.isVertical()&&this.isVerticalMaterial()&&(t.height=146*t.width/321),t}getSpecialShapeMaterialTop(){let t=0;return this.callerContext.isSpecialShapeFirstStyle()?t=this.isVertical()&&this.isVerticalMaterial()?Ut.isAndroid()?60:64:4:this.isVertical()?t=this.isVerticalMaterial()||this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()?129*this.getSpecialShapeBehindImageSize().height/667:194*this.getSpecialShapeBehindImageSize().height/667:(t=110*this.getSpecialShapeBehindImageSize().height/375,this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()&&(t=114*this.getSpecialShapeBehindImageSize().height/375)),Math.floor(t)}getActionBarContainerBottom(){let t=Ut.isAndroid()?24:16;return this.callerContext.isRotateAndSlideStyle()&&(t=this.isVertical()?Ut.isAndroid()?25:26:Ut.isAndroid()?5:4),t}getSpecialShapeSkinImageUrl(t=!0){let e="";try{e=t?this.isVertical()&&this.isVerticalMaterial()||this.isVertical()&&this.callerContext.isSpecialShapeAndRoatateAndSlideStyle()?this.callerContext.templateDataInfo.specialShapeInfo.vBehindImageUrl:this.callerContext.templateDataInfo.specialShapeInfo.hBehindImageUrl:this.isVertical()&&this.isVerticalMaterial()?this.callerContext.templateDataInfo.specialShapeInfo.vFrontImageUrl:this.callerContext.templateDataInfo.specialShapeInfo.hFrontImageUrl}catch(i){}return e}getSpecialShapeButtonImageUrl(){let t="";try{t=this.callerContext.templateDataInfo.specialShapeInfo.buttonImageUrl}catch(e){}return t}enableShowCouponView(){let t=!1;return 0!=this.bottombarViewModel.getCouponModel().cardStyle&&this.isVertical()&&this.isVerticalMaterial()&&(t=!0),t}isAdForLive(){return Z(this.adInfo)}isAddLiveButton(){return 1==this.adInfo.adBaseInfo.universeLiveStyle}reportShakeStyleElementImpression(){let t=new r;t.universe_feature_freq=17;let e={elementType:185,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Xt.sendLog(i)}isRotateAndSlideStyle(){return this.callerContext.isRotateAndSlideStyle()}isEqualScalingCutRule(){try{return this.isRotateAndSlideStyle()&&1==this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.cutRule}catch(t){}return!1}getCombineStyle(t){try{if(this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.interactiveStyle==t)return this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.combinedStyleType}catch(e){}return 0}getCombineStyleRotateTitle(){try{return this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.rotateInfo.title}catch(t){}return""}getCombineStyleRotateSubTitle(){let t="";try{if(L(this.adInfo)){const e=this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.rotateInfo.downloadTexts,{status:i,downloadProgress:n}=this.downloadReslut;switch(i){case 2:return`${n}%`;case 3:t="继续下载";break;case 6:t=Dt(e.openAppLabel)?e.openAppLabel:"立即打开";break;case 5:t=Dt(e.installAppLabel)?e.installAppLabel:"点击安装";break;default:t=e.adActionDescription}}else t=this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.rotateInfo.subTitle}catch(e){}return Dt(t)?"或点击"+t:""}getCombineStyleSlideTitle(){let t="";try{t=this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.slideInfo.title}catch(e){}return Dt(t)?t:"滑一滑"}reportCombination2ActionBarImpression(){if(!this.hasReportExpose){this.hasReportExpose=!0;let t={elementType:200};Te.log(140,null,t)}}startSensorListener(){this.sensorUtil||(this.sensorUtil=new Yi(this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo)),this.sensorUtil.startSensorListener(((t,e,i)=>{this.maxAcceleration=e,this.maxSensorValus=i,this.sensorCanConvert()&&(t?this.convertShake():this.convertRotate())}),((t,e,i)=>{!i&&t&&this.callerContext.notifySensorUpdate(t.xDegree,t.yDegree,t.zDegree)}))}convertShake(){let t=new r;t.interstitial_style=this.callerContext.getInterstitialStyleNew(),this.convert(2,{x:0,y:0},ae.SHAKE_ICON_SHACK,t,{splash_shake_acceleration:this.maxAcceleration})}sensorCanConvert(){return!this.inShowingOtherVC}convertRotate(){try{let t={splashInteractionRotateAngle:this.maxSensorValus},e=new r;e.interstitial_style=this.callerContext.getInterstitialStyleNew(),Te.convertIfNeeded(1,this.adInfo,1,{x:0,y:0},ae.ROTATE_ICON_ROTATE,e,t)}catch(t){}}stopSensorListener(){var t;null===(t=this.sensorUtil)||void 0===t||t.stopSensorListener()}handleSlideConvert(t,e,i,n){if(!this.enableConvertBySwipeType(i))return;let s={fingerSwipeType:i,fingerSwipeDistance:n},a=new r;a.interstitial_style=this.callerContext.getInterstitialStyleNew(),Te.convertIfNeeded(1,this.adInfo,1,{x:t,y:e},ae.CARD_SWIPE_CONVERT,a,s)}clickActionBarConvert(t){Te.convertIfNeeded(1,this.adInfo,1,{x:t.position.rawX,y:t.position.rawY},ae.SPLASH_CONVERSION_BUTTON_CLICK)}getSlideConvertDistance(){try{return this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.slideInfo.convertDistance}catch(t){}return 50}enableConvertBySwipeType(t){let e=!0;try{let i=this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.interactionInfo.slideInfo.convertSlideDirection;if(Ft(i))return!1;if(i.length<4)return!1;switch(t){case 1:e="1"==i.substring(0,1);break;case 4:e="1"==i.substring(1,2);break;case 2:e="1"==i.substring(2,3);break;case 3:e="1"==i.substring(3,4)}}catch(i){}return e}getEqualScalingMaterialSize(){let t={width:0,height:0};t.width=this.callerContext.interstitialContainerSize.width*(this.isVertical()?.8:1),t.height=t.width*(this.isVertical()?16/9:9/16);const e=this.getMaterialSize().width/this.getMaterialSize().height;let i={width:0,height:0};return this.isVertical()?this.isVerticalMaterial()?(i.height=t.height,i.width=i.height*e):(i.width=t.width,i.height=i.width/e):(i.height=this.callerContext.interstitialContainerSize.height,i.width=i.height*e),i}enableFullScreenClick(){return this.callerContext.enableFullScreenClick()}isVideoMaterial(){return this.callerContext.isVideoMaterial()}isPictureMaterial(){return this.callerContext.isPictureMaterial()}getVideoDuration(){return this.callerContext.adDefaultMaterialVideoDuration}addMaterilTapEventIfNeeded(t){this.enableFullScreenClick()&&t.addEventListener("tap",(e=>{const i=Et(e,t);this.callerContext.clickAd(1,i,3,ae.CARD_PAGE_CLICK)}))}enableShowOrderAdNewStyle(){return this.callerContext.enableShowOrderAdNewStyle()}canShowAutoCall(){return null!=this.getAutoCallAppInfo()}getAutoCallHeight(){let t=0;if(this.canShowAutoCall()){let e=this.getAutoCallAppInfo().cardStyle;3==e&&(t=67),2==e&&(t=80)}return t}getAutoCallAppInfo(){return this.callerContext.templateDataInfo.autoCallAppInfo}buildAutocallViewModel(){return this.autoViewModel}convert(t,e,i,n=null,s){n||(n=new r),n.interstitial_style=this.callerContext.getInterstitialStyleNew(),Te.convertIfNeeded(1,this.adInfo,t,e,i,n,s)}clickCloseButton(){this.setClosingAdStatus(!0),this.exitPopupViewModel.useTKExitPopup()?this.showExitPopupIfNeeded():this.callerContext.closeAd()}showExitPopupIfNeeded(){this.exitPopupViewModel.enableShowExitPopup()?(this.showExitPopupCallback&&this.showExitPopupCallback(),this.isShowingExitPopup=!0):this.callerContext.closeAd()}closeExitPopup(){this.setClosingAdStatus(!1),this.isShowingExitPopup=!1}setClosingAdStatus(t){this.materialViewModel.videoHasPlayed&&this.callerContext.hasVideoPlayer&&(this.callerContext.controlVideoPlayerStatus=t?"pause":"resume"),this.callerContext.hasLivePlayer&&(this.callerContext.controlLivePlayerStatus=t?"pause":"resume"),this.callerContext.isClosing=t}getIsShowingExitPopup(){return this.isShowingExitPopup}isLiveBaseStyle(t=!1){return!!this.callerContext.isLiveAd()&&(t?7==this.getLiveEndCardStyle():7==this.getLivePlayCardStyle())}isLiveShopStyle(t=!1){return!!this.callerContext.isLiveAd()&&(t?8==this.getLiveEndCardStyle():8==this.getLivePlayCardStyle())}getLivePlayCardStyle(){return this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.liveTypeInfo.actionbarCardType}getLiveEndCardStyle(){return this.adInfo.adMatrixInfo.adDataV2.interstitialCardInfo.liveTypeInfo.endCardType}getLiveProductInfo(){try{return this.liveRoomItemInfo}catch(t){}return null}getLiveLikeCount(){try{return this.livePushEndInfo.displayLikeUserCount}catch(t){}return null}getLiveAudienceCount(){try{return this.livePushEndInfo.displayWatchingUserCount}catch(t){}return null}enableSlideAction(){return this.isVertical()&&this.isRotateAndSlideStyle()}enableRotateForECCard(){return this.isRotateAndSlideStyle()&&this.isECCardStyle()}}const sa={adImpInfo:Xt.getKsAdDataAsync,deviceInfo:Xt.getDeviceInfoAsync,configInfo:Xt.getKsAdConfigAsync,containerLimit:Xt.getContainerLimitAsync,screenOrientation:Xt.getScreenOrientationAsync};(new class extends Se{constructor(){super(),this.startExpireDetect(),this.vm=new na,this.vm.addPageStatusListener((t=>{switch(t){case"showEnd":this.didAppear();break;case"hideEnd":this.didDisappear();case"pageVisiable":this.pageVisiable();break;case"pageInvisiable":this.pageInvisiable()}}))}setupViews(){Yt.log("setupview"),this.contentView=new Ts(this.vm),Ut.supportMinimumTKVersion("5.1.0")&&(this.rootView.style={backgroundColor:"#00000099"}),this.rootView.appendChild(this.contentView)}render(){if(!super.render())return!1;try{this.vm.getData((t=>{if(Yt.log("getdata done:"+t),t)try{this.setupViews(),Yt.log("setupview done"),Tachikoma.render(this.rootView),Yt.log("render done"),this.updateRenderStatus(1,"")}catch(e){this.updateRenderStatus(0,xt(e))}else this.updateRenderStatus(0,"data invalid")}))}catch(t){this.updateRenderStatus(0,xt(t))}return!0}didAppear(){this.hasReportExpose||(this.hasReportExpose=!0,this.extraDataCallback=t=>{let e={triggerType:t,photoSizeStyle:this.vm.callerContext.getReportPhotoSizeStyle()},i=new r;this.vm.enableShowOrderAdNewStyle()&&(i.template_show_type=this.vm.callerContext.getOrderAdNewStyleReportShowType()),i.interstitial_style=this.vm.callerContext.getInterstitialStyleNew(),e.clientExtData=JSON.stringify(i),Yt.log("expose"),Te.expose(e),function(){if(!Ut.supportMinimumTKVersion("5.0.7"))return;ie({category:"ad_client_apm_log",biz:"AD_INTERSTITIAL",sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_sdk_interstitial_load",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:{status:11,render_type:3}})}(),this.vm.exitPopupViewModel.recordAdDailyShowCount()},this.registerExtraDataListener(),this.vm.callerContext.enableShakeInteraction()&&this.vm.reportShakeStyleElementImpression()),this.vm.callerContext.hasVideoPlayer&&this.vm.materialViewModel.videoEnableAutoPlay&&!this.vm.materialViewModel.videoHasPlayed&&(!function(t){if(!Ut.supportMinimumVersion("3.3.44","3.3.44"))return;let e={creative_id:t.adBaseInfo.creativeId,status:1},i=new Date;$t.videoCreateTime=i.getTime(),ie({category:"ad_client_apm_log",biz:"AD_INTERSTITIAL",sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_sdk_interstitial_play",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:e})}(this.vm.adInfo),this.vm.callerContext.controlVideoPlayerStatus="play",this.vm.materialViewModel.videoHasPlayed=!0),this.vm.callerContext.hasLivePlayer&&this.vm.materialViewModel.videoEnableAutoPlay&&!this.vm.materialViewModel.videoHasPlayed&&(this.vm.callerContext.controlLivePlayerStatus="resume",this.vm.materialViewModel.videoHasPlayed=!0)}didDisappear(){this.vm.callerContext.hasVideoPlayer&&(this.vm.callerContext.controlVideoPlayerStatus="stop")}pageVisiable(){this.vm.callerContext.hasLivePlayer&&(this.vm.materialViewModel.playFinished||(this.vm.callerContext.controlLivePlayerStatus="resume")),this.vm.materialViewModel.videoHasPlayed&&this.vm.callerContext.hasVideoPlayer&&this.vm.materialViewModel.videoEnableAutoPlay&&(this.vm.materialViewModel.playFinished||this.vm.getIsShowingExitPopup()||(this.vm.callerContext.controlVideoPlayerStatus="resume"))}pageInvisiable(){this.vm.materialViewModel.videoHasPlayed&&this.vm.callerContext.hasVideoPlayer&&(this.vm.callerContext.controlVideoPlayerStatus="pause"),this.vm.callerContext.hasLivePlayer&&(this.vm.callerContext.controlLivePlayerStatus="pause")}registerExtraDataListener(){Xt.registerExtraDataListener((t=>{t&&t.data&&this.extraDataCallback&&this.extraDataCallback(t.data.triggerType)}))}updateRenderStatus(t,e){super.updateRenderStatus(t,e),this.stopExpireDetect()}startExpireDetect(){Yt.setLoggerEnabled(!0),this.expireTimer=setTimeout((()=>{this.renderStatusCalled||this.updateRenderStatus(0,Yt.exportLog())}),2e3)}stopExpireDetect(){clearTimeout(this.expireTimer),Yt.setLoggerEnabled(!1),Yt.clear()}}).render()})();
//# sourceMappingURL=ksad-interstitial-card.766.js.map