(()=>{"use strict";class t extends TKView{constructor(t){super(),this.style={flexDirection:"row",alignItems:"center"},this.starArray=new Array;let e=0;for(;e<5;++e){let i=new TKImage;i.style={width:11,height:11,marginRight:4};t>10*e+5?i.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_star_all_fe3666.png"):t>10*e?i.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_star_half_fe3666.png"):i.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_star_gray_fe3666.png"),this.appendChild(i),this.starArray.push(i)}}}var e,i,n,a,s=null;function o(t){s=t}function r(){return s}function h(t){return t instanceof Error?t.stack?t.stack:t.message:"string"==typeof t?t:"number"==typeof t?t+"":"unknown"}function l(){return!g(Tachikoma.env.hasTKBridge)&&1==Tachikoma.env.hasTKBridge}function d(){return"Android"===Tachikoma.env.platform}function c(t,e){let i={x:0,y:0};if(f.supportMinimumTKVersion("4.0.0")){const n=e.getLocationOnScreen(),a=t.position;if(!n||!a)return i;a.x=parseFloat((a.x+"").replace("dp","")),a.y=parseFloat((a.y+"").replace("dp","")),i={x:n.x+a.x,y:n.y+a.y}}return i}function p(t){return"string"==typeof t&&t.length>0}function m(){return s?s.SDKVersion:Tachikoma.env.SDKVersion}function C(){return s?s.sdkType:Tachikoma.env.sdkType}function g(t){return null===t||null==t||""===t}function u(t){return!!g(t)||0==t.length}function w(t){if(t)for(const i in t){if("object"==typeof t[i]&&!i.includes("$"))try{t[i].nativeID||(t[i].nativeID=i),w(t[i])}catch(e){}}}class f{static isAndroid(){return"Android"===this.platform}static isSupportDownloadProgressListen(){return this.isAndroid()||f.supportMinimumTKVersion("5.0.4")}static getCurrentTimeStamp(){return(new Date).getTime()}static getSemiCircle(){return this.isAndroid()?180:Math.PI}static getRotateSemiCircle(){return this.isAndroid()?45:Math.PI}static compareVersion(t,e){if(void 0===t&&void 0===e)return 0;if(void 0===t)return-1;if(void 0===e)return 1;let i=t.split("."),n=e.split("."),a=Math.max(i.length,n.length);for(var s=0;s<a;s++){let t=Number(void 0!==i[s]?i[s]:"0"),e=Number(void 0!==n[s]?n[s]:"0");if(t>e)return 1;if(t!=e)return-1}return 0}static supportMinimumVersion(t="0.0.0",e="0.0.0"){let i=C(),n=1==i&&-1!=f.compareVersion(m(),t),a=2==i&&-1!=f.compareVersion(m(),e);return n||a}static supportCurrentVersion(t="0.0.0",e="0.0.0"){let i=C(),n=1==i&&0==f.compareVersion(m(),t),a=2==i&&0==f.compareVersion(m(),e);return n||a}static supportMinimumTKVersion(t="0.0.0"){return-1!=f.compareVersion(s?s.tkVersion:Tachikoma.env.tkVersion,t)}}f.platform=Tachikoma.env.platform;class T extends TKView{constructor(t,e,i){super();let n=e.adBaseInfo,a="#00000000";3==t?a="#00000019":0!=t&&(a="#00000025"),this.style={height:g(i)?16:i,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",backgroundColor:a,borderRadius:3==t?3:2};let s=3;if(2!=t){let e=null;1==t||3==t?p(n.adMarkIcon)&&(e=n.adMarkIcon):p(n.adGrayMarkIcon)&&(e=n.adGrayMarkIcon),p(e)&&(this.iconView=new TKImage,this.iconView.style={width:12,height:12,marginLeft:3,opacity:3==t?.4:1},s=4,this.appendChild(this.iconView),this.iconView.setSrc(e))}let o="#9C9C9C";0!=t&&(o="#FFFFFF"),this.titleLabel=new TKText,this.titleLabel.style={color:o,fontSize:10,marginLeft:s,marginRight:3,textAlign:"center",includeFontPadding:!1,opacity:3==t?.4:1};let r=n.adSourceDescription;r||(r="广告"),this.titleLabel.setText(r),this.appendChild(this.titleLabel)}setTitleColor(t){this.titleLabel&&(this.titleLabel.style={color:t},this.style={height:16,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",borderRadius:2})}}!function(t){t[t.NONE=-1]="NONE",t[t.ACTION_BAR_CLICK=1]="ACTION_BAR_CLICK",t[t.UNKNOWN_ITEM_CLICK=0]="UNKNOWN_ITEM_CLICK",t[t.PLAY_END_ICON_CLICK=15]="PLAY_END_ICON_CLICK",t[t.PLAY_END_ICON_TITLE_CLICK=16]="PLAY_END_ICON_TITLE_CLICK",t[t.PLAY_END_ICON_DESCRIPTION_CLICK=17]="PLAY_END_ICON_DESCRIPTION_CLICK",t[t.PLAY_END_ACTION_BAR_CLICK=26]="PLAY_END_ACTION_BAR_CLICK",t[t.CARD_ACTION_BAR_CLICK=29]="CARD_ACTION_BAR_CLICK",t[t.CARD_ICON_CLICK=30]="CARD_ICON_CLICK",t[t.CARD_ICON_NAME_CLICK=31]="CARD_ICON_NAME_CLICK",t[t.CARD_ICON_COMMENT_CLICK=32]="CARD_ICON_COMMENT_CLICK",t[t.CARD_BLANK_AREA_CLICK=35]="CARD_BLANK_AREA_CLICK",t[t.CARD_PLAY_END_CLICK1=37]="CARD_PLAY_END_CLICK1",t[t.CARD_PLAY_END_CLICK2=38]="CARD_PLAY_END_CLICK2",t[t.PLAY_END_CALL_CLICK=39]="PLAY_END_CALL_CLICK",t[t.PLAY_DETAIL_CALL_CLICK=40]="PLAY_DETAIL_CALL_CLICK",t[t.PLAY_END_GIFT_CLICK=41]="PLAY_END_GIFT_CLICK",t[t.CARD_APP_STORE_CLICK=45]="CARD_APP_STORE_CLICK",t[t.CARD_APP_DOWNLOAD_NUM_CLICK=46]="CARD_APP_DOWNLOAD_NUM_CLICK",t[t.CARD_OTHERAREA_CLICK=53]="CARD_OTHERAREA_CLICK",t[t.CARD_ICON_MOBILE_CLICK=54]="CARD_ICON_MOBILE_CLICK",t[t.CARD_PICTURE_CLICK_ONE=57]="CARD_PICTURE_CLICK_ONE",t[t.CARD_PICTURE_CLICK_TWO=58]="CARD_PICTURE_CLICK_TWO",t[t.CARD_PICTURE_CLICK_THREE=59]="CARD_PICTURE_CLICK_THREE",t[t.CARD_PICTURE_TITLE_CLICK_ONE=60]="CARD_PICTURE_TITLE_CLICK_ONE",t[t.CARD_PICTURE_TITLE_CLICK_TWO=61]="CARD_PICTURE_TITLE_CLICK_TWO",t[t.CARD_PICTURE_TITLE_CLICK_THREE=62]="CARD_PICTURE_TITLE_CLICK_THREE",t[t.CARD_PICTURE_SUBTITLE_CLICK_ONE=63]="CARD_PICTURE_SUBTITLE_CLICK_ONE",t[t.CARD_PICTURE_SUBTITLE_CLICK_TWO=64]="CARD_PICTURE_SUBTITLE_CLICK_TWO",t[t.CARD_PICTURE_SUBTITLE_CLICK_THREE=65]="CARD_PICTURE_SUBTITLE_CLICK_THREE",t[t.CARD_RANK_CLICK=75]="CARD_RANK_CLICK",t[t.CARD_DOWNLOAD_CNT_CLICK=76]="CARD_DOWNLOAD_CNT_CLICK",t[t.CARD_TAG_CLICK=77]="CARD_TAG_CLICK",t[t.CARD_ITEM_BULLET_CLICK=80]="CARD_ITEM_BULLET_CLICK",t[t.CARD_RECOMMEND_REASON_CLICK=84]="CARD_RECOMMEND_REASON_CLICK",t[t.CARD_PAGE_CLICK=85]="CARD_PAGE_CLICK",t[t.PLAYEND_ICON_OTHERAREA_CLICK=104]="PLAYEND_ICON_OTHERAREA_CLICK",t[t.INTERACT_LANDING_PAGE_CLICK=110]="INTERACT_LANDING_PAGE_CLICK",t[t.ACTIONBAR_ICON_CLICK=115]="ACTIONBAR_ICON_CLICK",t[t.ACTIONBAR_ICON_COMMENT_CLICK=117]="ACTIONBAR_ICON_COMMENT_CLICK",t[t.ACTIONBAR_ICON_OTHER_AREA_CLICK=118]="ACTIONBAR_ICON_OTHER_AREA_CLICK",t[t.CLOSE_BULLET_ICON_CLICK=127]="CLOSE_BULLET_ICON_CLICK",t[t.CLOSE_BULLET_ICON_TITLE_CLICK=128]="CLOSE_BULLET_ICON_TITLE_CLICK",t[t.CLOSE_BULLET_ICON_DESCRIPTION_CLICK=129]="CLOSE_BULLET_ICON_DESCRIPTION_CLICK",t[t.CLOSE_BULLET_OTHERAREA_CLICK=130]="CLOSE_BULLET_OTHERAREA_CLICK",t[t.CLOSE_BULLET_ACTION_BAR_CLICK=131]="CLOSE_BULLET_ACTION_BAR_CLICK",t[t.SPLASH_CONVERSION_BUTTON_CLICK=132]="SPLASH_CONVERSION_BUTTON_CLICK",t[t.NEO_AUTO_SHOW_STOREKIT=147]="NEO_AUTO_SHOW_STOREKIT",t[t.CARD_LEFT_ACTION_BAR_CLICK=150]="CARD_LEFT_ACTION_BAR_CLICK",t[t.CARD_SWIPE_CONVERT=153]="CARD_SWIPE_CONVERT",t[t.ONLINE_AUDIENCE_NUM=154]="ONLINE_AUDIENCE_NUM",t[t.SHAKE_ICON_SHACK=157]="SHAKE_ICON_SHACK",t[t.SHAKE_BIG_ICON_CLICK=158]="SHAKE_BIG_ICON_CLICK",t[t.ROTATE_ICON_ROTATE=161]="ROTATE_ICON_ROTATE",t[t.CARD_TROLLEY_ICON_CLICK=164]="CARD_TROLLEY_ICON_CLICK",t[t.LANDING_PAGE_OTHER_AREA_CLICK=171]="LANDING_PAGE_OTHER_AREA_CLICK",t[t.CARD_FOLLOW_NUM=172]="CARD_FOLLOW_NUM",t[t.FALL_ICON_CLICK=173]="FALL_ICON_CLICK",t[t.LIVE_BUTTON_CLICK=175]="LIVE_BUTTON_CLICK",t[t.DIRECT_H5_PAGE_CLICK=177]="DIRECT_H5_PAGE_CLICK",t[t.GOODS_ITEM_CARD_CLICK=178]="GOODS_ITEM_CARD_CLICK",t[t.GOODS_ITEM_CARD_SLIDE_CLICK=179]="GOODS_ITEM_CARD_SLIDE_CLICK",t[t.ITEM_HOT_BUY_STYLE_CLICK=180]="ITEM_HOT_BUY_STYLE_CLICK",t[t.GUIDE_ENTER_LIVE_CLICK=181]="GUIDE_ENTER_LIVE_CLICK",t[t.AUTO_CLICK_OTHER_AREA=182]="AUTO_CLICK_OTHER_AREA"}(e||(e={})),function(t){t[t.adClickReward=1]="adClickReward"}(i||(i={})),function(t){t[t.isRewarded=1]="isRewarded",t[t.noExtraReward=2]="noExtraReward",t[t.hasWatchReward=3]="hasWatchReward"}(n||(n={})),function(t){t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical"}(a||(a={}));const y="ad_convert_event";class A extends TKView{constructor(t){super(),this.vm=t}getHeight(){return 0}stopActionAnimation(){}convert(t,e,i){this.vm.convert(1,t,e,i)}addContainerTranslateYAction(t,e,i,n=500){let a=new TKKeyframeAnimation;a.animType="position",a.keyframes=[{percent:0,value:{x:0,y:t},easing:"EaseInEaseOut"},{percent:1,value:{x:0,y:e},easing:"EaseInEaseOut"}],a.duration=n,this.addAnimation(a,i)}addContainerAlphaAction(t,e,i=500){let n=new TKKeyframeAnimation;n.animType="opacity",n.keyframes=[{percent:0,value:t!=d()?1:0,easing:"EaseInEaseOut"},{percent:1,value:t?1:0,easing:"EaseInEaseOut"}],t&&n.on("end",(t=>{this.reportImpressionCallback()})),n.duration=i,this.addAnimation(n,e)}showActionBarAnim(){}onGetMiddleMarginBottom(t){return Number(this.getHeight())}}class I extends Object{constructor(t,e,i,n){var a;super(),this.depIds={},this.vm=t,this.getter="function"==typeof e?e:this.parseGetter(e.trim()),this.cb=i,this.value=this.get(),this.cb(null!==(a=this.value)&&void 0!==a?a:n,null),console.log("Watcher on "+e)}update(){const t=this.get();t!=this.value&&(this.cb.call(this.vm,t,this.value),this.value=t)}addDep(t){const e=t.pid;this.depIds.hasOwnProperty(e)||(t.addDep(this),this.depIds[e]=t)}get(){I.target=this;const t=this.getter.call(this.vm,this.vm);return I.target=null,t}parseGetter(t){if(/[^\w.$]/.test(t))return;const e=t.split(".");return function(t){for(let i=0,n=e.length;i<n;i++){if(!t)return;t=t[e[i]]}return t}}}function v(t){return!!t}function x(t){return"string"==typeof t}let _;function V(){if(null!=_)return _;let t=!1;try{t=!1,_=t}catch(e){}return t}function b(t,e){if(!0===V()&&(null==t||!1===t))throw new Error("tkmvvm ----- 请检查传值: "+e)}function L(t){V()&&console.log("tachikoma TKMVVM log -> "+t)}class k extends Object{constructor(t,e){super(),this.object=t,this.observeKey=e,this._observe(t,e)}_observe(t,e){var i=this;Array.isArray(t)?this.defineArray(t):Object.keys(t).forEach((function(n){e?e===n&&i.observeValueWithKey(t,n):i.observeValueWithKey(t,n)}))}observeValueWithKey(t,e){let i=t[e];var n=new D(e);E(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:function(){return I.target&&n.depend(),i},set:function(t){t!==i&&(i=t,n.notify(),E(t))}})}defineArray(t){if(t)for(let e=0,i=t.length;e<i;e++)E(t[e])}}var R=0;class D extends Object{constructor(t){super(),this.key=t,this.pid=R++,this.deps=new Array}depend(){I.target.addDep(this)}addDep(t){this.deps.push(t)}removeDep(t){}notify(){this.deps.forEach((function(t){t.update()}))}}function E(t,e){if(!t||"object"!=typeof t)return;var i;if(!("object"==typeof(i=t)&&Object.keys(i).length>0))return;let n=!1,a=(null!=e?e:"")+"_tkmvvm_observed";if(t.hasOwnProperty(a)&&(n=t[a]),!n)return L("observe "+a),t[a]=!0,new k(t,e);L("already observe "+a)}const F={updateBackgroundColor:function(t,e,i){if(b(e,"backgroundColor"),t&&e&&x(e)){const i=function(t){let e="#FE3666";return t?/^rgb|^hsl/.test(t)?t:(t.startsWith("#")||(t="#"+t),/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/.test(t)?t:e):e}(e);t.style={backgroundColor:i}}},updateStyle:function(t,e,i){b(e,"style"),t&&e&&(t.style=e)},updateText:function(t,e,i){if(b(e,"text"),t&&x(e)){const i=t.setText;"function"==typeof i&&i.call(t,e)}},updateSrc:function(t,e,i){if(b(e,"src"),t&&e&&x(e)){const i=t.setSrc;"function"==typeof i&&i.call(t,e)}}};class K extends Object{constructor(){super()}tk_observe(t){v(t)&&(t in this?E(this,t):console.log("=====++++++ observe2: key not in this:"+t+":"+typeof this))}}function B(t,e,i,n,a){if(!v(t)||!v(i))return;const s=e.charAt(0).toUpperCase()+e.slice(1),o=F["update"+s],r=O(i),h=null==r?void 0:r.split(".");if(!h)return void b(h,"tk_bind error, check bind path");const l=h[0],d=i.$vm;if(!d)return void b(d,"vm_bind get vm error");d.tk_observe(l),new I(d,r,((e,i)=>{if(a)for(let t=0;t<a.length;t++){a[t].dataCheck(e,r)}o&&o(t,e,i)}),n)}function S(t,e,i){if(!v(t)||!v(e)||!v(i))return;const n=O(e),a=null==n?void 0:n.split(".");if(!a)return void b(a,"tk_bind error, check bind path");const s=a[0];t.tk_observe(s),new I(t,n,((t,e)=>{i&&i(t)}))}function O(t){let e=function(t){if(t)return t.bind_path?t.$bind_path:"string"==typeof t?t:void 0}(t);if(e)return e;b(e,"tk_bind error, check bind path")}var N,P;!function(t){t.START="start",t.CENTRT="center",t.END="end"}(N||(N={})),function(t){t[t.unknown=0]="unknown",t[t.DetailOne=1]="DetailOne",t[t.Simple=2]="Simple",t[t.DetailTwo=3]="DetailTwo"}(P||(P={}));var M,W;!function(t){t[t.RETAIN_CARD_TYPE_2=9]="RETAIN_CARD_TYPE_2",t[t.RETAIN_CARD_TYPE_3=10]="RETAIN_CARD_TYPE_3",t[t.RETAIN_CARD_TYPE_4=11]="RETAIN_CARD_TYPE_4",t[t.RETAIN_CARD_TYPE_5=14]="RETAIN_CARD_TYPE_5",t[t.RETAIN_CARD_TYPE_7=16]="RETAIN_CARD_TYPE_7",t[t.RETAIN_CARD_TYPE_8=17]="RETAIN_CARD_TYPE_8",t[t.RETAIN_CARD_TYPE_9=18]="RETAIN_CARD_TYPE_9",t[t.RETAIN_CARD_TYPE_10=19]="RETAIN_CARD_TYPE_10",t[t.RETAIN_CARD_TYPE_11=20]="RETAIN_CARD_TYPE_11"}(M||(M={}));class H{}!function(t){t[t.UNKNOWN_LIVE_ROOM_PATTERN=0]="UNKNOWN_LIVE_ROOM_PATTERN",t[t.STANDARD_LIVE_ROOM_PATTERN=1]="STANDARD_LIVE_ROOM_PATTERN",t[t.SIMPLIFIED_LIVE_ROOM_PATTERN=2]="SIMPLIFIED_LIVE_ROOM_PATTERN"}(W||(W={}));class z{}const j=0;var U,G;!function(t){t[t.LIVE_CUT3_STYLE1=11]="LIVE_CUT3_STYLE1",t[t.LIVE_CUT3_STYLE2=12]="LIVE_CUT3_STYLE2"}(U||(U={})),function(t){t[t.LIVE_CUT3_STYLE2=1]="LIVE_CUT3_STYLE2"}(G||(G={}));function Y(t){let e=null;try{1==t.adBaseInfo.adOperationType&&p(t.adBaseInfo.appIconUrl)?e=t.adBaseInfo.appIconUrl:p(t.advertiserInfo.portraitUrl)&&(e=t.advertiserInfo.portraitUrl)}catch(i){}return e||"https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"}function $(t){let e={width:0,height:0};try{const i=t.adMaterialInfo.materialFeature[0];1==i.featureType?(e.width=i.videoWidth,e.height=i.videoHeight):e=i.materialSize}catch(i){}return e.width>0&&e.height>0?e:{width:1280,height:720}}function J(t){let e=null;try{switch(t.adBaseInfo.adOperationType){case 1:e=t.adBaseInfo.appName;break;case 2:e=t.adBaseInfo.productName}p(e)||(e=t.advertiserInfo.rawUserName)}catch(i){}return e||"可爱的广告君"}function X(t){try{return t.adStyleConfInfo.innerAdType}catch(e){}return 0}function q(t){try{return t.adStyleConfInfo.actionBarType}catch(e){}return 0}function Z(t){let e=!1;try{e=4==t.adStyleConfInfo.innerAdType||5==t.adStyleConfInfo.innerAdType}catch(i){}return e}function Q(t){return 1==X(t)}function tt(t){let e=null;try{if(e=t.advertiserInfo.fansCount,e>0&&e<1e4)return e+"";if(e>=1e4)return e=(e/1e4).toFixed(1)+"万",e}catch(i){}return""}function et(t,e){let i;switch(e){case 1:try{i=t.adMatrixInfo.adDataV2.middleTKCardInfo.templateId}catch(n){i=void 0}break;case 12:try{i=t.adMatrixInfo.adDataV2.neoTKInfo.templateId}catch(n){i=void 0}break;case 3:try{i=t.adMatrixInfo.adDataV2.fullScreenInfo.templateId}catch(n){i=void 0}break;case 2:try{i=t.adMatrixInfo.adDataV2.interstitialCardInfo.templateId}catch(n){i=void 0}break;case 4:try{i=t.adMatrixInfo.adDataV2.topFloorTKInfo.templateId}catch(n){i=void 0}break;case 6:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(n){i=void 0}break;case 5:try{i=t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.templateId}catch(n){i=void 0}break;case 7:try{i=t.adMatrixInfo.adDataV2.activityMiddlePageInfo.templateId}catch(n){i=void 0}break;case 10:try{i=t.adMatrixInfo.adDataV2.rewardVideoTaskInfo.templateId}catch(n){i=void 0}break;case 9:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(n){i=void 0}break;case 11:try{i=t.adMatrixInfo.adDataV2.pushTKInfo.templateId}catch(n){i=void 0}break;case 13:try{i=t.adMatrixInfo.adDataV2.splashEndCardTKInfo.templateId}catch(n){i=void 0}break;case 14:try{i=t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId}catch(n){i=void 0}break;case 15:try{i=t.adMatrixInfo.adDataV2.installedActivateInfo.templateId}catch(n){i=void 0}break;case 16:try{i=t.adMatrixInfo.adDataV2.videoImageTKInfo.templateId}catch(n){i=void 0}break;default:i=void 0}return i}function it(t,e){let i=et(t,e);if(!p(i))return;const n=t.adMatrixInfo.adDataV2.templateDatas.length;for(let a=0;a<n;a++){let e=t.adMatrixInfo.adDataV2.templateDatas[a];if(e.templateId==i)return e}}function nt(t){let e="";if(t<=0||t>36e5)return e;let i,n,a,s=Math.floor(t%1e3/100),o=Math.floor(t/1e3),r=Math.floor(o%60),h=Math.floor(o/60%60);return i=""+s.toString(),n=r<10?"0"+r.toString():r.toString(),a=h<10?"0"+h.toString():h.toString(),e=a+":"+n+":"+i,e}function at(t,e){let i=!0;if(1==t.adBaseInfo.adOperationType)try{let n=t.downloadSafeInfo.complianceInfo;if(null!=n)switch(e){case 1:i=3!=n.actionBarType;break;case 2:i=3!=n.describeBarType;break;case 3:i=3!=n.materialJumpType;break;default:i=!0}}catch(n){i=!0}else try{let n=t.unDownloadConf.unDownloadRegionConf;if(null!=n)switch(e){case 1:i=1!=n.actionBarType;break;case 2:i=1!=n.describeBarType;break;case 3:i=1!=n.materialJumpType;break;default:i=!0}}catch(n){i=!0}return i}function st(t,e,i){try{if(!function(t,e){try{if(!p(t.adConversionInfo.playableUrl))return!1;const i=t.adConversionInfo.playableStyleInfo.playableOrientation;return 0==i||2==i&&1==e||1==i&&0==e}catch(i){}return!1}(t,i))return j;if(3!=e){const e=function(t){let e;try{e=JSON.parse(t.adBaseInfo.expParam)}catch(i){}return e||{}}(t).playableStyle;return!e||e<=0?j:e}if(5==t.adMatrixInfo.adDataV2.actionBarInfo.cardType)return 1;if(6==t.adMatrixInfo.adDataV2.actionBarInfo.cardType)return 2}catch(n){}return j}function ot(t,e){try{let i=e.adMatrixInfo.adDataV2.templateDatas;for(let e=0;e<i.length;e++){let n=i[e];if(n&&t==n.templateId)return n}}catch(i){}}function rt(t){if(null==t)return;let e=null;try{e=JSON.parse(t.data).merchantPlayInfo}catch(i){}return e}function ht(t,e){if(g(e))return;if(!d())return void t.addEventListener("swipe",(t=>{e()}));let i=null,n=t=>{if("down"==t.type)i=t;else if("up"==t.type&&null!=i){let n=t.position.x,a=t.position.y,s=i.position.x,o=i.position.y;(Math.abs(n-s)>=10||Math.abs(a-o)>=10)&&e()}};t.addEventListener("down",n),t.addEventListener("up",n)}class lt extends A{constructor(i){super(i),this.style={width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",position:"absolute",bottom:0},this.logoView=new T(1,this.vm.adInfo),this.logoView.style={marginLeft:12,marginBottom:6},this.appendChild(this.logoView);const n=new TKView;n.style={backgroundColor:"#FFFFFF",height:90,width:"100%",paddingLeft:16,paddingRight:11,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.appendChild(n);const a=new TKView;a.style={flexDirection:"row",flexShrink:1},n.appendChild(a);let s=0;this.vm.isDownloadAd()&&(this.appIcon=new TKImage,this.appIcon.style={width:58,height:58,borderRadius:12},this.appIcon.setSrc(this.vm.getAdIcon()),a.appendChild(this.appIcon),s=12);const o=new TKView;if(o.style={marginLeft:s,height:58,flexDirection:"column",alignItems:"flex-start",justifyContent:"space-around",alignSelf:"stretch",flexWrap:"no-wrap",flexShrink:1,marginRight:16},a.appendChild(o),this.nameLabel=new TKText,this.nameLabel.style={fontSize:17,color:"#222222",flexWrap:"no-wrap",textLineClamp:1,textOverflow:"ellipsis"},o.appendChild(this.nameLabel),this.vm.isDownloadAd()){const i=1==this.vm.screenOrientation;this.nameLabel.setText(this.vm.getAdTitle());const n=new TKView;if(n.style={flexDirection:i?"row":"column"},o.appendChild(n),this.vm.getAppScore()>=30||p(this.vm.getAppDownloadCountDesc())){if(this.vm.getAppScore()>=30){const i=this.vm.getAppScore();this.scoreView=new t(i),this.scoreView.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_APP_STORE_CLICK)})),n.appendChild(this.scoreView)}if(p(this.vm.getAppDownloadCountDesc())){const t=this.vm.getAppDownloadCountDesc();this.downloadCountLabel=new TKText,this.downloadCountLabel.style={fontSize:12,color:"#666666",marginLeft:i?12:0,marginTop:i?0:5},this.downloadCountLabel.setText(t),this.downloadCountLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_APP_DOWNLOAD_NUM_CLICK)})),n.appendChild(this.downloadCountLabel)}}else this.descLabel=new TKText,this.descLabel.style={textLineClamp:1,fontSize:14,color:"#666666",textOverflow:"ellipsis"},this.descLabel.setText(this.vm.getAdDescription()),n.appendChild(this.descLabel),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)}))}else this.nameLabel.setText(this.vm.getAdTitle()),this.descLabel=new TKText,this.descLabel.style={textLineClamp:1,fontSize:14,color:"#666666",textOverflow:"ellipsis"},B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription),o.appendChild(this.descLabel),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)}));this.rightContainer=new TKView,n.appendChild(this.rightContainer),this.actionBtn=new TKButton,this.actionBtn.style={fontSize:16,color:"#FFFFFF",backgroundColor:"#FE3666",borderRadius:4,paddingLeft:20,paddingRight:20,marginTop:20,marginBottom:20,marginLeft:5,marginRight:5,height:46},B(this.actionBtn,"text",this.vm.$attrsPath.actionText),this.rightContainer.appendChild(this.actionBtn),this.rightContainer.clipChildren=!1;const r=new TKView;r.style={position:"absolute",left:0,right:0,top:0,bottom:0},this.rightContainer.appendChild(r),this.appIcon&&this.appIcon.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_CLICK)})),this.nameLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_NAME_CLICK)})),r.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK)})),n.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK)})),this.vm.supportSlideClick()&&(this.appIcon&&ht(this.appIcon,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.nameLabel,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(r,(()=>{this.convert(1,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(n,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)}))),this.startActionAnimation(),this.vm.isAnimFinishCallback&&this.vm.isAnimFinishCallback()}startActionAnimation(){this.animationAllowed=!0,setTimeout((()=>{if(!this.animationAllowed)return;let t=new TKKeyframeAnimation;t.animType="rotationZ",t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.11,value:-f.getRotateSemiCircle()/9,easing:"EaseInEaseOut"},{percent:.22,value:f.getRotateSemiCircle()/4.5,easing:"EaseInEaseOut"},{percent:.33,value:-f.getRotateSemiCircle()/4.5,easing:"EaseInEaseOut"},{percent:.44,value:f.getRotateSemiCircle()/4.5,easing:"EaseInEaseOut"},{percent:.55,value:-f.getRotateSemiCircle()/6,easing:"EaseInEaseOut"},{percent:.66,value:f.getRotateSemiCircle()/9,easing:"EaseInEaseOut"},{percent:.77,value:-f.getRotateSemiCircle()/12,easing:"EaseInEaseOut"},{percent:.88,value:f.getRotateSemiCircle()/18,easing:"EaseInEaseOut"},{percent:.95,value:-f.getRotateSemiCircle()/36,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}];t.duration=1500,t.delay=500,t.on("end",(e=>{e?this.addActionRotateAnim(t):setTimeout((()=>{this.addActionRotateAnim(t)}),1500)})),this.addActionRotateAnim(t)}),1e3)}addActionRotateAnim(t){this.animationAllowed&&this.actionBtn.addAnimation(t,"rotate")}stopActionAnimation(){this.animationAllowed=!1,this.actionBtn&&this.actionBtn.removeAllAnimation()}getDefaultHeight(){return 112}getHeight(){return this.hasInteract?this.limitSize.height:this.getDefaultHeight()}}class dt{static randomString(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i="",n=0;n<t;n++)i+=e.charAt(Math.floor(48*Math.random()));return i}static randomName(t){return"jscb_"+t+"_"+this.randomString(4)+this.globalIndex++}static registerCallback(t,e=!0){return this.registerCallbackForAction(t,e,"")}static registerCallbackForAction(t,e=!0,i){if(!t)return null;const n=this.randomName(i);return Tachikoma[n]=e=>{t(e)},"Tachikoma."+n}}dt.globalIndex=0;const ct=new class{constructor(){this.enabled=!1,this.logs=[]}setLoggerEnabled(t){this.enabled=t}log(t){if(this.enabled){const e=new Date;0==this.logs.length&&this.logs.push(e.getMonth()+1+":"+e.getDate()+"-"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.logs.push(e.getMilliseconds()+":"+t)}}clear(){this.logs.splice(0,this.logs.length)}exportLog(){return JSON.stringify(this.logs)}};class pt{static getDeviceInfoAsync(){return pt.callNative("getDeviceInfo",null)}static getKsAdDataAsync(){return pt.callNative("getKsAdData",null)}static getKsAdConfigAsync(){return pt.callNative("getKsAdConfig",null)}static getScreenOrientationAsync(){return pt.callNative("getScreenOrientation",null)}static getVideoCloseTime(){return pt.callNative("getVideoCloseTime",null)}static getContainerLimitAsync(){return pt.callNative("getContainerLimit",null)}static getTKPreEnvAsync(){return pt.callNative("getTKPreEnv",null)}static getDeviceInfo(t){this.callNativeWithCallback("getDeviceInfo",null,t)}static getKsAdData(t){this.callNativeWithCallback("getKsAdData",null,t)}static getKsAdConfig(t){this.callNativeWithCallback("getKsAdConfig",null,t)}static getScreenOrientation(t){this.callNativeWithCallback("getScreenOrientation",null,t)}static getContainerLimit(t){return this.callNativeWithCallback("getContainerLimit",null,t)}static registerLifecycleListener(t){this.callNativeWithCallback("registerLifecycleListener",null,t,!1)}static registerNativeId(t){this.callNativeWithCallback("configNativeId",null,t,!1)}static registerExtraDataListener(t){this.callNativeWithCallback("getKsAdExtraData",null,t,!1)}static hideCard(t,e,i,n=!0){this.callNativeWithCallback("hide",{type:t,playDuration:e},i,n)}static sendLog(t,e){this.callNativeWithCallback("log",t,e)}static sendCommonLog(t,e){this.callNativeWithCallback("commonLog",t,e)}static sendCommercialLog(t,e){this.callNativeWithCallback("commercialLog",t,e)}static pageStatus(t,e){this.callNativeWithCallback("pageStatus",{status:t,errorMsg:p(e)?e:""})}static clickAction(t,e,i,n){this.clickActionBase(Object.assign({area:t,logParam:e},i),n)}static clickActionBase(t,e){this.callNativeWithCallback("clickAction",t,e)}static convert(t){this.callNativeWithCallback("convert",{clickActionButton:t})}static updateExceptedPosition(t){this.callNativeWithCallback("initKsAdFrame",t)}static replayVideo(){this.callNativeWithCallback("replayVideo")}static registerVideoListener(t){this.callNativeWithCallback("registerVideoListener",null,t,!1)}static dislike(){this.callNativeWithCallback("dislike")}static registerProgressListener(t){this.callNativeWithCallback("registerProgressListener",null,t,!1)}static registerVideoProgressListener(t){this.callNativeWithCallback("registerVideoProgressListener",null,t,!1)}static registerGetDynamicActionDesListener(t){this.callNativeWithCallback("getDynamicActionDes",null,t,!1)}static registerTimerListener(t){this.callNativeWithCallback("registerTimerListener",null,t,!1)}static registerVideoMuteStateListener(t){this.callNativeWithCallback("registerMuteStateListener",null,t,!1)}static registerVideoAutoPlayListener(t){this.callNativeWithCallback("registerVideoAutoPlayListener",null,t,!1)}static registerPlayStateResetListener(t){this.callNativeWithCallback("registerPlayStateResetListener",null,t,!1)}static updateVideoMuteState(t){this.callNativeWithCallback("updateVideoMuteState",{muted:t})}static skipVideo(t,e,i,n=0){this.callNativeWithCallback("skipVideo",{needPromopt:t,needReport:e,showTime:i,playDuration:n})}static closeVideo(t){this.callNativeWithCallback("closeVideo",{forceClose:t})}static showPlayEnd(t,e=0){this.callNativeWithCallback("showPlayEnd",{userForce:t,type:e})}static showPlayable(t=0){this.callNativeWithCallback("showPlayable",{playableSource:t})}static registerSceneChangeListener(t){this.callNativeWithCallback("registerSceneChangeListener",null,t,!1)}static hasReward(t){this.callNativeWithCallback("hasReward",{severCheckResult:t})}static clickGift(){this.callNativeWithCallback("clickGift")}static clickCall(t){this.callNativeWithCallback("clickCall",{isEnd:t})}static callButtonImpressionWhenPlay(){this.callNativeWithCallback("callButtonImpressionWhenPlay")}static callButtonImpressionWhenFinish(){this.callNativeWithCallback("callButtonImpressionWhenFinish")}static registerDeepRewardListener(t){this.callNativeWithCallback("registerDeepRewardListener",null,t,!1)}static giveRewardInAdvance(t){this.callNativeWithCallback("giveRewardInAdvance",null,t,!1)}static showLiveEndPage(t){this.callNativeWithCallback("showLiveEndPage",null,t,!1)}static updateRewardTaskState(t){this.callNativeWithCallback("updateRewardTaskState",null,t,!1)}static openURL(t,e){this.callNativeWithCallback("openURL",{url:t,title:e})}static showTKDialog(t){this.callNativeWithCallback("showTKDialog",{templateId:t})}static closeTKDialog(t){this.callNativeWithCallback("closeTKDialog",{templateId:t})}static registerKeyboardChangeListener(t){this.callNativeWithCallback("registerKeyboardChangeListener",null,t,!1)}static registerShakeListener(t){this.callNativeWithCallback("registerMotionListener",null,t,!1)}static close(t){this.callNativeWithCallback("close",null,t,!1)}static closePassData(t,e){this.callNativeWithCallback("close",t,e,!1)}static updateVideoPlayStatus(t,e,i,n){this.callNativeWithCallback("updateVideoPlayStatus",{status:t,errorCode:e||0,errorReason:i||"",currentTime:n||0})}static registerConvertStatusListener(t){this.callNativeWithCallback("registerConvertStatusListener",null,t,!1)}static cardImpression(){this.callNativeWithCallback("cardImpression")}static getCardShowCount(t){this.callNativeWithCallback("getCardShowCount",null,t,!1)}static getNativeData(t,e){this.callNativeWithCallback("getNativeData",{target:t},e,!1)}static updateExtraReward(t){this.callNativeWithCallback("updateExtraReward",t)}static registerApkInstalledListener(t){this.callNativeWithCallback("registerApkInstalledListener",null,t,!1)}static showToast(t){this.callNativeWithCallback("showToast",{message:t})}static registerExtraDialogListener(t){this.callNativeWithCallback("registerExtraDialogListener",null,t,!1)}static getPlayEndType(t){this.callNativeWithCallback("getPlayEndType",null,t,!1)}static playableConvert(t){this.callNativeWithCallback("playableConvert",t)}static getKsPlayableAdData(t){this.callNativeWithCallback("getKsPlayableAdData",null,t)}static getKsPlayableDeviceInfo(t){this.callNativeWithCallback("getKsPlayableDeviceInfo",null,t)}static registerPlayableStatusListener(t){this.callNativeWithCallback("registerPlayableStatusListener",null,t,!1)}static getTrackAdStatus(t){this.callNativeWithCallback("getTrackAdStatus",null,t,!1)}static showLandingPage(t){this.callNative("showLandingPage",{needCloseNeo:t})}static needCloseNeo(t){this.callNativeWithCallback("needCloseNeo",{needClose:t})}static registerBackPressed(t){this.callNativeWithCallback("registerBackPressedListener",null,t,!1)}static innerAdImpression(){this.callNativeWithCallback("adImpression",null)}static neoDidShowPlayAgain(){this.callNativeWithCallback("neoDidShowPlayAgain")}static showPlayAgain(){this.callNativeWithCallback("showPlayAgain")}static registerAggregationDataListener(t){this.callNativeWithCallback("registerAggregationDataListener",null,t,!1)}static getLandingPageInfo(t){this.callNativeWithCallback("getLandingPageInfo",null,t,!1)}static registerNeoStatusListener(t){this.callNativeWithCallback("registerNeoStatusListener",null,t,!1)}static callNative(t,e){return new Promise(((i,n)=>this.callNativeWithCallback(t,e,(t=>{t?(1!=t.result&&(t.result=null),i(t)):i({result:0,data:null})}))))}static callNativeWithCallback(t,e,i,n=!0){const a=l()?1:0;l()&&"pageStatus"==t||l()&&"registerLifecycleListener"==t?this.callNativeWithCallbackAndType(t,e,i,n,0):this.callNativeWithCallbackAndType(t,e,i,n,a)}static callTKWithCallback(t,e,i,n=!0){this.callNativeWithCallbackAndType(t,e,i,n,1)}static callNativeWithCallbackAndType(t,e,i,n=!0,a=0){if("undefined"==typeof KwaiAd)return ct.log("undefined value KwaiAd"),void(i&&i({result:0,data:null}));ct.log("call:"+t);let s=e=>{let n=0,a=null;try{let t=null;t="string"==typeof e?JSON.parse(e):e,n=t.result,a=t.data}catch(s){n=0,a=null}ct.log("cb:"+t+"  r:"+n),i&&i({result:n,data:a})};const o=dt.registerCallbackForAction(s,n,t),r={action:t,data:JSON.stringify(e||{}),callback:!0===Tachikoma.env.useNewBridge?s:o};0==a?KwaiAd.callAdBridge(r):KwaiAd.callTKBridge(r)}}class mt extends A{constructor(t){super(t),this.style={width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",position:"absolute",bottom:0};const i=new TKView;i.style={backgroundColor:"#00000000",height:68,width:"100%",paddingLeft:12,paddingRight:12,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.appendChild(i);const n=new TKProgressBar;n.style={backgroundColor:"#FF9BB3",width:"100%",height:44,cornerRadius:22,indeterminate:!1};const a=new TKProgressBar;a.style={backgroundColor:"#FE3666",width:"100%",height:44,cornerRadius:22,position:"absolute",left:12,top:12};const s=new TKText;s.style={fontSize:16,fontWeight:"bold",color:"#FFFFFF",width:"100%",height:44,textAlign:"center",position:"absolute",top:12,left:12},i.appendChild(n),i.appendChild(a),i.appendChild(s),B(s,"text",this.vm.$attrsPath.actionText),a.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK)})),n.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK)})),i.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK)})),this.vm.isAnimFinishCallback&&this.vm.isAnimFinishCallback()}getHeight(){return 68}}class Ct extends A{constructor(i){super(i),this.cardDelayShowTime=5,this.style={width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",position:"absolute",bottom:-80},this.logoView=new T(1,this.vm.adInfo),this.logoView.style={marginLeft:12,marginBottom:12},this.appendChild(this.logoView);const n=new TKView;n.style={backgroundColor:"#FFFFFF",height:80,width:"100%",paddingLeft:16,paddingRight:16,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.appendChild(n);const a=new TKView;a.style={flexDirection:"row",flexShrink:1},n.appendChild(a);this.appIcon=new TKImage,this.appIcon.style={width:58,height:58,borderRadius:12,borderColor:"#EAEAEA",borderWidth:.5},this.appIcon.setSrc(this.vm.getAdIcon()),a.appendChild(this.appIcon);const s=new TKView;if(s.style={marginLeft:12,height:55,flexDirection:"column",alignItems:"flex-start",justifyContent:"space-around",alignSelf:"center",flexWrap:"no-wrap",flexShrink:1,marginRight:8},a.appendChild(s),this.nameLabel=new TKText,this.nameLabel.style={fontSize:15,color:"#222222",flexWrap:"no-wrap",textLineClamp:1,textOverflow:"ellipsis"},s.appendChild(this.nameLabel),this.nameLabel.setText(this.vm.getAdTitle()),this.vm.isDownloadAd()){const i=new TKView;if(i.style={flexDirection:"column",alignItems:"flex-start",justifyContent:"center",alignSelf:"stretch"},s.appendChild(i),this.vm.getAppScore()>=30){const n=this.vm.getAppScore();this.scoreView=new t(n),this.scoreView.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_APP_STORE_CLICK)})),i.appendChild(this.scoreView)}this.descLabel=new TKText,this.descLabel.style={textLineClamp:1,fontSize:14,color:"#666666",marginTop:2,textOverflow:"ellipsis"},B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription,""),i.appendChild(this.descLabel),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)}))}else this.descLabel=new TKText,this.descLabel.style={textLineClamp:1,fontSize:14,color:"#666666",textOverflow:"ellipsis"},B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription),s.appendChild(this.descLabel),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)}));this.rightContainer=new TKView,this.rightContainer.style={flexDirection:"column",justifyContent:"center",alignItems:"center"},n.appendChild(this.rightContainer),this.actionBtn=new TKButton,this.actionBtn.style={fontSize:14,color:"#FFFFFF",backgroundColor:"#FE3666",borderRadius:18,width:88,height:36},B(this.actionBtn,"text",this.vm.$attrsPath.actionText),this.rightContainer.appendChild(this.actionBtn);const o=new TKView;o.style={position:"absolute",left:0,right:0,top:0,bottom:0},this.rightContainer.appendChild(o),this.appIcon&&this.appIcon.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_CLICK)})),this.nameLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_NAME_CLICK)})),o.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK)})),n.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK)})),this.vm.supportSlideClick()&&(this.appIcon&&ht(this.appIcon,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.nameLabel,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(o,(()=>{this.convert(1,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(n,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)}))),this.startActionAnimation()}startActionAnimation(){const t=this.vm.supportNewAnimation();setTimeout((()=>{if(this.animationAllowed=!0,!this.animationAllowed)return;let e=null;if(t){const t=new TKBasicAnimation;t.setEndValue((()=>{this.style={transform:{translate:{y:-80}}}})),e=t}else{const t=new TKKeyframeAnimation;t.animType="position",t.keyframes=[{percent:0,value:{x:0,y:0},easing:"EaseInEaseOut"},{percent:1,value:{x:0,y:f.isAndroid()?-80:0},easing:"EaseInEaseOut"}],e=t}e.duration=500,this.addActionTranslateAnim(e)}),1e3*this.cardDelayShowTime),f.isAndroid()||t||this.resetIOSFrame()}resetIOSFrame(){setTimeout((()=>{this.style={bottom:0}}),1e3*this.cardDelayShowTime+500)}addActionTranslateAnim(t){this&&(this.addAnimation(t,"translate"),t.on("end",(t=>{this.vm.isAnimFinishCallback&&this.vm.isAnimFinishCallback()})))}getHeight(){return 108}}class gt extends TKView{constructor(t,e=0,i=18,n=2,a=12){if(super(),t&&t.length>0){this.style={display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",height:i,overflow:"hidden"},this.tagArray=new Array;let s=t.length>3?3:t.length,o="#FFFFFF",r="#FE3666",h="#FE3666",l="normal";1==e&&(o="#FFE1E8",r="#FFFFFF00",h="#FE3666",l="medium"),2==e&&(o="#FFFFFF",r="#666666",h="#666666",l="normal");let d=0;for(;d<s;++d){let e=new TKText;e.style={backgroundColor:o,textAlign:"center",height:i,paddingLeft:8,paddingRight:8,marginRight:d==s-1?0:8,color:h,borderWidth:1,fontSize:a,fontWeight:l,borderColor:r,borderRadius:n},e.setText(t[d].text),this.appendChild(e)}}}}class ut extends A{constructor(i){super(i),this.cardDelayShowTime=5;let n=this.vm.getAdTagList();this.hasTags=n&&n.length>0,this.hasScore=this.vm.getAppScore()>=30,this.cardHeight=this.hasScore||this.hasTags?156:136,this.style={width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",position:"absolute",paddingLeft:16,paddingRight:16,bottom:-1*(this.cardHeight+16)},this.logoView=new T(1,this.vm.adInfo),this.logoView.style={marginBottom:10},this.appendChild(this.logoView);const a=new TKView;a.style={backgroundColor:"#FFFFFF",height:this.cardHeight,width:"100%",paddingLeft:12,paddingRight:12,paddingTop:12,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16,borderRadius:12},this.appendChild(a);const s=new TKView;s.style={flexDirection:"row",width:"100%",position:"relative"},a.appendChild(s);const o=new TKView;if(o.style={width:"100%",height:58,paddingLeft:70,flexDirection:"column",justifyContent:"space-around"},s.appendChild(o),this.appIcon=new TKImage,this.appIcon.style={width:58,height:58,position:"absolute",top:0,left:0,borderRadius:12,marginRight:12,borderColor:"#EAEAEA",borderWidth:.5},this.appIcon.setSrc(this.vm.getAdIcon()),s.appendChild(this.appIcon),this.nameLabel=new TKText,this.nameLabel.style={fontSize:21,color:"#222222",textLineClamp:1,textOverflow:"ellipsis"},o.appendChild(this.nameLabel),this.nameLabel.setText(this.vm.getAdTitle()),this.descLabel=new TKText,this.descLabel.style={textLineClamp:1,fontSize:14,color:"#666666",textOverflow:"ellipsis"},B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)})),this.hasScore||this.hasTags){let i=!1;const s=new TKView;if(s.style={flexDirection:"row",width:"100%",height:18,marginTop:6,position:"relative"},o.appendChild(s),this.hasScore){i=!0;const n=this.vm.getAppScore();this.scoreView=new t(n),this.scoreView.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_APP_STORE_CLICK)})),this.scoreView.style={width:75,position:"absolute",left:0,bottom:3.5},s.appendChild(this.scoreView)}this.hasTags&&(this.tagView=new gt(n),this.tagView.style={paddingLeft:i?80:0},s.appendChild(this.tagView)),a.appendChild(this.descLabel)}else o.appendChild(this.descLabel);this.bottomBtnContainer=new TKView,this.bottomBtnContainer.style={flexDirection:"column",justifyContent:"center",width:"100%",height:40,marginBottom:12,alignItems:"center"},a.appendChild(this.bottomBtnContainer),this.actionBtn=new TKButton,this.actionBtn.style={fontSize:14,color:"#FFFFFF",backgroundColor:"#FE3666",borderRadius:22,height:40,width:"100%"},B(this.actionBtn,"text",this.vm.$attrsPath.actionText),this.bottomBtnContainer.appendChild(this.actionBtn);const r=new TKView;r.style={position:"absolute",left:0,right:0,top:0,bottom:0},this.bottomBtnContainer.appendChild(r),this.appIcon&&this.appIcon.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_CLICK)})),this.nameLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_NAME_CLICK)})),r.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK)})),a.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK)})),this.vm.supportSlideClick()&&(this.appIcon&&ht(this.appIcon,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.nameLabel,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(r,(()=>{this.convert(1,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(a,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)}))),this.startActionAnimation()}startActionAnimation(){const t=this.vm.supportNewAnimation();setTimeout((()=>{if(this.animationAllowed=!0,!this.animationAllowed)return;let e=null;if(t){const t=new TKBasicAnimation;t.setEndValue((()=>{this.style={transform:{translate:{y:-1*(this.cardHeight+16)}}}})),e=t}else{const t=new TKKeyframeAnimation;t.animType="position",t.keyframes=[{percent:0,value:{x:0,y:0},easing:"EaseInEaseOut"},{percent:1,value:{x:0,y:f.isAndroid()?-(this.cardHeight+16):0},easing:"EaseInEaseOut"}],e=t}e.duration=800,this.addActionTranslateAnim(e)}),1e3*this.cardDelayShowTime),f.isAndroid()||t||this.resetIOSFrame()}resetIOSFrame(){setTimeout((()=>{this.style={bottom:0}}),1e3*this.cardDelayShowTime+800)}addActionTranslateAnim(t){this&&(this.addAnimation(t,"translate"),t.on("end",(t=>{this.vm.isAnimFinishCallback&&this.vm.isAnimFinishCallback()})))}getHeight(){return this.cardHeight+16+10+16}}class wt extends A{constructor(t){super(t),this.style={width:"100%",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",paddingLeft:16,paddingRight:16,paddingBottom:16},this.logoView=new T(1,this.vm.adInfo),this.logoView.style={marginLeft:0,marginBottom:6};const i=new TKView;i.style={backgroundColor:"#FFFFFF",height:82,paddingLeft:12,paddingRight:12,flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderRadius:12},0==this.vm.screenOrientation?(i.style={width:"100%"},this.appendChild(this.logoView),this.appendChild(i)):(this.style={flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between"},this.logoView.style={marginRight:0,marginBottom:0},i.style={width:434},this.appendChild(i),this.appendChild(this.logoView)),this.appIcon=new TKImage,this.appIcon.style={width:58,height:58,borderRadius:12,marginRight:12,borderColor:"#EAEAEA",borderWidth:.5},this.appIcon.setSrc(this.vm.getAdIcon()),i.appendChild(this.appIcon);let n=new TKView;n.style={height:55,width:"100%",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-around",flexWrap:"no-wrap",flexShrink:1},i.appendChild(n),this.nameLabel=new TKText,this.nameLabel.style={fontSize:15,color:"#222222",textLineClamp:1,textOverflow:"ellipsis"},n.appendChild(this.nameLabel),this.nameLabel.setText(this.vm.getAdTitle()),this.descLabel=new TKText,this.descLabel.style={textLineClamp:1,fontSize:14,color:"#666666",textOverflow:"ellipsis"},n.appendChild(this.descLabel),B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription),this.actionBtn=new TKButton,this.actionBtn.style={fontSize:14,color:"#FFFFFF",backgroundColor:"#FE3666",borderRadius:18,height:36,width:88},B(this.actionBtn,"text",this.vm.$attrsPath.actionText),i.appendChild(this.actionBtn),this.appIcon&&this.appIcon.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_CLICK)})),this.nameLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_NAME_CLICK)})),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)})),this.actionBtn.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK)})),i.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK)})),this.vm.supportSlideClick()&&(this.appIcon&&ht(this.appIcon,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.nameLabel,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.descLabel,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.actionBtn,(()=>{this.convert(1,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(i,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)}))),this.vm.isAnimFinishCallback&&this.vm.isAnimFinishCallback()}getHeight(){return 1==this.vm.screenOrientation?98:120}}class ft extends A{constructor(t){super(t),this.cardDelayShowTime=3,this.cardHeight=130,this.style={width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",position:"absolute",paddingLeft:16,paddingRight:16,bottom:-56},this.bottomContainerConver=new TKView,this.bottomContainerConver.style={opacity:0,backgroundColor:"#FFFFFF",position:"absolute",borderRadius:12,left:0,right:0,height:this.cardHeight,bottom:-146},this.bottomContainer=new TKView,this.bottomContainer.style={height:this.cardHeight+16,width:"100%",paddingBottom:16,borderRadius:12,paddingLeft:12,paddingRight:12,paddingTop:12,flexDirection:"column",alignItems:"flex-start"},this.appendChild(this.bottomContainer),this.bottomContainer.appendChild(this.bottomContainerConver);const i=new TKView;i.style={flexDirection:"row",width:"100%"},this.bottomContainer.appendChild(i),this.textContainer=new TKView,this.textContainer.style={width:"100%",height:58,justifyContent:"center",paddingLeft:70,flexDirection:"column"},i.appendChild(this.textContainer),this.appIcon=new TKImage,this.appIcon.style={width:58,height:58,position:"absolute",top:0,left:0,borderRadius:12,marginRight:12,borderColor:"#EAEAEA",borderWidth:.5},this.appIcon.setSrc(this.vm.getAdIcon()),i.appendChild(this.appIcon),this.nameContainer=new TKView,this.nameContainer.style={width:"100%",height:24,alignItems:"center",flexDirection:"row"},this.logoView=new T(0,this.vm.adInfo),this.logoView.style={marginLeft:10},this.nameLabel=new TKText,this.nameLabel.style={fontSize:17,textAlign:"center",color:"#FFFFFF",textLineClamp:1,textOverflow:"ellipsis",flexShrink:1},this.nameContainer.appendChild(this.nameLabel),this.nameContainer.appendChild(this.logoView),this.textContainer.appendChild(this.nameContainer),this.nameLabel.setText(this.vm.getAdTitle()),this.descLabel=new TKText,this.descLabel.style={marginTop:4,textLineClamp:1,fontSize:14,color:"#FFFFFF",textOverflow:"ellipsis"},B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription,""),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)})),this.textContainer.appendChild(this.descLabel),this.bottomBtnContainer=new TKView,this.bottomBtnContainer.style={marginTop:8,flexDirection:"column",justifyContent:"center",width:"100%",height:40,alignItems:"center",opacity:0},this.bottomContainer.appendChild(this.bottomBtnContainer),this.actionBtnContainer=new TKView,this.actionBtnContainer.style={backgroundColor:"#FFFFFF",opacity:.2,justifyContent:"center",height:40,width:"100%",borderRadius:20},this.bottomBtnContainer.appendChild(this.actionBtnContainer),this.actionBtn=new TKText,this.actionBtn.style={position:"absolute",left:0,right:0,top:0,bottom:0,fontSize:14,color:"#FFFFFF",textAlign:"center",borderRadius:22},B(this.actionBtn,"text",this.vm.$attrsPath.actionText,""),this.bottomBtnContainer.appendChild(this.actionBtn),this.appIcon&&this.appIcon.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_CLICK)})),this.nameLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_NAME_CLICK)})),this.actionBtn.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK)})),this.bottomContainer.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK)})),this.vm.supportSlideClick()&&(this.appIcon&&ht(this.appIcon,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.nameLabel,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.actionBtn,(()=>{this.convert(1,{x:0,y:0},e.CARD_SWIPE_CONVERT)})),ht(this.bottomContainer,(()=>{this.convert(2,{x:0,y:0},e.CARD_SWIPE_CONVERT)}))),this.startActionAnimation()}startActionAnimation(){setTimeout((()=>{this.animationAllowed=!0,this.animationAllowed&&this.addActionTranslateAnim()}),1e3*this.cardDelayShowTime),f.isAndroid()||this.vm.supportNewAnimation()||this.resetIOSFrame()}resetIOSFrame(){setTimeout((()=>{this.style={bottom:0},this.bottomContainerConver.style={height:this.cardHeight+16,bottom:15}}),1e3*this.cardDelayShowTime+4500)}addActionTranslateAnim(){this.vm.supportNewAnimation()?this.updateBottom(this,-48,"translate"):this.addTranslateAction(this,f.isAndroid()?0:8,f.isAndroid()?-48:8,"translate");let t=new TKKeyframeAnimation;t.animType="opacity",t.keyframes=[{percent:0,value:1,easing:"EaseInEaseOut"},{percent:1,value:1,easing:"EaseInEaseOut"}],t.duration=500,t.on("end",(t=>{setTimeout((()=>{this.actionBtnContainer.style={backgroundColor:"#FE3666"},this.addActionAlphaAnim(this.actionBtnContainer,f.isAndroid()?.2:1,1,"actionBtnContainerColorOpacity",500,1500,(t=>{this.addActionInfoAndBgChangeAnim()}))}),1500)})),this.bottomBtnContainer.addAnimation(t,"bottomBtnContainerOpacity")}updateAppInfoColor(){this.nameLabel.style={color:"#222222"},this.descLabel.style={color:"#666666"},this.logoView.setTitleColor("#D3D3D3"),this.nameContainer.style={width:"100%",height:24,alignItems:"center",flexDirection:"row"},this.textContainer.style={width:"100%",height:58,justifyContent:"center",paddingLeft:70,flexDirection:"column"}}addActionInfoAndBgChangeAnim(){this.vm.supportNewAnimation()?(this.updateBottom(this,-56,"infotranslate"),this.updateBottom(this.bottomContainerConver,-162,"bottomContainerConverTranslate")):(this.addTranslateAction(this,f.isAndroid()?-48:0,f.isAndroid()?-56:0,"infotranslate"),this.addTranslateAction(this.bottomContainerConver,0,f.isAndroid()?-162:0,"bottomContainerConverTranslate",500)),this.addActionAlphaAnim(this.bottomContainerConver,f.isAndroid()?0:1,1,"cardOpacity"),setTimeout((()=>{this.updateAppInfoColor(),this.vm.isAnimFinishCallback&&this.vm.isAnimFinishCallback()}),300)}addActionAlphaAnim(t,e,i,n,a=500,s=0,o=void 0){let r=new TKKeyframeAnimation;r.animType="opacity",r.keyframes=[{percent:0,value:e,easing:"EaseInEaseOut"},{percent:1,value:i,easing:"EaseInEaseOut"}],r.duration=a,r.on("end",(t=>{o&&setTimeout((()=>{o(t)}),s)})),t&&t.addAnimation(r,n)}addTranslateAction(t,e,i,n,a=500){let s=new TKKeyframeAnimation;s.animType="position",s.keyframes=[{percent:0,value:{x:0,y:e},easing:"EaseInEaseOut"},{percent:1,value:{x:0,y:i},easing:"EaseInEaseOut"}],s.duration=a,t&&t.addAnimation(s,n)}updateBottom(t,e,i,n=500){const a=new TKBasicAnimation;a.setEndValue((()=>{t.style={transform:{translate:{y:e}}}})),a.duration=n,t&&t.addAnimation(a,i)}stopActionAnimation(){this.animationAllowed=!1,this&&this.removeAllAnimation()}getHeight(){return this.cardHeight+16}}let Tt;function yt(){var t;return Tt||(Tt={all:t=t||new Map,on(e,i){const n=t.get(e);n?n.push(i):t.set(e,[i])},off(e,i){const n=t.get(e);n&&(i?n.splice(n.indexOf(i)>>>0,1):t.set(e,[]))},emit(e,i){let n=t.get(e);n&&n.slice().map((t=>{t(i)})),n=t.get("*"),n&&n.slice().map((t=>{t(e,i)}))},clear(){t.clear()}}),Tt}class At{static log(t,e,i){(i=i||{}).renderContainer=1;const n={actionType:t,payload:JSON.stringify(i)};e&&(n.clickInfo=e),pt.sendLog(n)}static convertIfNeeded(t,e,i,n,a,s,o,r){let h=at(e,i);console.log("tkloadcontroller shouldconvert:"+h),h&&this.convert(i,n,a,t,s,o,r)}static convert(t,e,i,n,a,s,o){let r,h;r=g(a)?{itemClickType:i,renderContainer:1}:{itemClickType:i,renderContainer:1,clientExtData:JSON.stringify(a)},g(s)||Object.assign(r,s),yt().emit(y,{clickType:i}),h=e?{x:e.x,y:e.y}:{},pt.clickAction(t,{payload:JSON.stringify(r),clickInfo:h,sceneType:n,itemClickType:i},o,(i=>{1!=i.result&&(this.log(2,e,r),pt.convert(1==t))}))}static expose(t){this.log(1,null,t)}static exposeElement(t,e){(e=e||{}).elementType=t,this.log(140,null,e)}static clickElement(t){const e={elementType:t};this.log(141,null,e)}static convertWithTypeIfNeeded(t,e,i,n,a){if(f.isAndroid())this.convertWithType(e,i,n,a);else{if(!at(t,e))return;this.convertWithType(e,i,n,a)}}static convertWithType(t,e,i,n){let a={itemClickType:i,renderContainer:1};yt().emit(y,{clickType:i}),pt.clickAction(t,{payload:JSON.stringify(a),clickInfo:{x:e.x,y:e.y},convertType:n},(i=>{1!=i.result&&(this.log(2,e,a),pt.convert(1==t))}))}static convertWithTypeIfNeededNew(t,e,i,n,a,s){if(f.isAndroid())this.convertWithTypeNew(e,i,n,a,s);else{if(!at(t,e))return;this.convertWithTypeNew(e,i,n,a,s)}}static convertWithTypeNew(t,e,i,n,a){let s=a||{};s.itemClickType=i,s.renderContainer=1,yt().emit(y,{clickType:i}),pt.clickAction(t,{payload:JSON.stringify(s),clickInfo:{x:e.x,y:e.y},convertType:n},(i=>{1!=i.result&&(this.log(2,e,s),pt.convert(1==t))}))}static convertNew(t,e,i,n,a,s){let o=s||{};o.itemClickType=a,o.renderContainer=1,yt().emit(y,{clickType:a});let r=a;pt.clickAction(e,{payload:JSON.stringify(o),clickInfo:{x:i.x,y:i.y,width:n.width,height:n.height},sceneType:t,itemClickType:r},(t=>{1!=t.result&&(this.log(2,i,o),pt.convert(1==e))}))}static playNSecond(t){let e={photoPlaySecond:t};this.log(402,null,e)}static skip(){this.log(501,null,null)}}class It extends A{constructor(t){super(t),this.spikeTimeBgColor="315,#FF8000,#FF0A43",this.spikeTimeStyle={height:"16",width:"16",gradientBgColor:this.spikeTimeBgColor,color:"#FFFFFF",textAlign:"center",borderRadius:2,fontSize:12,includeFontPadding:!1,textLineClamp:1},this.spikeTimer=0,this.isPortrait=0==this.vm.screenOrientation,this.realCardHeight=this.vm.getECOrderData().hasSpike?216:219,this.isPortrait||(this.realCardHeight=this.realCardHeight-24),this.style={height:this.getHeight(),width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:this.isPortrait?"column":"row-reverse",justifyContent:this.isPortrait?"flex-start":"space-between",paddingLeft:16,paddingRight:16},this.appendChild(this.createKsAdLogoView(this.vm.adInfo));let e=this.isPortrait?"100%":375;this.card=new TKView,this.card.style={width:e,height:175,marginTop:8,flexDirection:"column",backgroundColor:"#FFFFFF",borderRadius:12},this.vm.getECOrderData().hasSpike?this.card.appendChild(this.createSpikeHeaderView(this.vm.getECOrderData())):(this.card.appendChild(this.createNormalHeaderBgView()),this.card.appendChild(this.createNormalHeaderView(this.vm.getECOrderData()))),this.card.appendChild(this.createBodyView(this.vm.getECOrderData())),this.card.appendChild(this.createFooterView(this.vm.getECOrderData())),this.appendChild(this.card)}createKsAdLogoView(t){this.ksadLogoView=new T(1,t),this.ksadLogoView.style={height:16,marginBottom:this.isPortrait?0:20};let e=new TKView;return e.appendChild(this.ksadLogoView),e.style={height:this.isPortrait?16:"100%",width:this.isPortrait?"100%":"25%",marginRight:16,alignItems:"flex-end",flexDirection:"column-reverse"},e}createNormalHeaderView(t){this.header=new TKView,this.header.style={flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",paddingLeft:12,height:30};let i=new TKView;return i.style={height:"16",marginTop:11,flexDirection:"row",alignItems:"center",paddingRight:6},this.couponIcon=new TKImage,this.couponIcon.style={width:14,height:t.hasCounpon?11:14.5,marginRight:5},this.couponIcon.setSrc(t.getHeaderIcon()),i.appendChild(this.couponIcon),this.couponTips=new TKText,this.couponTips.setText(t.getHeaderTips()),this.couponTips.style={color:"#FF5000",fontSize:12},i.appendChild(this.couponTips),this.header.appendChild(i),this.kwaiLogoView=new TKImage,this.kwaiLogoView.style={width:20,height:20},this.kwaiLogoView.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_kwai_logo.png"),this.header.appendChild(this.kwaiLogoView),this.addClickConvert(this.header,2,e.CARD_OTHERAREA_CLICK),this.header}createNormalHeaderBgView(){let t=new TKImage;return t.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_ec_order_coupon_header_bg.png"),t.style={position:"absolute",left:0,right:0,top:0,height:90,width:"100%"},t}createSpikeHeaderView(t){this.header=new TKView,this.header.style={flexDirection:"row",justifyContent:"space-between",paddingLeft:12,height:26};let i=new TKImage;i.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_ec_order_header_bg.png"),i.style={position:"absolute",height:"100%",left:0,right:0,top:0,topLeftRadius:12,topRightRadius:12},this.header.appendChild(i);let n=new TKView;n.style={height:"100%",paddingBottom:2,paddingTop:2,flexDirection:"row",alignItems:"center",paddingRight:6},this.spikeIcon=new TKImage,this.spikeIcon.style={width:61,height:12},this.spikeIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_spike.png"),n.appendChild(this.spikeIcon);let a=new TKView;a.style={width:.5,height:11,backgroundColor:"#FF500080",marginLeft:5,marginRight:5},n.appendChild(a);let s=new TKText;return s.setText("距结束"),s.style={color:"#FF5000",fontSize:12,marginRight:2},n.appendChild(s),this.spikeHourText=new TKText,this.spikeHourText.style=this.spikeTimeStyle,n.appendChild(this.spikeHourText),n.appendChild(this.createTimeDivider()),this.spikeMinuteText=new TKText,this.spikeMinuteText.style=this.spikeTimeStyle,n.appendChild(this.spikeMinuteText),n.appendChild(this.createTimeDivider()),this.spikeSecondText=new TKText,this.spikeSecondText.style=this.spikeTimeStyle,n.appendChild(this.spikeSecondText),0!=this.spikeTimer&&clearInterval(this.spikeTimer),this.spikeTimer=setInterval((()=>{let e=t.getSpikeTime();this.spikeHourText.setText(e.getFormattedHour()),this.spikeMinuteText.setText(e.getFormattedMinute()),this.spikeSecondText.setText(e.getFormattedSecond())}),1e3),this.header.appendChild(n),this.kwaiLogoView=new TKImage,this.kwaiLogoView.style={width:20,height:20},this.kwaiLogoView.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_kwai_logo.png"),this.header.appendChild(this.kwaiLogoView),this.addClickConvert(this.header,2,e.CARD_OTHERAREA_CLICK),this.header}createBodyView(t){this.bodyView=new TKView,this.bodyView.style={height:64,width:"100%",paddingLeft:12,paddingRight:12,marginTop:6,flexDirection:"row"},this.productIcon=new TKImage,this.productIcon.style={width:64,height:64,borderRadius:4,marginRight:8},this.bodyView.appendChild(this.productIcon),this.productIcon.setSrc(t.icon);let i=new TKView;i.style={height:"100%",flexShrink:1,flexDirection:"column"},this.adNameText=new TKText,this.adNameText.style={color:"#222222",fontSize:15,textLineClamp:1,textOverflow:"ellipsis"},this.adNameText.setText(t.name),i.appendChild(this.adNameText),this.adDescText=new TKText,this.adDescText.style={color:"#9C9C9C",fontSize:12,marginTop:4,textLineClamp:1,textOverflow:"ellipsis"},this.adDescText.setText(t.getAdDesc()),i.appendChild(this.adDescText),this.priceContainer=new TKView,this.priceContainer.style={flexDirection:"row",alignItems:"flex-end",height:24},this.pricePrefix=new TKText,this.pricePrefix.setText(t.getPricePrefix()),this.pricePrefix.style={fontSize:12,color:"#FE3666",marginRight:4,textAlign:"center"},this.priceContainer.appendChild(this.pricePrefix);let n=new TKText;n.setText("¥"),n.style={fontSize:14,color:"#FE3666",marginRight:2,textAlign:"center"},this.priceContainer.appendChild(n),this.priceCurrent=new TKText,this.priceCurrent.setText(t.price),this.priceCurrent.style={fontSize:20,color:"#FE3666",marginRight:6,textAlign:"center"},this.priceContainer.appendChild(this.priceCurrent);let a=t.originalPrice;return g(a)||(this.priceOriginal=new TKText,this.priceOriginal.setText("¥"+a),this.priceOriginal.style={fontSize:13,color:"#C6C6C6",textDecoration:"line-through",textAlign:"center"},this.priceContainer.appendChild(this.priceOriginal)),i.appendChild(this.priceContainer),this.bodyView.appendChild(i),this.addClickConvert(this.bodyView,2,e.CARD_OTHERAREA_CLICK),this.bodyView}createFooterView(t){let i=new TKView;return i.style={paddingLeft:18,paddingRight:18},this.btnClick=new TKButton,this.btnClick.setText(t.btnClickText),this.btnClick.style={height:48,width:"100%",marginTop:15,fontSize:15,color:"#FFFFFF",backgroundColor:"#FE3666",borderRadius:30},this.addClickConvert(this.btnClick,1,e.CARD_ACTION_BAR_CLICK),i.appendChild(this.btnClick),i}getHeight(){return this.realCardHeight}createTimeDivider(){let t=new TKText;return t.setText(":"),t.style={fontSize:12,height:16,textAlign:"center",color:"#FF5000",marginLeft:2,marginRight:2,includeFontPadding:!1},t}addClickConvert(t,e,i){t.addEventListener("tap",(n=>{let a={template_show_type:this.vm.getECOrderData().getCardStyleLog()};const s=c(n,t);this.vm.convert(1,e,s,i,a)}))}}class vt extends K{constructor(){super(),this.$attrsPath=new Proxy(this,{get:(t,e)=>xt(t,e)})}getData(t){}}function xt(t,e){return new Proxy({$vm:t,$bind_path:e},{get:(i,n)=>"string"!=typeof n||"function"==typeof i[n]||0==n.indexOf("$")?Reflect.get(i,n):xt(t,e+"."+n)})}class _t extends vt{constructor(t,e,i,n,a){super(),this.lifeStatus="none",this.adInfo=t,this.adStyle=e,this.configInfo=i,this.containerLimit=n,this.screenOrientation=a}updateLifeStatus(t){this.lifeStatus=t}isVertical(){return 0==this.screenOrientation}getLiveButtonTitle(){return g(this.adInfo.adBaseInfo.universeLiveGuideText)?"点击进入直播间":this.adInfo.adBaseInfo.universeLiveGuideText}}class Vt{static isClickReward(t,e){try{let i=!0;if(f.isAndroid()&&!g(e)&&(i=e.sdkApiVersionCode>=3032401),t.adBaseInfo.extraClickReward&&i)return!0}catch(i){}return!1}static isEcOrder(t,e){try{return 1==t.abConfig.ecRewardAdKwaishopStyle&&(4==e.adStyleConfInfo.innerAdType||5==e.adStyleConfInfo.innerAdType)}catch(i){}return!1}static isOriginLiveAd(t){return 1==t.adBaseInfo.universeLiveType&&0!=t.advertiserInfo.userId}static getAuthorId(t){return t.advertiserInfo.userId}static getLiveStreamId(t){return t.adBaseInfo.liveStreamId}static getIconUrl(t){let e=t.adBaseInfo.appIconUrl;return!g(e)&&Vt.isDownloadInteraction(t)||(e=t.advertiserInfo.portraitUrl),g(e)&&(e="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),e}static isDownloadInteraction(t){return 1==t.adBaseInfo.adOperationType}static getAdTitle(t){let e=null;try{e=1==t.adBaseInfo.adOperationType?t.adBaseInfo.appName:t.adBaseInfo.productName,e=p(e)?e:t.advertiserInfo.rawUserName}catch(i){}return e=p(e)?e:"可爱的广告君",e}static getAdActionDesc(t){if(g(t))return"查看详情";let e=t.adBaseInfo.adActionDescription;return g(e)&&(e=this.isDownloadInteraction(t)?"立即下载":"查看详情"),e}static obtainVideoLiveData(t){let e=it(t,14);return JSON.parse(e.data)}static liveGetAuthorName(t,e){let i="";try{i=t.neoLiveAuthorInfoData.authorName}catch(n){}try{g(i)&&(i=t.neoLiveCartDetailData.authorName)}catch(n){}try{g(i)&&(i=e.adBaseInfo.appName)}catch(n){}return i}static liveGetLiveDesc(t,e){let i="";try{i=t.neoLiveCartDetailData.liveDesc}catch(n){}try{g(i)&&(i=t.neoLiveAuthorInfoData.liveDesc)}catch(n){}try{g(i)&&(i=t.adDescription)}catch(n){}try{g(i)&&(i=e.adBaseInfo.adDescription)}catch(n){}return i}static getNeoActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.neoTKInfo.actionBarCardType;if(!g(e))return e}catch(e){}return null}static getFullscreenActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.fullScreenInfo.actionBarCardType;if(!g(e))return e}catch(e){}return null}}class bt extends vt{constructor(){super(...arguments),this.actionText="",this.lifeStatus="none",this.hasExtraReward=!1,this.widthDp=0}obtainScreenWidthDp(){return this.widthDp>0?this.widthDp:375}isScreenPortrait(){return 0==this.screenOrientation}checkDataValid(){return!!this.adInfo}getBottomBarStyle(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailWebCardInfo.style}catch(t){}return 0}getShortVideoFollowPlaycardStyle(){return this.configInfo.abConfig.shortVideoFollowRewardPlayStyle}isEcFollow(){return 3==X(this.adInfo)}getNeoActionBarCardType(){return 2==this.adStyle?Vt.getNeoActionBarCardType(this.adInfo):3==this.adStyle?Vt.getFullscreenActionBarCardType(this.adInfo):null}getActionBarStyle(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailWebCardInfo.cardType}catch(t){}return 0}getLightInteractionType(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailCommonInfo.rewardInteractionType}catch(t){}return 0}getLightInteractionShowTime(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailCommonInfo.rewardInteractionShowTime}catch(t){}return 2}getLightInteractionDuration(){try{return this.adInfo.adMatrixInfo.adDataV2.playCardStyleInfo.detailCommonInfo.rewardInteractionDuration}catch(t){}return 6}getAdAttributeType(){return this.adInfo.adBaseInfo.adAttributeType||0}isDownloadAd(){return 1==this.adInfo.adBaseInfo.adOperationType}getDownloadAppIcon(){let t;try{t=this.adInfo.adBaseInfo.appIconUrl}catch(e){}return p(t)||(t="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),t}getAdTitle(){var t;return Q(this.adInfo)&&v(null===(t=this.adInfo.adProductInfo)||void 0===t?void 0:t.name)?this.adInfo.adProductInfo.name:J(this.adInfo)}getAppScore(){return this.adInfo.adBaseInfo.appScore||0}getAppDownloadCountDesc(){return this.adInfo.adBaseInfo.appDownloadCountDesc||null}getAdDescription(){return this.adInfo.adBaseInfo.appDescription||this.adInfo.adBaseInfo.adDescription||null}getAdActionDesc(){return this.adInfo.adBaseInfo.adActionDescription||""}supportSlideClick(){var t;return(null===(t=this.adInfo.adMatrixInfo.adDataV2.dynamicAdStyleInfo)||void 0===t?void 0:t.slideClick)||!1}getAdIcon(){var t,e;return Q(this.adInfo)&&p(null===(e=null===(t=this.adInfo)||void 0===t?void 0:t.adProductInfo)||void 0===e?void 0:e.icon)?this.adInfo.adProductInfo.icon:Y(this.adInfo)}isVerticalMaterial(){let t=$(this.adInfo);return t.width<t.height}getMaterialSize(){return $(this.adInfo)}getVideoDuration(){return function(t){try{return t.adMaterialInfo.materialFeature[0].videoDuration}catch(e){}return 0}(this.adInfo)}isAdForLive(){return 7==X(this.adInfo)}isAddLiveButton(){return 1==this.adInfo.adBaseInfo.universeLiveStyle}isShortLive(){return 6==X(this.adInfo)}isECOrderAd(){return function(t,e){if(Q(e))return!1;let i=!1;try{i=1==t.abConfig.ecRewardAdKwaishopStyle}catch(n){return!1}return i&&Z(e)}(this.configInfo,this.adInfo)}isLiveSubscribe(){return function(t){let e=null;try{e=t.adMatrixInfo.adDataV2.merchantLiveReservationInfo}catch(i){return!1}if(g(e))return!1;if(g(e.title)||g(e.liveStartTime)||g(e.bookUserCount))return!1;try{return 2==t.adStyleConfInfo.innerAdType}catch(i){return!1}}(this.adInfo)}isClickReward(){return function(t){try{let e=!0;const i=r();if(f.isAndroid()&&r()&&(e=i.sdkApiVersionCode>=3032401),t.adBaseInfo.extraClickReward&&e)return!0}catch(e){}return!1}(this.adInfo)}isCommercialProductStyle(){return Q(this.adInfo)}getAdTagList(){try{const t=this.adInfo.adMatrixInfo.adDataV2.dynamicAdStyleInfo.extraDisplayInfo.exposeTagInfoList;if(t.length>0)return t}catch(t){}return null}getPlayableStyle(){return st(this.adInfo,this.adStyle,this.screenOrientation)}isHorizontalPlayable(){return this.getPlayableStyle()!=j&&1==this.screenOrientation}convert(t,e,i,n,a=null,s,o){At.convertIfNeeded(t,this.adInfo,e,i,n,a,s,o)}getECOrderData(){return this.mCardModel||(this.mCardModel=kt.newInstance(this.adInfo)),this.mCardModel}getDirectEcData(){return this.directEcCardModel||(this.directEcCardModel=Rt.newInstance(this.adInfo,this.configInfo)),this.directEcCardModel}getNormalModel(){return this.normalCardModel||(this.normalCardModel=Et.newInstance(this.adInfo,this.configInfo.appConfig)),this.normalCardModel}getLiveSubscribeModel(){return null==this.liveSubscribeModel&&(this.liveSubscribeModel=Ft.newInstance(this.adInfo)),this.liveSubscribeModel}getCouponModel(){return this.couponCardModel||(null!=Dt.newInstance(this.adInfo,this.styleType,this.configInfo)?this.couponCardModel=Dt.newInstance(this.adInfo,this.styleType,this.configInfo):this.couponCardModel=new Dt),this.couponCardModel}getKSAdLiveButtonViewModel(){return this.adLiveButtonModel=new _t(this.adInfo,this.adStyle,this.configInfo,this.containerLimit,this.screenOrientation),this.adLiveButtonModel}getCouponBackImageUrl(){return"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_video_coupon.png"}supportNewAnimation(){return f.supportMinimumTKVersion("4.0.0")}showPlayable(t){At.clickElement(67),pt.showPlayable(t)}isDiscountNewStyle(){let t=!1;try{t=1==this.adInfo.adProductInfo.discountStyle}catch(e){}return f.isAndroid()||f.supportMinimumTKVersion("4.0.3")||(t=!1),0==this.getDiscountType()&&(t=!1),t}isAutoChooseReward(){try{return 1==this.adInfo.adProductInfo.autoChoose}catch(t){}return!1}getAutoChooseRewardCountDown(){try{return this.configInfo.appConfig.interactiveStyleConfig.chooseRewardTime}catch(t){}return 20}getGuideChooseRewardCountDown(){try{return this.configInfo.appConfig.interactiveStyleConfig.superDiscountTime}catch(t){}return 60}getGuideChooseRewardRemainingTime(){try{return this.configInfo.appConfig.interactiveStyleConfig.transitReceiveTime}catch(t){}return 10}getDiscountType(){try{return this.adInfo.adProductInfo.discountType}catch(t){}return 0}enableShowGuidanceRedPacket(){return this.getVideoDuration()-this.getAutoChooseRewardCountDown()>=this.getGuideChooseRewardRemainingTime()}getDiscountInfos(){try{return this.adInfo.adProductInfo.fakeDiscountInfos}catch(t){}return[]}getRedPacketValueString(t){const e=this.getDiscountInfos();if(0==t){if(e.length>1)return e.length>2?e[2]:e[1]}else if(1==t){if(e.length>0)return e[0]}else if(2==t&&e.length>2)return e[1];return""}getRedPacketImageUrl(t,e){let i="";if(t){if(i=1==this.getDiscountType()?"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_discounts_red_packet_open_coupon.png":"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_discounts_red_packet_open.png",g(this.getRedPacketValueString(e)))return"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_discounts_red_packet_open_surprise.png"}else i=1==e?"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_discounts_red_packet_close_most.png":"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_discounts_red_packet_close.png";return i}setStyleType(t){this.styleType=t}isValidBottomCouponCardInfo(){return null!=this.bottomCouponInfo}getCouponBottomBusinessType(){let t;try{t=null==this.bottomCouponInfo?0:this.bottomCouponInfo.businessType}catch(e){t=0}return t}getCouponBottomDuration(){let t;try{t=null==this.bottomCouponInfo?0:this.bottomCouponInfo.couponDuration}catch(e){t=0}return t}getCouponCardViewBg(){let t;try{t=null==this.bottomCouponInfo?"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/ksad_bottom_bar_coupon_bg.png":this.bottomCouponInfo.couponIcon}catch(e){t="https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/ksad_bottom_bar_coupon_bg.png"}return p(t)||(t="https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/ksad_bottom_bar_coupon_bg.png"),t}getCouponBottomPriceRMB(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.priceTag}catch(e){t=""}return p(t)||(t=""),t}getCouponBottomPrice(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.price}catch(e){t=""}return p(t)||(t=""),t}getCouponBottomTitle(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.title}catch(e){t=""}return p(t)||(t=""),t}getCouponBottomActionBtn(){let t;try{t=null==this.bottomCouponInfo?"":this.bottomCouponInfo.actionBarDesc}catch(e){t=""}return p(t)||(t=""),t}getProductShortTitle(){let t;try{t=this.adInfo.adProductInfo.shortTitle}catch(e){}return p(t)||(t=""),t}getProductSellingPoint(){let t;try{t=this.adInfo.adProductInfo.sellingPoint}catch(e){}return p(t)||(t="优惠好物 诚心推荐"),t}getDiscountFinalViewWidth(){return 0==this.screenOrientation?Tachikoma.env.deviceWidth:324}getRedPacketViewSize(t,e){let i=Tachikoma.env.deviceWidth-80;1!=t&&(i=0==this.screenOrientation?Tachikoma.env.deviceWidth-76-60:200);let n=i/3.15,a=1.15*n;return{width:1==e?a:n,height:1==e?a/.77:n/.77}}getDiscountNeoExtData(t){const e=this.getDiscountType();let i=new z;return 1==e?i.neoAwardType="union_coupon":2==e?i.neoAwardType="union_spike":3==e&&(i.neoAwardType="union_discount"),t&&t.length>0&&(i.neoAwardAmount=t.join(",")),i}getDiscountTemplateShowType(t){return 1==t?"neo_award_card_1":2==t?"neo_award_card_2":3==t?"neo_award_card_3":""}reportDiscountViewImpression(t){let e=new H;e.neo_ext_data=this.getDiscountNeoExtData(this.getDiscountInfos()),e.template_show_type=this.getDiscountTemplateShowType(t);let i,n={clientExtData:JSON.stringify(e)};1==t?i=929:2==t?i=930:3==t&&(i=931);let a={actionType:i,payload:JSON.stringify(n)};pt.sendLog(a)}reportDiscountInitialViewClose(t){let e=new H;e.template_show_type=this.getDiscountTemplateShowType(t);let i={elementType:69,clientExtData:JSON.stringify(e)},n={actionType:141,payload:JSON.stringify(i)};pt.sendLog(n)}getCouponTemplateShowType(t){return 1==t?"coupon_of_cash_equity":2==t?"coupon_of_no_cash_equity":""}reportEquityCardImpression(t){let e=new H;e.template_show_type=this.getCouponTemplateShowType(t);let i={elementType:16,clientExtData:JSON.stringify(e)},n={actionType:140,payload:JSON.stringify(i)};pt.sendLog(n)}isDeepVideoStyle(){if(1==this.screenOrientation)return!1;if(g(this.deepVideoModel)&&(this.deepVideoModel=new Kt(this.adInfo)),g(this.deepVideoModel.deepVideoInfo)){try{let t;t=2==this.adStyle?this.adInfo.adMatrixInfo.adDataV2.neoTKInfo.templateId:this.adInfo.adMatrixInfo.adDataV2.fullScreenInfo.templateId;let e=rt(ot(t,this.adInfo));if(!g(e)&&e.merchantPlayCardStyle>0)return this.deepVideoModel.deepVideoInfo=e,!0}catch(t){}return!1}return!0}getLiveCutRoomInfo(){return function(t,e){let i=it(e,3==t?3:12);try{let t=JSON.parse(i.data);return g(t)||g(t.neoLiveRoomInfoData)?null:t}catch(n){}return null}(this.adStyle,this.adInfo)}}class Lt{constructor(t){if(this.hour="0",this.minute="0",this.second="0",t>0){let e=t/1e3;this.hour=Math.floor(e/3600).toString(),e%=3600,this.minute=Math.floor(e/60).toString(),e%=60,this.second=Math.floor(e).toString()}}getFormattedHour(){return this.formatTime(this.hour)}getFormattedMinute(){return this.formatTime(this.minute)}getFormattedSecond(){return this.formatTime(this.second)}formatTime(t){return g(t)?"":t.length>1?t:"0"+t}}class kt{static newInstance(t){let e,i=new kt,n=t.adProductInfo,a=n.seckillInfo;return i.hasCounpon=!u(n.couponList),i.name=g(n.name)?"可爱的广告君":n.name,i.icon=n.icon,i.price=n.price,i.originalPrice=n.originPrice,g(a)||(i.spikeTimestamp=a.endTime,i.spikeSoldStock=a.soldStock,i.spikeOriginalStock=a.originalStock),i.hasSpike=i.spikeTimestamp>0,i.volume=n.volume,i.rating=n.rating,i.btnClickText="立即抢购",i.volume&&i.rating?i.volumeAndRating=i.volume+" | "+i.rating:i.volume?i.volumeAndRating=i.volume:i.rating&&(i.volumeAndRating=i.rating),i.adInfo=t,e=i.hasSpike&&i.hasCounpon?"spikeAndCoupon":i.hasSpike?"spike":i.hasCounpon?"coupon":"noSpikeAndNoCoupon",i.cardStyle=e,i}getSpikeTime(){let t=Date.parse((new Date).toString());return new Lt(this.spikeTimestamp-t)}getAdDesc(){let t;return t=this.hasSpike?"已抢"+this.spikeSoldStock+"/"+this.spikeOriginalStock+"件":g(this.rating)||g(this.volume)?g(this.rating)?g(this.volume)?"":this.volume:this.rating:this.volume+"·"+this.rating,t}getPricePrefix(){let t;return t=this.hasCounpon?"券后价":this.hasSpike?"秒杀价":"惊喜价",t}getHeaderIcon(){return this.hasCounpon?"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_ec_order_coupon.png":"https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_ec_order_gift.png"}getHeaderTips(){return this.hasCounpon?"恭喜你，获取一张优惠券":"恭喜你发现好价，手慢无～"}getCardStyleLog(){let t;if(g(this.cardStyle))return t="5",t;switch(this.cardStyle){case"spikeAndCoupon":t="1";break;case"spike":t="2";break;case"coupon":t="3";break;case"noSpikeAndNoCoupon":t="4";break;default:t="5"}return t}}class Rt{static newInstance(t,e){let i=new Rt;i.cardStyle=0|e.appConfig.h5UrlNewStyle;let n=t.adProductInfo;if(i.hasCounpon=!u(n.couponList),i.hasCounpon){const t=n.couponList[0];i.couponTitle="￥ "+t.displayValue}if(i.name=g(n.name)?"可爱的广告君":n.name,i.icon=n.icon,i.price=p(n.price)?n.price:"惊喜价",i.originalPrice=n.originPrice,!u(n.couponList)){let t=n.couponList[0];i.spikeIntervalMs=1e3,i.spikeTimestamp=p(t.leftFetchTime)?Number(t.leftFetchTime):0}return i.hasSpike=i.spikeTimestamp>0&&2==i.cardStyle,i.volume=n.volume,i.rating=n.rating,i.btnClickText="立即抢购",i.volume&&i.rating?i.volumeAndRating=i.volume+" | "+i.rating:i.volume?i.volumeAndRating=i.volume:i.rating&&(i.volumeAndRating=i.rating),i.adInfo=t,i}getSpikeTime(){this.spikeTimestamp<0&&(this.spikeTimestamp=0);const t=new Lt(this.spikeTimestamp);return this.spikeTimestamp-=this.spikeIntervalMs,t}}class Dt{constructor(){this.cardStyle=0,this.delayTime=2}static newInstance(t,e,i){return function(t,e){let i=it(t,e);if(g(i)||g(i.data))return;let n=JSON.parse(i.data);return g(n.couponInfo)?void 0:(null==n.couponInfo.delayTime&&(n.couponInfo.delayTime=2),n.couponInfo)}(t,e)}}class Et{bindBaseData(t){this.iconUrl=Y(t),this.name=J(t),this.actionText=function(t){if(g(t))return"查看详情";let e=t.adBaseInfo.adActionDescription;return g(e)&&(e=function(t){try{return 1==t.adBaseInfo.adOperationType}catch(e){}return!1}(t)?"立即下载":"查看详情"),e}(t),this.desc=t.adBaseInfo.adDescription}static newInstance(t,e){let i=new Et;return i.bindBaseData(t),i.extraActionText=e.rewardContentExtraRewardNotClickedDesc,g(i.extraActionText)&&(i.extraActionText="立即点击，可再得1份奖励"),i.extraActionTextClicked=e.rewardContentExtraRewardClickedDesc,g(i.extraActionTextClicked)&&(i.extraActionTextClicked="立即打开"),i}}class Ft extends Et{static newInstance(t){let e=t.adMatrixInfo.adDataV2.merchantLiveReservationInfo,i=new Ft;return i.name=e.title,i.desc=e.liveStartTime,i.iconUrl=e.userHeadUrl,i.subscribeCount=this.formatCount(e.bookUserCount),i}static formatCount(t){let e="";if(t>=50&&t<1e4)e=t.toFixed(2);else if(t>=1e4){e=(t/1e4).toFixed(1)+"万"}return e}}class Kt{constructor(t){this.deepVideoInfo=void 0,this.adInfo=t}getDeepVideCardStyle(){return this.deepVideoInfo.merchantPlayCardStyle}getDeepVideoTransformTime(){try{if(this.deepVideoInfo.showNewStyleDelaySeconds>0)return this.deepVideoInfo.showNewStyleDelaySeconds}catch(t){}return 5}getDeepVideoGoodsIcon(){return p(this.deepVideoInfo.icon)?this.deepVideoInfo.icon:Y(this.adInfo)}getDeepVideoGoodsIconlabel(){return this.deepVideoInfo.iconLabel}getDeepVideoGoodsTitle(){return this.deepVideoInfo.itemTitle}getDeepVideoAuthorName(){return this.deepVideoInfo.authorName}isDeepVideoShowLowPrice(){var t;return null!==(t=this.deepVideoInfo.showLowPrice)&&void 0!==t&&t}getDeepVideoPrice(){return this.deepVideoInfo.price}getDeepVideoOrderList(){return this.deepVideoInfo.itemTradeInfoList}getActionBarDesc(){return this.deepVideoInfo.actionBarDesc}isShowComments(){return this.deepVideoInfo.showComments}getCommentList(){try{return this.deepVideoInfo.confCommentList}catch(t){return null}}}class Bt extends bt{getData(t){let e=[];e.push(pt.getKsAdDataAsync()),e.push(pt.getDeviceInfoAsync()),e.push(pt.getKsAdConfigAsync()),e.push(pt.getContainerLimitAsync()),e.push(pt.getScreenOrientationAsync()),Promise.all(e).then((e=>{const i=e[0].data,n=e[1].data,a=e[2].data,s=e[3].data,r=e[4].data;try{this.adInfo=i.impAdInfo[0].adInfo[0],this.adStyle=i.impAdInfo[0].adStyle,this.screenOrientation=r.screenOrientation,this.bottomCouponInfo=function(t,e){let i=it(t,e);if(!g(i))return JSON.parse(i.data).bottomCouponInfo}(this.adInfo,9)}catch(h){}this.configInfo=a,this.containerLimit=s,this.screenOrientation=r.screenOrientation,o(n),this.additionalInit(),t&&t(!0)}))}additionalInit(){this.registerProgressListener(),this.registerLifeStatusListener(),this.registerExtraDialogListener()}registerProgressListener(){this.actionText=this.adInfo.adBaseInfo.adActionDescription||"立即下载",f.isSupportDownloadProgressListen()&&this.isDownloadAd()&&pt.registerProgressListener((t=>{if(t.result){const{status:e,progress:i,totalBytes:n}=t.data,a=Number((100*i).toFixed(0))>100?"100":(100*i).toFixed(0);let s;switch(e){case 0:case 1:case 4:s=this.adInfo.adBaseInfo.adActionDescription;break;case 2:s=`${a}%`;break;case 3:s="继续下载";break;case 5:s=p(this.adInfo.adBaseInfo.installAppLabel)?this.adInfo.adBaseInfo.installAppLabel:"点击安装";break;case 6:s=p(this.adInfo.adBaseInfo.openAppLabel)?this.adInfo.adBaseInfo.openAppLabel:"立即打开"}this.actionText=s}}))}registerLifeStatusListener(){pt.registerLifecycleListener((t=>{if(t.result&&t.data){const e=t.data.lifeStatus;e!==this.lifeStatus&&(this.lifeStatus=e)}}))}registerExtraDialogListener(){pt.registerExtraDialogListener((t=>{if(t&&t.data){"close"==t.data.dialogEvent&&pt.getNativeData("getExtraReward",(t=>{this.hasExtraReward=t.data&&t.data.extraRewardStatus==n.hasWatchReward}))}}))}}class St{constructor(){this.renderCalled=!1,this.renderStatusCalled=!1,this.rootView=new TKView,this.rootView.style={width:"100%",height:"100%"}}render(){return!this.renderCalled&&(this.renderCalled=!0,!0)}updateRenderStatus(t,e=""){this.renderCalled&&!this.renderStatusCalled&&(this.renderStatusCalled=!0,pt.pageStatus(t,e),this.registerNativeId())}registerNativeId(){1==Tachikoma.env.isDebug&&f.supportMinimumTKVersion("4.0.7")&&!f.isAndroid()&&(this.startConfig(),pt.registerNativeId((t=>{t&&t.data&&this.startConfig()})))}startConfig(){this.configNativeIdTimer&&clearTimeout(this.configNativeIdTimer),this.configNativeIdTimer=setTimeout((()=>{w(this)}),120)}}class Ot extends TKView{constructor(){super(),this.animCount=0,this.animationAllowed=!0,this.createLiveView(),this.createLineLeftView(),this.createLineMiddleView(),this.createLineRightView(),this.startLiveViewAnimation(),this.animationTimer=setInterval((()=>{this.animCount++,this.startLiveViewAnimation()}),300)}createLiveView(){this.liveView=new TKView,this.liveView.style={backgroundColor:"#FE3666",width:16,height:16,borderRadius:8,flexDirection:"row",alignItems:"center",justifyContent:"center"},this.appendChild(this.liveView)}createLineLeftView(){this.lineLeft=new TKView,this.lineLeft.style={position:"absolute",bottom:4,width:1.5,left:4,height:8,backgroundColor:"#FFFFFF"},this.liveView.appendChild(this.lineLeft)}createLineMiddleView(){this.lineMiddle=new TKView,this.lineMiddle.style={position:"absolute",bottom:4,width:1.5,height:4,left:7,backgroundColor:"#FFFFFF"},this.liveView.appendChild(this.lineMiddle)}createLineRightView(){this.lineRight=new TKView,this.lineRight.style={position:"absolute",bottom:4,width:1.5,left:10,height:6,backgroundColor:"#FFFFFF"},this.liveView.appendChild(this.lineRight)}startLiveViewAnimation(){if(!this.animationAllowed)return;const t=this.getAnimation(this.lineLeft,1);this.lineLeft.addAnimation(t,"animLeft");const e=this.getAnimation(this.lineMiddle,2);this.lineMiddle.addAnimation(e,"animMiddle");const i=this.getAnimation(this.lineRight,3);this.lineRight.addAnimation(i,"animRight")}getAnimation(t,e){const i=new TKKeyframeAnimation;return i.setAnimations([()=>(1==e?t.style={height:this.animCount%2==0?6:8}:2==e?t.style={height:this.animCount%2==0?8:4}:3==e&&(t.style={height:this.animCount%2==0?4:6}),1)]),i.duration=300,i}stopLiveViewAnimation(){clearInterval(this.animationTimer),this.animationAllowed=!1,this.lineLeft&&this.lineLeft.removeAllAnimation(),this.lineMiddle&&this.lineMiddle.removeAllAnimation(),this.lineRight&&this.lineRight.removeAllAnimation()}setLineHeightSize(t){this.lineLeft.style={bottom:4,width:1.5,height:t,backgroundColor:"#FFFFFF"},this.lineMiddle.style={bottom:4,width:1.5,height:t-4,backgroundColor:"#FFFFFF"},this.lineRight.style={bottom:4,width:1.5,height:t-2,backgroundColor:"#FFFFFF"}}}class Nt extends TKView{constructor(t){super(),this.vm=t,this.isVertical=this.vm.isVertical(),this.size=this.isVertical?{width:188,height:46}:{width:98,height:24},this.setupView(),this.setupAction(),this.setupData();const e=this;S(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{"showStart"===t&&e.startAnimation()}))}setupView(){this.style={position:"absolute",width:this.size.width+30,height:this.size.height+20,justifyContent:"center",alignItems:"center"},this.buttonView=new TKView,this.buttonView.style={position:"absolute",width:this.size.width,height:this.size.height,backgroundColor:"#0000004D",borderColor:"#FFFFFF66",borderWidth:1,borderRadius:.5*this.size.height,alignSelf:"center"},this.appendChild(this.buttonView),this.containerView=new TKView,this.containerView.style={flexDirection:"row",width:this.size.width,height:this.size.height,justifyContent:"center",alignItems:"center"},this.appendChild(this.containerView),this.iconView=new Pt(this.vm),this.containerView.appendChild(this.iconView),this.titleText=new TKText,this.titleText.style={color:"#FFFFFF",fontSize:this.isVertical?16:10,fontWeight:"medium",marginLeft:6},this.containerView.appendChild(this.titleText)}setupData(){this.titleText.setText(this.vm.getLiveButtonTitle())}setupAction(){const t=this;this.addEventListener("tap",(e=>{t.clickCallback&&t.clickCallback(e)}))}startAnimation(){if(this.isAnimating)return;this.isAnimating=!0,this.iconView.startAnimation();const t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.buttonView.style={transform:{scale:1.02}},.6),()=>(t.buttonView.style={transform:{scale:1}},1)]),e.duration=1100,e.repeatCount=Number.MAX_VALUE,this.buttonView.addAnimation(e,"buttonViewAnimation")}}class Pt extends TKView{constructor(t){super(),this.vm=t,this.isVertical=this.vm.isVertical(),this.size=this.isVertical?{width:13,height:13}:{width:9,height:8},this.setupView()}setupView(){this.style={width:this.size.width,height:this.size.height,flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end"},this.firstVerticalBar=this.createVerticalBar(this.size.height),this.appendChild(this.firstVerticalBar),this.secondVerticalBar=this.createVerticalBar(this.size.height-8),this.appendChild(this.secondVerticalBar),this.thirdVerticalBar=this.createVerticalBar(this.size.height-4),this.appendChild(this.thirdVerticalBar)}startAnimation(){const t=this.createVerticalBarAnimation(this.firstVerticalBar,this.size.height-4,this.size.height);this.firstVerticalBar.addAnimation(t,"firstVerticalBarAnimation");const e=this.createVerticalBarAnimation(this.secondVerticalBar,this.size.height,this.size.height-8);this.secondVerticalBar.addAnimation(e,"secondVerticalBarAnimation");const i=this.createVerticalBarAnimation(this.thirdVerticalBar,this.size.height-8,this.size.height-4);this.thirdVerticalBar.addAnimation(i,"thirdVerticalBarAnimation")}createVerticalBar(t){const e=new TKView;return e.style={width:this.vm.isVertical()?2:1,height:t,backgroundColor:"#FFFFFF",borderRadius:1},e}createVerticalBarAnimation(t,e,i){const n=new TKKeyframeAnimation;return n.setAnimations([()=>(t.style={height:e},.5),()=>(t.style={height:i},1)]),n.timingFunction="ease-in-out",n.duration=600,n.repeatCount=Number.MAX_VALUE,n}}class Mt extends A{constructor(t){super(t),this.setupViews(),this.setDatas(),this.bindEvent()}setupViews(){if(this.cardWidth=0==this.vm.screenOrientation?this.vm.containerLimit.width:375,this.style={width:this.cardWidth,flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-start",position:"absolute",bottom:14,left:0},this.bottomContainer=new TKView,this.bottomContainer.style={width:"100%",height:320,flexDirection:"row"},this.appendChild(this.bottomContainer),this.iconImg=new TKImage,this.iconImg.style={width:48,height:48,borderColor:"#FFFFFF",borderWidth:1,borderRadius:24,marginLeft:16,marginRight:10,marginBottom:this.vm.adInfo.adBaseInfo.haveBeenFollowed?12:0,alignSelf:"flex-end"},this.bottomContainer.appendChild(this.iconImg),this.vm.adInfo.adBaseInfo.haveBeenFollowed){let t=new TKView;t.style={position:"absolute",bottom:0,left:16,width:48,height:17,borderRadius:8.5,backgroundColor:"#FFFFFF",flexDirection:"column",alignItems:"center",justifyContent:"center"};let e=new TKText;e.style={fontSize:10,color:"#222222"},e.setText("你的关注"),t.appendChild(e),this.bottomContainer.appendChild(t)}this.rightCardViewContainer=new TKView,this.rightCardViewContainer.style={position:"absolute",bottom:0,left:74,width:this.cardWidth-90,flexDirection:"column",opacity:0},this.rightCardView=new TKView,this.rightCardView.style={width:"100%",flexDirection:"column",backgroundColor:"#FFFFFF",bottomRightRadius:10,topLeftRadius:10,topRightRadius:10},this.vm.isAdForLive()&&0==this.vm.screenOrientation&&this.appendTextAndProductClickView(),this.vm.isAdForLive()&&0==this.vm.screenOrientation&&this.vm.isAddLiveButton()&&f.isAndroid()&&(this.adLiveButton=new Nt(this.vm.getKSAdLiveButtonViewModel()),this.adLiveButton.style={width:"100%",alignSelf:"auto",marginTop:60},this.adLiveButton.startAnimation(),this.adLiveButton.clickCallback=t=>{const i=c(t,this.adLiveButton);this.convert(1,i,e.LIVE_BUTTON_CLICK)},this.bottomContainer.appendChild(this.adLiveButton)),this.appendAdLogo(),this.rightCardViewContainer.appendChild(this.rightCardView),this.bottomContainer.appendChild(this.rightCardViewContainer),this.appendRightCardTitleView(),this.appendLineView(),this.vm.isValidBottomCouponCardInfo()?(this.appendRightCouponCardView(),this.rightCardViewContainer.style={opacity:1}):(this.appendRightCardDescView(),this.appendActionBarView(),this.startScaleAnimation())}appendTextAndProductClickView(){let t=new TKView;t.style={width:this.cardWidth-24,position:"absolute",left:16,bottom:150,height:170,flexDirection:"row"},this.leftTextClickView=new TKView,this.leftTextClickView.style={width:243,height:170},this.rightProductClickView=new TKView,this.rightProductClickView.style={width:this.cardWidth-24-243,height:170},t.appendChild(this.leftTextClickView),t.appendChild(this.rightProductClickView),this.bottomContainer.appendChild(t)}appendAdLogo(){this.ksadLogoView=new T(1,this.vm.adInfo),this.ksadLogoView.style={height:16,marginBottom:4,alignSelf:"flex-end"},this.rightCardViewContainer.appendChild(this.ksadLogoView)}appendRightCardTitleView(){let t=new TKView;t.style={height:32,width:"100%",flexDirection:"row",alignItems:"center"},this.titleText=new TKText,this.titleText.style={color:"#222222",fontSize:14,textLineClamp:1,maxWidth:"92%",paddingLeft:16,paddingRight:4,textOverflow:"ellipsis",fontWeight:"medium"},t.appendChild(this.titleText),this.liveIcon=new Ot,t.appendChild(this.liveIcon),this.rightCardView.appendChild(t)}appendLineView(){let t=new TKView;t.style={height:1,width:"100%",flexDirection:"row",alignItems:"center",backgroundColor:"#F6F6F6"},this.rightCardView.appendChild(t)}appendRightCardDescView(){this.descView=new TKText,this.descView.style={marginLeft:16,marginRight:16,textLineClamp:2,textOverflow:"ellipsis",fontSize:12,color:"#666666",textLineHeight:20,marginTop:8,marginBottom:8},this.rightCardView.appendChild(this.descView)}appendActionBarView(){this.actionBarView=new TKView,this.actionBarView.style={height:0,width:"100%",paddingLeft:16,paddingRight:16,flexDirection:"row",opacity:0},this.rightCardView.appendChild(this.actionBarView),this.leftActionBar=new TKView,this.leftActionBar.style={width:"33%",height:36,backgroundColor:"#FFD7E0",flexDirection:"row",alignItems:"center",topLeftRadius:18,bottomLeftRadius:18,justifyContent:"center"},this.leftActionBarIcon=new TKImage,this.leftActionBarIcon.style={width:17,height:17},this.leftActionBarText=new TKText,this.leftActionBarText.style={fontSize:14,color:"#FE3666",fontWeight:"medium"},this.leftActionBar.appendChild(this.leftActionBarIcon),this.leftActionBar.appendChild(this.leftActionBarText),this.middleIcon=new TKImage,this.middleIcon.style={width:"9%",height:36},this.middleIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_live_actionbar.png"),this.rightActionBar=new TKView,this.rightActionBar.style={width:"58%",height:36,topRightRadius:18,bottomRightRadius:18,backgroundColor:"#FE3666",flexDirection:"row",alignItems:"center",justifyContent:"center"},this.rightActionBarIcon=new TKImage,this.rightActionBarIcon.style={width:17,height:17},this.rightActionBarText=new TKText,this.rightActionBarText.style={fontSize:14,color:"#FFFFFF",fontWeight:"medium"},this.rightActionBar.appendChild(this.rightActionBarText),this.rightActionBar.appendChild(this.rightActionBarIcon),this.actionBarView.appendChild(this.leftActionBar),this.actionBarView.appendChild(this.middleIcon),this.actionBarView.appendChild(this.rightActionBar)}appendRightCouponCardView(){this.couponCardView=new TKView,this.couponCardView.style={height:60,width:this.cardWidth-122,marginLeft:16,marginRight:16,marginTop:10,marginBottom:10,position:"absolute"},this.rightCardView.appendChild(this.couponCardView),this.couponCardViewBg=new TKImage,this.couponCardViewBg.style={position:"absolute",top:0,left:0,height:60,borderRadius:4,width:this.cardWidth-122},this.couponCardView.appendChild(this.couponCardViewBg),this.priceLayout=new TKView,this.priceLayout.style={height:60,width:65,position:"absolute",top:0,justifyContent:"center",alignContent:"center",alignItems:"center",flexDirection:"row"},this.couponCardPriceTxt=new TKText,this.couponCardPriceTxt.style={fontSize:20,color:"#FFFFFF",height:60,justifyContent:"center",textAlign:"center",fontWeight:"medium"},this.priceLayout.appendChild(this.couponCardPriceTxt),this.couponCardView.appendChild(this.priceLayout),this.couponCardDesView=new TKView,this.couponCardDesView.style={position:"absolute",left:79,flexDirection:"column",justifyContent:"center",alignContent:"center",height:60,width:90},this.couponCardTitle=new TKText,this.couponCardTitle.style={fontSize:13,color:"#FFFFFF",height:18,fontWeight:"medium",textAlign:"left"},this.couponCardTitle.setText("超值优惠券"),this.couponCardDesView.appendChild(this.couponCardTitle),this.couponCardDurationTxt=new TKText,this.couponCardDurationTxt.style={fontSize:12,color:"#FFFFFF",height:15,opacity:.7,textAlign:"left"},this.couponCardDesView.appendChild(this.couponCardDurationTxt),this.couponCardView.appendChild(this.couponCardDesView),this.couponCardActionBtn=new TKText,this.couponCardActionBtn.style={right:9,top:17,width:62,height:26,backgroundColor:"#FFFFFF",fontSize:12,color:"#FF3A30",alignItems:"center",borderRadius:13,alignContent:"flex-end",justifyContent:"center",textAlign:"center",position:"absolute"},this.couponCardView.appendChild(this.couponCardActionBtn),this.reportCouponImpression()}createFontSizeSpanItem(t,e){const i=new TKSpanItem;return i.spanType="absoluteSize",i.color="#FFFFFF",i.size=12,i.start=t,i.end=e,i}setDatas(){if(this.iconImg.setSrc(this.vm.getAdIcon()),this.titleText.setText(this.vm.getAdTitle()),this.vm.isValidBottomCouponCardInfo()){let t;this.couponCardViewBg.setSrc(this.vm.getCouponCardViewBg()),t=this.vm.getCouponBottomPriceRMB()+this.vm.getCouponBottomPrice();const e=this.createFontSizeSpanItem(0,this.vm.getCouponBottomPriceRMB().length),i=new TKSpan;i.addSpan(e),this.couponCardPriceTxt.setSpan(t,i),this.couponCardActionBtn.setText(this.vm.getCouponBottomActionBtn()),this.couponCardTitle.setText(this.vm.getCouponBottomTitle()),this.couponCardDuration=1e3*this.vm.getCouponBottomDuration(),this.couponCardDurationTxt.setText(nt(this.couponCardDuration)+"后失效"),this.startShowTimer()}else this.descView.setText(this.vm.adInfo.adBaseInfo.adDescription),this.vm.adInfo.adBaseInfo.haveBeenFollowed?(this.leftActionBarIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_collected.png"),this.leftActionBarText.setText("感兴趣")):(this.leftActionBarIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_live_follow.png"),this.leftActionBarText.setText("关注")),this.rightActionBarIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_live_look.png"),this.rightActionBarText.setText(this.vm.adInfo.adBaseInfo.adActionDescription)}bindEvent(){this.bottomContainer.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK)})),this.vm.isValidBottomCouponCardInfo()?this.couponCardView.addEventListener("tap",(t=>{let i=new H,n=new z;n.couponType=this.vm.getCouponBottomBusinessType(),i.neo_ext_data=n,At.convertIfNeeded(1,this.vm.adInfo,1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK,i)})):(this.leftActionBar.addEventListener("tap",(t=>{let i=new H;i.follows_status=this.vm.adInfo.adBaseInfo.haveBeenFollowed?2:1,At.convertIfNeeded(1,this.vm.adInfo,1,{x:0,y:0},e.CARD_LEFT_ACTION_BAR_CLICK,i)})),this.rightActionBar.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.ACTION_BAR_CLICK)})),this.leftTextClickView&&this.leftTextClickView.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.ACTIONBAR_ICON_COMMENT_CLICK)}))),this.rightProductClickView&&this.rightProductClickView.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.ACTIONBAR_ICON_CLICK)})),this.adLiveButton&&this.adLiveButton.addEventListener("tap",(t=>{this.convert(1,{x:0,y:0},e.LIVE_BUTTON_CLICK)}))}startScaleAnimation(){setTimeout((()=>{const t=this.getScaleAnimation(this.rightCardViewContainer);this.rightCardViewContainer.addAnimation(t,"scaleAnimation")}),500)}startTransAnimation(){const t=this.getTransformAnimation(this.rightCardViewContainer);this.rightCardViewContainer.addAnimation(t,"tkKeyframeAnimation")}showActionBarAnimation(){const t=this.getShowActionBarAnimation(this.actionBarView);this.actionBarView.addAnimation(t,"showActionBarAnimation")}startActionBarOpacityAnimation(){const t=this.getOpacityActionBarAnimation(this.actionBarView);this.actionBarView.addAnimation(t,"opacityActionBarAnimation"),t.on("end",(t=>{this.vm.isAnimFinishCallback&&this.vm.isAnimFinishCallback()}))}getScaleAnimation(t){const e=new TKKeyframeAnimation;return e.setAnimations([()=>(t.style={transform:{translate:{x:-t.getSize().width/2/2,y:t.getSize().height/2/2},scale:.5},opacity:.1},1)]),e.duration=100,e.on("end",(()=>{this.startTransAnimation()})),e}getTransformAnimation(t){const e=new TKKeyframeAnimation;return e.setAnimations([()=>(t.style={transform:{translate:{x:0,y:0},scale:1},opacity:1},1)]),e.duration=300,e.on("end",(()=>{setTimeout((()=>{this.showActionBarAnimation()}),2e3)})),e}getShowActionBarAnimation(t){const e=new TKKeyframeAnimation;return e.setAnimations([()=>(t.style={height:46,paddingBottom:10},1)]),e.duration=300,e.on("end",(()=>{this.startActionBarOpacityAnimation()})),e}getOpacityActionBarAnimation(t){const e=new TKKeyframeAnimation;return e.setAnimations([()=>(t.style={opacity:1},1)]),e.duration=300,e.on("end",(()=>{})),e}getHeight(){return 334}startShowTimer(){this.stopShowTimer(),this.showTimer=setInterval((()=>{let t=this.couponCardDuration;this.couponCardDuration=t-10,this.couponCardDuration<=0?this.stopShowTimer():this.couponCardDurationTxt.setText(nt(this.couponCardDuration)+"后失效")}),10)}stopShowTimer(){this.showTimer&&clearInterval(this.showTimer),this.showTimer=0}stopActionAnimation(){this.liveIcon&&this.liveIcon.stopLiveViewAnimation(),this.vm.isValidBottomCouponCardInfo()&&this.stopShowTimer()}reportCouponImpression(){let t=new H,e=new z;e.couponType=this.vm.getCouponBottomBusinessType(),t.neo_ext_data=e;let i={elementType:16,clientExtData:JSON.stringify(t)},n={actionType:140,payload:JSON.stringify(i)};pt.sendLog(n)}}class Wt extends TKView{constructor(t,e,i){super(),this.adInfo=t,this.fansUrls=function(t){let e=null,i=["https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_photo4.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_photo1.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_photo3.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_photo2.png"];try{e=t.advertiserInfo.fansIconList}catch(n){}if(null==e)return i;if(e.length<4)for(let a=0;a<4-e.length;a++)e.push(i[a]);return e}(t),this.portraits=new Array;for(let n=0;n<i+1;n++){let t=n%this.fansUrls.length,a=this.fansUrls[t],s=new Ht(a,i);s.left=16*n+4,s.style={position:"absolute",width:e,height:e,borderRadius:e/2,borderWidth:1,borderColor:"#FFFFFF",left:s.left},this.appendChild(s),this.portraits.push(s)}this.portraits[i].style={opacity:0},this.startAnimation()}startAnimation(){this.animationAllowed=!0,this.cycleAnimation()}stopActionAnimation(){this.animationAllowed=!1;for(let t=0;t<this.portraits.length;t++){this.portraits[t].removeAllAnimation()}}cycleAnimation(){this.animationAllowed&&setTimeout((()=>{for(let t=0;t<this.portraits.length;t++){this.portraits[t].moveAnimation(this)}this.cycleAnimation()}),800)}}class Ht extends TKImage{constructor(t,e){super(),this.iconCount=e,this.setSrc(t)}moveAnimation(t){this.willHide=!1,this.willShow=!1;let e=this.left;-12==e&&(this.willShow=!0,e=16*this.iconCount+4,t.appendChild(this)),4==e&&(this.willHide=!0);let i=e-16,n=new TKKeyframeAnimation;n.setAnimations([()=>(this.style={left:e,opacity:this.willShow?0:1,transform:{scale:this.willShow?.8:1}},0),()=>(this.style={left:i,opacity:this.willHide?0:1,transform:{scale:this.willHide?.8:1}},1)]),n.duration=500,n.on("end",(()=>{this.left=i})),this.addAnimation(n,"moveAniamtion")}}class zt extends A{constructor(t){super(t),this.bigHeight=194,this.smallHeight=146,this.cardHeight=142,this.cardHeightSmall=94,this.animStopped=!1,this.btnHeight=36,this.isPortrait=0==this.vm.screenOrientation;let e=Ut.createInstance(this.vm.adInfo);this.style={height:this.getHeight(),width:this.isPortrait?f.isAndroid()?"100%":this.vm.containerLimit.width:375,flexDirection:"column",justifyContent:"flex-end",alignSelf:"flex-end",paddingBottom:16,paddingLeft:16,paddingRight:16},this.appendChild(this.createHeadView(this.vm.adInfo,e)),this.mCardView=this.createCardView(e),this.appendChild(this.mCardView),setTimeout((()=>{this.startTransHeadView()}),2e3)}createHeadView(t,i){let n=new TKView;n.style={height:36,width:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end"};let a=new TKView;return a.style={height:28,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",backgroundColor:"#00000080",borderRadius:4,marginBottom:-28,paddingRight:12,opacity:0},zt.addClickConvert(this.vm.adInfo,a,2,e.CARD_FOLLOW_NUM),this.fansListView=new Wt(this.vm.adInfo,20,3),this.fansListView.style={width:60,height:20},this.fansCountView=new TKText,this.fansCountView.style={fontSize:12,color:"#FFFFFFFC"},this.fansCountView.setText(i.fansCountText),a.appendChild(this.fansListView),a.appendChild(this.fansCountView),this.mHeadFansView=a,n.appendChild(a),this.logoView=new T(1,t),this.logoView.style={height:14,marginBottom:4},n.appendChild(this.logoView),n}createCardView(t){let e=new TKView;if(e.style={width:"100%",height:this.cardHeightSmall,borderRadius:12,paddingLeft:12,paddingTop:11,paddingRight:16,backgroundColor:"#FFFFFF",flexDirection:"column",justifyContent:"space-between"},e.appendChild(this.createBodyView(t)),this.mCardBtnsView=this.createBtnsView(t),e.appendChild(this.mCardBtnsView),t.isLive){let t=new TKText;t.style={fontSize:10,color:"#FFFFFF",backgroundColor:"#FE3666",height:14,topLeftRadius:7,topRightRadius:7,bottomRightRadius:7,position:"absolute",top:12,left:50,paddingHorizontal:5,textAlign:"center"},t.setText("直播"),e.appendChild(t)}return e}startTransHeadView(){let t=new TKBasicAnimation;t.setEndValue((()=>{this.mHeadFansView.style={opacity:1,transform:{translate:{y:-36}}}})),t.timingFunction="EaseOut",t.duration=300,t.on("end",(()=>{setTimeout((()=>{this.switchToBigCard()}),3e3)})),this.mHeadFansView.addAnimation(t,"headFansTrans")}switchToBigCard(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.mCardBtnsView.style={opacity:1},1)]),t.duration=300,t.timingFunction="EaseOut";let e=new TKKeyframeAnimation;e.setAnimations([()=>(this.mCardView.style={height:this.cardHeight},1)]),e.duration=300,e.timingFunction="EaseOut",this.mCardBtnsView.addAnimation(t,"btnOpacity"),this.mCardView.addAnimation(e,"cardSwitch")}startLiveBorderAnima(t){let e=new TKKeyframeAnimation;t.style={opacity:0,transform:{scale:1}},e.setAnimations([()=>(t.style={opacity:1,transform:{scale:1.16}},.5),()=>(t.style={opacity:0,transform:{scale:1.35}},1)]),e.duration=500,t.addAnimation(e,"borderWave")}createBodyView(t){let i=new TKView;return i.style={width:"100%",height:70,marginBottom:8,flexDirection:"row"},this.iconArea=new TKView,this.iconArea.style={width:70,height:70,marginRight:3,flexDirection:"column",justifyContent:"center",alignItems:"center"},zt.addClickConvert(this.vm.adInfo,this.iconArea,2,e.CARD_ICON_CLICK),t.isLive&&(this.mIconBorder=new TKView,this.mIconBorder.style={opacity:0,width:52,height:52,borderColor:"#FE3666",borderWidth:1,borderRadius:26,position:"absolute"},this.iconArea.appendChild(this.mIconBorder),this.animateTimer=setInterval((()=>{this.startLiveBorderAnima(this.mIconBorder)}),1e3)),this.iconView=new TKImage,this.iconView.style={width:52,height:52,borderRadius:26,position:"absolute"},this.iconView.setSrc(t.icon),this.iconArea.appendChild(this.iconView),i.appendChild(this.iconArea),this.textContainer=new TKView,this.textContainer.style={height:"60",maxWidth:227,marginTop:4,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start"},this.nameView=new TKText,this.nameView.style={width:"100%",fontSize:16,textAlign:"left",fontWeight:"medium",color:"#000000",textLineClamp:1,textOverflow:"ellipsis"},this.nameView.setText(t.name),zt.addClickConvert(this.vm.adInfo,this.nameView,2,e.CARD_ICON_NAME_CLICK),this.textContainer.appendChild(this.nameView),this.descView=new TKText,this.descView.style={width:"100%",textLineClamp:2,fontSize:12,color:"#666666",textOverflow:"ellipsis"},this.descView.setText(t.desc),zt.addClickConvert(this.vm.adInfo,this.descView,2,e.CARD_ICON_COMMENT_CLICK),this.textContainer.appendChild(this.descView),i.appendChild(this.textContainer),i}createBtnsView(t){this.btnsView=new TKView,this.btnsView.style={height:this.btnHeight,width:"100%",opacity:0,marginBottom:16,flexDirection:"row"},zt.addClickConvert(this.vm.adInfo,this.btnsView,1,e.CARD_ACTION_BAR_CLICK);let i=this.btnHeight/2;return this.detailContainer=new TKView,this.detailContainer.style={height:"100%",width:"35%",backgroundColor:"#FFD7E0",topLeftRadius:i,bottomLeftRadius:i,flexDirection:"row",justifyContent:"center",paddingLeft:6},this.btnDetail=new TKText,this.btnDetail.style={height:"100%",fontSize:14,textAlign:"center",color:"#FE3666",textLineClamp:1},this.btnDetail.setText(t.btnDetail),this.detailContainer.appendChild(this.btnDetail),this.dividerImage=new TKImage,this.dividerImage.style={width:"8%",height:"100%"},this.dividerImage.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ec_follow_btns.png"),this.followContainer=new TKView,this.followContainer.style={height:"100%",width:"57%",backgroundColor:"#FE3666",topRightRadius:i,bottomRightRadius:i,paddingRight:11},this.followArea=new TKView,this.followArea.style={justifyContent:"center",flexDirection:"row",alignItems:"center",height:"100%",width:"100%"},this.btnFollow=new TKText,this.btnFollow.style={fontSize:14,textLineClamp:1,textAlign:"center",color:"#FFFFFF"},this.btnFollow.setText(t.btnFollow),this.imageAdd=new TKImage,this.imageAdd.style={width:20,height:20},this.imageAdd.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_add_white.png"),this.followArea.appendChild(this.imageAdd),this.followArea.appendChild(this.btnFollow),this.followContainer.appendChild(this.followArea),(new TKView).style={width:11,height:"100%"},zt.addClickConvert(this.vm.adInfo,this.detailContainer,1,e.ACTION_BAR_CLICK),zt.addClickConvert(this.vm.adInfo,this.followContainer,1,e.ACTION_BAR_CLICK),this.btnsView.appendChild(this.detailContainer),this.btnsView.appendChild(this.dividerImage),this.btnsView.appendChild(this.followContainer),this.btnsView}static addClickConvert(t,e,i,n){e.addEventListener("tap",(e=>{At.convertIfNeeded(1,t,i,e.position,n,null)}))}getHeight(){return this.bigHeight}stopActionAnimation(){this.animStopped=!0,this.animateTimer&&clearInterval(this.animateTimer),g(this.mIconBorder)||this.mIconBorder.removeAllAnimation()}}class jt extends A{constructor(t){super(t),this.cardHeight=210,this.toolsButtonSize=32,this.itemHeight=8,this.itemHeightHight=14,this.animStopped=!1,this.mPlusOneImages=new Array,this.isPortrait=0==this.vm.screenOrientation;let e=Ut.createInstance(this.vm.adInfo);this.style={flexDirection:"row",height:this.getHeight(),width:f.isAndroid()?"100%":this.vm.containerLimit.width};let i=new TKView;i.style={width:"100%",height:193,position:"absolute",bottom:0,left:0,right:0,gradientBgColor:"90,00000099,00000000"},this.appendChild(i),this.appendChild(this.createCardArea(e)),e.isLive||this.appendChild(this.createRightToolButtons(e)),setTimeout((()=>{this.startAnim()}),500)}createCardArea(t){if(this.cardArea=new TKView,this.cardArea.style={width:t.isLive?"100%":"78%",height:this.getHeight(),justifyContent:t.isLive?"space-between":"flex-end",flexDirection:"column",paddingTop:t.isLive?64:0},zt.addClickConvert(this.vm.adInfo,this.cardArea,2,e.CARD_OTHERAREA_CLICK),t.isLive){let t=this.createLiveLabel();this.cardArea.appendChild(t)}let i=new TKView;return this.mCardView=i,i.style={width:"100%",height:this.cardHeight,alignSelf:"flex-end",justifyContent:"space-between",flexDirection:"column",marginBottom:-52,paddingLeft:12,paddingRight:12,paddingBottom:16},this.mHeadView=this.createCardHeadView(t),i.appendChild(this.mHeadView),i.appendChild(this.createCardBodyView(t)),this.mBtnsView=this.createCardBtnsView(t),i.appendChild(this.mBtnsView),this.cardArea.appendChild(i),this.cardArea}startAnim(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.mHeadView.style={transform:{translate:{x:375}}},1)]),t.duration=300,t.timingFunction="EaseOut",t.on("end",(()=>{this.animStopped||(setTimeout((()=>{this.startCardUpAnim()}),5e3),this.startPlusOneAnim())})),this.mHeadView.addAnimation(t,"headTrans")}startCardUpAnim(){if(this.animStopped)return;let t=new TKKeyframeAnimation;t.duration=300,t.timingFunction="EaseOut",t.setAnimations([()=>(this.mCardView.style={transform:{translate:{y:-52}}},1)]);let e=new TKKeyframeAnimation;e.duration=300,e.timingFunction="EaseOut",e.setAnimations([()=>(this.mBtnsView.style={opacity:1},1)]),this.mCardView.addAnimation(t,"cardUp"),this.mBtnsView.addAnimation(t,"btnsAlpha")}startPlusOneAnim(){if(this.animStopped||g(this.mPlusOneView))return;let t=new TKKeyframeAnimation;t.duration=300,t.timingFunction="EaseOut",t.setAnimations([()=>(this.mPlusOneView.style={width:31,opacity:1,height:70},1)]);let e=this.mPlusOneImages.length;for(let i=0;i<e;i++){let t=this.mPlusOneImages[i],e=new TKKeyframeAnimation;e.duration=300,e.timingFunction="EaseOut",e.setAnimations([()=>(t.style={width:31,height:24,opacity:1},1)]),t.addAnimation(e,"imgScale")}this.mPlusOneView.addAnimation(t,"plusOneScale"),t.on("end",(()=>{for(let t=0;t<e;t++){let i=this.mPlusOneImages[t],n=new TKKeyframeAnimation;n.duration=500,n.setAnimations([()=>(i.style={height:12,width:15,opacity:0,transform:{translate:{y:-44}}},1)]),setTimeout((()=>{i.addAnimation(n,"plusOneUp")}),250*t),t==e-1&&n.on("end",(()=>{this.mPlusOneImages.splice(0,e),this.mHeadView.removeChild(this.mPlusOneView),this.mPlusOneView=null,this.mPlusOneView=this.createPlusOneContainer(),this.mHeadView.appendChild(this.mPlusOneView),setTimeout((()=>{this.startPlusOneAnim()}),500)}))}}))}createPlusOneContainer(){let t=new TKView;t.style={opacity:0,height:12,width:15,bottom:8,right:61,position:"absolute",flexDirection:"column",justifyContent:"flex-end",alignItems:"center"};let e=this.createPlusOneView(),i=this.createPlusOneView(),n=this.createPlusOneView(),a=this.createPlusOneView();return this.mPlusOneImages.push(e,i,n,a),t.appendChild(e),t.appendChild(i),t.appendChild(n),t.appendChild(a),t}createPlusOneView(){let t=new TKImage;return t.style={width:0,height:0,opacity:0,position:"absolute",bottom:0,right:0,resize:"contain"},t.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_plus_one.png"),t}createLiveLabel(){let t=new TKView;t.style={width:"100%",height:30,justifyContent:"center",alignItems:"center",flexDirection:"row"};let e={width:2,height:this.itemHeight,backgroundColor:"#FFFFFF"},i=new TKView;i.style={flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:16,height:24};let n=new TKView;n.style=e;let a=new TKView;a.style=e;let s=new TKView;s.style=e,i.appendChild(n),i.appendChild(a),i.appendChild(s),t.appendChild(i);let o=new TKText;o.style={color:"#FFFFFF",fontSize:20,textAlign:"center",paddingLeft:8,paddingRight:8},o.setText("当前正在直播"),t.appendChild(o);let r=new TKView;r.style={flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:16,height:24};let h=new TKView;h.style=e;let l=new TKView;l.style=e;let d=new TKView;return d.style=e,r.appendChild(h),r.appendChild(l),r.appendChild(d),t.appendChild(r),n.addAnimation(this.createWaveItemAnim(n,1),"wave"),a.addAnimation(this.createWaveItemAnim(a,2),"wave"),s.addAnimation(this.createWaveItemAnim(s,3),"wave"),d.addAnimation(this.createWaveItemAnim(d,1),"wave"),l.addAnimation(this.createWaveItemAnim(l,2),"wave"),h.addAnimation(this.createWaveItemAnim(h,3),"wave"),t}createWaveItemAnim(t,e){let i=new TKKeyframeAnimation;return i.setAnimations([()=>(t.style={height:this.itemHeight},.25*(e-1)),()=>(t.style={height:this.itemHeightHight},.25*e),()=>(t.style={height:this.itemHeight},1)]),i.duration=1200,i.repeatCount=-1,i.timingFunction="EaseOut",i.on("start",(()=>{this.animStopped&&t.removeAnimation("wave")})),i}createCardHeadView(t){let i=new TKView;if(i.style={height:"70",marginLeft:-375,width:t.isLive?"78%":"100%",flexDirection:"column",justifyContent:"flex-end"},this.headView=new TKView,this.headView.style={width:"100%",height:28,borderRadius:14,gradientBgColor:"0,FE366600,FE3666",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},zt.addClickConvert(this.vm.adInfo,this.headView,2,e.CARD_FOLLOW_NUM),this.fansListView=new Wt(this.vm.adInfo,20,3),this.fansListView.style={width:60,height:20,marginRight:8},this.fansCountView=new TKText,this.fansCountView.style={fontSize:12,color:"#FFFFFF"},this.fansCountView.setText(t.fansCountText),this.plusOneView=null,this.needShowPlusOneLabel()){this.plusOneView=new TKView,this.plusOneView.style={height:20,width:44,borderRadius:10,backgroundColor:"#FFFFFF",flexDirection:"row",justifyContent:"center",alignItems:"center",position:"absolute",right:4};let t=new TKText;t.style={fontSize:10,color:"#FE3666",marginRight:2},t.setText("我要"),this.iconPlusOne=new TKImage,this.iconPlusOne.style={height:9,width:11},this.iconPlusOne.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_plus_one_pink.png"),this.plusOneView.appendChild(t),this.plusOneView.appendChild(this.iconPlusOne)}return this.headView.appendChild(this.fansListView),this.headView.appendChild(this.fansCountView),null!=this.plusOneView&&this.headView.appendChild(this.plusOneView),i.appendChild(this.headView),this.needShowPlusOneAnima()&&(this.mPlusOneView=this.createPlusOneContainer(),i.appendChild(this.mPlusOneView)),i}createCardBodyView(t){let i=new TKView;i.style={flexDirection:"column",width:"100%"};let n=new TKView;return n.style={flexDirection:"row",width:"100%",alignItems:"center"},this.nameView=new TKText,this.nameView.style={fontSize:15,color:"#FFFFFF",fontWeight:"bold",textAlign:"center",includeFontPadding:!1,marginBottom:5},this.nameView.setText("@"+t.name),n.appendChild(this.nameView),zt.addClickConvert(this.vm.adInfo,this.nameView,2,e.CARD_ICON_NAME_CLICK),this.logoView=new T(0,this.vm.adInfo,12),this.logoView.style={height:12,opacity:.4,marginLeft:8},n.appendChild(this.logoView),i.appendChild(n),this.descView=new TKText,this.descView.style={fontSize:14,color:"#FFFFFF",fontWeight:"normal",textLineClamp:2,textOverflow:"ellipsis",textAlign:"left"},this.descView.setText(t.desc),i.appendChild(this.descView),zt.addClickConvert(this.vm.adInfo,this.descView,2,e.CARD_ICON_COMMENT_CLICK),i}createCardBtnsView(t){this.btnsView=new TKView,this.btnsView.style={height:36,width:"100%",flexDirection:"row",justifyContent:"space-between"},zt.addClickConvert(this.vm.adInfo,this.btnsView,1,e.CARD_ACTION_BAR_CLICK),this.btnDetailArea=new TKView,this.btnDetailArea.style={height:"100%",width:"48%",backgroundColor:"#FFFFFF",borderRadius:18,flexDirection:"row",alignItems:"center",justifyContent:"center"},this.btnDetail=new TKText,this.btnDetail.style={height:"100%",color:"#FE3666",textAlign:"center"},this.btnDetail.setText(t.btnDetail),this.btnDetailArea.appendChild(this.btnDetail),this.btnsView.appendChild(this.btnDetailArea),this.followContainer=new TKView,this.followContainer.style={height:"100%",width:"100%",flexDirection:"row",justifyContent:"center",alignItems:"center",backgroundColor:"#FE3666",borderRadius:18},this.btnFollow=new TKText,this.btnFollow.style={height:"100%",color:"#FFFFFF",textAlign:"center"},this.btnFollow.setText(t.btnFollow),this.imageAdd=new TKImage,this.imageAdd.style={width:20,height:20},this.imageAdd.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_add_white.png"),this.followContainer.appendChild(this.imageAdd),this.followContainer.appendChild(this.btnFollow);let i=new TKView;return i.style={height:"100%",width:"48%"},i.appendChild(this.followContainer),this.btnsView.appendChild(i),this.btnsView}createRightToolButtons(t){this.toolsArea=new TKView,this.toolsArea.style={flexDirection:"column",height:"100%",width:"22%",justifyContent:"space-between",alignItems:"center",paddingBottom:22},zt.addClickConvert(this.vm.adInfo,this.toolsArea,1,e.CARD_ICON_CLICK);let i=this.createAvatarView(t);return this.toolsArea.appendChild(i),this.toolsArea.appendChild(this.newToolsIcon("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_heart.png","点赞")),this.toolsArea.appendChild(this.newToolsIcon("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_comment.png","评论")),this.toolsArea.appendChild(this.newToolsIcon("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_favor.png","收藏")),this.toolsArea.appendChild(this.newToolsIcon("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_share.png","分享")),this.toolsArea}newToolsIcon(t,e){return this.toolBtn=new TKView,this.toolBtn.style={flexDirection:"column",width:"100%",alignItems:"center"},this.image=new TKImage,this.image.style={padding:2,width:this.toolsButtonSize,height:this.toolsButtonSize},this.image.setSrc(t),this.toolBtn.appendChild(this.image),this.titleView=new TKText,this.titleView.style={fontSize:10,textAlign:"center",color:"#FFFFFF"},this.titleView.setText(e),this.toolBtn.appendChild(this.titleView),this.toolBtn}createAvatarView(t){let e=new TKView;e.style={width:44,height:52,flexDirection:"column",alignItems:"center"},this.avatarImage=new TKImage,this.avatarImage.style={width:44,height:44,borderRadius:22,borderColor:"#FFFFFF",borderWidth:1},this.avatarImage.setSrc(t.icon),e.appendChild(this.avatarImage);let i=new TKView;return i.style={height:16,width:26,backgroundColor:"#FE3666",borderRadius:8,flexDirection:"column",justifyContent:"center",alignItems:"center",position:"absolute",bottom:0},this.addImgae=new TKImage,this.addImgae.style={height:10,width:10,alignSelf:"center"},this.addImgae.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_add_white_no_margin.png"),i.appendChild(this.addImgae),e.appendChild(i),e}needShowPlusOneLabel(){let t=this.vm.configInfo.abConfig.shortVideoFollowRewardAnimationStyle;return 0==t||2==t}needShowPlusOneAnima(){let t=this.vm.configInfo.abConfig.shortVideoFollowRewardAnimationStyle;return 0==t||1==t}getHeight(){return 318}stopActionAnimation(){this.animStopped=!0}}class Ut{constructor(){this.btnDetail="了解更多",this.btnFollow="关注",this.fansCountText="100万人关注了ta"}static createInstance(t){let e=new Ut;return e.name=Vt.getAdTitle(t),e.desc=t.adBaseInfo.adDescription,g(e.desc)&&(e.desc=""),e.icon=Vt.getIconUrl(t),e.isLive=t.adBaseInfo.isAccountLive,e.fansCountText=tt(t)+"人关注了Ta",e}}class Gt extends A{constructor(t){super(t),this.bottomBgColor="90,#00000080,#00000000",0==this.vm.screenOrientation?this.style={width:"100%",height:"100%"}:this.style={width:"50%",height:"100%",position:"absolute",right:0,bottom:0},this.setupViews()}setupViews(){let t=new TKView;t.style={width:"100%",height:193,gradientBgColor:this.bottomBgColor,position:"absolute",bottom:0},this.appendChild(t),this.initDailogSmallCard(),this.initDailogBigCard(),this.initBottomUI(),setTimeout((()=>{this.showSmallDialog()}),500)}initBottomUI(){let t=new TKView;t.style={height:68,width:"100%",padding:16,left:0,bottom:0,position:"absolute",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.appendChild(t);let i=new TKView;i.style={flexGrow:1,height:36,marginRight:8,borderRadius:18,backgroundColor:"#FFFFFF32",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",alignContent:"center"},t.appendChild(i),this.fansListView=new Wt(this.vm.adInfo,24,4),this.fansListView.style={width:86,height:24,marginLeft:6},i.appendChild(this.fansListView);let n=new TKText;n.style={fontSize:12,color:"#FFFFFF",marginLeft:-3,marginRight:8,height:34,textAlign:"center"},n.setText(tt(this.vm.adInfo)+"人关注了Ta"),i.appendChild(n),this.coverButton=new TKButton,this.coverButton.style={width:110,height:36,borderRadius:18,backgroundColor:"#FE3666",fontSize:14,color:"#FFFFFF"},this.coverButton.setText(this.vm.adInfo.adBaseInfo.adActionDescription),t.appendChild(this.coverButton),i.addEventListener("tap",(t=>{const i=c(t,this);this.convert(2,i,e.CARD_FOLLOW_NUM)})),this.coverButton.addEventListener("tap",(t=>{const i=c(t,this);this.convert(1,i,e.CARD_ACTION_BAR_CLICK)}))}initDailogSmallCard(){this.dialogSmallContainer=this.initDailogCardUI(!1),this.appendChild(this.dialogSmallContainer),this.dialogSmallContainer.addEventListener("tap",(t=>{const i=c(t,this);this.convert(2,i,e.CARD_OTHERAREA_CLICK)}))}initDailogBigCard(){this.dialogBigContainer=this.initDailogCardUI(!0),this.appendChild(this.dialogBigContainer),this.dialogBigContainer.addEventListener("tap",(t=>{const i=c(t,this);this.convert(2,i,e.CARD_OTHERAREA_CLICK)}))}initDailogCardUI(t){let e=new TKView;e.style={position:"absolute",height:t?88:60,width:"100%",paddingLeft:16,paddingRight:68,top:120,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",opacity:0};let i=new TKView;i.style={height:"100%",width:44},e.appendChild(i);let n=new TKImage;n.style={width:44,height:44,borderColor:"#FFFFFF",borderWidth:1,borderRadius:22};let a=this.vm.adInfo.adBaseInfo.appIconUrl;p(a)||(a="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),n.setSrc(a),i.appendChild(n);let s=new TKView;s.style={position:"absolute",width:26,height:16,borderRadius:8,backgroundColor:"#FE3666",left:9,top:34,flexDirection:"row",justifyContent:"center",alignItems:"center"},i.appendChild(s);let o=new TKImage;o.style={width:12,height:12},o.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_follow.png"),s.appendChild(o);let r=new TKView;r.style={height:"100%",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",flexGrow:1},e.appendChild(r);let h=new TKView;h.style={width:"100%",height:16,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},r.appendChild(h);let l=new TKView;l.style={height:"100%",maxWidth:"80%",marginLeft:12},h.appendChild(l);let d=this.vm.adInfo.adBaseInfo.appName;p(d)||(d=Vt.getAdTitle(this.vm.adInfo));let c=new TKText;c.style={fontSize:12,height:"100%",width:"100%",color:"#00000030",position:"absolute",marginTop:1,marginLeft:1,textLineClamp:1,textOverflow:"ellipsis"},c.setText(d),l.appendChild(c);let m=new TKText;m.style={fontSize:12,height:"100%",color:"#FFFFFF",textAlign:"center",textLineClamp:1,textOverflow:"ellipsis"},m.setText(d),l.appendChild(m),this.vm.adInfo.adBaseInfo.isAccountLive&&(t?(this.liveIcon=new Ot,this.liveIcon.style={marginLeft:4,marginRight:4},h.appendChild(this.liveIcon)):(this.liveIconSmall=new Ot,this.liveIconSmall.style={marginLeft:4,marginRight:4},h.appendChild(this.liveIconSmall)));let C=new TKText;C.style={color:"#FFFFFF80",fontSize:12,marginLeft:4,textAlign:"center"},C.setText("刚刚"),h.appendChild(C);let g=new TKView;g.style={marginTop:4,height:t?66:40,width:"100%",paddingRight:16,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},r.appendChild(g);let u=new TKView;u.style={width:7,height:"100%",marginLeft:5},g.appendChild(u);let w=new TKImage;if(w.style={width:7,height:14,position:"absolute",top:10},w.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_triangle.png"),u.appendChild(w),t){let t=new TKView;t.style={height:"100%",width:"100%",borderRadius:8,paddingLeft:15,paddingRight:15,backgroundColor:"#FFFFFF"},g.appendChild(t);let e=new TKText;e.style={fontSize:14,textLineClamp:2,textLineSpace:4,textOverflow:"ellipsis",color:"#222222",width:"100%",height:"100%",textAlign:"center"},e.setText(this.vm.adInfo.adBaseInfo.adDescription),t.appendChild(e);let i=new T(0,this.vm.adInfo);i.style={height:16,position:"absolute",right:4,bottom:4},r.appendChild(i)}else{let t=new TKView;t.style={height:"100%",borderRadius:8,backgroundColor:"#FFFFFF"},g.appendChild(t);let e=new TKText;e.style={fontSize:14,color:"#222222",height:20,marginTop:10,marginBottom:10,marginLeft:15,marginRight:10},e.setText("快来关注我吧"),t.appendChild(e)}return e}stopActionAnimation(){this.dialogSmallContainer.removeAllAnimation(),this.dialogBigContainer.removeAllAnimation(),this.liveIcon.stopLiveViewAnimation(),this.liveIconSmall.stopLiveViewAnimation(),this.fansListView.stopActionAnimation()}showSmallDialog(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.dialogSmallContainer.style={top:106,opacity:1},1)]),t.duration=300,t.on("end",(()=>{setTimeout((()=>{this.showBigDialog()}),2e3)})),this.dialogSmallContainer.addAnimation(t,"showSmallAniamtion")}showBigDialog(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.dialogSmallContainer.style={top:0,opacity:0},1)]),t.duration=500,this.dialogSmallContainer.addAnimation(t,"hideSmallAniamtion");let e=new TKKeyframeAnimation;e.setAnimations([()=>(this.dialogBigContainer.style={top:78,opacity:1},1)]),e.duration=500,this.dialogBigContainer.addAnimation(e,"showbigAniamtion")}getHeight(){return 234}}class Yt extends TKView{constructor(){super(),this.tag1=new $t(1),this.appendChild(this.tag1),this.tag2=new $t(2),this.appendChild(this.tag2),this.tag3=new $t(3),this.appendChild(this.tag3),this.tag4=new $t(4),this.appendChild(this.tag4),this.starAnimation()}starAnimation(){this.tagShow(this.tag1),this.animationAllowed=!0}stopActionAnimation(){this.animationAllowed=!1,this.tag1&&this.tag1.removeAllAnimation(),this.tag2&&this.tag2.removeAllAnimation(),this.tag3&&this.tag3.removeAllAnimation(),this.tag4&&this.tag4.removeAllAnimation()}cycleAnimation(){this.animationAllowed&&(90==this.tag1.status?(this.tag1.status=60,this.tag2.status=90,this.tag3.status=0,this.tag4.status=36):60==this.tag1.status?(this.tag1.status=36,this.tag2.status=60,this.tag3.status=90,this.tag4.status=0):36==this.tag1.status?(this.tag1.status=0,this.tag2.status=36,this.tag3.status=60,this.tag4.status=90):0==this.tag1.status&&(this.tag1.status=90,this.tag2.status=0,this.tag3.status=36,this.tag4.status=60),this.tag1.updateCurrentTop(),this.tag2.updateCurrentTop(),this.tag3.updateCurrentTop(),this.tag4.updateCurrentTop(),setTimeout((()=>{this.cycleAnimation()}),800))}tagShow(t){t.updateCurrentTop(),setTimeout((()=>{t==this.tag1&&(this.tag1.status=60,this.tagShow(this.tag2),this.tag1.updateCurrentTop()),t==this.tag2&&(this.tag2.status=60,this.tag1.status=36,this.tagShow(this.tag3),this.tag1.updateCurrentTop(),this.tag2.updateCurrentTop()),t==this.tag3&&(this.tag3.status=60,this.tag1.status=0,this.tag2.status=36,this.tag1.updateCurrentTop(),this.tag2.updateCurrentTop(),this.tag3.updateCurrentTop(),this.tagShow(this.tag4)),t==this.tag4&&this.cycleAnimation()}),800)}}class $t extends TKView{constructor(t){switch(super(),this.isShow=!1,this.style={height:20,borderRadius:10,position:"absolute",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",backgroundColor:"#00000060",top:90,opacity:0},this.leftIcon=new TKImage,this.leftIcon.style={width:16,height:16,marginLeft:8},this.appendChild(this.leftIcon),this.contentText=new TKText,this.contentText.style={height:"100%",marginLeft:3,marginRight:8,fontSize:12,color:"#FFDC84",textAlign:"center"},this.appendChild(this.contentText),t){case 1:this.leftIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_live_car.png"),this.contentText.setText("好物推荐超低折扣");break;case 2:this.leftIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_live_heart.png"),this.contentText.setText("宠粉主播");break;case 3:this.leftIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_live_gift.png"),this.contentText.setText("进入直播间送惊喜");break;case 4:this.leftIcon.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_live_grass.png"),this.contentText.setText("种草达人")}}updateCurrentTop(){let t=90,e=90;if(60==this.status)t=60,e=36;else if(36==this.status)t=36,e=0,this.tagHideAnimation();else{if(0==this.status)return this.style={top:90},void this.layout();t=90,e=60,this.tagShowAnimation()}let i=new TKKeyframeAnimation;i.setAnimations([()=>(this.style={top:t},0),()=>(this.style={top:e},1)]),i.duration=800,this.addAnimation(i,"updateTopAniamtion")}tagShowAnimation(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.style={opacity:0},0),()=>(this.style={opacity:1},1)]),t.duration=800,this.addAnimation(t,"showAniamtion")}tagHideAnimation(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.style={opacity:1},0),()=>(this.style={opacity:0},1)]),t.duration=800,this.addAnimation(t,"hideAniamtion")}}class Jt extends TKView{constructor(t){super(),this.imageSrcs=["https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_1.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_2.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_3.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_4.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_5.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_6.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_7.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_1.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_2.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_3.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_4.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_5.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_6.png","https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_animate_7.png"],this.mImageRight=0,this.mImageRight=t,this.images=new Array;for(let e=0;e<this.imageSrcs.length;++e){let t=this.imageSrcs[e],i=this.createAnimateImage(t);this.images.push(i)}}createAnimateImage(t){let e=new TKImage;return e.style={width:34,height:34,position:"absolute",right:this.mImageRight,top:150,opacity:0},e.setSrc(t),this.appendChild(e),e}stopActionAnimation(){this.animationAllowed=!1;for(let t=0;t<this.images.length;++t){this.images[t].removeAllAnimation()}}startAnimation(){this.animationAllowed=!0,this.cycleAniamtion()}cycleAniamtion(){if(this.animationAllowed){for(let t=0;t<this.images.length;++t){let e=this.images[t];setTimeout((()=>{this.animationMove(e)}),300*t)}setTimeout((()=>{this.cycleAniamtion()}),4200)}}animationMove(t){let e=new TKKeyframeAnimation;e.setAnimations([()=>(t.style={transform:{scale:1}},0),()=>(t.style={transform:{scale:1.3}},1)]),e.duration=600,t.addAnimation(e,"scaleAniamtion");let i=new TKKeyframeAnimation;i.setAnimations([()=>(t.style={opacity:0,top:125},0),()=>(t.style={opacity:1,top:98},.2),()=>(t.style={opacity:1,top:71},.4),()=>(t.style={opacity:0,top:0},.8),()=>(t.style={opacity:0,top:-20},1)]),i.duration=1600,t.addAnimation(i,"moveAniamtion")}}class Xt extends A{constructor(t){super(t),this.setupViews(),this.reloadDataInfo(),this.bindEvent()}setupViews(){this.style={width:"100%",height:"100%"},this.initLiveUI(),this.initBottomCardUI(),this.initAniamteUI(),setTimeout((()=>{this.changeAnimation()}),2400)}initLiveUI(){this.liveContainer=new TKView,this.liveContainer.style={position:"absolute",height:132,width:"100%",left:16,top:90,flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start"},this.appendChild(this.liveContainer),this.liveTopImage=new TKImage,this.liveTopImage.style={width:123,height:52,position:"absolute",top:5},this.liveTopImage.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fans_live.png"),this.liveTagListView=new Yt,this.liveTagListView.style={width:"100%",height:100,top:30},this.liveContainer.appendChild(this.liveTagListView),this.liveContainer.appendChild(this.liveTopImage)}initBottomCardUI(){this.bottomContainer=new TKView,this.bottomContainer.style={position:"absolute",width:"100%",height:100,bottom:0,left:-500},this.appendChild(this.bottomContainer),this.ksadLogoView=new T(1,this.vm.adInfo),this.ksadLogoView.style={height:16,position:"absolute",right:16,top:0},this.bottomContainer.appendChild(this.ksadLogoView);let t=new TKView;t.style={position:"absolute",width:"100%",height:94,bottom:0,padding:16},this.bottomContainer.appendChild(t);let e=new TKView;e.style={width:"100%",height:"100%",borderRadius:12,backgroundColor:"#00000060",flexDirection:"row",justifyContent:"space-between",padding:12},t.appendChild(e),this.appIcon=new TKImage,this.appIcon.style={width:20,height:20,borderRadius:10},e.appendChild(this.appIcon),this.descText=new TKText,this.descText.style={color:"#FFFFFF",fontSize:14,flexShrink:2,paddingLeft:8,paddingRight:4,width:"100%",textLineSpace:4,textLineClamp:2,textOverflow:"ellipsis"},e.appendChild(this.descText),this.coverBtn=new TKButton,this.coverBtn.style={width:73,height:33,borderRadius:16.5,backgroundColor:"#FFFFFF32",fontSize:14,color:"#FFFFFF"},e.appendChild(this.coverBtn)}initAniamteUI(){this.imageAnimationView=new Jt(15),this.imageAnimationView.style={width:73,height:170,position:"absolute",right:32,opacity:0},this.appendChild(this.imageAnimationView)}reloadDataInfo(){try{let t=this.vm.adInfo,e=t.adBaseInfo.appIconUrl;p(e)||(e="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),this.appIcon.setSrc(e),this.descText.setText(t.adBaseInfo.adDescription),this.coverBtn.setText(t.adBaseInfo.adActionDescription)}catch(t){}}bindEvent(){this.liveContainer.addEventListener("tap",(t=>{const i=c(t,this);this.convert(2,i,e.CARD_RECOMMEND_REASON_CLICK)})),this.bottomContainer.addEventListener("tap",(t=>{const i=c(t,this);this.convert(2,i,e.CARD_OTHERAREA_CLICK)})),this.coverBtn.addEventListener("tap",(t=>{const i=c(t,this);this.convert(1,i,e.CARD_ACTION_BAR_CLICK)}))}stopActionAnimation(){this.liveTagListView.stopActionAnimation(),this.imageAnimationView.stopActionAnimation()}changeAnimation(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.liveContainer.style={top:10},1)]),t.duration=1e3,this.liveContainer.addAnimation(t,"liveContainerAniamtion"),setTimeout((()=>{this.showBottomAnimation()}),500)}showBottomAnimation(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.bottomContainer.style={left:0},1)]),t.duration=500,t.on("end",(()=>{setTimeout((()=>{this.coverButtomAnimation()}),2e3)})),this.bottomContainer.addAnimation(t,"bottomContainerAniamtion")}coverButtomAnimation(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.coverBtn.style={backgroundColor:"#FE3666"},1)]),t.duration=500,t.on("end",(()=>{setTimeout((()=>{this.showImageAnimation()}),2e3)})),this.coverBtn.addAnimation(t,"coverAniamtion")}showImageAnimation(){this.imageAnimationView.style={opacity:1},this.imageAnimationView.startAnimation()}getHeight(){return 218}}class qt extends A{constructor(t){super(t),this.logoAreaHeight=20,this.cardMargin=12,this.cardMarginLandscape=16,this.smallCardHeight=78,this.bigCardHeight=142,this.horizontalCardWidth=351,this.mBtnAnimaCanceled=!1,this.isPortrait=0==this.vm.screenOrientation;let e=this.getHeight();this.isPortrait?this.style={height:e,width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"column",justifyContent:"space-between",paddingLeft:this.cardMargin,paddingRight:this.cardMargin,paddingBottom:this.cardMargin}:this.style={height:e,width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"row-reverse",justifyContent:"space-between",paddingLeft:this.cardMarginLandscape,paddingRight:this.cardMarginLandscape,paddingBottom:this.cardMarginLandscape},S(this.vm,this.vm.$attrsPath.hasExtraReward,(t=>{t&&this.switchToBigCard()})),this.isPortrait||this.appendChild(this.createKsAdLogoView(this.vm.adInfo)),this.mCardView=this.createExtraCard(this.vm.getNormalModel()),this.appendChild(this.mCardView)}createExtraCard(t){let e=new TKView;return e.style={height:"100%",width:this.isPortrait?"100%":this.horizontalCardWidth},this.mSmallCardView=this.createExtraSmallCard(t),e.appendChild(this.mSmallCardView),this.mBigCardView=this.createExtraBigCard(t),e}switchToBigCard(){this.mCardView.appendChild(this.mBigCardView),this.layout();let t=new TKBasicAnimation;t.setEndValue((()=>{this.mSmallCardView.style={transform:{translate:{y:25}},opacity:0}})),t.duration=500,t.timingFunction="EaseInEaseOut";let e=new TKBasicAnimation;e.setEndValue((()=>{this.mBigCardView.style={transform:{translate:{y:-25}},opacity:1}})),e.duration=500,e.timingFunction="EaseInEaseOut",this.mSmallCardView.addAnimation(t,"smallTransform"),this.mBigCardView.addAnimation(e,"bigTransform");let i=new TKBasicAnimation;i.setEndValue((()=>{this.mSweepView.style={transform:{translate:{x:400}}}})),i.duration=1e3,i.timingFunction="Linear",i.on("end",(()=>{this.mHandDownView.style={opacity:1},this.startBigCardBtnAnim()})),setTimeout((()=>{this.mSweepView.addAnimation(i,"sweep")}),700)}switchToSmall(){let t=new TKBasicAnimation;t.setEndValue((()=>{this.mSmallCardView.style={transform:{translate:{y:0}},opacity:1}})),t.duration=500,t.timingFunction="EaseInEaseOut";let e=new TKBasicAnimation;e.setEndValue((()=>{this.mBigCardView.style={transform:{translate:{y:0}},opacity:0}})),e.duration=500,e.timingFunction="EaseInEaseOut",this.mSmallCardView.addAnimation(t,"smallTransformVisible"),this.mBigCardView.addAnimation(e,"bigTransformGone"),e.on("end",(()=>{this.mCardView.removeChild(this.mBigCardView)}))}startBigCardBtnAnim(){if(this.mBtnAnimaCanceled)return;let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.mExtraBtn.style={transform:{scale:1}},0),()=>(this.mExtraBtn.style={transform:{scale:1}},.5),()=>(this.mExtraBtn.style={transform:{scale:.9}},.75),()=>(this.mExtraBtn.style={transform:{scale:1}},1)]),t.duration=400,t.on("end",(()=>{this.startBigCardBtnAnim()}));let e=new TKKeyframeAnimation;e.duration=400,e.setAnimations([()=>(this.mHandDownView.style={transform:{translate:{y:0}}},0),()=>(this.mHandDownView.style={transform:{translate:{y:10}}},.5),()=>(this.mHandDownView.style={transform:{translate:{y:0}}},1)]),this.mExtraBtn.addAnimation(t,"scale"),this.mHandDownView.addAnimation(e,"handTrans")}stopActionAnimation(){this.mBtnAnimaCanceled=!0,this.mSweepView&&this.mSweepView.removeAllAnimation(),this.mExtraBtn&&this.mExtraBtn.removeAllAnimation()}createExtraBigCard(t){let i=new TKView;i.nativeID="bigCard",i.style={width:"100%",flexDirection:"column",justifyContent:"space-around",padding:12,height:this.bigCardHeight,backgroundColor:"#FFFFFF",borderRadius:8},i.appendChild(this.createContentView(t,!0)),this.addClickConvert(i,2,e.CARD_BLANK_AREA_CLICK,!0);let n=new TKView;n.style={width:"100%",height:48},n.nativeID="btnContainer",this.addClickConvert(n,1,e.CARD_ACTION_BAR_CLICK,!0),this.mExtraBtn=new TKText,this.mExtraBtn.style={position:"absolute",textAlign:"center",left:0,right:0,width:"100%",height:48,backgroundColor:"#FE3666",borderRadius:24,fontSize:16,color:"#FFFFFF"},this.mExtraBtn.enabled=!1,this.mExtraBtn.setText(t.extraActionText),this.mSweepView=new TKImage,this.mSweepView.style={height:48,width:34,position:"absolute",left:-34},this.mSweepView.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_extra_reward_sweep.png"),n.appendChild(this.mExtraBtn),n.appendChild(this.mSweepView),i.appendChild(n),this.mHandDownView=new TKImage,this.mHandDownView.style={height:75,width:69,position:"absolute",top:32,right:15,opacity:0},this.mHandDownView.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_hand_down.png"),i.appendChild(this.mHandDownView);let a=new TKView;return a.style={width:"100%",height:"100%",flexDirection:"column",justifyContent:"space-between",bottom:-25,left:0,right:0,opacity:0,position:"absolute"},this.isPortrait&&a.appendChild(this.createKsAdLogoView(this.vm.adInfo)),a.appendChild(i),this.addClickConvert(i,2,e.CARD_BLANK_AREA_CLICK,!0),a}createExtraSmallCard(t){let i=new TKView;i.style={width:"100%",height:this.smallCardHeight,backgroundColor:"#FFFFFF",borderRadius:8,padding:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"},i.nativeID="smallCard",i.appendChild(this.createContentView(t,!1)),this.addClickConvert(i,2,e.CARD_BLANK_AREA_CLICK,!1);let n=new TKButton;n.style={height:36,paddingHorizontal:18,backgroundColor:"#FE3666",borderRadius:18,fontSize:14,textAlign:"center",color:"#FFFFFF"},n.setText(t.actionText),n.nativeID="btnOpen",this.addClickConvert(n,1,e.CARD_ACTION_BAR_CLICK,!1),i.appendChild(n);let a=new TKView;return a.style={height:this.isPortrait?this.smallCardHeight+this.logoAreaHeight:this.smallCardHeight,width:"100%",flexDirection:"column",justifyContent:"space-between",bottom:0,left:0,right:0,position:"absolute"},this.isPortrait&&a.appendChild(this.createKsAdLogoView(this.vm.adInfo)),a.appendChild(i),a}createKsAdLogoView(t){return this.ksadLogoView=new T(1,t),this.ksadLogoView.style={height:14,alignSelf:"flex-end"},this.ksadLogoView}createContentView(t,i){let n=new TKView;n.style={height:58,flexDirection:"row"};let a=new TKImage;a.style={height:58,width:58,borderRadius:12},a.nativeID="iconView:"+i,this.addClickConvert(a,2,e.CARD_ICON_CLICK,i),n.appendChild(a);let s=new TKView;s.style={height:58,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",marginLeft:12,paddingTop:3,paddingBottom:3,maxWidth:169};let o=new TKText;o.style={fontSize:17,fontWeight:"medium",color:"#222222",textLineClamp:1,textOverflow:"ellipsis"},o.nativeID="nameView:"+i;let r=new TKText;return r.style={fontSize:14,color:"#666666",textLineClamp:1,textOverflow:"ellipsis"},r.nativeID="descView:"+i,this.addClickConvert(o,2,e.CARD_ICON_NAME_CLICK,i),this.addClickConvert(r,2,e.CARD_ICON_COMMENT_CLICK,i),s.appendChild(o),s.appendChild(r),n.appendChild(s),a.setSrc(t.iconUrl),o.setText(t.name),r.setText(t.desc),n}addClickConvert(t,e,a,s){t.addEventListener("tap",(o=>{let r=null,h=at(this.vm.adInfo,e);if(console.log("CurrentExtraRewardHolder addClickConvert shouldConvert: "+h+", isExtraReward: "+s+", viewID: "+t.nativeID),s&&h){let t={extraRewardType:i.adClickReward,extraRewardStatus:n.isRewarded};pt.updateExtraReward(t),setTimeout((()=>{this.stopActionAnimation(),this.mExtraBtn.setText(this.vm.getNormalModel().extraActionTextClicked),this.mHandDownView.style={opacity:0}}),500),r={businessSceneType:22},setTimeout((()=>{this.switchToSmall()}),300)}this.vm.convert(1,e,o.position,a,null,r)}))}getHeight(){return this.isPortrait?this.bigCardHeight+this.cardMargin+this.logoAreaHeight:this.bigCardHeight+this.cardMarginLandscape}}function Zt(t,e,i,n,a=!1){const s=new TKKeyframeAnimation;return a?(s.setAnimations([()=>(t.style={transform:{scale:e}},.5),()=>(t.style={transform:{scale:1}},1)]),s.timingFunction="EaseInEaseOut"):(s.animType="scale",s.keyframes=[{percent:0,value:1,easing:"EaseInEaseOut"},{percent:.33,value:e,easing:"EaseInEaseOut"},{percent:.66,value:1/e,easing:"EaseInEaseOut"},{percent:1,value:1,easing:"EaseInEaseOut"}]),s.duration=i,s.repeatCount=n,s}function Qt(t,e,i=!1){const n=new TKKeyframeAnimation;return i?(n.setAnimations([()=>(t.style={opacity:1},1)]),n.timingFunction="EaseInEaseOut"):(n.animType="opacity",n.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:1,value:1,easing:"EaseInEaseOut"}]),n.duration=e,n}class te extends TKView{constructor(t,e,i,n){super(),this.vm=t,this.index=e,this.isOpened=i,this.discountCardType=n,this.setupView(),this.setupAction(),this.setupData()}setupView(){const t=this.vm.getRedPacketViewSize(this.discountCardType,this.index);this.style={width:t.width,height:t.height,justifyContent:"center",alignItems:"center"},this.redPacketImage=new TKImage,this.redPacketImage.style={width:"100%",height:"100%"},this.appendChild(this.redPacketImage),this.valueContainerView=new TKView,this.valueContainerView.style={position:"absolute",paddingTop:18,flexDirection:"row",justifyContent:"center",alignItems:"flex-end",opacity:0},this.appendChild(this.valueContainerView);let e=36;1!=this.discountCardType&&(e=0==this.vm.screenOrientation?30:28),this.valueText=new TKText,this.valueText.style={fontSize:e,color:"#FFE7BF",textAlign:"center"},this.valueContainerView.appendChild(this.valueText);let i=18;1!=this.discountCardType&&(i=0==this.vm.screenOrientation?16:14),this.unitText=new TKText,this.unitText.style={fontSize:i,color:"#FFE7BF",textAlign:"center",marginBottom:5},this.valueContainerView.appendChild(this.unitText),this.isOpened?this.openRedPacket():this.closeRedPacket()}setupData(){g(this.vm.getRedPacketValueString(this.index))?(this.valueText.style={visibility:"hidden"},this.unitText.style={visibility:"hidden"}):(this.valueText.setText(this.vm.getRedPacketValueString(this.index)),this.unitText.setText("元"))}setupAction(){const t=this;this.addEventListener("tap",(i=>{let n,a,s=new H;p(t.vm.getRedPacketValueString(t.index))&&(n=[t.vm.getRedPacketValueString(t.index)]),s.neo_ext_data=t.vm.getDiscountNeoExtData(n),s.template_show_type=t.vm.getDiscountTemplateShowType(t.discountCardType),0==t.index?a=e.CARD_PICTURE_CLICK_ONE:1==t.index?a=3==this.discountCardType?e.CARD_ACTION_BAR_CLICK:e.CARD_PICTURE_CLICK_TWO:2==t.index&&(a=e.CARD_PICTURE_CLICK_THREE);const o=c(i,t);t.vm.convert(1,2,o,a,s)}))}openRedPacket(){this.redPacketImage.setSrc(this.vm.getRedPacketImageUrl(!0,this.index)),this.valueContainerView.style={opacity:1}}closeRedPacket(){this.redPacketImage.setSrc(this.vm.getRedPacketImageUrl(!1,this.index)),this.valueContainerView.style={opacity:0}}updateFinalViewType(t){this.discountCardType=t}getRedPacketWidth(){return this.vm.getRedPacketViewSize(this.discountCardType,this.index).width}startShakeAnimation(t){const e=this,i=new TKKeyframeAnimation;this.vm.supportNewAnimation()?(i.setAnimations([()=>(e.style={transform:{scale:1.05,rotate:5}},.25),()=>(e.style={transform:{scale:1.1,rotate:-5}},.6),()=>(e.style={transform:{scale:1,rotate:0}},1)]),i.timingFunction="EaseInEaseOut"):(i.animType="rotationZ",i.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:f.getSemiCircle()/36,easing:"EaseInEaseOut"},{percent:.5,value:-f.getSemiCircle()/18,easing:"EaseInEaseOut"},{percent:.75,value:f.getSemiCircle()/36,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}]),i.duration=800,i.repeatCount=t,i.on("end",(()=>{e.shakeAnimationCompletion&&e.shakeAnimationCompletion()})),this.addAnimation(i,"shakeAnimation")}}class ee extends TKImage{constructor(t,e){super(),this.vm=t,this.discountCardType=e,this.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_hand_touch_guide.png")}startGuidanceAnimation(t){if(this.isCompletedShowAnimation){const e=Zt(this,1.15,480,t,this.vm.supportNewAnimation());this.addAnimation(e,"handImageBeatAnimation")}else{const e=Qt(this,200,this.vm.supportNewAnimation());this.addAnimation(e,"handImageShowAnimation"),this.isCompletedShowAnimation=!0;const i=this;e.on("end",(()=>{const e=Zt(i,1.15,480,t,i.vm.supportNewAnimation());i.addAnimation(e,"handImageBeatAnimation")}))}}}class ie extends TKView{constructor(t){super(),this.vm=t,this.discountCardType=1,this.setupView(),this.setupData(),this.setupAction()}setupView(){this.style={width:"100%",height:"100%",backgroundColor:f.isAndroid?"#00000080":"#00000066",justifyContent:"center",alignItems:"center"};const t=Tachikoma.env.deviceWidth;this.shiningImage=new TKImage,this.shiningImage.style={width:t,height:344*t/375,position:"absolute"},this.shiningImage.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_discounts_lighting.png"),this.appendChild(this.shiningImage),this.containerView=new TKView,this.containerView.style={justifyContent:"center",alignItems:"center",width:t},this.appendChild(this.containerView);const e=0==this.vm.screenOrientation?26:10;this.closeButton=new TKImage,this.closeButton.style={width:24,height:24,marginBottom:e,marginRight:20,alignSelf:"flex-end"},this.closeButton.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_fill_close.png"),this.containerView.appendChild(this.closeButton),this.titleImage=new TKImage,this.titleImage.style={width:280,height:64,marginBottom:12},this.titleImage.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_discounts_interact_title_image.png"),this.containerView.appendChild(this.titleImage),this.maxDiscountsImage=new TKImage,this.maxDiscountsImage.style={width:88,height:26,opacity:0},this.maxDiscountsImage.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_max_discounts_tag.png"),this.containerView.appendChild(this.maxDiscountsImage);const i=0==this.vm.screenOrientation?31:-13;this.redPacketsView=new TKView,this.redPacketsView.style={top:-13,width:t,marginBottom:i,paddingTop:20,paddingLeft:20,paddingBottom:20,paddingRight:20,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.containerView.appendChild(this.redPacketsView),this.leftRedPacketView=new te(this.vm,0,!0,this.discountCardType),this.leftRedPacketView.style={marginTop:12},this.redPacketsView.appendChild(this.leftRedPacketView),this.rightRedPacketView=new te(this.vm,2,!0,this.discountCardType),this.rightRedPacketView.style={marginTop:12},this.redPacketsView.appendChild(this.rightRedPacketView),this.centerOpendRedPacketView=new te(this.vm,1,!0,this.discountCardType);const n=(t-this.centerOpendRedPacketView.getRedPacketWidth())/2;this.centerOpendRedPacketView.style={position:"absolute",left:n},this.redPacketsView.appendChild(this.centerOpendRedPacketView),this.centerClosedRedPacketView=new te(this.vm,1,!1,this.discountCardType),this.centerClosedRedPacketView.style={position:"absolute",left:n,opacity:0},this.redPacketsView.appendChild(this.centerClosedRedPacketView);const a=0==this.vm.screenOrientation?-20:25;this.handImage=new ee(this.vm,this.discountCardType),this.handImage.style={marginTop:-68,marginLeft:76,top:a,height:68,width:68,opacity:0},this.appendChild(this.handImage),this.vm.reportDiscountViewImpression(this.discountCardType)}setupData(){this.vm.isAutoChooseReward()&&(this.autoChooseRewardCountDown=this.vm.getAutoChooseRewardCountDown(),this.startAutoChooseRewardTimer());const t=this;setTimeout((()=>{t.startAnimation()}),1e3)}setupAction(){const t=this;this.addEventListener("tap",(i=>{let n=new H;n.neo_ext_data=t.vm.getDiscountNeoExtData(),n.template_show_type=t.vm.getDiscountTemplateShowType(t.discountCardType);const a=c(i,t);t.vm.convert(1,2,a,e.CARD_OTHERAREA_CLICK,n)})),this.titleImage.addEventListener("tap",(i=>{let n=new H;n.neo_ext_data=t.vm.getDiscountNeoExtData(),n.template_show_type=t.vm.getDiscountTemplateShowType(t.discountCardType);const a=c(i,t.titleImage);t.vm.convert(1,2,a,e.CARD_ICON_NAME_CLICK,n)})),this.closeButton.addEventListener("tap",(()=>{t.vm.reportDiscountInitialViewClose(t.discountCardType),t.hideInitialView()}))}startAnimation(){this.startRedPacketsFoldAnimation()}startRedPacketsFoldAnimation(){const t=this,e=Zt(this.centerOpendRedPacketView,.85,800,1,this.vm.supportNewAnimation());this.centerOpendRedPacketView.addAnimation(e,"centerOpendRedPacketBeatAnimation");const i=Zt(this.leftRedPacketView,1.05,800,1,this.vm.supportNewAnimation()),n=this.createRedPacketMoveAnimation(this.leftRedPacketView);i.on("end",(()=>{t.leftRedPacketView.addAnimation(n,"lefttRedPacketFoldMoveAnimation")})),this.leftRedPacketView.addAnimation(i,"leftRedPacketBeatAnimation");const a=Zt(this.rightRedPacketView,1.05,800,1,this.vm.supportNewAnimation()),s=this.createRedPacketMoveAnimation(this.rightRedPacketView);a.on("end",(()=>{t.rightRedPacketView.addAnimation(s,"rightRedPacketFoldMoveAnimation")})),this.rightRedPacketView.addAnimation(a,"rightRedPacketBeatAnimation"),this.startShiningAnimation(),setTimeout((()=>{t.leftRedPacketView.style={opacity:0},t.rightRedPacketView.style={opacity:0},t.centerOpendRedPacketView.style={opacity:0};const e=Qt(t.centerClosedRedPacketView,160,this.vm.supportNewAnimation());setTimeout((()=>{t.startRedPacketsExpandAnimation()}),160),t.centerClosedRedPacketView.addAnimation(e,"centerClosedRedPacketViewOpacityAnimation")}),1200)}createRedPacketMoveAnimation(t,e=!0){const i=new TKKeyframeAnimation,n=t.getRedPacketWidth()+20;let a=0;if(t==this.leftRedPacketView?a=e?n:this.vm.supportNewAnimation()||f.isAndroid()?0:-n:t==this.rightRedPacketView&&(a=e?-n:this.vm.supportNewAnimation()||f.isAndroid()?0:n),this.vm.supportNewAnimation())i.setAnimations([()=>(t.style={left:a},1)]),i.timingFunction="EaseInEaseOut";else{const n=f.isAndroid()?a:Number(t.getOrigin().x)+a,s=f.isAndroid()?0:Number(t.getOrigin().y),o=f.isAndroid()?this.getRedPacketMoveAnimationCurrentOffsetX(t,e):n;i.animType="position",i.keyframes=[{percent:0,value:{x:o,y:s},easing:"EaseInEaseOut"},{percent:1,value:{x:n,y:s},easing:"EaseInEaseOut"}]}return i.duration=400,i}getRedPacketMoveAnimationCurrentOffsetX(t,e=!0){let i=0;const n=t.getRedPacketWidth()+20;return t==this.leftRedPacketView?!e&&f.isAndroid()&&(i=n):t==this.rightRedPacketView&&!e&&f.isAndroid()&&(i=-n),i}startShiningAnimation(){const t=this,e=new TKKeyframeAnimation;this.vm.supportNewAnimation()?(e.setAnimations([()=>(t.shiningImage.style={transform:{rotate:45}},1)]),e.timingFunction="EaseInEaseOut"):(e.animType="rotationZ",e.keyframes=[{percent:0,value:f.isAndroid()?0:f.getSemiCircle()/4,easing:"EaseInEaseOut"},{percent:1,value:f.getSemiCircle()/4,easing:"EaseInEaseOut"}]),e.duration=800,this.shiningImage.addAnimation(e,"shiningImageRotateAnimation"),e.on("end",(()=>{t.shiningImage.style={opacity:0}}))}startRedPacketsExpandAnimation(){const t=this;this.startCenterClosedRedPacketBeatAnimation(),this.leftRedPacketView.closeRedPacket(),t.leftRedPacketView.style={opacity:1};const e=t.createRedPacketMoveAnimation(t.leftRedPacketView,!1);t.leftRedPacketView.addAnimation(e,"lefttRedPacketExpandMoveAnimation"),this.rightRedPacketView.closeRedPacket(),t.rightRedPacketView.style={opacity:1};const i=t.createRedPacketMoveAnimation(t.rightRedPacketView,!1);t.rightRedPacketView.addAnimation(i,"rightRedPacketExpandMoveAnimation")}startCenterClosedRedPacketBeatAnimation(){const t=this,e=Zt(this.centerClosedRedPacketView,.95,500,1,this.vm.supportNewAnimation());setTimeout((()=>{t.centerClosedRedPacketView.startShakeAnimation(2)}),500),this.centerClosedRedPacketView.shakeAnimationCompletion=()=>{t.centerClosedRedPacketView.style={opacity:0};const e=Qt(t.centerOpendRedPacketView,145,t.vm.supportNewAnimation());t.centerOpendRedPacketView.addAnimation(e,"centerOpenedRedPackeShowAnimation"),e.on("end",(()=>{setTimeout((()=>{t.hideInitialView()}),2e3)}));const i=Qt(t.maxDiscountsImage,120,t.vm.supportNewAnimation());t.maxDiscountsImage.addAnimation(i,"maxDiscountsImageShowAnimation"),i.on("end",(()=>{this.startGuidanceAnimation()}))},this.centerClosedRedPacketView.addAnimation(e,"centerClosedRedPacketBeatAnimation")}startGuidanceAnimation(){this.handImage.startGuidanceAnimation(3)}hideInitialView(){if(this.isHidingInitialView)return;this.isHidingInitialView=!0;const t=this,e=new TKKeyframeAnimation;this.vm.supportNewAnimation()?(e.setAnimations([()=>(t.style={opacity:0},1)]),e.timingFunction="EaseInEaseOut"):(e.animType="opacity",e.keyframes=[{percent:0,value:f.isAndroid?1:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}]),e.duration=500,e.on("end",(()=>{t.closeCallback&&(t.stopAutoClooseRewardTimer(),t.closeCallback(t.autoChooseRewardCountDown),t.isHidingInitialView=!1)})),this.addAnimation(e,"hideInitialViewAnimation")}startAutoChooseRewardTimer(){const t=this;this.autoChooseRewardTimer=setInterval((()=>{t.autoChooseRewardCountDown-=1}),1e3)}stopAutoClooseRewardTimer(){this.autoChooseRewardTimer&&(clearInterval(this.autoChooseRewardTimer),this.autoChooseRewardTimer=0)}}class ne extends TKView{constructor(t){super(),this.vm=t,this.discountCardType=2,this.setupView()}setupView(){const t=this.vm.getDiscountFinalViewWidth();this.style={paddingLeft:16,paddingRight:16,paddingBottom:16,alignItems:"center",width:t},this.productView=new ae(this.vm),this.productView.style={marginBottom:8},this.appendChild(this.productView);const e=this;this.redPacketsView=new se(this.vm,t-32),this.redPacketsView.startGuideChooseRewardCallback=()=>{e.discountCardType=3,e.productView.updateFinalViewType(e.discountCardType),e.redPacketsView.updateFinalViewType(e.discountCardType),e.handImage.startGuidanceAnimation(Number.MAX_VALUE),e.vm.reportDiscountViewImpression(e.discountCardType)},this.redPacketsView.stopGuideChooseRewardCallback=()=>{e.handImage.style={visibility:"hidden"}},this.appendChild(this.redPacketsView);this.handImage=new ee(this.vm,this.discountCardType),this.handImage.style={marginTop:-60,marginLeft:70,top:20,height:60,width:60,opacity:0},this.appendChild(this.handImage)}startAnimation(){const t=this,e=Qt(t,500,this.vm.supportNewAnimation());e.on("end",(()=>{t.handImage.startGuidanceAnimation(Number.MAX_VALUE),t.redPacketsView.startAnimation()})),this.addAnimation(e,"showFinalViewAnimation"),this.vm.reportDiscountViewImpression(t.discountCardType)}updateAutoChooseRewardCountDown(t){this.redPacketsView&&this.redPacketsView.updateAutoChooseRewardCountDown(t)}}class ae extends TKView{constructor(t){super(),this.vm=t,this.discountCardType=2,this.setupView(),this.setupData(),this.setupAction()}setupView(){this.style={width:"100%",flexDirection:"row",alignItems:"center"},this.iconImage=new TKImage,this.iconImage.style={width:50,height:50,borderRadius:8},this.appendChild(this.iconImage),this.textContainerView=new TKView,this.textContainerView.style={height:50,marginLeft:8,marginRight:110,paddingTop:2,paddingBottom:2,justifyContent:"center"},this.appendChild(this.textContainerView),this.titleText=new TKText,this.titleText.style={fontSize:16,color:"#FFFFFF",textLineClamp:1,marginBottom:8,display:"none"},this.textContainerView.appendChild(this.titleText),this.descriptionText=new TKText,this.descriptionText.style={fontSize:14,color:"#FFFFFF",textLineClamp:1},this.textContainerView.appendChild(this.descriptionText),this.logoView=new T(1,this.vm.adInfo),this.logoView.style={position:"absolute",right:0,bottom:0},this.logoView.enabled=!1,this.appendChild(this.logoView)}setupData(){this.iconImage.setSrc(this.vm.getAdIcon()),p(this.vm.getProductShortTitle())&&(this.titleText.style={display:"flex"}),this.titleText.setText(this.vm.getProductShortTitle()),this.descriptionText.setText(this.vm.getProductSellingPoint())}setupAction(){this.addClickConvert(this.iconImage,2,e.CARD_ICON_CLICK),this.addClickConvert(this.titleText,2,e.CARD_ICON_NAME_CLICK),this.addClickConvert(this.descriptionText,2,e.CARD_ICON_NAME_CLICK)}updateFinalViewType(t){this.discountCardType=t}addClickConvert(t,e,i){const n=this;t.addEventListener("tap",(a=>{let s=new H;s.neo_ext_data=n.vm.getDiscountNeoExtData(),s.template_show_type=n.vm.getDiscountTemplateShowType(n.discountCardType);const o=c(a,t);n.vm.convert(1,e,o,i,s)}))}}class se extends TKView{constructor(t,e){super(),this.vm=t,this.width=e,this.discountCardType=2,this.setupView(),this.setupData(),this.setupAction()}setupView(){this.style={width:this.width,justifyContent:"flex-end",alignItems:"center",borderRadius:8,backgroundColor:"#222222CC"},this.titleText=new TKText,this.titleText.style={position:"absolute",top:10,left:10,height:21,fontSize:14,color:"#FFFFFF"},this.appendChild(this.titleText),this.countdownText=new TKText,this.countdownText.style={position:"absolute",top:10,right:10,height:21,fontSize:12,color:"#FFFFFF"},this.appendChild(this.countdownText),this.redPacketsView=new TKView,this.redPacketsView.style={flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:0,paddingTop:42},this.appendChild(this.redPacketsView),this.leftRedPacketView=new te(this.vm,0,!1,this.discountCardType),this.leftRedPacketView.style={marginBottom:14},this.redPacketsView.appendChild(this.leftRedPacketView);const t=0==this.vm.screenOrientation?30:28;this.centerRedPacketView=new te(this.vm,1,!0,this.discountCardType),this.centerRedPacketView.style={marginLeft:t,marginRight:t,marginBottom:12},this.redPacketsView.appendChild(this.centerRedPacketView),this.rightRedPacketView=new te(this.vm,2,!1,this.discountCardType),this.rightRedPacketView.style={marginBottom:14},this.redPacketsView.appendChild(this.rightRedPacketView)}setupData(){this.titleText.setText("恭喜获得专属幸运福利"),this.vm.isAutoChooseReward()&&this.vm.enableShowGuidanceRedPacket()||this.countdownText.setText("仅剩66个优惠名额")}setupAction(){const t=this;this.addEventListener("tap",(i=>{let n=new H;n.neo_ext_data=t.vm.getDiscountNeoExtData(),n.template_show_type=t.vm.getDiscountTemplateShowType(t.discountCardType);const a=c(i,t);t.vm.convert(1,2,a,e.CARD_OTHERAREA_CLICK,n)}))}startAnimation(){this.centerRedPacketView.startShakeAnimation(3)}updateAutoChooseRewardCountDown(t){this.autoChooseRewardCountDown=t,this.countdownText.setText(this.autoChooseRewardCountDown+"s后自动选择"),this.startAutoChooseRewardTimer()}startAutoChooseRewardTimer(){this.stopAutoClooseRewardTimer();const t=this;this.autoChooseRewardTimer=setInterval((()=>{t.autoChooseRewardCountDown-=1,t.countdownText.setText(this.autoChooseRewardCountDown+"s后自动选择"),t.autoChooseRewardCountDown<=0&&(t.stopAutoClooseRewardTimer(),t.countdownText.setText(""),t.countdownText.style={visibility:"hidden"},t.showGuidanceRedPacketIfNeeded())}),1e3)}stopAutoClooseRewardTimer(){this.autoChooseRewardTimer&&(clearInterval(this.autoChooseRewardTimer),this.autoChooseRewardTimer=0)}showGuidanceRedPacketIfNeeded(){this.guideChooseRewardCountDown=this.vm.getGuideChooseRewardCountDown(),this.vm.enableShowGuidanceRedPacket()&&(this.leftRedPacketView.style={visibility:"hidden"},this.rightRedPacketView.style={visibility:"hidden"},this.centerRedPacketView.closeRedPacket(),this.centerRedPacketView.startShakeAnimation(3),this.titleText.setText("已为您选择超级优惠"),this.countdownText.setText(this.guideChooseRewardCountDown+"s后失效"),this.startGuideChooseRewardTimer(),this.startGuideChooseRewardCallback&&this.startGuideChooseRewardCallback())}startGuideChooseRewardTimer(){this.stopGuideChooseRewardTimer();const t=this;this.guideChooseRewardTimer=setInterval((()=>{t.guideChooseRewardCountDown-=1,t.countdownText.style={visibility:"visible"},t.countdownText.setText(t.guideChooseRewardCountDown+"s后失效"),t.guideChooseRewardCountDown<=0&&(t.countdownText.style={visibility:"hidden"},t.stopGuideChooseRewardTimer(),t.style={display:"none"},t.stopGuideChooseRewardCallback&&t.stopGuideChooseRewardCallback())}),1e3)}stopGuideChooseRewardTimer(){this.guideChooseRewardTimer&&(clearInterval(this.guideChooseRewardTimer),this.guideChooseRewardTimer=0)}updateFinalViewType(t){this.discountCardType=t,this.centerRedPacketView.updateFinalViewType(this.discountCardType)}}class oe extends A{constructor(t){super(t),this.style={width:"100%",height:"100%",padding:0,justifyContent:"center",alignItems:"center"};const e=this;this.initialView=new ie(this.vm),this.initialView.closeCallback=t=>{e.finalView&&e.vm.isAutoChooseReward()&&this.vm.enableShowGuidanceRedPacket()&&e.finalView.updateAutoChooseRewardCountDown(t),e.showFinalView()},this.appendChild(this.initialView),this.finalView=new ne(this.vm),this.finalView.style={position:"absolute",left:0,bottom:0,opacity:0},this.appendChild(this.finalView)}getHeight(){return 0==this.vm.screenOrientation?Tachikoma.env.deviceHeight:Tachikoma.env.deviceWidth}showFinalView(){this.isShowFinalView||(this.initialView&&this.removeChild(this.initialView),this.finalView&&this.finalView.startAnimation(),this.isShowFinalView=!0)}}const re="coupon_of_cash_equity";class he extends A{constructor(t){super(t),this.vm=t,this.setupView(),this.appendOutContainerView(),this.appendCouponContainerView(),this.setupData(),this.setupActions()}setupView(){this.width=this.vm.containerLimit.width-32,this.height=80*(this.width-16)/327,this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",bottom:-16,opacity:0},this.containerView=new TKView,this.containerView.style={width:this.width,height:this.getHeight(),left:16,flexDirection:"column",justifyContent:"center",alignItems:"center",position:"absolute",backgroundColor:"#FFFFFF",borderRadius:10},this.appendChild(this.containerView),this.setupLogoView()}appendOutContainerView(){this.couponTitleContainer=new TKView,this.couponTitleContainer.style={width:this.width-16,height:17,top:"7.7%",left:8,flexDirection:"row",alignItems:"center",position:"absolute"},this.containerView.appendChild(this.couponTitleContainer),this.bannerTitle=new TKText,this.bannerTitle.style={left:0,top:0,fontSize:12,color:"#FC4A5D",textLineClamp:1,fontWeight:"medium",position:"absolute",alignItems:"center",justifyContent:"center",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.bannerTitle),this.couponTips=new TKText,this.couponTips.style={right:0,fontSize:10,fontWeight:"medium",color:"#6666664D",textLineClamp:1,position:"absolute",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.couponTips)}appendCouponContainerView(){this.icon=new TKImage,this.icon.style={width:this.width-16,height:this.height,left:8,position:"absolute",resize:"stretch",bottom:"6.4%"},this.containerView.appendChild(this.icon),this.couponViewContainer=new TKView,this.couponViewContainer.style={width:this.width-16,height:this.height,left:8,flexDirection:"row",justifyContent:"center",alignItems:"center",position:"absolute",bottom:"6.4%"},this.containerView.appendChild(this.couponViewContainer),this.priceContainer=new TKView,this.priceContainer.style={left:0,width:"26%",position:"absolute",alignItems:"center",justifyContent:"center",alignContent:"center",flexDirection:"row"},this.couponViewContainer.appendChild(this.priceContainer),this.price=new TKText,this.price.style={fontSize:d()?38:32,color:"#FFFFFF",textLineClamp:1,fontWeight:"bold",textOverflow:"ellipsis",alignItems:"center",justifyContent:"center",textAlign:"center"},this.priceContainer.appendChild(this.price),this.titleContainer=new TKView,this.titleContainer.style={left:"30.8%",width:"36.7%",height:44,justifyContent:"flex-start",alignItems:"flex-start",position:"absolute"},this.couponViewContainer.appendChild(this.titleContainer),this.title=new TKText,this.title.style={top:d()?0:2,fontSize:d()?17:15,color:"#FFFFFF",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis",position:"absolute"},this.titleContainer.appendChild(this.title),this.contentDesc=new TKText,this.contentDesc.style={bottom:0,fontSize:d()?14:12,color:"#FFCCCC",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis",position:"absolute"},this.titleContainer.appendChild(this.contentDesc),this.actionBarContainer=new TKView,this.actionBarContainer.style={width:92*this.width/375,height:36*this.width/375,flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#FFFFFF",right:10,borderRadius:18*this.width/375,position:"absolute"},this.couponViewContainer.appendChild(this.actionBarContainer),this.actionBarDesc=new TKText,this.actionBarDesc.style={fontSize:d()?16:14,color:"#FF3A30",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"},this.actionBarContainer.appendChild(this.actionBarDesc)}setupLogoView(){var t;const e=(null===(t=Tachikoma.env.safeAreaInsets)||void 0===t?void 0:t.bottom)>0?43:27;this.logoView=new T(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:16,bottom:this.getHeight()+e},this.logoView.enabled=!1,this.appendChild(this.logoView)}getHeight(){return this.height+44}setupData(){let t=this.vm.getCouponModel();this.bannerTitle.setText(t.bannerTitle),this.couponTips.setText(t.couponTips),this.title.setText(t.title),this.contentDesc.setText(t.contentDesc),this.actionBarDesc.setText(t.actionBarDesc),this.addPriceSpan(),this.icon.setSrc(this.vm.getCouponBackImageUrl())}setupActions(){const t=this;t.containerView.addEventListener("tap",(i=>{let n=new H;n.template_show_type=re;const a=c(i,t.containerView);t.vm.convert(1,2,a,e.CARD_ACTION_BAR_CLICK,n)})),t.actionBarContainer.addEventListener("tap",(i=>{let n=new H;n.template_show_type=re;const a=c(i,t.actionBarContainer);t.vm.convert(1,1,a,e.CARD_ACTION_BAR_CLICK,n)}))}addPriceSpan(){let t=this.vm.getCouponModel(),e=t.priceTag+t.price;const i=e.search(t.priceTag);let n=new TKSpan,a=d()?22:16;const s=new TKSpanItem;s.size=a,s.spanType="absoluteSize",s.start=i,s.end=i+t.priceTag.length,n.addSpan(s),this.price.setSpan(e,n)}}const le="coupon_of_no_cash_equity";class de extends A{constructor(t){super(t),this.bgColor="135, #FF786A, #FFF4E1",this.vm=t,this.setupView(),this.setupData(),this.setupActions(),this.addHighlightSpan()}setupView(){this.width=this.vm.containerLimit.width-32,this.height=80*(this.width-16)/327,this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",bottom:-16,opacity:0},this.containerView=new TKView,this.containerView.style={width:this.width,height:this.getHeight(),left:16,flexDirection:"column",position:"absolute",justifyContent:"center",alignItems:"center",gradientBgColor:this.bgColor,borderRadius:10},this.appendChild(this.containerView),this.appendOutContainerView(),this.appendCouponContainerView(),this.setupLogoView()}appendOutContainerView(){this.couponTitleContainer=new TKView,this.couponTitleContainer.style={width:this.width-16,height:17,left:8,top:"7.7%",flexDirection:"row",alignItems:"center",position:"absolute"},this.containerView.appendChild(this.couponTitleContainer),this.bannerTitle=new TKText,this.bannerTitle.style={left:0,top:0,fontSize:12,color:"#FC4A5D",textLineClamp:1,fontWeight:"medium",position:"absolute",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.bannerTitle),this.couponTips=new TKText,this.couponTips.style={right:0,fontSize:10,color:"#FFFFFF",textLineClamp:1,position:"absolute",fontWeight:"medium",textOverflow:"ellipsis"},this.couponTitleContainer.appendChild(this.couponTips)}appendCouponContainerView(){this.couponViewContainer=new TKView,this.couponViewContainer.style={width:this.width-16,height:this.height,flexDirection:"row",backgroundColor:"#FDFDFD",justifyContent:"center",alignItems:"center",position:"absolute",bottom:"6.4%",borderRadius:8},this.containerView.appendChild(this.couponViewContainer),this.icon=new TKImage,this.icon.style={width:68*this.width/343,height:68*this.width/343,left:"1.8%",borderRadius:6,position:"absolute"},this.couponViewContainer.appendChild(this.icon),this.titleContainer=new TKView,this.titleContainer.style={left:"27.5%",width:"40%",height:46,justifyContent:"flex-start",alignItems:"flex-start",position:"absolute"},this.couponViewContainer.appendChild(this.titleContainer),this.title=new TKText,this.title.style={top:d()?0:2,fontSize:15,position:"absolute",color:"#040404",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis"},this.titleContainer.appendChild(this.title),this.contentDesc=new TKText,this.contentDesc.style={bottom:0,fontSize:12,color:"#8C8C8C",textLineClamp:1,position:"absolute",fontWeight:"medium",textOverflow:"ellipsis"},this.titleContainer.appendChild(this.contentDesc),this.actionBarContainer=new TKView,this.actionBarContainer.style={width:88*this.width/343,height:36*this.width/343,flexDirection:"column",justifyContent:"center",alignItems:"center",position:"absolute",backgroundColor:"#FE3666",right:10,borderRadius:18*this.width/343},this.couponViewContainer.appendChild(this.actionBarContainer),this.actionBarDesc=new TKText,this.actionBarDesc.style={fontSize:14,color:"#FFFFFF",textLineClamp:1,fontWeight:"medium",includeFontPadding:!1,textOverflow:"ellipsis"},this.actionBarContainer.appendChild(this.actionBarDesc)}setupLogoView(){var t;const e=(null===(t=Tachikoma.env.safeAreaInsets)||void 0===t?void 0:t.bottom)>0?43:27;this.logoView=new T(0,this.vm.adInfo),this.logoView.style={position:"absolute",left:16,bottom:this.getHeight()+e},this.logoView.enabled=!1,this.appendChild(this.logoView)}getHeight(){return this.height+44}setupData(){let t=this.vm.getCouponModel();this.bannerTitle.setText(t.bannerTitle),this.couponTips.setText(t.couponTips),this.icon.setSrc(t.icon),this.title.setText(t.title),this.contentDesc.setText(t.contentDesc),this.actionBarDesc.setText(t.actionBarDesc)}setupActions(){const t=this;t.containerView.addEventListener("tap",(i=>{let n=new H;n.template_show_type=le;const a=c(i,t.containerView);t.vm.convert(1,2,a,e.CARD_ACTION_BAR_CLICK,n)})),t.actionBarContainer.addEventListener("tap",(i=>{let n=new H;n.template_show_type=le;const a=c(i,t.actionBarContainer);t.vm.convert(1,1,a,e.CARD_ACTION_BAR_CLICK,n)}))}addHighlightSpan(){let t=this.vm.getCouponModel();const e=t.title.search(t.highlightTitle);if(-1==e||t.highlightTitle.length<=0)return void this.title.setText(t.title);let i=new TKSpan;const n=new TKSpanItem;n.color="#FE3666",n.spanType="foregroundColor",n.start=e,n.end=e+t.highlightTitle.length,i.addSpan(n),this.title.setSpan(t.title,i)}}class ce extends A{constructor(t){super(t),this.cardDelayShowTime=5,this.extraDisplayInfos=this.vm.getAdTagList(),this.hasTags=this.extraDisplayInfos&&this.extraDisplayInfos.length>0;const e=1==this.vm.screenOrientation;this.style={width:f.isAndroid()?"100%":this.vm.containerLimit.width,flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",position:"absolute",paddingLeft:e?0:16,paddingRight:e?0:16,bottom:0},e?(this.cardHeight=82,this.setupHorizontal()):(this.cardHeight=136+(this.hasTags?16:0),this.setupVerticalStyle()),this.actionCover=new TKView,this.actionCover.style={position:"absolute",left:0,right:0,top:0,bottom:0},this.bottomBtnContainer.appendChild(this.actionCover),this.addActions()}setupVerticalStyle(){this.logoView=new T(1,this.vm.adInfo),this.logoView.style={marginBottom:10},this.appendChild(this.logoView),this.bottomContainer=new TKView,this.bottomContainer.style={backgroundColor:"#FFFFFF",height:this.cardHeight,width:"100%",paddingLeft:12,paddingRight:12,paddingTop:12,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16,borderRadius:12},this.appendChild(this.bottomContainer);const t=new TKView;t.style={flexDirection:"row",width:"100%",position:"relative"},this.bottomContainer.appendChild(t);const i=new TKView;if(i.style={height:58,paddingLeft:70,flexGrow:1,flexDirection:"column",justifyContent:"space-around"},t.appendChild(i),this.appIcon=new TKImage,this.appIcon.style={width:58,height:58,position:"absolute",top:0,left:0,borderRadius:12,marginRight:12,borderColor:"#EAEAEA",borderWidth:.5},this.appIcon.setSrc(this.vm.getAdIcon()),t.appendChild(this.appIcon),this.nameLabel=new TKText,this.nameLabel.style={fontSize:16,fontWeight:"medium",color:"#222222",textLineClamp:1,textOverflow:"ellipsis"},i.appendChild(this.nameLabel),this.nameLabel.setText(this.vm.getAdTitle()),this.descLabel=new TKText,this.descLabel.style={textLineClamp:1,fontSize:14,color:"#666666",textOverflow:"ellipsis"},B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)})),this.hasTags){const t=new TKView;t.style={flexDirection:"row",width:"100%",height:18,marginTop:6,position:"relative"},i.appendChild(t),this.tagView=new gt(this.extraDisplayInfos,0,18,2,10),t.appendChild(this.tagView),this.descLabel.style={marginTop:8,marginBottom:8},this.bottomContainer.appendChild(this.descLabel)}else i.appendChild(this.descLabel);this.bottomBtnContainer=new TKView,this.bottomBtnContainer.style={flexDirection:"column",justifyContent:"center",width:"100%",height:40,marginBottom:12,alignItems:"center"},this.bottomContainer.appendChild(this.bottomBtnContainer),this.actionBtn=new TKButton,this.actionBtn.style={fontSize:14,color:"#FFFFFF",backgroundColor:"#FE3666",borderRadius:22,height:40,width:"100%"},B(this.actionBtn,"text",this.vm.$attrsPath.actionText),this.bottomBtnContainer.appendChild(this.actionBtn)}setupHorizontal(){this.logoView=new T(1,this.vm.adInfo),this.logoView.style={marginBottom:10},this.appendChild(this.logoView),this.bottomContainer=new TKView,this.bottomContainer.style={backgroundColor:"#FFFFFF",height:this.cardHeight,width:"100%",paddingLeft:12,paddingRight:12,paddingTop:12,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start"},this.appendChild(this.bottomContainer);const t=new TKView;t.style={flexDirection:"row",width:"100%",justifyContent:"flex-start",alignItems:"flex-start"},this.bottomContainer.appendChild(t),this.appIcon=new TKImage,this.appIcon.style={width:58,height:58,top:0,left:0,borderRadius:12,marginRight:12,borderColor:"#EAEAEA",borderWidth:.5},this.appIcon.setSrc(this.vm.getAdIcon()),t.appendChild(this.appIcon);const i=new TKView;i.style={height:58,flexGrow:1,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",maxWidth:"70%"},t.appendChild(i);const n=new TKView;if(n.style={marginTop:2,maxWidth:"100%",height:24,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},i.appendChild(n),this.nameLabel=new TKText,this.nameLabel.style={fontSize:16,fontWeight:"medium",includeFontPadding:!1,color:"#222222",textLineClamp:1,textOverflow:"ellipsis"},n.appendChild(this.nameLabel),this.nameLabel.setText(this.vm.getAdTitle()),this.descLabel=new TKText,this.descLabel.style={marginBottom:2,textLineClamp:1,maxWidth:"100%",fontSize:14,color:"#666666",textOverflow:"ellipsis"},B(this.descLabel,"text",this.vm.$attrsPath.adInfo.adBaseInfo.adDescription),this.descLabel.addEventListener("tap",(t=>{this.convert(2,{x:0,y:0},e.CARD_ICON_COMMENT_CLICK)})),i.appendChild(this.descLabel),this.hasTags){const t=new TKView;t.style={flexDirection:"row",width:"100%",height:18,position:"relative"},n.appendChild(t),this.tagView=new gt(this.extraDisplayInfos,0,18,2,10),this.tagView.style={paddingLeft:12},t.appendChild(this.tagView)}this.bottomBtnContainer=new TKView,this.bottomBtnContainer.style={position:"absolute",flexDirection:"column",justifyContent:"center",width:88,height:"100%",alignItems:"center",right:16},t.appendChild(this.bottomBtnContainer),this.actionBtn=new TKButton,this.actionBtn.style={fontSize:14,color:"#FFFFFF",backgroundColor:"#FE3666",borderRadius:18,height:36,width:88},B(this.actionBtn,"text",this.vm.$attrsPath.actionText),this.bottomBtnContainer.appendChild(this.actionBtn)}addActions(){let t=new H;t.actionbar_card_type=9,this.appIcon&&this.appIcon.addEventListener("tap",(i=>{this.vm.convert(1,2,{x:0,y:0},e.CARD_ICON_CLICK,t)})),this.nameLabel.addEventListener("tap",(i=>{this.vm.convert(1,2,{x:0,y:0},e.CARD_ICON_NAME_CLICK,t)})),this.actionCover.addEventListener("tap",(i=>{this.vm.convert(1,1,{x:0,y:0},e.CARD_ACTION_BAR_CLICK,t)})),this.bottomContainer.addEventListener("tap",(i=>{this.vm.convert(1,2,{x:0,y:0},e.CARD_BLANK_AREA_CLICK,t)})),this.vm.supportSlideClick()&&(this.appIcon&&this.appIcon.addEventListener("swipe",(i=>{this.vm.convert(1,2,{x:0,y:0},e.CARD_SWIPE_CONVERT,t)})),this.nameLabel.addEventListener("swipe",(i=>{this.vm.convert(1,2,{x:0,y:0},e.CARD_SWIPE_CONVERT,t)})),this.actionCover.addEventListener("swipe",(i=>{this.vm.convert(1,1,{x:0,y:0},e.CARD_SWIPE_CONVERT,t)})),this.bottomContainer.addEventListener("swipe",(i=>{this.vm.convert(1,2,{x:0,y:0},e.CARD_SWIPE_CONVERT,t)})))}getHeight(){return this.cardHeight+16+10+16}}class pe extends St{constructor(){super(),this.videoBottomBar=null,this.videoBottomCouponBar=null,this.videoSideCard=null,this.isDefaultBottombar=!1,this.canShowCoupon=!1,this.vm=new Bt}setupViews(){var t,e;this.vm.getBottomBarStyle();let i=this.vm.containerLimit.height,n=this.vm.screenOrientation;this.vm.setStyleType(9);const a=t=>{pt.updateExceptedPosition({leftMargin:0,rightMargin:0,bottomMargin:0,height:t}),this.rootView.style={height:t},this.rootView.layout()},s=()=>{this.videoBottomBar.vm.reportEquityCardImpression(this.vm.getCouponModel().cardStyle)};0==n&&0!=this.vm.getCouponModel().cardStyle&&(this.canShowCoupon=!0);const o=()=>{this.canShowCoupon&&(setTimeout((()=>{this.videoBottomBar.addContainerTranslateYAction(this.bottombarPositionStart,this.bottombarPositionEnd,"bottomCardtranslate",350),this.videoBottomBar.addContainerAlphaAction(!1,"'bottomCardOpacity'",350),this.videoBottomBar.reportImpressionCallback=s}),1e3*this.vm.getCouponModel().delayTime+500),setTimeout((()=>{this.videoBottomCouponBar.addContainerAlphaAction(!0,"'bottomCouponCardOpacity'",500),this.videoBottomCouponBar.addContainerTranslateYAction(this.couponViewPositionStart,this.couponViewPositionEnd,"bottomCouponCardtranslate",500),this.videoBottomCouponBar.reportImpressionCallback=s}),1e3*this.vm.getCouponModel().delayTime+650))};this.rootView.style={position:"absolute",left:0,right:0,top:0,height:100};let r=q(this.vm.adInfo);if(this.canShowCoupon&&(this.vm.isAnimFinishCallback=o),2==function(t){try{return t.adMaterialInfo.materialFeature[0].featureType}catch(e){}return 0}(this.vm.adInfo))this.videoBottomBar=new ce(this.vm);else if(this.vm.isShortLive())this.videoBottomBar=new Mt(this.vm);else if(f.supportMinimumVersion("3.3.26","3.3.30")&&this.vm.isEcFollow()){switch(this.vm.getShortVideoFollowPlaycardStyle()){case 1:this.videoBottomBar=new zt(this.vm);break;case 2:0==n&&(this.videoBottomBar=new jt(this.vm));break;case 3:this.videoBottomBar=new Gt(this.vm);break;case 4:0==n&&(this.videoBottomBar=new Xt(this.vm))}}else 3==r?this.vm.isDiscountNewStyle()&&(this.videoBottomBar=new oe(this.vm)):this.vm.isECOrderAd()?this.videoBottomBar=new It(this.vm):this.vm.isClickReward()?this.videoBottomBar=new qt(this.vm):this.vm.isAdForLive()&&(f.supportMinimumVersion("3.3.19","3.3.26")&&!f.supportMinimumVersion("3.3.22","3.3.29")?this.videoBottomBar=new mt(this.vm):this.videoBottomBar=new Mt(this.vm));if(!this.videoBottomBar){switch(this.vm.getActionBarStyle()){case 1:this.videoBottomBar=new wt(this.vm);break;case 2:this.videoBottomBar=new ft(this.vm);break;case 3:this.videoBottomBar=new Ct(this.vm);break;case 4:this.videoBottomBar=new ut(this.vm);break;default:this.videoBottomBar=this.getDefaultBottomBar(),this.isDefaultBottombar=!0}}i=this.videoBottomBar.getHeight(),this.videoBottomBar.resizeCallback=a;const h={position:"absolute",left:0,right:0,bottom:0};h.height=i;const l=new TKView;l.style=h,l.appendChild(this.videoBottomBar),this.rootView.appendChild(l),this.videoBottomBar.resizeCallback=a;const c=(null===(t=Tachikoma.env.safeAreaInsets)||void 0===t?void 0:t.bottom)>0?74:44;let p=this.videoBottomBar.getHeight()+c>i?this.videoBottomBar.getHeight()+c:i;if(this.canShowCoupon){1==this.vm.getCouponModel().cardStyle?this.videoBottomCouponBar=new he(this.vm):this.videoBottomCouponBar=new de(this.vm),this.rootView.appendChild(this.videoBottomCouponBar);let t=this.videoBottomCouponBar.getHeight();p=t+c>i?t+c:i}if(a(p),At.log(241),this.canShowCoupon){const t=(null===(e=Tachikoma.env.safeAreaInsets)||void 0===e?void 0:e.bottom)>0?38:10,i=t+8;let n=this.isDefaultBottombar?-this.videoBottomBar.getHeight()+t:0;this.bottombarPositionStart=d()?0:p+n,this.bottombarPositionEnd=d()?8:p+n,this.couponViewPositionStart=d()?0:p-this.videoBottomCouponBar.getHeight()-20-i,this.couponViewPositionEnd=d()?-8:p-this.videoBottomCouponBar.getHeight()-20-i}S(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{"hideEnd"==t&&this.videoBottomBar&&this.videoBottomBar.stopActionAnimation(),"hideEnd"==t&&this.videoBottomCouponBar&&this.videoBottomCouponBar.stopActionAnimation()}))}getDefaultBottomBar(){return null}render(){if(this.renderCalled)return!1;this.renderCalled=!0;try{this.vm.getData((t=>{if(t)try{this.setupViews(),Tachikoma.render(this.rootView),this.updateRenderStatus(1,"")}catch(e){this.updateRenderStatus(0,h(e))}else this.updateRenderStatus(0,"data invalid")}))}catch(t){this.updateRenderStatus(0,h(t))}return!0}}class me extends pe{getDefaultBottomBar(){return new lt(this.vm)}}if(f.isAndroid()||-1!=f.compareVersion(Tachikoma.env.osVersion,"11")||-1!=f.compareVersion(Tachikoma.env.engineVersion,"0.5.36")){(new me).render()}else pt.pageStatus(0,"ios10")})();
//# sourceMappingURL=ksad-video-bottom-card-v2.129.js.map