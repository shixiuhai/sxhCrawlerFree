(()=>{"use strict";class t{static saveLocal(t,e){if("undefined"!=typeof TKLocalStorage&&bt.supportMinimumTKVersion("4.0.0"))try{(new TKLocalStorage).set(t,e)}catch(i){}}static getLocalString(t){if("undefined"!=typeof TKLocalStorage&&bt.supportMinimumTKVersion("4.0.0"))try{let e=(new TKLocalStorage).get(t);if(e)return e.toString()}catch(e){}return null}static getLocalInt(t){if("undefined"!=typeof TKLocalStorage&&bt.supportMinimumTKVersion("4.0.0"))try{let e=(new TKLocalStorage).get(t);if(e)return Number.parseInt(e.toString())}catch(e){}return 0}static getLocalBoolean(t){if("undefined"!=typeof TKLocalStorage&&bt.supportMinimumTKVersion("4.0.0"))try{let e=(new TKLocalStorage).get(t);if(e)return Boolean(e.toString)}catch(e){}return!1}}let e=null;const i="TKResIndexKey";class a{constructor(){var e,a,s;this.defaultHost="p1-lm.adukwai.com",this.currentIndex=0;let n=null===(s=null===(a=null===(e=it())||void 0===e?void 0:e.appConfig)||void 0===a?void 0:a.idc)||void 0===s?void 0:s.tkres;n&&0!=n.length||(n=["p1-lm.adukwai.com","p2-lm.adukwai.com"]),this.resList=n;let o=t.getLocalInt(i);o>n.length&&(o=0),this.currentIndex=o}static getInstance(){return e||(e=new a),e}getCurrentHost(){return this.currentIndex>=this.resList.length?this.defaultHost:this.resList[this.currentIndex]}markUrlFail(e){if(!(e.indexOf(this.getCurrentHost())<0||"undefined"!=typeof KSAdTKNetworkManager&&0==KSAdTKNetworkManager.getCurrentNetworkType())){const e=this.currentIndex;this.currentIndex=++this.currentIndex%this.resList.length,this.currentIndex!==e&&t.saveLocal(i,this.currentIndex)}}}var s,n;!function(t){t.START="start",t.CENTRT="center",t.END="end"}(s||(s={})),function(t){t[t.unknown=0]="unknown",t[t.DetailOne=1]="DetailOne",t[t.Simple=2]="Simple",t[t.DetailTwo=3]="DetailTwo"}(n||(n={}));var o,r,h;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.PRODUCT=1]="PRODUCT",t[t.EVENT=2]="EVENT",t[t.COUPON=3]="COUPON",t[t.PRODUCT_DEEP_VIDEO=4]="PRODUCT_DEEP_VIDEO"}(o||(o={}));class l{}!function(t){t[t.RETAIN_CARD_TYPE_1=8]="RETAIN_CARD_TYPE_1",t[t.RETAIN_CARD_TYPE_2=9]="RETAIN_CARD_TYPE_2",t[t.RETAIN_CARD_TYPE_3=10]="RETAIN_CARD_TYPE_3",t[t.RETAIN_CARD_TYPE_4=11]="RETAIN_CARD_TYPE_4",t[t.RETAIN_CARD_TYPE_5=14]="RETAIN_CARD_TYPE_5",t[t.RETAIN_CARD_TYPE_7=16]="RETAIN_CARD_TYPE_7",t[t.RETAIN_CARD_TYPE_8=17]="RETAIN_CARD_TYPE_8",t[t.RETAIN_CARD_TYPE_9=18]="RETAIN_CARD_TYPE_9",t[t.RETAIN_CARD_TYPE_10=19]="RETAIN_CARD_TYPE_10",t[t.RETAIN_CARD_TYPE_11=20]="RETAIN_CARD_TYPE_11"}(r||(r={}));class c{}!function(t){t[t.UNKNOWN_LIVE_ROOM_PATTERN=0]="UNKNOWN_LIVE_ROOM_PATTERN",t[t.STANDARD_LIVE_ROOM_PATTERN=1]="STANDARD_LIVE_ROOM_PATTERN",t[t.SIMPLIFIED_LIVE_ROOM_PATTERN=2]="SIMPLIFIED_LIVE_ROOM_PATTERN"}(h||(h={}));class d{}var p,m,u;!function(t){t[t.LIVE_CUT3_STYLE1=11]="LIVE_CUT3_STYLE1",t[t.LIVE_CUT3_STYLE2=12]="LIVE_CUT3_STYLE2"}(p||(p={})),function(t){t[t.LIVE_CUT3_STYLE2=1]="LIVE_CUT3_STYLE2"}(m||(m={})),function(t){t[t.unkonwn=0]="unkonwn",t[t.videoPromoteFollow=1]="videoPromoteFollow",t[t.videoPromoteGoods=2]="videoPromoteGoods",t[t.liveGoods=3]="liveGoods",t[t.liveNotGoods=4]="liveNotGoods",t[t.videoAd=5]="videoAd"}(u||(u={}));function g(t){try{const e=t.adMatrixInfo.adDataV2.styleComponentInfo;if(e&&e.styleComponentFlag)return!0}catch(e){}return!1}function w(t,e,i){if(console.log("tkloadcontroller target componentName:"+e+" slotId:"+i),mt(e)&&!ft(i))try{const a=t.adMatrixInfo.adDataV2.componentDatas.length;for(let s=0;s<a;s++){let a=t.adMatrixInfo.adDataV2.componentDatas[s];if(a.componentName==e&&a.slotId==i)return a}}catch(a){}}function f(t){try{if(t)return JSON.parse(t.data)}catch(e){}}class y{static isClickReward(t,e){try{let i=!0;if(bt.isAndroid()&&!ft(e)&&(i=e.sdkApiVersionCode>=3032401),t.adBaseInfo.extraClickReward&&i)return!0}catch(i){}return!1}static isEcOrder(t,e){try{return 1==t.abConfig.ecRewardAdKwaishopStyle&&(4==e.adStyleConfInfo.innerAdType||5==e.adStyleConfInfo.innerAdType)}catch(i){}return!1}static isOriginLiveAd(t){return 1==t.adBaseInfo.universeLiveType&&0!=t.advertiserInfo.userId}static getAuthorId(t){try{return t.advertiserInfo.userId||0}catch(e){return 0}}static getLiveStreamId(t){try{return t.adBaseInfo.liveStreamId||""}catch(e){return""}}static getLiveServiceToken(t){try{return t.adConversionInfo.liveServiceToken||""}catch(e){return""}}static getLiveUserId(t){try{return t.adConversionInfo.liveVisitorId||0}catch(e){return 0}}static getIconUrl(t){let e=t.adBaseInfo.appIconUrl;return!ft(e)&&y.isDownloadInteraction(t)||(e=t.advertiserInfo.portraitUrl),ft(e)&&(e="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),e}static isDownloadInteraction(t){return 1==t.adBaseInfo.adOperationType}static getAdTitle(t){let e=null;try{e=1==t.adBaseInfo.adOperationType?t.adBaseInfo.appName:t.adBaseInfo.productName,e=mt(e)?e:t.advertiserInfo.rawUserName}catch(i){}return e=mt(e)?e:"可爱的广告君",e}static getAdActionDesc(t){if(ft(t))return"查看详情";let e=t.adBaseInfo.adActionDescription;return ft(e)&&(e=this.isDownloadInteraction(t)?"立即下载":"查看详情"),e}static obtainVideoLiveData(t){let e=D(t,14);return JSON.parse(e.data)}static liveGetAuthorName(t,e){let i="";try{i=t.neoLiveAuthorInfoData.authorName}catch(a){}try{ft(i)&&(i=t.neoLiveCartDetailData.authorName)}catch(a){}try{ft(i)&&(i=e.adBaseInfo.appName)}catch(a){}return i}static liveGetLiveDesc(t,e){let i="";try{i=t.neoLiveCartDetailData.liveDesc}catch(a){}try{ft(i)&&(i=t.neoLiveAuthorInfoData.liveDesc)}catch(a){}try{ft(i)&&(i=t.adDescription)}catch(a){}try{ft(i)&&(i=e.adBaseInfo.adDescription)}catch(a){}return i}static getNeoActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.neoTKInfo.actionBarCardType;if(!ft(e))return e}catch(e){}return null}static getFullscreenActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.fullScreenInfo.actionBarCardType;if(!ft(e))return e}catch(e){}return null}static getNeoAutoDialogType(t){var e;if(g(t)){if(w(t,"reward-dialog-common",5))return 1;if(w(t,"reward-dialog-fund",5))return 2}else try{let i=0;if(y.isOriginLiveAd(t))i=null===(e=t.adMatrixInfo.adDataV2.videoLiveTKInfo)||void 0===e?void 0:e.neoAutoDialogType;else{let e=S(t);i=1==e?t.adMatrixInfo.adDataV2.neoTKInfo.neoAutoDialogType:2==e?t.adMatrixInfo.adDataV2.videoImageTKInfo.neoAutoDialogType:0}1!=i&&2!=i&&(i=0);let a=function(t){if(null==t)return null;try{let e=null;if(y.isOriginLiveAd(t))e=k(t,14);else{let i=S(t);2==i?e=k(t,16):1==i&&(e=k(t,12))}if(e){let i=K(e,t);return JSON.parse(i.data).neoAutoDialog}}catch(e){}return null}(t);return 1==i&&ft(a.neoAutoDialogGiftPic)&&ft(a.neoAutoDialogGiftTitle)&&(i=0),i}catch(i){}return 0}static hasNeoAutoDialog(t){let e=y.getNeoAutoDialogType(t);return!ft(e)&&0!=e}static newDeepVideoInteractCardInfo(t,e){if(ft(t)||ft(e))return null;let i;if(i=JSON.parse(JSON.stringify(Object.assign(t,e))),i.merchantStyleType=o.PRODUCT_DEEP_VIDEO,i.interactiveCardShowTime=0,i.rightsCardCustomImageUrl=t.icon,i.rightsCardCustomContent=t.name,i.rightsCardProductIconDesc="热卖",ft(t.rating))i.rightsCardProductTags=t.serviceInfoList;else{let e=[t.rating];i.rightsCardProductTags=e.concat(t.serviceInfoList)}return i}}function I(t,e){if(!(null==t?void 0:t.impAdInfo)||0==t.impAdInfo.length)return null;let i=null;if(e)for(let a=0;a<t.impAdInfo.length;++a){let s=t.impAdInfo[a];if(s.adInfo.length>0&&s.adInfo[0].adBaseInfo.creativeId==e){i=s;break}}return i||(i=t.impAdInfo[0]),i}function C(t){var e;return(null===(e=null==t?void 0:t.adInfo)||void 0===e?void 0:e.length)>0?t.adInfo[0]:null}function T(t){if(!(null==t?void 0:t.impAdInfo)||0==t.impAdInfo.length)return null;const e=t.impAdInfo[0];return(null==e?void 0:e.adInfo)&&0!=e.adInfo.length?e.adInfo[0]:null}function v(t){let e=null;try{1==t.adBaseInfo.adOperationType&&mt(t.adBaseInfo.appIconUrl)?e=t.adBaseInfo.appIconUrl:mt(t.advertiserInfo.portraitUrl)&&(e=t.advertiserInfo.portraitUrl)}catch(i){}return e||"https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"}function S(t){try{return t.adMaterialInfo.materialFeature[0].featureType}catch(e){}return 0}function b(t){try{return function(t){try{return!mt(t.firstFrame)||t.firstFrame.includes(".kpg")||t.firstFrame.includes(".webp")?mt(t.coverUrl)?t.coverUrl:t.coverUrl||t.materialUrl||"":t.firstFrame}catch(e){}return""}(t.adMaterialInfo.materialFeature[0])}catch(e){}return""}function A(t){try{return t.adMaterialInfo.materialFeature[0].materialUrl}catch(e){}return""}function V(t){try{return t.adMaterialInfo.materialFeature[0].videoDuration}catch(e){}return 0}function _(t){try{return 1==t.adBaseInfo.adOperationType}catch(e){}return!1}function L(t){let e=null;try{switch(t.adBaseInfo.adOperationType){case 1:e=t.adBaseInfo.appName;break;case 2:e=t.adBaseInfo.productName}mt(e)||(e=t.advertiserInfo.rawUserName)}catch(i){}return e||"可爱的广告君"}function x(t){try{return t.adStyleConfInfo.innerAdType}catch(e){}return 0}function k(t,e){let i;try{switch(e){case 1:i=t.adMatrixInfo.adDataV2.middleTKCardInfo.templateId;break;case 12:i=t.adMatrixInfo.adDataV2.neoTKInfo.templateId;break;case 3:i=t.adMatrixInfo.adDataV2.fullScreenInfo.templateId;break;case 2:i=t.adMatrixInfo.adDataV2.interstitialCardInfo.templateId;break;case 4:i=t.adMatrixInfo.adDataV2.topFloorTKInfo.templateId;break;case 6:case 9:i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId;break;case 5:i=t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.templateId;break;case 7:i=t.adMatrixInfo.adDataV2.activityMiddlePageInfo.templateId;break;case 10:i=t.adMatrixInfo.adDataV2.rewardVideoTaskInfo.templateId;break;case 11:i=t.adMatrixInfo.adDataV2.pushTKInfo.templateId;break;case 13:i=t.adMatrixInfo.adDataV2.splashEndCardTKInfo.templateId;break;case 14:i=t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId;break;case 15:i=t.adMatrixInfo.adDataV2.installedActivateInfo.templateId;break;case 16:i=t.adMatrixInfo.adDataV2.videoImageTKInfo.templateId;break;case 100:i=t.adMatrixInfo.adDataV2.complianceCardInfo.templateId;break;case 101:i=t.adMatrixInfo.adDataV2.downloadConfirmCardInfo.templateId;break;case 17:i=t.adMatrixInfo.adDataV2.feedTKCardInfo.templateId;break;default:i=void 0}}catch(a){i=void 0}return i}function D(t,e){let i=k(t,e);if(console.log("tkloadcontroller target templateid:"+i),!mt(i))return;const a=t.adMatrixInfo.adDataV2.templateDatas.length;for(let s=0;s<a;s++){let e=t.adMatrixInfo.adDataV2.templateDatas[s];if(e.templateId==i)return e}}function R(t,e){let i=k(t,e);if(!i)return null;console.log("tkloadcontroller   get template is:"+i);const a=t.adMatrixInfo.styles.templates.length;for(let s=0;s<a;s++){let e=t.adMatrixInfo.styles.templates[s];if((null==e?void 0:e.templateId)==i)return e}return null}function E(t){var e;try{return bt.isAndroid()&&1==t.adBaseInfo.adOperationType&&(null===(e=t.downloadSafeInfo.complianceInfo)||void 0===e?void 0:e.titleBarTextSwitch)>0}catch(i){}return!1}function B(t,e){let i=!0;if(1==t.adBaseInfo.adOperationType)try{let a=t.downloadSafeInfo.complianceInfo;if(console.log("tkloadcontroller   download ad:"+JSON.stringify(a)),null!=a)switch(e){case 1:i=3!=a.actionBarType;break;case 2:i=3!=a.describeBarType;break;case 3:i=3!=a.materialJumpType;break;default:i=!0}}catch(a){i=!0}else try{let a=t.unDownloadConf.unDownloadRegionConf;if(console.log("tkloadcontroller   h5 ad:"+JSON.stringify(a)+", clickArea: "+e),null!=a)switch(e){case 1:i=1!=a.actionBarType;break;case 2:i=1!=a.describeBarType;break;case 3:i=1!=a.materialJumpType;break;default:i=!0}console.log("tkloadcontroller   h5 ad:"+i)}catch(a){i=!0}return i}function P(t){return y.isOriginLiveAd(t)||function(t){return 7==x(t)}(t)}function K(t,e){try{let i=e.adMatrixInfo.adDataV2.templateDatas;for(let e=0;e<i.length;e++){let a=i[e];if(a&&t==a.templateId)return a}}catch(i){}}function N(t,e){let i=null,a=U(t,e);return a&&(i=function(t,e){let i=D(t,e);if(null==i)return;return JSON.parse(i.data).redPacketInfo}(t,a)),i}function F(t,e){let i=null,a=U(t,e);return a&&(i=function(t,e){let i=D(t,e);if(null==i)return;return JSON.parse(i.data).merchantCardInfo}(t,a)),i}function M(t){let e=!1;try{e=t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.showEndPage}catch(i){}return e}function H(t){let e=!1;try{e=1==t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.renderType&&(bt.supportCurrentTKVersion("5.0.5.1")||bt.supportMinimumTKVersion("5.0.8"))}catch(i){}return e}function O(t,e){let i=D(t,e);if(null==i)return;let a=JSON.parse(i.data),s=null;try{s=a.widgetInfo}catch(n){}return s}function W(t,e){let i=null,a=U(t,e);return a&&(i=function(t,e){let i=D(t,e);if(null==i)return;return JSON.parse(i.data).giftBoxInfo}(t,a)),i}function U(t,e){let i=null;try{if(function(t){let e=!1;try{e=1==t.adMatrixInfo.adDataV2.videoImageTKInfo.renderType}catch(i){}return e}(t))return 16;if(function(t){let e=!1;try{e=!ft(t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId)}catch(i){}return e}(t))return 14;2==e?i=function(t){let e=!1;try{e=1==t.adMatrixInfo.adDataV2.neoTKInfo.renderType}catch(i){}return e}(t)?12:4:3==e?i=function(t){let e=!1;try{e=1==t.adMatrixInfo.adDataV2.fullScreenInfo.renderType}catch(i){}return e}(t)?3:4:13==e?i=2:4==e&&(i=5)}catch(a){}return i}function z(t){if(bt.isAndroid()){try{return t.shakeInfo.acceleration}catch(e){}return 12}{const i=[.35,.5,.65,.8,1,1.5,2];let a=5;try{a=t.shakeInfo.acceleration-1}catch(e){}return a<=0?a=5:a>=i.length&&(a=i.length-1),i[a]}}function Y(t){try{return t.bidirectionalSwitch}catch(e){}return!1}function G(t){return!(!t.downloadSafeInfo||!bt.isSupportDownloadDel())&&t.downloadSafeInfo.downloadDeleteEnable}function X(t){return!!(_(t)&&t.downloadSafeInfo&&bt.isSupportDownloadDel())&&t.downloadSafeInfo.downloadShowPauseEnable}var j=null,$=null,J=null,Z=null,q=null;function Q(t){console.log("tkloadcontroller  save global device info:"+JSON.stringify(t)),j=t}function tt(){return q}function et(){return j}function it(){return $}function at(){return Z}function st(){const t=Tachikoma.env.styleTemplate;return t?JSON.parse(t):null}function nt(t,e){e=e||st(),t=t||T(at());const i=null==e?void 0:e.templateId,a=null==e?void 0:e.templateVersionCode,s=null==t?void 0:t.adTKGrayConfig,n=i+"#"+a;return(null==s?void 0:s.get(n))||0}function ot(){return Date.parse((new Date).toString())}function rt(t){return t instanceof Error?t.message+":"+t.stack:"string"==typeof t?t:"number"==typeof t?t+"":"unknown"}function ht(){var t;return!dt()&&(null===(t=Tachikoma.env.safeAreaInsets)||void 0===t?void 0:t.bottom)>0}function lt(){return dt()?{left:0,top:0,bottom:0,right:0}:Tachikoma.env.safeAreaInsets}function ct(){return!ft(Tachikoma.env.hasTKBridge)&&1==Tachikoma.env.hasTKBridge}function dt(){return"Android"===Tachikoma.env.platform}function pt(t,e){let i={x:0,y:0};if(bt.supportMinimumTKVersion("4.0.0")){const a=e.getLocationOnScreen(),s=t.position;if(!a||!s)return i;s.x=parseFloat((s.x+"").replace("dp","")),s.y=parseFloat((s.y+"").replace("dp","")),i={x:a.x+s.x,y:a.y+s.y}}return i}function mt(t){return"string"==typeof t&&t.length>0}function ut(){return j?j.tkVersion:Tachikoma.env.tkVersion||Tachikoma.env.TKVersion}function gt(){return j?j.SDKVersion:Tachikoma.env.SDKVersion}function wt(){return j?j.sdkType:Tachikoma.env.sdkType}function ft(t){return null===t||null==t||""===t}new class{};class yt{constructor(t,e,i){this.name=t,this.object=e,this.parent=i,this.children=new Map}addChildren(t,e){this.children.set(t,e)}}function It(t,e,i){if(t){e||(e=new yt("root",t)),i||(i=new Set),i.add(t);for(const a in t){const s=typeof t[a],n=t[a];if("object"==s&&!a.includes("$")&&n){n.nativeID||(n.nativeID=a);const t=new yt(a,n,e);if(e.addChildren(a,t),i.has(n)){const e=[];e.push(t);let i=t,a=!1;for(;i.parent;)if(i=i.parent,e.push(i),i.object===t.object){a=!0;break}if(a){let t="执行出错：发生循环引用\n";for(let a=e.length-1;a>=0;--a)i=e[a],t+=i.name+":"+i.object+"\n";throw new Error(t)}}It(n,t,i)}}}}function Ct(){return 1==Tachikoma.env.isDebug}function Tt(t){let e=t;return e.indexOf("/")>=0||t.startsWith("http")||(e="https://"+a.getInstance().getCurrentHost()+"/kos/nlav111362/ksad/"+t),e}function vt(t,e){!function(t,e,i){if(t&&e){const s=Tt(e);t.setImageLoadCallback&&!ft(s)&&s.startsWith("http")&&t.setImageLoadCallback((t=>{a.getInstance().markUrlFail(s),i&&i(t)})),t.setSrc(s)}}(t,e,null)}function St(t,e,i,s){let n=0;if(setTimeout((()=>{0==n&&(n=-1,s(!1))}),i),t&&e){const i=Tt(e);t.setImageLoadCallback&&!ft(i)&&i.startsWith("http")&&t.setImageLoadCallback((t=>{a.getInstance().markUrlFail(i),s&&0==n&&(n=1,s(t))})),t.setSrc(i)}}class bt{static isAndroid(){return"Android"===this.platform}static isSupportDownloadProgressListen(){return this.isAndroid()||bt.supportMinimumTKVersion("5.0.4")}static isSupportDownloadDel(){return this.isAndroid()&&bt.supportMinimumTKVersion("5.0.7")}static getCurrentTimeStamp(){return(new Date).getTime()}static getSemiCircle(){return this.isAndroid()?180:Math.PI}static getRotateSemiCircle(){return this.isAndroid()?45:Math.PI}static compareVersion(t,e){if(void 0===t&&void 0===e)return 0;if(void 0===t)return-1;if(void 0===e)return 1;let i=t.split("."),a=e.split("."),s=Math.max(i.length,a.length);for(var n=0;n<s;n++){let t=Number(void 0!==i[n]?i[n]:"0"),e=Number(void 0!==a[n]?a[n]:"0");if(t>e)return 1;if(t!=e)return-1}return 0}static supportMinimumVersion(t="0.0.0",e="0.0.0"){let i=wt(),a=1==i&&-1!=bt.compareVersion(gt(),t),s=2==i&&-1!=bt.compareVersion(gt(),e);return a||s}static supportCurrentVersion(t="0.0.0",e="0.0.0"){let i=wt(),a=1==i&&0==bt.compareVersion(gt(),t),s=2==i&&0==bt.compareVersion(gt(),e);return a||s}static supportCurrentTKVersion(t="0.0.0"){return ut()==t}static supportMinimumTKVersion(t="0.0.0"){return-1!=bt.compareVersion(ut(),t)}}bt.platform=Tachikoma.env.platform;Tt("h5_default_icon.png"),Tt("download_default_icon.png");var At,Vt,_t,Lt;!function(t){t[t.NONE=-1]="NONE",t[t.ACTION_BAR_CLICK=1]="ACTION_BAR_CLICK",t[t.UNKNOWN_ITEM_CLICK=0]="UNKNOWN_ITEM_CLICK",t[t.PORTRAIT_CLICK=13]="PORTRAIT_CLICK",t[t.COMMENT_CLICK=14]="COMMENT_CLICK",t[t.PLAY_END_ICON_CLICK=15]="PLAY_END_ICON_CLICK",t[t.PLAY_END_ICON_TITLE_CLICK=16]="PLAY_END_ICON_TITLE_CLICK",t[t.PLAY_END_ICON_DESCRIPTION_CLICK=17]="PLAY_END_ICON_DESCRIPTION_CLICK",t[t.COMMENT_DETAIL_CLICK=25]="COMMENT_DETAIL_CLICK",t[t.PLAY_END_ACTION_BAR_CLICK=26]="PLAY_END_ACTION_BAR_CLICK",t[t.CARD_ACTION_BAR_CLICK=29]="CARD_ACTION_BAR_CLICK",t[t.CARD_ICON_CLICK=30]="CARD_ICON_CLICK",t[t.CARD_ICON_NAME_CLICK=31]="CARD_ICON_NAME_CLICK",t[t.CARD_ICON_COMMENT_CLICK=32]="CARD_ICON_COMMENT_CLICK",t[t.CARD_BLANK_AREA_CLICK=35]="CARD_BLANK_AREA_CLICK",t[t.CARD_PLAY_END_CLICK1=37]="CARD_PLAY_END_CLICK1",t[t.CARD_PLAY_END_CLICK2=38]="CARD_PLAY_END_CLICK2",t[t.PLAY_END_CALL_CLICK=39]="PLAY_END_CALL_CLICK",t[t.PLAY_DETAIL_CALL_CLICK=40]="PLAY_DETAIL_CALL_CLICK",t[t.PLAY_END_GIFT_CLICK=41]="PLAY_END_GIFT_CLICK",t[t.CARD_APP_STORE_CLICK=45]="CARD_APP_STORE_CLICK",t[t.CARD_APP_DOWNLOAD_NUM_CLICK=46]="CARD_APP_DOWNLOAD_NUM_CLICK",t[t.CARD_OTHERAREA_CLICK=53]="CARD_OTHERAREA_CLICK",t[t.CARD_ICON_MOBILE_CLICK=54]="CARD_ICON_MOBILE_CLICK",t[t.CARD_PICTURE_CLICK_ONE=57]="CARD_PICTURE_CLICK_ONE",t[t.CARD_PICTURE_CLICK_TWO=58]="CARD_PICTURE_CLICK_TWO",t[t.CARD_PICTURE_CLICK_THREE=59]="CARD_PICTURE_CLICK_THREE",t[t.CARD_PICTURE_TITLE_CLICK_ONE=60]="CARD_PICTURE_TITLE_CLICK_ONE",t[t.CARD_PICTURE_TITLE_CLICK_TWO=61]="CARD_PICTURE_TITLE_CLICK_TWO",t[t.CARD_PICTURE_TITLE_CLICK_THREE=62]="CARD_PICTURE_TITLE_CLICK_THREE",t[t.CARD_PICTURE_SUBTITLE_CLICK_ONE=63]="CARD_PICTURE_SUBTITLE_CLICK_ONE",t[t.CARD_PICTURE_SUBTITLE_CLICK_TWO=64]="CARD_PICTURE_SUBTITLE_CLICK_TWO",t[t.CARD_PICTURE_SUBTITLE_CLICK_THREE=65]="CARD_PICTURE_SUBTITLE_CLICK_THREE",t[t.CARD_RANK_CLICK=75]="CARD_RANK_CLICK",t[t.CARD_DOWNLOAD_CNT_CLICK=76]="CARD_DOWNLOAD_CNT_CLICK",t[t.CARD_TAG_CLICK=77]="CARD_TAG_CLICK",t[t.CARD_ITEM_BULLET_CLICK=80]="CARD_ITEM_BULLET_CLICK",t[t.CARD_RECOMMEND_REASON_CLICK=84]="CARD_RECOMMEND_REASON_CLICK",t[t.CARD_PAGE_CLICK=85]="CARD_PAGE_CLICK",t[t.COMMON_CARD_CLICK=89]="COMMON_CARD_CLICK",t[t.COMMENT_PICTURE_CLICK=100]="COMMENT_PICTURE_CLICK",t[t.PLAYEND_ICON_OTHERAREA_CLICK=104]="PLAYEND_ICON_OTHERAREA_CLICK",t[t.INTERACT_LANDING_PAGE_CLICK=110]="INTERACT_LANDING_PAGE_CLICK",t[t.ACTIONBAR_ICON_CLICK=115]="ACTIONBAR_ICON_CLICK",t[t.ACTIONBAR_ICON_COMMENT_CLICK=117]="ACTIONBAR_ICON_COMMENT_CLICK",t[t.ACTIONBAR_ICON_OTHER_AREA_CLICK=118]="ACTIONBAR_ICON_OTHER_AREA_CLICK",t[t.CLOSE_BULLET_ICON_CLICK=127]="CLOSE_BULLET_ICON_CLICK",t[t.CLOSE_BULLET_ICON_TITLE_CLICK=128]="CLOSE_BULLET_ICON_TITLE_CLICK",t[t.CLOSE_BULLET_ICON_DESCRIPTION_CLICK=129]="CLOSE_BULLET_ICON_DESCRIPTION_CLICK",t[t.CLOSE_BULLET_OTHERAREA_CLICK=130]="CLOSE_BULLET_OTHERAREA_CLICK",t[t.CLOSE_BULLET_ACTION_BAR_CLICK=131]="CLOSE_BULLET_ACTION_BAR_CLICK",t[t.SPLASH_CONVERSION_BUTTON_CLICK=132]="SPLASH_CONVERSION_BUTTON_CLICK",t[t.NEO_AUTO_SHOW_STOREKIT=147]="NEO_AUTO_SHOW_STOREKIT",t[t.CARD_LEFT_ACTION_BAR_CLICK=150]="CARD_LEFT_ACTION_BAR_CLICK",t[t.CARD_SWIPE_CONVERT=153]="CARD_SWIPE_CONVERT",t[t.ONLINE_AUDIENCE_NUM=154]="ONLINE_AUDIENCE_NUM",t[t.SHAKE_ICON_SHACK=157]="SHAKE_ICON_SHACK",t[t.SHAKE_BIG_ICON_CLICK=158]="SHAKE_BIG_ICON_CLICK",t[t.ROTATE_ICON_ROTATE=161]="ROTATE_ICON_ROTATE",t[t.ROTATE_BIG_ICON_CLICK=162]="ROTATE_BIG_ICON_CLICK",t[t.CARD_TROLLEY_ICON_CLICK=164]="CARD_TROLLEY_ICON_CLICK",t[t.LANDING_PAGE_OTHER_AREA_CLICK=171]="LANDING_PAGE_OTHER_AREA_CLICK",t[t.CARD_FOLLOW_NUM=172]="CARD_FOLLOW_NUM",t[t.FALL_ICON_CLICK=173]="FALL_ICON_CLICK",t[t.LIVE_BUTTON_CLICK=175]="LIVE_BUTTON_CLICK",t[t.DIRECT_H5_PAGE_CLICK=177]="DIRECT_H5_PAGE_CLICK",t[t.GOODS_ITEM_CARD_CLICK=178]="GOODS_ITEM_CARD_CLICK",t[t.GOODS_ITEM_CARD_SLIDE_CLICK=179]="GOODS_ITEM_CARD_SLIDE_CLICK",t[t.ITEM_HOT_BUY_STYLE_CLICK=180]="ITEM_HOT_BUY_STYLE_CLICK",t[t.GUIDE_ENTER_LIVE_CLICK=181]="GUIDE_ENTER_LIVE_CLICK",t[t.AUTO_CLICK_OTHER_AREA=182]="AUTO_CLICK_OTHER_AREA",t[t.POPLAY_FALL_IOCN=186]="POPLAY_FALL_IOCN",t[t.ROTATE_SHAKE_BIG_ICON_CLICK=187]="ROTATE_SHAKE_BIG_ICON_CLICK",t[t.RETAIN_AGG_CARD_CLICK=189]="RETAIN_AGG_CARD_CLICK",t[t.PLAYEND_AGG_CARD_CLICK=190]="PLAYEND_AGG_CARD_CLICK",t[t.SURPRISE_BOX_CLICK=191]="SURPRISE_BOX_CLICK",t[t.BUBBLE_RAIN_CLICK=192]="BUBBLE_RAIN_CLICK"}(At||(At={})),function(t){t[t.adClickReward=1]="adClickReward"}(Vt||(Vt={})),function(t){t[t.isRewarded=1]="isRewarded",t[t.noExtraReward=2]="noExtraReward",t[t.hasWatchReward=3]="hasWatchReward"}(_t||(_t={})),function(t){t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical"}(Lt||(Lt={}));const xt="ad_convert_event";var kt,Dt;!function(t){t[t.THREEIMG_DEFAULT_CLICK=0]="THREEIMG_DEFAULT_CLICK",t[t.THREEIMG_FIRST_CLICK=1]="THREEIMG_FIRST_CLICK",t[t.THREEIMG_SECOND_CLICK=2]="THREEIMG_SECOND_CLICK",t[t.THREEIMG_THIRD_CLICK=3]="THREEIMG_THIRD_CLICK"}(kt||(kt={})),function(t){t[t.picStyle=1]="picStyle",t[t.textStyle=2]="textStyle"}(Dt||(Dt={}));const Rt=new class{constructor(){this.enabled=!1,this.logs=[]}setLoggerEnabled(t){this.enabled=t}log(t){if(this.enabled){const e=new Date;0==this.logs.length&&this.logs.push(e.getMonth()+1+":"+e.getDate()+"-"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.logs.push(e.getMilliseconds()+":"+t),Ct()&&console.log("tkloadcontroller:"+t)}}clear(){this.logs.splice(0,this.logs.length)}exportLog(){return JSON.stringify(this.logs)}};class Et{static randomString(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i="",a=0;a<t;a++)i+=e.charAt(Math.floor(48*Math.random()));return i}static randomName(t){return"jscb_"+t+"_"+this.randomString(4)+this.globalIndex++}static registerCallback(t,e=!0){return this.registerCallbackForAction(t,e,"")}static registerCallbackForAction(t,e=!0,i){if(!t)return null;const a=this.randomName(i);return Tachikoma[a]=e=>{t(e)},"Tachikoma."+a}}Et.globalIndex=0;class Bt{static getDeviceInfoAsync(){return Bt.callNative("getDeviceInfo",null).then((t=>(t.result&&t.data&&Q(t.data),t)))}static getKsAdDataAsync(){return Bt.callNative("getKsAdData",null).then((t=>{var e;return t.result&&t.data&&(e=t.data,Z=e),t}))}static getKsAdConfigAsync(){return Bt.callNative("getKsAdConfig",null).then((t=>{var e;return t.result&&t.data&&(e=t.data,$=e),t}))}static getScreenOrientationAsync(){return Bt.callNative("getScreenOrientation",null)}static getVideoCloseTime(){return Bt.callNative("getVideoCloseTime",null)}static getContainerLimitAsync(){return Bt.callNative("getContainerLimit",null)}static getTKPreEnvAsync(){return Bt.callNative("getTKPreEnv",null)}static getDeviceInfo(t){this.callNativeWithCallback("getDeviceInfo",null,t)}static getKsAdData(t){this.callNativeWithCallback("getKsAdData",null,t)}static getKsAdConfig(t){this.callNativeWithCallback("getKsAdConfig",null,t)}static getScreenOrientation(t){this.callNativeWithCallback("getScreenOrientation",null,t)}static getContainerLimit(t){return this.callNativeWithCallback("getContainerLimit",null,t)}static registerLifecycleListener(t){this.lifeStatusCallback=t,this.callNativeWithCallback("registerLifecycleListener",null,(t=>{this.lifeStatusCallback&&!this.isForceUpdateLifeStatus&&this.lifeStatusCallback(t)}),!1)}static forceUpdateLifeStatus(t,e){let i={result:1,data:{lifeStatus:t}};this.isForceUpdateLifeStatus=e,this.lifeStatusCallback&&this.lifeStatusCallback(i)}static registerFocusListener(t){bt.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("registerFocusListener",null,t,!1)}static registerNativeId(t){this.callNativeWithCallback("configNativeId",null,t,!1)}static registerExtraDataListener(t){this.callNativeWithCallback("getKsAdExtraData",null,t,!1)}static hideCard(t,e,i,a=!0){this.callNativeWithCallback("hide",{type:t,playDuration:e},i,a)}static sendLog(t,e){this.callNativeWithCallback("log",t,e)}static sendCommonLog(t,e){this.callNativeWithCallback("commonLog",t,e)}static sendCommercialLog(t,e){this.callNativeWithCallback("commercialLog",t,e)}static adOutCallback(t,e){bt.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("adOutCallback",t,e)}static pageStatus(t,e){this.callNativeWithCallback("pageStatus",{status:t,errorMsg:mt(e)?e:""})}static clickActionBase(t,e){this.callNativeWithCallback("clickAction",t,e)}static convert(t){this.callNativeWithCallback("convert",{clickActionButton:t})}static updateExceptedPosition(t){this.callNativeWithCallback("initKsAdFrame",t)}static replayVideo(){this.callNativeWithCallback("replayVideo")}static registerVideoListener(t){this.callNativeWithCallback("registerVideoListener",null,t,!1)}static dislike(){this.callNativeWithCallback("dislike")}static registerProgressListener(t){this.callNativeWithCallback("registerProgressListener",null,(e=>{t&&t(e)}),!1)}static registerVideoProgressListener(t){this.callNativeWithCallback("registerVideoProgressListener",null,t,!1)}static registerGetDynamicActionDesListener(t){this.callNativeWithCallback("getDynamicActionDes",null,t,!1)}static registerTimerListener(t){this.callNativeWithCallback("registerTimerListener",null,t,!1)}static registerVideoMuteStateListener(t){this.callNativeWithCallback("registerMuteStateListener",null,t,!1)}static registerVideoAutoPlayListener(t){this.callNativeWithCallback("registerVideoAutoPlayListener",null,t,!1)}static registerPlayStateResetListener(t){this.callNativeWithCallback("registerPlayStateResetListener",null,t,!1)}static updateVideoMuteState(t){this.callNativeWithCallback("updateVideoMuteState",{muted:t})}static skipVideo(t,e,i,a=0){this.callNativeWithCallback("skipVideo",{needPromopt:t,needReport:e,showTime:i,playDuration:a})}static closeVideo(t){this.callNativeWithCallback("closeVideo",{forceClose:t})}static showPlayEnd(t,e=0){this.callNativeWithCallback("showPlayEnd",{userForce:t,type:e})}static showPlayable(t=0){this.callNativeWithCallback("showPlayable",{playableSource:t})}static registerSceneChangeListener(t){this.callNativeWithCallback("registerSceneChangeListener",null,t,!1)}static hasReward(t){this.callNativeWithCallback("hasReward",{severCheckResult:t})}static clickGift(){this.callNativeWithCallback("clickGift")}static clickCall(t){this.callNativeWithCallback("clickCall",{isEnd:t})}static callButtonImpressionWhenPlay(){this.callNativeWithCallback("callButtonImpressionWhenPlay")}static callButtonImpressionWhenFinish(){this.callNativeWithCallback("callButtonImpressionWhenFinish")}static registerDeepRewardListener(t){this.callNativeWithCallback("registerDeepRewardListener",null,t,!1)}static giveRewardInAdvance(t){this.callNativeWithCallback("giveRewardInAdvance",null,t,!1)}static showLiveEndPage(t){this.callNativeWithCallback("showLiveEndPage",null,t,!1)}static updateRewardTaskState(t){this.callNativeWithCallback("updateRewardTaskState",null,t,!1)}static openURL(t,e,i){this.callNativeWithCallback("openURL",{url:t,title:e,showConfirmDialog:i})}static showTKDialog(t){this.callNativeWithCallback("showTKDialog",{templateId:t})}static closeTKDialog(t){this.callNativeWithCallback("closeTKDialog",{templateId:t})}static registerKeyboardChangeListener(t){this.callNativeWithCallback("registerKeyboardChangeListener",null,t,!1)}static registerShakeListener(t){this.callNativeWithCallback("registerMotionListener",null,t,!1)}static close(t){this.callNativeWithCallback("close",null,t,!1)}static closePassData(t,e){this.callNativeWithCallback("close",t,e,!1)}static registerConvertStatusListener(t){this.callNativeWithCallback("registerConvertStatusListener",null,t,!1)}static cardImpression(){this.callNativeWithCallback("cardImpression")}static getCardShowCount(t){this.callNativeWithCallback("getCardShowCount",null,t,!1)}static getNativeData(t,e){this.callNativeWithCallback("getNativeData",{target:t},e,!1)}static updateExtraReward(t){this.callNativeWithCallback("updateExtraReward",t)}static registerApkInstalledListener(t){this.callNativeWithCallback("registerApkInstalledListener",null,t,!1)}static showToast(t){this.callNativeWithCallback("showToast",{message:t})}static registerExtraDialogListener(t){this.callNativeWithCallback("registerExtraDialogListener",null,t,!1)}static getPlayEndType(t){this.callNativeWithCallback("getPlayEndType",null,t,!1)}static playableConvert(t){this.callNativeWithCallback("playableConvert",t)}static getKsPlayableAdData(t){this.callNativeWithCallback("getKsPlayableAdData",null,t)}static getKsPlayableDeviceInfo(t){this.callNativeWithCallback("getKsPlayableDeviceInfo",null,t)}static registerPlayableStatusListener(t){this.callNativeWithCallback("registerPlayableStatusListener",null,t,!1)}static getTrackAdStatus(t){this.callNativeWithCallback("getTrackAdStatus",null,t,!1)}static showLandingPage(t){this.callNative("showLandingPage",{needCloseNeo:t})}static needCloseNeo(t){this.callNativeWithCallback("needCloseNeo",{needClose:t})}static registerBackPressed(t){dt()&&this.callNativeWithCallback("registerBackPressedListener",null,t,!1)}static innerAdImpression(){this.callNativeWithCallback("adImpression",null)}static neoDidShowPlayAgain(){this.callNativeWithCallback("neoDidShowPlayAgain")}static showPlayAgain(){this.callNativeWithCallback("showPlayAgain")}static registerAggregationDataListener(t){this.callNativeWithCallback("registerAggregationDataListener",null,t,!1)}static getLandingPageInfo(t){this.callNativeWithCallback("getLandingPageInfo",null,t,!1)}static registerNeoStatusListener(t){this.callNativeWithCallback("registerNeoStatusListener",null,t,!1)}static callNative(t,e){return new Promise(((i,a)=>this.callNativeWithCallback(t,e,(t=>{t?(1!=t.result&&(t.result=null),i(t)):i({result:0,data:null})}))))}static callNativeWithCallback(t,e,i,a=!0){const s=ct()?1:0;ct()&&"pageStatus"==t||ct()&&"registerLifecycleListener"==t?this.callNativeWithCallbackAndType(t,e,i,a,0):this.callNativeWithCallbackAndType(t,e,i,a,s)}static callTKWithCallback(t,e,i,a=!0){this.callNativeWithCallbackAndType(t,e,i,a,1)}static callNativeWithCallbackAndType(t,e,i,a=!0,s=0){if("undefined"==typeof KwaiAd)return Rt.log("undefined value KwaiAd"),void(i&&i({result:0,data:null}));Rt.log("call:"+t);let n=e=>{let a=0,s=null;try{let t=null;t="string"==typeof e?JSON.parse(e):e,a=t.result,s=t.data}catch(n){a=0,s=null}Rt.log("cb:"+t+"  r:"+a),i&&i({result:a,data:s})};const o=Et.registerCallbackForAction(n,a,t),r={action:t,data:JSON.stringify(e||{}),callback:!0===Tachikoma.env.useNewBridge?n:o};0==s?KwaiAd.callAdBridge(r):KwaiAd.callTKBridge(r)}}function Pt(t,e,i){Bt.callNativeWithCallback("splashShowStatus",{status:t,errorCode:e,errorMsg:i})}let Kt;function Nt(){var t;return Kt||(Kt={all:t=t||new Map,on(e,i){const a=t.get(e);a?a.push(i):t.set(e,[i])},off(e,i){const a=t.get(e);a&&(i?a.splice(a.indexOf(i)>>>0,1):t.set(e,[]))},emit(e,i){let a=t.get(e);a&&a.slice().map((t=>{t(i)})),a=t.get("*"),a&&a.slice().map((t=>{t(e,i)}))},clear(){t.clear()}}),Kt}class Ft{constructor(t,e,i,a,s,n,o){this.soundEnable=!1,this.ignoreCompliance=!1,this.disableDownloadDialog=!1,this.disableLeaveConfirm=!1,this.disableVideoWebPage=!1,this.disableActivityMiddlePage=!1,this.originAdInfo=t,this.deviceInfo=e,this.serverConfig=i,this.creativeId=n;let r=I(this.originAdInfo,n);this.adInfo=C(r),this.adCacheId=o||Tachikoma.env.adCacheId,this.originAdInfo.adCacheId=this.adCacheId,this.appId=s||Tachikoma.env.appId,this.scene=a,a||(Tachikoma.env.adScene?this.scene=JSON.parse(Tachikoma.env.adScene):this.scene={adStyle:r.adStyle,backUrl:""})}getCommercialLogInfo(){const t=new Mt;t.creativeId=this.creativeId,t.llsid=this.originAdInfo.llsid,t.posId=this.originAdInfo.impAdInfo[0].posId;const e=this.adInfo.adConversionInfo.h5SecondConfirmationSwitch;return t.landingPageType=e?0:1,this.sourceTemplate&&(t.templateId=this.sourceTemplate.templateId,t.templateVersion=this.sourceTemplate.templateVersionCode,t.tkPublishType=nt(this.adInfo,this.sourceTemplate)),t}getOcpcActionType(){try{return this.adInfo.ocpcActionType}catch(t){return 0}}getCampaignType(){try{return this.adInfo.adBaseInfo.campaignType}catch(t){return 0}}getIndustryFirstLevelId(){try{return this.adInfo.adBaseInfo.industryFirstLevelId}catch(t){return 0}}getAdOperationType(){try{return this.adInfo.adBaseInfo.adOperationType}catch(t){return 0}}}class Mt{}class Ht{constructor(){this.reward_type=-1,this.task_type=-1,this.task_step=-1}static createPageShowInstance(t,e,i){if(0==e||ft(i))return null;if(i.loadDataTime<=0||i.downloadFinishTime<=0)return null;let a=this.INVALID_VALUE;if(e!=this.INVALID_VALUE){a=Date.parse((new Date).toString())-e,a<this.INVALID_VALUE&&(a=this.INVALID_VALUE)}let s=new Ht;return s.page_status=2,s.load_type=i.loadFromCache?2:1,s.render_duration_ms=a,s.download_type=i.downloadType,s.download_size=i.downloadSize,s.creative_id=t.adBaseInfo.creativeId,s.video_url=A(t),s.video_duration_ms=V(t),s}}function Ot(t){Yt({category:"ad_client_apm_log",biz:"AD_SPLASH",sub_biz:"OTHER",rate:1,suffixRatio:"",primaryKey:"status",event_id:"ad_sdk_splash_load",type:"EXECUTION_BIZ_TIME",msg:{status:8001,error_msg:t||""}})}function Wt(t,e,i,a){!function(t){let e={category:"ad_client_apm_log",biz:"AD_SPLASH",sub_biz:"OTHER",rate:1,suffixRatio:"",event_id:"ad_sdk_splash_load",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:t};Yt(e)}({status:6001,is_load_success:e,duration_ms:i,image_download_time_ms:a,url:A(t)})}function Ut(t){Yt({category:"ad_client_apm_log",biz:"AD_SPLASH",sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_sdk_splash_load",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:t})}function zt(t){Yt({category:"ad_client_error_log",biz:"AD_SPLASH",sub_biz:"OTHER",rate:1,suffixRatio:"",event_id:"ad_sdk_splash_monitor_style_data_error",primaryKey:"status",type:"EXECUTION_BIZ_TIME",msg:t})}function Yt(t){bt.supportMinimumTKVersion("4.0.4")&&(t.msg&&(t.msg.report_source=1),Bt.sendCommercialLog(t,(()=>{})))}Ht.INVALID_VALUE=-1;class Gt{static createVideoCommonInstance(t,e){return 3==t?Gt.createFullscreenCommonInstance(e):2==t?Gt.createNeoCommonInstance(e):null}static createImageCommonInstance(t,e){var i;let a=new c;return a.template_id=k(e,16),a.template_version=null===(i=R(e,16))||void 0===i?void 0:i.templateVersion,a}static createLiveCommonInstance(t,e){var i;let a=new c;return a.template_id=k(e,14),a.template_version=null===(i=R(e,14))||void 0===i?void 0:i.templateVersion,a}static createNeoCommonInstance(t){var e;let i=new c,a=y.getNeoActionBarCardType(t);return i.actionbar_card_type=a,i.template_id=k(t,12),i.template_version=null===(e=R(t,12))||void 0===e?void 0:e.templateVersion,a!=p.LIVE_CUT3_STYLE1&&a!=p.LIVE_CUT3_STYLE2||(i.live_room_pattern=h.SIMPLIFIED_LIVE_ROOM_PATTERN),i}static createFullscreenCommonInstance(t){let e=new c,i=y.getFullscreenActionBarCardType(t);return e.actionbar_card_type=i,i!=p.LIVE_CUT3_STYLE1&&i!=p.LIVE_CUT3_STYLE2||(e.live_room_pattern=h.SIMPLIFIED_LIVE_ROOM_PATTERN),e}static appendNeoExtData(t,e,i,a){if(null==t)return;let s=t.neo_ext_data;null==s&&(s=new d,t.neo_ext_data=s),i&&(s.videoRollbackToImageTimeout=i.videoRollbackToImageTimeout),s.originalMaterialType=S(e),a&&s&&a(s)}}var Xt=function(t,e,i,a){return new(i||(i=Promise))((function(s,n){function o(t){try{h(a.next(t))}catch(e){n(e)}}function r(t){try{h(a.throw(t))}catch(e){n(e)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,r)}h((a=a.apply(t,e||[])).next())}))};class jt{static sendLog(t,e,i,a){this.log(t,null,e,i,a)}static log(t,e,i,a,s){(i=i||{}).renderContainer=1;const n={actionType:t,payload:JSON.stringify(i)};if(s&&(n.creativeId=s),a)if(null==a?void 0:a.adCacheId)n.adCacheId=null==a?void 0:a.adCacheId;else{const t=I(a,s);n.adTemplate=JSON.stringify(t)}e&&(n.clickInfo=e),Bt.sendLog(n)}static convertIfNeeded(t,e,i,a,s,n,o,r,h,l,d){let p=B(e,i);if(!p)return p;let m=J;return ft(m)||(n||(n=new c),ft(n.template_id)&&(n.template_id=m.templateId),ft(n.template_version)&&(n.template_version=m.templateVersion)),n=jt.appendGlobalNeoExtData(n,e),P(e)&&this.reportLivePlaySecond(this.sCurrentPlayTimeMs/1e3),this.convert(i,a,s,t,n,o,r,h,l,d),p}static convert(t,e,i,a,s,n,o,r,h,l){var c,d;return Xt(this,void 0,void 0,(function*(){const p=C(I(at(),r));if(!p||!B(p,t))return void console.log("tkloadcontroller invalid convert:"+p+":"+t);let m,u;m=ft(s)?{itemClickType:i,renderContainer:1}:{itemClickType:i,renderContainer:1,clientExtData:JSON.stringify(s)},ft(n)||Object.assign(m,n),Nt().emit(xt,{clickType:i}),e?(u={x:e.x,y:e.y},e.width&&(u.width=e.width),e.height&&(u.height=e.height)):u={};let g=-1;(null==o?void 0:o.convertType)&&(g=o.convertType,m.triggerType=g);let w=!1;if(this.matchTKConversion()){console.log("tkloadcontroller match conversion service");let i=KSAdTKBundleService.getInstance("CommercialKSAdConversionService","conversion-service",null);if(i){console.log("tkloadcontroller service instance is:"+i);const s=new Ft(h||at(),et(),it());s.currentPlayTime=this.sCurrentPlayTimeMs,s.clickScene=a,s.convertType=g,s.creativeId=r,s.clickArea=t,s.soundEnable=this.sSoundEnable,s.sourceTemplate=st(),(null==o?void 0:o.liveItemId)&&(s.liveItemId=o.liveItemId),Tachikoma.env.isDebug&&(f="TK转化链路开始",Bt.callNativeWithCallback("showToast",{message:f})),i.getVersion()>=2&&(this.sSecondClickCallback=t=>{0==t?Bt.forceUpdateLifeStatus("pageInvisiable",!0):1==t?Bt.forceUpdateLifeStatus("pageInvisiable",!1):2==t&&Bt.forceUpdateLifeStatus("pageVisiable",!1)},i.setSecondConfirmCallback(this.sSecondClickCallback),i.getVersion()>=3&&bt.supportMinimumTKVersion("5.1.3")&&dt()&&(this.sDownloadTipCallback=t=>{switch(t){case 0:Bt.adOutCallback({targetMethod:"adDownloadConfirmTipShow"});break;case 2:Bt.adOutCallback({targetMethod:"adDownloadConfirmTipCancel"});break;case 1:Bt.adOutCallback({targetMethod:"adDownloadConfirmTipDismiss"})}},i.setDownloadConfirmTipCallback(this.sDownloadTipCallback))),this.sHandleAdClickCallback=t=>{if(this.sCurrentPlayTimeMs>0&&(m.playedDuration=this.sCurrentPlayTimeMs),t.reportExtraParam)try{let e=ft(m.clientExtData)?{}:JSON.parse(m.clientExtData);e.clientExtData=JSON.parse(t.reportExtraParam),m.clientExtData=JSON.stringify(e)}catch(i){!function(t,e="",i=""){var a,s;Yt({category:"ad_client_error_log",biz:"TACHIKOMA",sub_biz:"OTHER",rate:.001,suffixRatio:"",event_id:"ad_tk_render_performance",primaryKey:"unknown",type:"OTHER",msg:{render_state:3,error_reason:rt(t),template_id:ft(i)?null===(a=st())||void 0===a?void 0:a.templateId:i,version_code:ft(e)?null===(s=st())||void 0===s?void 0:s.templateVersionCode:e}})}(i)}this.log(2,e,m),bt.isAndroid()||this.handleIOSConvertCallback(t)},this.sAfterHandleClickCallback=()=>{bt.supportMinimumTKVersion("6.0.3")&&!bt.isAndroid()&&Bt.callNativeWithCallback("callbackAfterHandleAdClick",{})},i.getVersion()>=4&&i.setAfterHandleClickCallback(this.sAfterHandleClickCallback),i.handleAdClick(JSON.stringify(s),this.sHandleAdClickCallback),w=!0}else this.loadConversionServiceIfNeeded((t=>{console.log("tkloadcontroller service load result:"+t)}))}var f;let y=null==h?void 0:h.impAdInfo[0];r||(r=null===(d=null===(c=T(h||at()))||void 0===c?void 0:c.adBaseInfo)||void 0===d?void 0:d.creativeId),function(t,e,i,a,s,n,o,r){e.isCallbackOnly=r,Bt.clickActionBase(Object.assign(Object.assign({area:t,logParam:e},i),{creativeId:a,adTemplate:n,disableCallback:o,isCallbackOnly:r}),s)}(t,{payload:JSON.stringify(m),clickInfo:u,sceneType:a,itemClickType:i},o,r,(i=>{1!=i.result&&(this.log(2,e,m),Bt.convert(1==t))}),y,l,w)}))}static handleIOSConvertCallback(t){t.success&&3==t.interactionType&&Bt.adOutCallback({targetMethod:"closeConvertPageCallback",methodParams:JSON.stringify({interactionType:t.interactionType})})}static reportClick(t,e,i,a){null==a&&(a=new c),a=jt.appendGlobalNeoExtData(a,t);let s={clientExtData:JSON.stringify(a)};s=Object.assign(s,i),jt.log(2,null,s)}static appendGlobalNeoExtData(t,e){let i=it(),a=tt();return null!=a&&null!=i&&(t||(t=new c),Gt.appendNeoExtData(t,e,i.abConfig,(t=>{t.realRenderResult=a}))),t}static expose(t,e){this.log(1,null,t,e)}static exposeElement(t,e){(e=e||{}).elementType=t,this.log(140,null,e)}static clickElement(t){const e={elementType:t};this.log(141,null,e)}static convertWithTypeIfNeeded(t,e,i,a,s){this.convertWithType(e,i,a,s)}static convertWithType(t,e,i,a){this.convert(t,e,i,0,null,null,{convertType:a})}static convertWithTypeIfNeededNew(t,e,i,a,s,n){B(t,e)&&this.convertWithTypeNew(e,i,a,s,n)}static convertWithTypeNew(t,e,i,a,s){this.convert(t,e,i,0,null,s,{convertType:a})}static playNSecond(t,e){let i={photoPlaySecond:t};if(e){let t={clientExtData:JSON.stringify(e)};Object.assign(i,t)}this.log(402,null,i)}static playStart(t){let e=null;t&&(e={clientExtData:JSON.stringify(t)}),jt.log(399,null,e)}static reportLivePlaySecond(t){let e={photoPlaySecond:Math.round(t)},i={actionType:28,payload:JSON.stringify(e)};Bt.sendLog(i)}static skip(){this.log(501,null,null)}static loadConversionServiceIfNeeded(t){this.matchTKConversion()&&KSAdTKBundleService.loadBundle("CommercialKSAdConversionService",t),t&&t(!1)}static matchTKConversion(){var t,e;return!!(null===(e=null===(t=it())||void 0===t?void 0:t.abConfig)||void 0===e?void 0:e.tkConversionSwitch)&&(!(!dt()||!bt.supportMinimumTKVersion("6.0.5"))||!dt()&&bt.supportMinimumTKVersion("6.0.3"))}static updateVideoPlayStatus(t,e,i,a){!function(t,e,i,a){Bt.callNativeWithCallback("updateVideoPlayStatus",{status:t,errorCode:e||0,errorReason:i||"",currentTime:a||0})}(t,e,i,a),"progress"==t&&a&&(this.sCurrentPlayTimeMs=a)}static updateLivePlayStatus(t,e,i,a){"progress"==t&&a&&(this.sCurrentPlayTimeMs=a)}}jt.sSoundEnable=!1;class $t{constructor(){this.renderCalled=!1,this.renderStatusCalled=!1,this.rootView=new TKView,this.rootView.style={width:"100%",height:"100%"}}render(){return!this.renderCalled&&(this.renderCalled=!0,!0)}updateRenderStatus(t,e=""){this.renderCalled&&!this.renderStatusCalled&&(this.renderStatusCalled=!0,Bt.pageStatus(t,e),this.registerNativeId(),jt.loadConversionServiceIfNeeded((t=>{})))}registerNativeId(){Ct()&&bt.supportMinimumTKVersion("4.0.7")&&!bt.isAndroid()&&(this.startConfig(),Bt.registerNativeId((t=>{t&&t.data&&this.startConfig()})))}startConfig(){this.configNativeIdTimer&&clearTimeout(this.configNativeIdTimer),this.configNativeIdTimer=setTimeout((()=>{It(this)}),120)}}class Jt extends TKView{}class Zt extends Object{constructor(t,e,i,a){var s;super(),this.depIds={},this.vm=t,this.getter="function"==typeof e?e:this.parseGetter(e.trim()),this.cb=i,this.value=this.get(),this.cb(null!==(s=this.value)&&void 0!==s?s:a,null),console.log("Watcher on "+e)}update(){const t=this.get();t!=this.value&&(this.cb.call(this.vm,t,this.value),this.value=t)}addDep(t){const e=t.pid;this.depIds.hasOwnProperty(e)||(t.addDep(this),this.depIds[e]=t)}get(){Zt.target=this;const t=this.getter.call(this.vm,this.vm);return Zt.target=null,t}parseGetter(t){if(/[^\w.$]/.test(t))return;const e=t.split(".");return function(t){for(let i=0,a=e.length;i<a;i++){if(!t)return;t=t[e[i]]}return t}}}function qt(t){return!!t}function Qt(t){return"string"==typeof t}let te;function ee(){if(null!=te)return te;let t=!1;try{t=!1,te=t}catch(e){}return t}function ie(t,e){if(!0===ee()&&(null==t||!1===t))throw new Error("tkmvvm ----- 请检查传值: "+e)}function ae(t){return t.$vm}function se(t){ee()&&console.log("tachikoma TKMVVM log -> "+t)}class ne extends Object{constructor(t,e){super(),this.object=t,this.observeKey=e,this._observe(t,e)}_observe(t,e){var i=this;Array.isArray(t)?this.defineArray(t):Object.keys(t).forEach((function(a){e?e===a&&i.observeValueWithKey(t,a):i.observeValueWithKey(t,a)}))}observeValueWithKey(t,e){let i=t[e];var a=new re(e);he(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:function(){return Zt.target&&a.depend(),i},set:function(t){t!==i&&(i=t,a.notify(),he(t))}})}defineArray(t){if(t)for(let e=0,i=t.length;e<i;e++)he(t[e])}}var oe=0;class re extends Object{constructor(t){super(),this.key=t,this.pid=oe++,this.deps=new Array}depend(){Zt.target.addDep(this)}addDep(t){this.deps.push(t)}removeDep(t){}notify(){this.deps.forEach((function(t){t.update()}))}}function he(t,e){if(!t||"object"!=typeof t)return;var i;if(!("object"==typeof(i=t)&&Object.keys(i).length>0))return;let a=!1,s=(null!=e?e:"")+"_tkmvvm_observed";if(t.hasOwnProperty(s)&&(a=t[s]),!a)return se("observe "+s),t[s]=!0,new ne(t,e);se("already observe "+s)}const le={updateBackgroundColor:function(t,e,i){if(ie(e,"backgroundColor"),t&&e&&Qt(e)){const i=function(t){let e="#FE3666";return t?/^rgb|^hsl/.test(t)?t:(t.startsWith("#")||(t="#"+t),/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/.test(t)?t:e):e}(e);t.style={backgroundColor:i}}},updateStyle:function(t,e,i){ie(e,"style"),t&&e&&(t.style=e)},updateText:function(t,e,i){if(ie(e,"text"),t&&Qt(e)){const i=t.setText;"function"==typeof i&&i.call(t,e)}},updateSrc:function(t,e,i){if(ie(e,"src"),t&&e&&Qt(e)){const i=t.setSrc;"function"==typeof i&&i.call(t,e)}}};class ce extends Object{constructor(){super()}tk_observe(t){qt(t)&&(t in this?he(this,t):console.log("=====++++++ observe2: key not in this:"+t+":"+typeof this))}}function de(t,e,i,a,s){if(!qt(t)||!qt(i))return;const n=e.charAt(0).toUpperCase()+e.slice(1),o=le["update"+n],r=ue(i),h=null==r?void 0:r.split(".");if(!h)return void ie(h,"tk_bind error, check bind path");const l=h[0],c=ae(i);if(!c)return void ie(c,"vm_bind get vm error");c.tk_observe(l),new Zt(c,r,((e,i)=>{if(s)for(let t=0;t<s.length;t++){s[t].dataCheck(e,r)}o&&o(t,e,i)}),a)}function pe(t,e){const i=ae(t);if(!qt(i)||!qt(t)||!qt(e))return;const a=ue(t),s=null==a?void 0:a.split(".");if(!s)return void ie(s,"tk_bind error, check bind path");const n=s[0];i.tk_observe(n),new Zt(i,a,((t,i)=>{e&&e(t)}))}function me(t,e,i){if(!qt(t)||!qt(e)||!qt(i))return;const a=ue(e),s=null==a?void 0:a.split(".");if(!s)return void ie(s,"tk_bind error, check bind path");const n=s[0];t.tk_observe(n),new Zt(t,a,((t,e)=>{i&&i(t)}))}function ue(t){let e=function(t){if(t)return t.bind_path?t.$bind_path:"string"==typeof t?t:void 0}(t);if(e)return e;ie(e,"tk_bind error, check bind path")}class ge extends TKView{constructor(t){super(),this.columnNum=3,this.traveViews=[],this.iconImages=[],this.iconDefaultSize={width:150,height:150},this.hasAnimedView=new Array(9),this.currentIntervalTime=0,this.animedCount=0,this.timer=0,this.hasShow=!1,this.vm=t,this.pendantRowDelay=0,this.rowNum=this.vm.getRowNum(),this.vm.checkParam()&&(this.style={width:"100%",height:"100%"},this.throughHitTest=!0,this.createTravelView(),this.createRedPacketInTravel())}createTravelView(){this.traveViews=[];for(let t=0;t<this.columnNum;t++){let e=new TKView;e.style={width:this.iconDefaultSize.width,height:this.vm.containerSize.height+this.iconDefaultSize.height+30,position:"absolute",left:this.getLeftMagin(t),alignItems:"center",top:-this.iconDefaultSize.height},e.throughHitTest=!0,this.appendChild(e),this.traveViews.push(e)}}getLeftMagin(t){let e=this.vm.containerSize.width/this.columnNum,i=this.iconDefaultSize.width-e;return 0==t?0:1==t?e-i/2:this.vm.containerSize.width-this.iconDefaultSize.width}createRedPacketInTravel(){this.iconImages=[];for(let t=0;t<this.columnNum;t++)for(let e=0;e<this.rowNum;e++){let i=this.createIconImage(e,t);this.iconImages[t*this.rowNum+e]=i,this.traveViews[t].appendChild(i)}}createIconImage(t,e){let i=new TKImage,a=this.vm.getScaleType(t,e);if(i.style={width:this.iconDefaultSize.width*a,height:this.iconDefaultSize.height*a,position:"absolute",top:0},this.vm.isCanClick()){let t=this;i.addEventListener("tap",(e=>{const a=pt(e,i);this.vm.convert(2,a,At.FALL_ICON_CLICK),t.hide(!0)}))}else i.addEventListener("tap",(t=>{}));return i.setSrc(this.vm.getRedPacketIconUrl()),i}createIconAnimation(t,e){const i=1e3*this.vm.getShowTime(t),a=new TKKeyframeAnimation;let s=this;a.timingFunction="linear",a.setAnimations([()=>(e.style={top:0},0),()=>(e.style={top:s.vm.containerSize.height+s.iconDefaultSize.height+30},1)]),t==this.vm.getLastAnimIconIndex()&&a.on("end",(()=>{s.hide()})),a.duration=i;let n="translateAnimation"+t.toString();if(e.addAnimation(a,n),this.vm.isCanShowRotateAnim(t)&&setTimeout((()=>{this.startRotateAnimation(e)}),this.vm.getRotateAnimDelayTime(t)),2==this.vm.getAnimType()){const t=new TKKeyframeAnimation;t.timingFunction="ease-in",t.setAnimations([()=>(e.style={opacity:1},.5),()=>(e.style={opacity:.5},.75),()=>(e.style={opacity:0},1)]),t.duration=.6*i,e.addAnimation(t,"opacityAnimation")}}startRotateAnimation(t){const e=new TKKeyframeAnimation;e.setAnimations([()=>(t.style={transform:{rotate:{z:0}}},0),()=>(t.style={transform:{rotate:{z:-25}}},.2),()=>(t.style={transform:{rotate:{z:25}}},.4),()=>(t.style={transform:{rotate:{z:-21}}},.6),()=>(t.style={transform:{rotate:{z:21}}},.8),()=>(t.style={transform:{rotate:{z:0}}},1)]),e.duration=1500,t.addAnimation(e,"rotateAnim")}show(){this.vm.isParamValid()&&(this.hasShow||(this.hasShow=!0,this.vm.reportRedPacketImpression(),this.showRedPacketIconWithAnim()))}hide(t=!1){const e=this;setTimeout((()=>{e.removeAllAnimation(),e.removeAll(),e.vm.dismissCallbackOnlyOnce()}),t?100:0)}showRedPacketIconWithAnim(){this.tryShowAnim(),this.timer=setInterval((()=>{this.currentIntervalTime+=this.vm.getAnimMinTime(),this.tryShowAnim()}),this.vm.getAnimMinTime())}tryShowAnim(){if(this.animedCount!=this.vm.getAnimedCount()){for(let t=0;t<this.vm.getAnimedCount();t++)if(!this.hasAnimedView[t]&&this.currentIntervalTime==this.vm.getIconDelayTime(t)){this.hasAnimedView[t]=!0;let e=this.iconImages[t];this.createIconAnimation(t,e),this.animedCount=this.animedCount+1}}else this.timer&&clearInterval(this.timer)}}class we extends TKView{constructor(t,e,i){super();let a=e.adBaseInfo,s="#00000000";3==t?s="#00000019":0!=t&&(s="#00000025"),this.style={height:ft(i)?16:i,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",backgroundColor:s,borderRadius:3==t?3:2};let n=3;if(2!=t){let e=null;1==t||3==t?mt(a.adMarkIcon)&&(e=a.adMarkIcon):mt(a.adGrayMarkIcon)&&(e=a.adGrayMarkIcon),mt(e)&&(this.iconView=new TKImage,this.iconView.style={width:12,height:12,marginLeft:3,opacity:3==t?.4:1},n=4,this.appendChild(this.iconView),this.iconView.setSrc(e))}let o="#9C9C9C";0!=t&&(o="#FFFFFF"),this.titleLabel=new TKText,this.titleLabel.style={color:o,minimumTextScaleFactor:.5,fontSize:10,marginLeft:n,marginRight:3,textAlign:"center",includeFontPadding:!1,opacity:3==t?.4:1};let r=a.adSourceDescription;r||(r="广告"),this.titleLabel.setText(r),this.appendChild(this.titleLabel)}setTitleColor(t){this.titleLabel&&(this.titleLabel.style={color:t},this.style={height:16,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",borderRadius:2})}}class fe extends TKView{constructor(t,e,i,a="#30303099",s="#FFFFFF",n){super(),this.adInfo=t,this.isVertical=0==e,this.backgroundColor=a,this.color=s,this.shadow=n,this.containerWidth=i,this.setupView(),this.setupData()}setupView(){this.style={opacity:.6,flexDirection:"column",backgroundColor:this.backgroundColor,borderRadius:4,padding:10};let t=this.style.width;if("number"==typeof t)this.containerWidth=t;else if("string"==typeof t)if(isNaN(Number(t))){if("%"!=t.slice(-1))return;this.containerWidth*=Number(t.slice(0,-1))/100}else this.containerWidth=Number(t);if(this.addEventListener("tap",(()=>{})),this.appInfoLabel=this.createLabel(this.color),this.isVertical&&(this.appInfoLabel.style={flexShrink:1,textLineClamp:1,textOverflow:"ellipsis"},this.appInfoLabel.text=this.appendNameText(""),this.appInfoLabel.text=this.appendDeveloperText(this.appInfoLabel.text),mt(this.appInfoLabel.text)&&bt.supportMinimumTKVersion("5.0.0")))try{this.appInfoLabel.measureForText(this.appInfoLabel.text,this.containerWidth,2).startIndex>1&&(this.appendChild(this.appInfoLabel),this.isTooLong=!0)}catch(e){console.error("ignore"+new Error(e).stack)}this.otherLabel=this.createLabel(this.color),this.otherLabel.style={marginRight:10},this.appendChild(this.otherLabel),mt(this.shadow)&&(this.otherLabel.style={shadow:this.shadow})}createLabel(t){let e=new TKText;return e.style={color:t,fontSize:10,textLineHeight:16},e}setupData(){let t="";if(this.isVertical?(this.isTooLong||(t=this.appendNameText(t),t=this.appendDeveloperText(t)),t=this.appendRecordText(t)):(t=this.appendNameText(t),t=this.appendDeveloperText(t),t=this.appendRecordText(t)),bt.supportMinimumTKVersion("4.0.5")?mt(this.adInfo.downloadSafeInfo.appVersion)&&(t+="| 版本 "+this.adInfo.downloadSafeInfo.appVersion):mt(this.adInfo.adBaseInfo.appVersion)&&(t+="版本 "+this.adInfo.adBaseInfo.appVersion),ft(this.adInfo.downloadSafeInfo.introductionInfoUrl)&&ft(this.adInfo.downloadSafeInfo.appPermissionInfoUrl)&&ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)?t+=" ":t+=" | ",this.span=new TKSpan,!ft(this.adInfo.downloadSafeInfo.introductionInfoUrl)){const e=t.length;t+="功能";const i=t.length;ft(this.adInfo.downloadSafeInfo.appPermissionInfoUrl)&&ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)?t+=" ":t+=" | ",this.introductionClickSpanItem=new TKSpanItem,this.introductionClickSpanItem.spanType="click",this.introductionClickSpanItem.start=e,this.introductionClickSpanItem.end=i,this.introductionClickSpanItem.color=this.color,this.introductionClickSpanItem.setSpanOnClickListener((()=>{this.clickCallback&&this.clickCallback(this.adInfo.downloadSafeInfo.introductionInfoUrl,"功能介绍")})),this.span.addSpan(this.introductionClickSpanItem)}if(!ft(this.adInfo.downloadSafeInfo.appPermissionInfoUrl)){const e=t.length;t+="权限";const i=t.length;ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)?t+=" ":t+=" | ",this.permissionClickSpanItem=new TKSpanItem,this.permissionClickSpanItem.spanType="click",this.permissionClickSpanItem.start=e,this.permissionClickSpanItem.end=i,this.permissionClickSpanItem.color=this.color,this.permissionClickSpanItem.setSpanOnClickListener((()=>{this.clickCallback&&this.clickCallback(this.adInfo.downloadSafeInfo.appPermissionInfoUrl,"权限信息")})),this.span.addSpan(this.permissionClickSpanItem)}if(!ft(this.adInfo.downloadSafeInfo.appPrivacyUrl)){const e=t.length;t+="隐私";const i=t.length;t+=" ",this.privacyClickSpanItem=new TKSpanItem,this.privacyClickSpanItem.spanType="click",this.privacyClickSpanItem.start=e,this.privacyClickSpanItem.end=i,this.privacyClickSpanItem.color=this.color,this.privacyClickSpanItem.setSpanOnClickListener((()=>{this.clickCallback&&this.clickCallback(this.adInfo.downloadSafeInfo.appPrivacyUrl,"隐私政策")})),this.span.addSpan(this.privacyClickSpanItem)}this.otherLabel.setSpan(t,this.span)}appendNameText(t){return bt.supportMinimumTKVersion("4.0.5")?mt(this.adInfo.downloadSafeInfo.appName)&&(t+=this.adInfo.downloadSafeInfo.appName+" "):mt(this.adInfo.adBaseInfo.appName)&&(t+=this.adInfo.adBaseInfo.appName+" "),t}appendDeveloperText(t){return bt.supportMinimumTKVersion("4.0.5")?mt(this.adInfo.downloadSafeInfo.corporationName)&&(t+=this.adInfo.downloadSafeInfo.corporationName+" "):mt(this.adInfo.adBaseInfo.corporationName)&&(t+=this.adInfo.adBaseInfo.corporationName+" "),t}appendRecordText(t){return bt.supportMinimumTKVersion("4.0.5")&&mt(this.adInfo.downloadSafeInfo.recordNumber)&&(t+=this.adInfo.downloadSafeInfo.recordNumber+" "),t}}class ye extends ce{constructor(){super(),this.$attrsPath=new Proxy(this,{get:(t,e)=>Ie(t,e)})}getData(t){}}function Ie(t,e){return new Proxy({$vm:t,$bind_path:e},{get:(i,a)=>"string"!=typeof a||"function"==typeof i[a]||0==a.indexOf("$")?Reflect.get(i,a):Ie(t,e+"."+a)})}var Ce;!function(t){t[t.SHOW_WHEN_PAUSE=1]="SHOW_WHEN_PAUSE",t[t.SHOW_WHEN_STATE_SWITCH=2]="SHOW_WHEN_STATE_SWITCH"}(Ce||(Ce={}));class Te extends ye{constructor(t,e,i,a){super(),this.downloadState=0,this.descText="",this.showPopupView=!1,this.showControlStrategy=null,this.adInfo=t,this.adStyle=e,this.configInfo=i,this.screenOrientation=a;let s=X(this.adInfo);this.needDownloadingState=!!s&&(3!=e&&2!=e&&1!=e)}onCloseClick(){this.showControlStrategy=Ce.SHOW_WHEN_PAUSE,X(this.adInfo)?this.needDownloadingState?this.showControlStrategy=Ce.SHOW_WHEN_STATE_SWITCH:this.showControlStrategy=Ce.SHOW_WHEN_PAUSE:G(this.adInfo)&&(this.showControlStrategy=Ce.SHOW_WHEN_PAUSE)}pageVisibleChange(t){t&&this.updateState(this.downloadState)}updateDownloadProgress(t){1==t.getDownloadState()&&0==t.getProgress()&&(this.showPopupView=!1),t.getTotalBytes()>0&&(this.downloadProgress=t.getProgress(),this.updateDesc(t.getDownloadState(),t.getProgress()),this.updateState(t.getDownloadState()))}updateDesc(t,e){if(this.needDownloadingState){let i=3==t;this.descText=i?"继续下载应用":`下载中${(100*e).toFixed(0)}%`}else this.descText="继续下载应用"}updateState(t){if(0==t)return void(this.downloadState=t);let e=this.downloadState;if(this.downloadState=t,this.showControlStrategy)this.handleShowControlStrategy(e,this.downloadState);else switch(this.downloadState){case 0:case 1:case 4:case 6:break;case 2:this.needDownloadingState?this.showPopupView=!0:this.showPopupView=!1,3==e&&Bt.showToast(this.getContinueToast());break;case 3:this.needDownloadingState||(this.showPopupView=!0),Bt.showToast(this.getPauseToast());break;case 5:this.showPopupView=!1}}handleShowControlStrategy(t,e){this.showControlStrategy==Ce.SHOW_WHEN_PAUSE?3==e&&(this.showPopupView=!0,this.showControlStrategy=null):this.showControlStrategy==Ce.SHOW_WHEN_STATE_SWITCH&&(3==e&&2==t||2==e&&3==t)&&(this.showPopupView=!0,this.showControlStrategy=null)}isDownloadPaused(){return 3==this.downloadState}isNeedShowDownloading(){return this.needDownloadingState}convert(t,e,i,a,s=null,n){jt.convertIfNeeded(t,this.adInfo,e,i,a,s,n)}getDesText(){return this.descText}getContinueToast(){return"继续下载中"}getDeleteToast(){return"取消安装,已删除安装包"}getPauseToast(){return"已暂停下载"}}class ve{constructor(){this.downloadStats=0,this.downloadProgress=-1,this.totalBytes=0}static newInstance(t,e,i){let a=new ve;return a.downloadStats=t,a.downloadProgress=e,a.totalBytes=i,a}obtainActionButtonText(t){let e,i=X(t);switch(this.downloadStats){case 0:case 1:case 4:e=t.adBaseInfo.adActionDescription;break;case 2:e=i?"暂停":`${(100*this.downloadProgress).toFixed(0)}%`;break;case 3:e="继续下载";break;case 5:e=mt(t.adBaseInfo.installAppLabel)?t.adBaseInfo.installAppLabel:"点击安装";break;case 6:e=mt(t.adBaseInfo.openAppLabel)?t.adBaseInfo.openAppLabel:"立即打开"}return e}getProgress(){return this.downloadProgress}getDownloadState(){return this.downloadStats}getTotalBytes(){return this.totalBytes}isDownloadFinish(){return 5==this.downloadStats||6==this.downloadStats}isDownloading(){return 2==this.downloadStats}}class Se{constructor(t,e,i){this.xDegree=t,this.yDegree=e,this.zDegree=i}}class be{constructor(t){this.radFlag=!1,this.xFlag=!1,this.yFlag=!1,this.zFlag=!1,this.antiXFlag=!1,this.antiYFlag=!1,this.antiZFlag=!1,this.bidirectionalSwitch=!1,this.NS2S=1e-9,this.rotateInfo=t,this.bidirectionalSwitch=function(t){try{return t.bidirectionalSwitch}catch(e){}return!1}(t)}beforeMonitor(){this.startTime=bt.isAndroid()?0:ot()/1e3,this.maxSensorInfo=new Se(0,0,0),this.xDegree=0,this.yDegree=0,this.zDegree=0}resetValues(){this.xDegree=0,this.yDegree=0,this.zDegree=0}canConvertRotate(t){try{if(!ft(t)&&!ft(t.values)){if(!this.radFlag){this.xOriginOmiga=0,this.yOriginOmiga=0,this.zOriginOmiga=0;let i=-1;try{i=it().abConfig.rotateProgressIncreaseCompatible}catch(e){}i>=0&&(t.values[0]>i&&(this.xOriginOmiga=t.values[0]),t.values[1]>i&&(this.yOriginOmiga=t.values[1]),t.values[2]>i&&(this.zOriginOmiga=t.values[2])),this.radFlag=!0}let i=!1,a=!1,s=!1,n=0;bt.isAndroid()?(0!=this.startTime&&(n=(t.timestamp-this.startTime)*this.NS2S),this.startTime=t.timestamp):(n=t.timestamp/1e3-this.startTime,this.startTime=t.timestamp/1e3),this.xDegree+=n*(t.values[0]-this.xOriginOmiga)*180/Math.PI,this.yDegree+=n*(t.values[1]-this.yOriginOmiga)*180/Math.PI,this.zDegree+=n*(t.values[2]-this.zOriginOmiga)*180/Math.PI;let o=new Se(this.xDegree,this.yDegree,this.zDegree);if(Math.abs(o.xDegree)>Math.abs(this.maxSensorInfo.xDegree)&&(this.maxSensorInfo.xDegree=o.xDegree),Math.abs(o.yDegree)>Math.abs(this.maxSensorInfo.yDegree)&&(this.maxSensorInfo.yDegree=o.yDegree),Math.abs(o.zDegree)>Math.abs(this.maxSensorInfo.zDegree)&&(this.maxSensorInfo.zDegree=o.zDegree),this.bidirectionalSwitch)return this.bidirectionRotateConvert(o);i=this.canConvertCurrentDegree(o.xDegree,this.rotateInfo.x),a=this.canConvertCurrentDegree(o.yDegree,this.rotateInfo.y),s=this.canConvertCurrentDegree(o.zDegree,this.rotateInfo.z);let r=i||a||s;return r&&(this.radFlag=!1),r}}catch(i){}return!1}bidirectionRotateConvert(t){t.xDegree>0&&!this.xFlag?this.xFlag=this.canConvertCurrentDegree(t.xDegree,this.rotateInfo.x):t.xDegree<0&&!this.antiXFlag&&(this.antiXFlag=this.canConvertCurrentDegree(t.xDegree,this.rotateInfo.x)),t.yDegree>0&&!this.yFlag?this.yFlag=this.canConvertCurrentDegree(t.yDegree,this.rotateInfo.y):t.yDegree<0&&!this.antiYFlag&&(this.antiYFlag=this.canConvertCurrentDegree(t.yDegree,this.rotateInfo.y)),t.zDegree>0&&!this.zFlag?this.zFlag=this.canConvertCurrentDegree(t.zDegree,this.rotateInfo.z):t.zDegree<0&&!this.antiZFlag&&(this.antiZFlag=this.canConvertCurrentDegree(t.zDegree,this.rotateInfo.z));let e=this.xFlag&&this.antiXFlag,i=this.yFlag&&this.antiYFlag,a=this.zFlag&&this.antiZFlag,s=e||i||a;return s&&(console.log("bidirection function canRotate, x:"+e+"===y:"+i+"===z:"+a),this.resetFlag()),s}resetFlag(){this.xFlag=!1,this.antiXFlag=!1,this.yFlag=!1,this.antiYFlag=!1,this.zFlag=!1,this.antiZFlag=!1,this.radFlag=!1}canConvertCurrentDegree(t,e){if(e.rotateDegree<0)return!1;let i=!0,a=0==e.rotateDegree?45:e.rotateDegree;switch(e.direction){case 1:i=t<0&&Math.abs(t)>=a;break;case 2:i=t>0&&Math.abs(t)>=a;break;default:i=Math.abs(t)>=a}return i&&this.bidirectionalSwitch&&this.resetValues(),i}maxRotateContent(){return JSON.stringify({x:Math.round(this.maxSensorInfo.xDegree),y:Math.round(this.maxSensorInfo.yDegree),z:Math.round(this.maxSensorInfo.zDegree)})}}class Ae{constructor(t){this.xFlag=!1,this.yFlag=!1,this.zFlag=!1,this.antixFlag=!1,this.antiyFlag=!1,this.antizFlag=!1,this.canShakeCount=0,this.interactiveInfo=t}bidireationShakeConvert(t){let e=this.canBidireationShake(t);return dt()?this.canShakeCount>2&&(console.log("bidirection function android success convert, current canShakeCount:"+this.canShakeCount),this.canShakeCount=0,!0):e}canBidireationShake(t){t[0]>0&&!this.xFlag?this.xFlag=this.computeAcceleration(t[0]):t[0]<0&&!this.antixFlag&&(this.antixFlag=this.computeAcceleration(t[0])),t[1]>0&&!this.yFlag?this.yFlag=this.computeAcceleration(t[1]):t[1]<0&&!this.antiyFlag&&(this.antiyFlag=this.computeAcceleration(t[1])),t[2]>0&&!this.zFlag?this.zFlag=this.computeAcceleration(t[2]):t[2]<0&&!this.antizFlag&&(this.antizFlag=this.computeAcceleration(t[2]));let e=this.xFlag&&this.antixFlag,i=this.yFlag&&this.antiyFlag,a=this.zFlag&&this.antizFlag,s=e||i||a;return s&&(console.log("bidirection function canShake, x:"+e+"===y:"+i+"===z:"+a),this.canShakeCount++,this.resetFlag()),s}computeAcceleration(t){let e=Math.abs(t-9.81);return Math.abs(t)>=z(this.interactiveInfo)&&e>=.05}resetFlag(){this.xFlag=!1,this.yFlag=!1,this.zFlag=!1,this.antixFlag=!1,this.antiyFlag=!1,this.antizFlag=!1}}class Ve{constructor(t){this.gravity=9.81,this.minError=.05,this.accelerationThreshold=z(t),this.bidireationalSwitch=Y(t.shakeInfo),this.bidirectionalRotateShakeUtil=new Ae(t),this.lastValue=new Array,this.lastValue[0]=0,this.lastValue[1]=0,this.lastValue[2]=0}beforeMonitor(){this.maxAcceleration=0}resetValues(){this.lastValue=new Array,this.lastValue[0]=0,this.lastValue[1]=0,this.lastValue[2]=0}canConvertShake(t){try{if(!ft(t)&&!ft(t.values)){if(t=this.noiseReduction(t),this.isInvalidValue(t.values))return!1;this.lastValue=t.values;let e=t.values[0],i=t.values[1],a=t.values[2];return this.bidireationalSwitch?(this.maxAcceleration=Math.max(Math.max(Math.abs(e),Math.abs(i)),Math.abs(a)),this.bidirectionalRotateShakeUtil.bidireationShakeConvert(t.values)):(this.maxAcceleration=Math.sqrt(e*e+i*i+a*a),this.maxAcceleration>=this.accelerationThreshold)}}catch(e){}return!1}isInvalidValue(t){let e=Math.abs(Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]));return!!(Math.abs(e-this.gravity)<=this.minError&&bt.isAndroid())}noiseReduction(t){let e=.6;return 0==this.lastValue[0]&&0==this.lastValue[1]&&0==this.lastValue[2]&&(e=1),this.lastValue[0]=e*t.values[0]+(1-e)*this.lastValue[0],this.lastValue[1]=e*t.values[1]+(1-e)*this.lastValue[1],this.lastValue[2]=e*t.values[2]+(1-e)*this.lastValue[2],t.values[0]=this.lastValue[0],t.values[1]=this.lastValue[1],t.values[2]=this.lastValue[2],t}}class _e{constructor(t,e,i){this.xDegree=t,this.yDegree=e,this.zDegree=i}}class Le{constructor(t){this.rotationMatrix=new Array(9),this.simulatedGyroscopeValues=[],this.originRotateDegree=[],this.mRotateDegree=[],this.isInitValidValue=!1,this.rotateInfo=t,this.resetMaxRotateInfo()}resetMaxRotateInfo(){this.maxSensorInfo=new _e(0,0,0)}handleImitateSensorData(t,e,i,a=(t=>{})){if(0!=e.length&&0!=t.length){if(this.getRotationMatrix(this.rotationMatrix,null,t,e),this.getOrientation(this.rotationMatrix,this.simulatedGyroscopeValues),this.mRotateDegree[0]=180*this.simulatedGyroscopeValues[0]/Math.PI,this.mRotateDegree[1]=180*this.simulatedGyroscopeValues[1]/Math.PI,this.mRotateDegree[2]=180*this.simulatedGyroscopeValues[2]/Math.PI,!this.isInitValidValue&&(0!=this.mRotateDegree[0]||0!=this.mRotateDegree[1]||0!=this.mRotateDegree[2])){this.isInitValidValue=!0;let t=new Array(3);t[0]=this.mRotateDegree[0],t[1]=this.mRotateDegree[1],t[2]=this.mRotateDegree[2],this.originRotateDegree=t}this.mRotateDegree[0]=this.mRotateDegree[0]-this.originRotateDegree[0],this.mRotateDegree[1]=this.mRotateDegree[1]-this.originRotateDegree[1],this.mRotateDegree[2]=this.mRotateDegree[2]-this.originRotateDegree[2],!ft(this.mRotateDegree)&&a&&a(this.mRotateDegree),this.canConvertRotate(this.mRotateDegree)&&(i&&i(this.maxRotateContent()),this.resetMaxRotateInfo())}}canConvertRotate(t){try{if(!ft(t)){let e=!1,i=!1,a=!1;return Math.abs(t[0])>Math.abs(this.maxSensorInfo.xDegree)&&(this.maxSensorInfo.xDegree=t[0]),Math.abs(t[1])>Math.abs(this.maxSensorInfo.yDegree)&&(this.maxSensorInfo.yDegree=t[1]),Math.abs(t[2])>Math.abs(this.maxSensorInfo.zDegree)&&(this.maxSensorInfo.zDegree=t[2]),e=this.canConvertCurrentDegree(t[0],this.rotateInfo.x),i=this.canConvertCurrentDegree(t[1],this.rotateInfo.y),a=this.canConvertCurrentDegree(t[2],this.rotateInfo.z),e||i||a}}catch(e){}return!1}canConvertCurrentDegree(t,e){if(e.rotateDegree<0)return!1;let i=!0,a=0==e.rotateDegree?45:e.rotateDegree;switch(e.direction){case 1:i=t<0&&Math.abs(t)>=a;break;case 2:i=t>0&&Math.abs(t)>=a;break;default:i=Math.abs(t)>=a}return i}maxRotateContent(){return JSON.stringify({x:Math.round(this.maxSensorInfo.xDegree),y:Math.round(this.maxSensorInfo.yDegree),z:Math.round(this.maxSensorInfo.zDegree),useImitateRotate:!0})}getRotationMatrix(t,e,i,a){try{let s=i[0],n=i[1],o=i[2],r=9.81;if(s*s+n*n+o*o<.01*r*r)return!1;let h=a[0],l=a[1],c=a[2],d=l*o-c*n,p=c*s-h*o,m=h*n-l*s,u=Math.sqrt(d*d+p*p+m*m);if(u<.1)return!1;let g=1/u;d*=g,p*=g,m*=g;let w=1/Math.sqrt(s*s+n*n+o*o);s*=w,n*=w,o*=w;let f=n*m-o*p,y=o*d-s*m,I=s*p-n*d;if(null!=t&&(9==t.length?(t[0]=d,t[1]=p,t[2]=m,t[3]=f,t[4]=y,t[5]=I,t[6]=s,t[7]=n,t[8]=o):16==t.length&&(t[0]=d,t[1]=p,t[2]=m,t[3]=0,t[4]=f,t[5]=y,t[6]=I,t[7]=0,t[8]=s,t[9]=n,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1)),null!=e){let t=1/Math.sqrt(h*h+l*l+c*c),i=(h*f+l*y+c*I)*t,a=(h*s+l*n+c*o)*t;9==e.length?(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=i,e[5]=a,e[6]=0,e[7]=-a,e[8]=i):16==e.length&&(e[0]=1,e[1]=0,e[2]=0,e[4]=0,e[5]=i,e[6]=a,e[8]=0,e[9]=-a,e[10]=i,e[3]=e[7]=e[11]=e[12]=e[13]=e[14]=0,e[15]=1)}}catch(s){return!1}return!0}getOrientation(t,e){try{9==t.length?(e[0]=Math.atan2(t[1],t[4]),e[1]=Math.asin(-t[7]),e[2]=Math.atan2(-t[6],t[8])):(e[0]=Math.atan2(t[1],t[5]),e[1]=Math.asin(-t[9]),e[2]=Math.atan2(-t[8],t[10]))}catch(i){}return e}}class xe{constructor(t){this.rotateInfo=t}registerImitateRotateSensorListener(t,e=(t=>{})){if(!bt.supportMinimumTKVersion("5.0.5")||!bt.isAndroid())return;if(!KSAdSensorManager.supportSensor(3)||!KSAdSensorManager.supportSensor(5))return;this.imtateRotateHandler=new Le(this.rotateInfo);let i=[],a=[];try{KSAdSensorManager.registerSensorListener(3,-3,(s=>{i=s.values,this.imtateRotateHandler.handleImitateSensorData(i,a,t,e)})),KSAdSensorManager.registerSensorListener(5,-3,(s=>{a=s.values,this.imtateRotateHandler.handleImitateSensorData(i,a,t,e)}))}catch(s){}}unRegisterImitateRotateSensorListener(){bt.supportMinimumTKVersion("5.0.5")&&bt.isAndroid()&&(KSAdSensorManager.unregisterSensorListener(3),KSAdSensorManager.unregisterSensorListener(5))}}class ke{constructor(t){this.isListeningSeneor=!1,this.interactionInfo=t}startSensorListener(t,e){var i,a,s,n;this.isListeningSeneor||(this.isListeningSeneor=!0,(null===(a=null===(i=this.interactionInfo)||void 0===i?void 0:i.rotateInfo)||void 0===a?void 0:a.enable)&&this.startRotateListener(t,e),(null===(n=null===(s=this.interactionInfo)||void 0===s?void 0:s.shakeInfo)||void 0===n?void 0:n.enable)&&this.startShakeListener(t,e))}startRotateListener(t,e){var i,a;if("undefined"!=typeof KSAdSensorManager)if(this.initializeRotateHandler(this.interactionInfo.rotateInfo),this.rotateHandler.beforeMonitor(),KSAdSensorManager.supportSensor(2))try{KSAdSensorManager.registerSensorListener(2,-3,(i=>{try{if(e&&e(this.rotateHandler,this.shakeHandler,!1),this.rotateHandler&&this.rotateHandler.canConvertRotate(i)){t&&this.isListeningSeneor&&t(!1,0,this.rotateHandler.maxRotateContent()),this.stopSensorListener();try{KSAdSystemUtil.startVibrate(200)}catch(a){Ot(rt(a))}}}catch(a){Ot("outerError:"+rt(a))}}))}catch(s){}else{if(this.rotateHandler.bidirectionalSwitch)return;(null===(a=null===(i=this.interactionInfo)||void 0===i?void 0:i.rotateInfo)||void 0===a?void 0:a.useImitateRotate)&&(this.sensorImitateRotateUtil=new xe(this.interactionInfo.rotateInfo),this.sensorImitateRotateUtil.registerImitateRotateSensorListener((e=>{try{if(!ft(e)){t&&this.isListeningSeneor&&t(!1,0,e),this.stopSensorListener();try{KSAdSystemUtil.startVibrate(200)}catch(s){Ot(rt(s))}}}catch(s){Ot("outerError:"+rt(s))}}),(t=>{e&&t&&t.length>2&&(this.rotateHandler.xDegree=t[0],this.rotateHandler.yDegree=t[1],this.rotateHandler.zDegree=t[2],e(this.rotateHandler,null,!1))})))}}startShakeListener(t,e){if("undefined"!=typeof KSAdSensorManager){this.initializeShakeHandler(),this.shakeHandler.beforeMonitor();try{KSAdSensorManager.registerSensorListener(1,-3,(i=>{e&&e(this.rotateHandler,this.shakeHandler,!0),this.shakeHandler&&this.shakeHandler.canConvertShake(i)&&(KSAdSystemUtil.startVibrate(200),t&&this.isListeningSeneor&&t(!0,this.shakeHandler.maxAcceleration,""),this.stopSensorListener())}))}catch(i){}}}stopSensorListener(){this.isListeningSeneor=!1,this.stopRotateListener(),this.stopShakeListener()}stopRotateListener(){var t,e;"undefined"!=typeof KSAdSensorManager&&(null===(e=null===(t=this.interactionInfo)||void 0===t?void 0:t.rotateInfo)||void 0===e?void 0:e.enable)&&(this.sensorImitateRotateUtil?this.sensorImitateRotateUtil.unRegisterImitateRotateSensorListener():KSAdSensorManager.unregisterSensorListener(2))}stopShakeListener(){var t,e;"undefined"!=typeof KSAdSensorManager&&(null===(e=null===(t=this.interactionInfo)||void 0===t?void 0:t.shakeInfo)||void 0===e?void 0:e.enable)&&KSAdSensorManager.unregisterSensorListener(1)}initializeShakeHandler(){this.shakeHandler=new Ve(this.interactionInfo)}initializeRotateHandler(t){this.rotateHandler=new be(t)}getRotateHandler(){return this.rotateHandler}getShakeHandler(){return this.shakeHandler}static reportRotateSensorStatus(t){if(bt.supportMinimumTKVersion("5.0.5")&&bt.isAndroid())try{!function(t){Ut({status:5001,ad_style:t})}(t),KSAdSensorManager.supportSensor(1)||function(t){Ut({status:5011,ad_style:t})}(t);let e=!1;KSAdSensorManager.supportSensor(2)||(e=!0,function(t){Ut({status:5002,ad_style:t})}(t));let i=!1;KSAdSensorManager.supportSensor(3)||(i=!0,function(t){Ut({status:5003,ad_style:t})}(t));let a=!1;KSAdSensorManager.supportSensor(5)||(a=!0,function(t){Ut({status:5004,ad_style:t})}(t));let s=!1;KSAdSensorManager.supportSensor(4)||(s=!0,function(t){Ut({status:5008,ad_style:t})}(t)),i&&s&&function(t){Ut({status:5009,ad_style:t})}(t),i&&a&&function(t){Ut({status:5005,ad_style:t})}(t),e&&(i||a)&&function(t){Ut({status:5007,ad_style:t})}(t),e&&(i||s)&&function(t){Ut({status:5010,ad_style:t})}(t)}catch(e){!function(t,e){Ut({status:5006,error_msg:t,ad_style:e})}(rt(e),t)}}}class De{constructor(t,e,i,a,s,n){this.lifeStatus="none",this.adInfo=t,this.adStyle=e,this.configInfo=i,this.containerLimit=a,this.screenOrientation=s,this.originContainerLimit=n}getOriginWidth(){return this.originContainerLimit?this.originContainerLimit.width:0}isCurvedScreen(){return this.containerLimit.width/this.containerLimit.height<1.8}getOriginHeight(){return this.originContainerLimit?this.originContainerLimit.height:0}}class Re extends De{isLandScape(){return 6==this.adInfo.adMaterialInfo.derivativeMaterialType||2==this.adInfo.adMaterialInfo.derivativeMaterialType}}class Ee extends ye{constructor(){super(...arguments),this.hasReportShow=!1,this.hasReportShowShake=!1,this.inShowingOtherVC=!1,this.lifeStatus="none",this.actionText="",this.rotateActionBarText="",this.hasReachSensorTimeInterval=!0,this.downloadState=0}getData(t){let e=[];e.push(Bt.getKsAdDataAsync()),e.push(Bt.getDeviceInfoAsync()),e.push(Bt.getKsAdConfigAsync()),e.push(Bt.getContainerLimitAsync()),e.push(Bt.getScreenOrientationAsync()),Promise.all(e).then((e=>{const i=e[0].data,a=e[1].data,s=e[2].data,n=e[3].data,o=e[4].data;try{this.adInfo=i.impAdInfo[0].adInfo[0],this.adStyle=i.impAdInfo[0].adStyle,this.screenOrientation=o.screenOrientation,this.interactionInfo=function(t,e){let i=D(t,e);if(null==i)return;let a=JSON.parse(i.data);return null!=a?a.interactionInfo:void 0}(this.adInfo,13),this.bidirectionalRotateShakeUtil=new Ae(this.interactionInfo),this.downloadPopupVM=new Te(this.adInfo,this.adStyle,this.configInfo,this.screenOrientation),this.additionalInit()}catch(r){}this.deviceInfo=a,Q(this.deviceInfo),this.configInfo=s,this.containerLimit=n,this.screenOrientation=o.screenOrientation,this.initCallerContext(),t&&t(!0)}))}initCallerContext(){this.callerContext=new Re(this.adInfo,this.adStyle,this.configInfo,this.containerLimit,this.screenOrientation)}checkDataValid(){return!!this.adInfo}getResourceRoot(){return"image/ksad-splash-end-card/"}additionalInit(){this.splashInfo=this.adInfo.adMatrixInfo.adDataV2.splashInfo,this.splashEndCardTKInfo=this.adInfo.adMatrixInfo.adDataV2.splashEndCardTKInfo,this.closeSecond=this.getCountDownSecond(),this.initTime=ot(),this.registerProgressListener(),this.registerLifeStatusListener()}registerLifeStatusListener(){Bt.registerLifecycleListener((t=>{if(t.result&&t.data){const e=t.data.lifeStatus;e!==this.lifeStatus&&this.updateLifeStatus(e)}}))}updateLifeStatus(t){"showEnd"!=t||this.hasReportShow||(this.hasReportShow=!0,this.exposeElement()),"pageVisiable"==t?this.inShowingOtherVC=!1:"pageInvisiable"==t&&(this.inShowingOtherVC=!0),this.lifeStatus=t}exposeElement(){let t=new c;t.universe_feature_freq=9;let e={elementType:87,clientExtData:JSON.stringify(t),business_scene_type:6};jt.log(140,null,e)}registerProgressListener(){this.actionText=_(this.adInfo)?function(t){if(ft(t))return"查看详情";let e=t.adBaseInfo.adActionDescription;return ft(e)&&(e=_(t)?"立即下载":"查看详情"),e}(this.adInfo):"点击查看",bt.isSupportDownloadProgressListen()&&_(this.adInfo)&&Bt.registerProgressListener((t=>{if(t.result){const{status:e,progress:i,totalBytes:a}=t.data,s=Number((100*i).toFixed(0))>100?"100":(100*i).toFixed(0);let n;switch(this.downloadState=e,this.downloadPopupVM.updateDownloadProgress(ve.newInstance(e,i,a)),e){case 0:case 1:case 4:n=this.adInfo.adBaseInfo.adActionDescription,this.rotateActionBarText="或点击"+n;break;case 2:n=`${s}%`,this.rotateActionBarText=n;break;case 3:n="继续下载",this.rotateActionBarText="或点击"+n;break;case 5:n=mt(this.adInfo.adBaseInfo.installAppLabel)?this.adInfo.adBaseInfo.installAppLabel:"点击安装",this.rotateActionBarText="或点击"+n;break;case 6:n=mt(this.adInfo.adBaseInfo.openAppLabel)?this.adInfo.adBaseInfo.openAppLabel:"立即打开",this.rotateActionBarText="或点击"+n}this.actionText=n}}))}convert(t,e,i,a){jt.convertIfNeeded(2,this.adInfo,t,e,i,null,a)}isShowCloseCountDown(){return!ft(this.adInfo.adMatrixInfo.adDataV2.splashEndCardTKInfo.endCardShowCountDown)&&this.adInfo.adMatrixInfo.adDataV2.splashEndCardTKInfo.endCardShowCountDown}getCountDownSecond(){return this.adInfo.adMatrixInfo.adDataV2.splashEndCardTKInfo.endCardShowSecond||5}isSupportFullScreenClick(){return!!ft(this.adInfo.adMatrixInfo.adDataV2.splashEndCardTKInfo.endCardFullScreenClick)||this.adInfo.adMatrixInfo.adDataV2.splashEndCardTKInfo.endCardFullScreenClick}isShowCompliance(){try{return this.adInfo.downloadSafeInfo.complianceInfo.titleBarTextSwitch>0&&_(this.adInfo)&&bt.isAndroid()}catch(t){}return!1}isShowShakeActionBar(){try{return bt.supportMinimumTKVersion("4.0.9")&&!ft(this.interactionInfo.shakeInfo)&&2==S(this.adInfo)&&KSAdSensorManager.supportSensor(1)}catch(t){}return!1}shakeTitle(){try{return mt(this.interactionInfo.shakeInfo.subtitle)?this.interactionInfo.shakeInfo.subtitle:"摇一摇"}catch(t){}return"摇一摇"}shakeActionBarTitle(){let t="";try{if(_(this.adInfo)){const e=this.interactionInfo.actionBarInfo.downloadTexts;switch(this.downloadState){case 6:t=e.openAppLabel;break;case 5:t=e.installAppLabel;break;default:t=e.adActionDescription}}else t=this.interactionInfo.actionBarInfo.title||"跳转详情页或第三方应用"}catch(e){}return mt(t)?"或点击"+t:""}canConvertShake(t){try{if(!ft(t)&&!ft(t.values)){let e=!1,i=0;Y(this.interactionInfo.shakeInfo)?(e=this.bidirectionalRotateShakeUtil.bidireationShakeConvert(t.values),i=Math.max(Math.max(Math.abs(t.values[0]),Math.abs(t.values[1])),Math.abs(t.values[2]))):(i=Math.sqrt(t.values[0]*t.values[0]+t.values[1]*t.values[1]+t.values[2]*t.values[2]),e=i>=z(this.interactionInfo)),!this.inShowingOtherVC&&this.hasReachSensorTimeInterval&&e&&(this.hasReachSensorTimeInterval=!1,this.reOpenSensor(),this.convert(2,{x:0,y:0},At.SHAKE_ICON_SHACK,{splash_shake_acceleration:i,business_scene_type:6}))}}catch(e){}}reOpenSensor(){setTimeout((()=>{this.hasReachSensorTimeInterval=!0}),1500)}reportShakeImpression(){this.hasReportShowShake||(this.hasReportShowShake=!0,jt.exposeElement(205))}startCountDown(){this.stopCountDown(),this.countDownTimer=setInterval((()=>{if(this.closeSecond<=1)return M(this.adInfo)?(this.reportEndCardCloseAction(!1),Pt(3)):bt.supportMinimumTKVersion("4.0.7")?Bt.closePassData({closeType:2}):Bt.close(),void clearInterval(this.countDownTimer);--this.closeSecond}),1e3)}stopCountDown(){this.countDownTimer&&clearInterval(this.countDownTimer)}isNeedScale(t){return this.containerLimit.height<t&&bt.supportMinimumTKVersion("4.0.10")}isShowTransparentEndPage(){try{return this.adInfo.adMatrixInfo.adDataV2.splashEndCardTKInfo.showTransparentEndCard}catch(t){}return!1}reportEndCardCloseAction(t){let e=new c;e.duration=ot()-this.initTime;let i={business_scene_type:6,itemCloseType:t?1:2,clientExtData:JSON.stringify(e)};jt.log(3,null,i)}isEnableShowRotateActionBar(){return bt.supportMinimumTKVersion("5.0.0")&&this.splashEndCardTKInfo.isEnableRotate}isEnableSlide(){return this.splashEndCardTKInfo.isEnableSlide}getRotateTitle(){var t;return(null===(t=this.splashInfo.interactionInfo)||void 0===t?void 0:t.rotateInfo.title)||"扭一扭"}isSensorCanConvert(){return!this.inShowingOtherVC}startSensorListener(){this.sensorUtil||(this.sensorUtil=new ke(this.splashInfo.interactionInfo)),this.sensorUtil.startSensorListener(((t,e,i)=>{this.isSensorCanConvert()&&(t?this.convert(2,{x:0,y:0},At.SHAKE_ICON_SHACK,{business_scene_type:6,splash_shake_acceleration:e}):this.convert(2,{x:0,y:0},At.ROTATE_ICON_ROTATE,{business_scene_type:6,splash_interaction_rotate_angle:i}))}),((t,e,i)=>{!i&&this.rotateInfoCallback&&t&&this.rotateInfoCallback(t.xDegree,t.yDegree,t.zDegree)}))}stopSensorListener(){var t;null===(t=this.sensorUtil)||void 0===t||t.stopSensorListener()}getRotateContent(){var t;return(null===(t=this.splashInfo.interactionInfo)||void 0===t?void 0:t.actionBarInfo.title)||"跳转详情页或第三方应用"}tryConvertSlideEvent(t,e,i,a,s){if(!this.isEnableSlide())return;const n=i-t,o=a-e;this.canHitSwipeEvent(n,o,10)&&(Math.abs(n)>=Math.abs(o)?this.convert(s,{x:0,y:0},At.CARD_SWIPE_CONVERT,{finger_swipe_type:n>0?3:2,finger_swipe_distance:n,business_scene_type:6}):this.convert(s,{x:0,y:0},At.CARD_SWIPE_CONVERT,{finger_swipe_type:o>0?4:1,finger_swipe_distance:o,business_scene_type:6}))}canHitSwipeEvent(t,e,i){return!(Math.abs(t)<i&&Math.abs(e)<i)}isEnableFullScreenClickExpand(){return this.splashEndCardTKInfo.endCardFullScreenClickExpand}}class Be extends Ee{constructor(t,e,i,a){super(),this.adInfo=t,this.configInfo=e,this.containerLimit=i,this.screenOrientation=a,this.additionalInit()}}class Pe extends TKView{constructor(t,e){super(),this.isAnimStarting=!1,this.vm=t,this.viewWH=e,this.setupView(),this.setupData()}setupView(){this.style={width:2*this.viewWH,height:2*this.viewWH},this.shakeAnimationView=new TKView,this.shakeAnimationView.style={width:2*this.viewWH,height:2*this.viewWH},this.appendChild(this.shakeAnimationView),this.shakeImage=new TKImage,this.shakeImage.style={width:this.viewWH,height:this.viewWH,left:0,top:0,position:"absolute"},this.shakeImage.setSrc(this.vm.getResourceRoot()+"icon_ksad_endcard_shake.png"),this.shakeAnimationView.appendChild(this.shakeImage)}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.startShakeAnimation();break;case"hideEnd":case"pageInvisiable":this.stopShakeAnimation()}}))}startShakeAnimation(){if(this.isAnimStarting)return;this.stopShakeAnimation(),this.isAnimStarting=!0,this.addShakeAnim();const t=this;this.shakeAnimationTimer=setInterval((()=>{t.addShakeAnim()}),1200);try{KSAdSensorManager.registerSensorListener(1,-3,(t=>{this.vm.canConvertShake(t)}))}catch(e){}}addShakeAnim(){const t=new TKKeyframeAnimation;t.animType="rotationZ";let e=bt.isAndroid()?.8:1;t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:bt.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-bt.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:bt.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-bt.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:bt.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}],t.duration=1500,t.repeatCount=0,this.shakeAnimationView&&this.shakeAnimationView.addAnimation(t,"shakeAnimation")}stopShakeAnimation(){this.isAnimStarting=!1,KSAdSensorManager.unregisterSensorListener(1),this.shakeAnimationTimer&&(clearInterval(this.shakeAnimationTimer),this.shakeAnimationTimer=0),this.shakeAnimationView&&this.shakeAnimationView.removeAllAnimation()}}class Ke extends TKView{constructor(t,e){super(),this.downloadState=0,this.vm=t,this.showContainer=e,this.setupView(),this.setupAction(),pe(this.vm.$attrsPath.showPopupView,(t=>{console.log("jky KSAdDownloadPopup needShowPopupView: "+t),this.updatePopViewState(t)})),pe(this.vm.$attrsPath.downloadState,(t=>{this.updateControlBtnState(this.vm.isDownloadPaused())})),pe(this.vm.$attrsPath.descText,(t=>{this.desText&&t&&this.desText.setText(t)}))}setupView(){this.style={width:"100%",height:"100%",alignItems:"center",opacity:0,position:"absolute"},this.baseContainer=new TKView,this.baseContainer.style={alignItems:"center",justifyContent:"center",width:245,height:36,top:10,shadow:"0 0 8 #00000099",backgroundColor:"#FFFFFF",borderRadius:120,flexDirection:"row"},this.appendChild(this.baseContainer),this.closeButton=new TKImage,this.closeButton.style={marginStart:10,justifyContent:"center",width:10,height:10},this.closeButton.setSrc("image/ksad-compose-image/ksad_icon_close.png"),this.baseContainer.appendChild(this.closeButton),this.desText=new TKText,this.desText.style={marginStart:10,width:77,fontSize:12,textAlign:"left",includeFontPadding:!1,color:"#222222",fontWeight:"200"},this.desText.setText(this.vm.getDesText()),this.baseContainer.appendChild(this.desText),this.continueButton=new TKText,this.continueButton.style={marginStart:12,width:52,height:20,borderRadius:100,borderWidth:.5,borderColor:"#FE3666",color:"#F66484",fontSize:12,textAlign:"center"},this.updateControlBtnState(!1),this.baseContainer.appendChild(this.continueButton),this.delButton=new TKText,this.delButton.style={marginStart:8,width:52,height:20,borderRadius:100,borderWidth:.5,borderColor:"#4D666666",color:"#666666",fontSize:12,textAlign:"center"},this.delButton.setText("删除"),this.baseContainer.appendChild(this.delButton)}setupAction(){this.baseContainer.addEventListener("tap",(t=>{})),this.closeButton.addEventListener("tap",(t=>{this.vm.onCloseClick(),this.vm.showPopupView=!1})),this.continueButton.addEventListener("tap",(t=>{this.vm.convert(1,1,{x:t.position.rawX,y:t.position.rawY},At.ACTION_BAR_CLICK),this.vm.isNeedShowDownloading()||this.dismissPopup()})),this.delButton.addEventListener("tap",(t=>{var e;e=t=>{Bt.showToast(this.vm.getDeleteToast())},Bt.callNativeWithCallback("cancelAppDownloadForAd",null,e),this.dismissPopup()}))}updatePopViewState(t){console.log("jky updatePopViewState: show: "+t+", isShow: "+this.isShow),t?this.isShow||(this.showContainer.appendChild(this),this.isShow=!0,this.startShowAnimation()):this.isShow&&(this.showContainer.removeChild(this),this.isShow=!1,this.dismissPopup())}updateControlBtnState(t){t?this.continueButton.setText("继续"):this.continueButton.setText("暂停")}startShowAnimation(){this.style={visibility:"visible"};const t=new TKKeyframeAnimation;t.setAnimations([()=>(this.style={marginTop:48,opacity:0},0),()=>(this.style={marginTop:64,opacity:1},1)]),t.duration=600,t.repeatCount=1,this.addAnimation(t,"popupShowAnimation")}dismissPopup(){const t=new TKKeyframeAnimation;t.setAnimations([()=>(this.style={opacity:1},0),()=>(this.style={opacity:0},1)]),t.duration=300,t.repeatCount=1,this.addAnimation(t,"popupDismissAnimation"),this.style={visibility:"hidden"}}setMarginTop(t){this.baseContainer.style={top:t}}}class Ne extends TKView{constructor(t,e){super(),this.lottieViewWidth=78,this.lottieViewHeight=62,this.isAnimationRunning=!1,this.vm=t,this.viewWH=e,this.scale=Math.min(e.width/this.lottieViewWidth,e.height/this.lottieViewHeight),this.setupView(),this.setupAction()}setupView(){this.style={width:this.viewWH.width,height:this.viewWH.height},this.rotateAnimationView=new TKView,this.rotateAnimationView.style={width:this.lottieViewWidth,height:this.lottieViewHeight,alignItems:"center",transform:{scale:this.scale,translate:{x:Math.ceil(this.lottieViewWidth*(this.scale-1)/2),y:Math.ceil(this.lottieViewHeight*(this.scale-1)/2)}}},this.appendChild(this.rotateAnimationView),bt.supportMinimumTKVersion("5.0.0")&&(this.rotateView=new TKLottieImageView,this.rotateView.style={top:6,width:56,height:56,position:"absolute"},this.setRotateLottieView("image/ksad-splash-end-card/ksad_endcard_rotate_icon.json",this.rotateView,!0),this.arrowView=new TKLottieImageView,this.arrowView.style={width:80,height:27,position:"absolute"},this.setRotateLottieView("image/ksad-splash-end-card/ksad_endcard_rotate_arrow.json",this.arrowView,!1),this.vm.rotateInfoCallback=(t,e,i)=>{let a=Math.abs(t)/this.vm.splashInfo.interactionInfo.rotateInfo.x.rotateDegree,s=Math.abs(e)/this.vm.splashInfo.interactionInfo.rotateInfo.y.rotateDegree,n=Math.abs(i)/this.vm.splashInfo.interactionInfo.rotateInfo.z.rotateDegree,o=Math.max(a,s,n);this.arrowView.setProgress(o>1?1:o<0?0:o)})}setupAction(){pe(this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.startRotateAnimation();break;case"hideEnd":case"pageInvisiable":this.stopRotateAnimation()}}))}setRotateLottieView(t,e,i){e.setUri(t),e.setLoop(i),e.enabled=!1,this.rotateAnimationView.appendChild(e)}startRotateAnimation(){var t;this.isAnimationRunning||(this.stopRotateAnimation(),this.isAnimationRunning=!0,null===(t=this.rotateView)||void 0===t||t.resume(),this.vm.startSensorListener())}stopRotateAnimation(){var t;this.isAnimationRunning&&(null===(t=this.rotateView)||void 0===t||t.stop(),this.vm.stopSensorListener(),this.isAnimationRunning=!1)}}class Fe extends Jt{constructor(t){super(),this.contentHeight=0,this.isNeedScale=!1,this.vm=t,this.isCurvedScreen=this.vm.callerContext.isCurvedScreen(),this.isLandScape=this.vm.callerContext.isLandScape(),this.setupViews(),this.bindEvent(),me(this.vm,this.vm.$attrsPath.closeSecond,(t=>{this.closeTime&&this.closeTime.setText(t+"s")})),me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.vm.startCountDown();break;case"pageInvisiable":case"hideEnd":this.vm.stopCountDown()}})),M(this.vm.adInfo)&&this.vm.startCountDown()}setupViews(){this.style={width:"100%",height:"100%"},this.vm.isShowTransparentEndPage()||this.appendBgView(),this.appendContnetView(),this.contentHeight+=10,this.isNeedScale=this.vm.isNeedScale(this.contentHeight),this.dialogView.style={height:this.contentHeight},this.setupDownloadPopup(),this.showAnimation()}setupDownloadPopup(){G(this.vm.adInfo)&&(this.downloadPopup=new Ke(this.vm.downloadPopupVM,this))}bindEvent(){this.vm.isSupportFullScreenClick()&&(this.giftView.addEventListener("tap",(t=>{this.vm.convert(2,pt(t,this.giftView),At.PLAYEND_ICON_OTHERAREA_CLICK,{business_scene_type:6})})),this.iconImg.addEventListener("tap",(t=>{this.vm.convert(2,pt(t,this.iconImg),At.PLAY_END_ICON_CLICK,{business_scene_type:6})})),this.appName.addEventListener("tap",(t=>{this.vm.convert(2,pt(t,this.appName),At.PLAY_END_ICON_TITLE_CLICK,{business_scene_type:6})})),this.appDescView.addEventListener("tap",(t=>{this.vm.convert(2,pt(t,this.appDescView),At.PLAY_END_ICON_DESCRIPTION_CLICK,{business_scene_type:6})})),this.addSwipeEvent(this.giftView,2),this.addSwipeEvent(this.iconImg,2),this.addSwipeEvent(this.appName,2),this.addSwipeEvent(this.appDescView,2),this.vm.isEnableFullScreenClickExpand()&&(this.clickAreaView.addEventListener("tap",(t=>{this.vm.convert(2,pt(t,this.clickAreaView),At.PLAYEND_ICON_OTHERAREA_CLICK,{business_scene_type:6})})),this.addSwipeEvent(this.clickAreaView,2))),this.actionBarView.addEventListener("tap",(t=>{this.vm.convert(1,pt(t,this.actionBarView),At.PLAY_END_ACTION_BAR_CLICK,{business_scene_type:6})})),this.addSwipeEvent(this.actionBarView,1),this.closeImg.addEventListener("tap",(t=>{if(M(this.vm.adInfo))this.vm.reportEndCardCloseAction(!0),Pt(2);else if(bt.supportMinimumTKVersion("4.0.7"))Bt.closePassData({closeType:1});else{let t={business_scene_type:6},e={actionType:3,payload:JSON.stringify(t)};Bt.sendLog(e),Bt.close()}}))}appendBgView(){this.blurBg=new TKBlurImage,this.blurBg.style={left:0,top:0,width:"100%",height:"100%",resize:"cover",position:"absolute"},this.blurBg.setBlurRadius(20),this.blurBg.setSrc(A(this.vm.adInfo)),this.appendChild(this.blurBg)}appendContnetView(){this.contentView=new TKView,this.contentView.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",backgroundColor:"#00000099"},this.appendChild(this.contentView),this.dialogView=new TKView,this.dialogView.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},this.contentView.appendChild(this.dialogView),this.clickAreaView=new TKView,this.clickAreaView.style={width:327,justifyContent:"center",alignItems:"center"},this.dialogView.appendChild(this.clickAreaView),this.appendContentTitleIcon(),this.apendContentGiftView(),this.vm.isEnableShowRotateActionBar()?this.appendRotateActionBarView():this.vm.isShowShakeActionBar()?this.appendShakeActionBarView():this.appendActionBarView(),this.appendCloseView()}appendContentTitleIcon(){this.contentHeight+=32,this.titleImg=new TKImage,this.titleImg.style={width:220,height:32,resize:"cover"},this.titleImg.setSrc(this.vm.getResourceRoot()+"icon_ksad_endcard_title.png"),!this.isLandScape&&this.clickAreaView.appendChild(this.titleImg)}apendContentGiftView(){this.giftView=new TKView,this.giftView.style={width:this.isLandScape?this.isCurvedScreen?184:163:327,height:this.isLandScape?this.isCurvedScreen?247:206:412,marginTop:this.isLandScape?20:7,alignItems:"center"},this.contentHeight+=Number(this.giftView.style.height)+Number(this.giftView.style.marginTop),this.clickAreaView.appendChild(this.giftView),this.giftImage=new TKImage,this.giftImage.style={width:this.isLandScape?this.isCurvedScreen?130:163:327,height:this.isLandScape?this.isCurvedScreen?164:206:412,position:"absolute",left:0,top:0},this.giftImage.setSrc(this.vm.getResourceRoot()+"icon_ksad_endcard_giftbox.png"),this.giftView.appendChild(this.giftImage),this.appendAppIconView(),this.appendAppNameView(),this.appendAppDescView(),this.appendLogo(),this.appendPrivacyView()}appendAppIconView(){this.iconImg=new TKImage,this.iconImg.style={width:this.isLandScape?this.isCurvedScreen?40:50:100,height:this.isLandScape?this.isCurvedScreen?40:50:100,borderRadius:24,marginTop:this.isLandScape?this.isCurvedScreen?48:60:120},this.iconImg.setSrc(v(this.vm.adInfo)),this.giftView.appendChild(this.iconImg)}appendAppNameView(){this.appName=new TKText,this.appName.style={height:this.isLandScape?18:30,textAlign:"center",fontSize:this.isLandScape?14:20,fontWeight:"medium",color:"#222222",marginTop:8,maxWidth:this.isLandScape?120:230,textOverflow:"ellipsis",textLineClamp:1},this.appName.setText(L(this.vm.adInfo)),this.giftView.appendChild(this.appName)}appendAppDescView(){this.appDescView=new TKText,this.appDescView.style={color:"#FFFFFF",fontSize:this.isLandScape?10:16,marginTop:this.isLandScape?10:34,height:this.isLandScape?50:68,textLineHeight:this.isLandScape?this.isCurvedScreen?12:15:24,textOverflow:"ellipsis",textLineClamp:2,fontWeight:"medium",width:"100%",paddingLeft:this.isLandScape?24:36,paddingRight:this.isLandScape?24:36,textAlign:"center"},this.appDescView.setText(this.vm.adInfo.adBaseInfo.adDescription),this.giftView.appendChild(this.appDescView)}appendLogo(){this.logoView=new we(3,this.vm.adInfo),this.logoView.style={position:"absolute",left:this.isLandScape?4:12,bottom:this.isLandScape?4:10,transform:{scale:.8}},this.giftView.appendChild(this.logoView)}appendPrivacyView(){if(!this.vm.isShowCompliance())return;const t=this.vm.containerLimit.width-30;this.privacyView=new fe(this.vm.adInfo,this.vm.screenOrientation,t,""),this.privacyView.style={position:"absolute",bottom:this.isLandScape?null:12,top:this.isLandScape?0:null,left:0,opacity:.6},this.privacyView.clickCallback=(t,e)=>{Bt.openURL(t,e)},this.contentView.appendChild(this.privacyView)}appendRotateActionBarView(){this.actionBarView=new TKView,this.actionBarView.style={marginTop:this.isLandScape?6:16,width:this.isLandScape?120:200,height:this.isLandScape?36:60,alignItems:"center",flexDirection:"column"},this.contentHeight+=Number(this.actionBarView.style.height)+Number(this.actionBarView.style.marginTop),this.actionBarImg=new TKImage,this.actionBarImg.style={width:this.isLandScape?120:200,height:this.isLandScape?36:60,position:"absolute",left:0,top:0},this.actionBarImg.setSrc(this.vm.getResourceRoot()+"icon_ksad_endcard_high_btn.png"),this.actionBarView.appendChild(this.actionBarImg);let t=new TKView;t.style={width:"100%",height:this.isLandScape?28:56,top:0,justifyContent:"center",flexDirection:"row"},this.actionBarView.appendChild(t),this.rotateActionView=new Ne(this.vm,{width:this.isLandScape?12:24,height:this.isLandScape?12:24}),this.rotateActionView.style={marginRight:this.isLandScape?2:4,marginTop:this.isLandScape?4:10},t.appendChild(this.rotateActionView),this.actionBarTitle=new TKText,this.actionBarTitle.style={marginTop:this.isLandScape?5:10,height:this.isLandScape?13:20,fontSize:this.isLandScape?10:16,color:"#FFFFFF",textOverflow:"ellipsis",textLineClamp:1,fontWeight:"medium"},this.actionBarTitle.setText(this.vm.getRotateTitle()),t.appendChild(this.actionBarTitle),this.actionBarSubTitle=new TKText,this.actionBarSubTitle.style={bottom:this.isLandScape?5:10,fontSize:this.isLandScape?7:10,maxWidth:this.isLandScape?110:200,marginTop:4,color:"#FFFFFF",textOverflow:"ellipsis",textLineClamp:1,position:"absolute"},_(this.vm.adInfo)?de(this.actionBarSubTitle,"text",this.vm.$attrsPath.rotateActionBarText):this.actionBarSubTitle.setText("或点击"+this.vm.getRotateContent()),this.actionBarView.appendChild(this.actionBarSubTitle),this.clickAreaView.appendChild(this.actionBarView)}appendShakeActionBarView(){this.contentHeight+=this.isLandScape?38:76,this.actionBarView=new TKView,this.actionBarView.style={marginTop:this.isLandScape?8:16,width:this.isLandScape?100:200,height:this.isLandScape?30:60,alignItems:"center",flexDirection:"column"},this.actionBarImg=new TKImage,this.actionBarImg.style={width:this.isLandScape?100:200,height:this.isLandScape?30:60,position:"absolute",left:0,top:0},this.actionBarImg.setSrc(this.vm.getResourceRoot()+"icon_ksad_endcard_high_btn.png"),this.actionBarView.appendChild(this.actionBarImg);let t=new TKView;t.style={width:"100%",height:this.isLandScape?28:56,top:0,justifyContent:"center",flexDirection:"row"},this.actionBarView.appendChild(t),this.shakeActionBar=new Pe(this.vm,this.isLandScape?12:24),this.shakeActionBar.style={marginRight:this.isLandScape?12:void 0,marginTop:this.isLandScape?4:8},t.appendChild(this.shakeActionBar),this.actionBarTitle=new TKText,this.actionBarTitle.style={marginTop:this.isLandScape?5:10,marginLeft:-20,height:20,fontSize:this.isLandScape?10:16,color:"#FFFFFF",textOverflow:"ellipsis",textLineClamp:1,fontWeight:"medium"},this.actionBarTitle.setText(this.vm.shakeTitle()),t.appendChild(this.actionBarTitle),this.actionBarSubTitle=new TKText,this.actionBarSubTitle.style={bottom:this.isLandScape?5:10,fontSize:this.isLandScape?7:10,marginTop:4,color:"#FFFFFF",textOverflow:"ellipsis",textLineClamp:1,position:"absolute"},this.actionBarSubTitle.setText(this.vm.shakeActionBarTitle()),this.actionBarView.appendChild(this.actionBarSubTitle),this.clickAreaView.appendChild(this.actionBarView),this.vm.reportShakeImpression()}appendActionBarView(){this.contentHeight+=this.isLandScape?38:64,this.actionBarView=new TKView,this.actionBarView.style={marginTop:this.isLandScape?8:16,width:this.isLandScape?120:200,height:this.isLandScape?28:48,justifyContent:"center",alignItems:"center",flexDirection:"column"},this.actionBarImg=new TKImage,this.actionBarImg.style={width:this.isLandScape?120:200,height:this.isLandScape?28:48,position:"absolute",left:0,top:0},this.actionBarImg.setSrc(this.vm.getResourceRoot()+"icon_ksad_endcard_btn.png"),this.actionBarView.appendChild(this.actionBarImg),this.actionBarTitle=new TKText,this.actionBarTitle.style={fontSize:this.isLandScape?10:16,color:"#FFFFFF",textOverflow:"ellipsis",textLineClamp:1,fontWeight:"medium"},de(this.actionBarTitle,"text",this.vm.$attrsPath.actionText),this.actionBarView.appendChild(this.actionBarTitle),_(this.vm.adInfo)||(this.actionBarSubTitle=new TKText,this.actionBarSubTitle.style={fontSize:this.isLandScape?7:10,color:"#FFFFFF",textOverflow:"ellipsis",textLineClamp:1,marginTop:2},this.actionBarSubTitle.setText("跳转详情页/第三方应用"),this.actionBarView.appendChild(this.actionBarSubTitle)),this.clickAreaView.appendChild(this.actionBarView)}appendCloseView(){this.contentHeight+=38,this.closeView=new TKView,this.closeView.style={height:24,marginTop:this.isLandScape?8:14,paddingLeft:this.vm.isShowCloseCountDown()?12:4,paddingRight:this.vm.isShowCloseCountDown()?12:4,borderRadius:12,borderColor:"#FFFFFF66",borderWidth:1,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.vm.isShowCloseCountDown()&&(this.closeTime=new TKText,this.closeTime.style={color:"#FFFFFFC8",fontSize:12},this.closeTime.setText(this.vm.closeSecond+"s"),this.closeView.appendChild(this.closeTime),this.closeTimeLine=new TKText,this.closeTimeLine.style={color:"#FFFFFFC8",fontSize:12,marginLeft:6,marginRight:4,marginBottom:2},this.closeTimeLine.setText("|"),this.closeView.appendChild(this.closeTimeLine)),this.closeImg=new TKImage,this.closeImg.style={width:16,height:16},this.closeImg.setSrc(this.vm.getResourceRoot()+"icon_ksad_endcard_close.png"),this.closeView.appendChild(this.closeImg),this.dialogView.appendChild(this.closeView)}showAnimation(){this.contentView&&this.contentView.addAnimation(this.getAlphaAnimation(this.contentView),"alphaAnimation"),this.dialogView&&(this.dialogView.addAnimation(this.getAlphaAnimation(this.dialogView),"alphaAnimation"),this.dialogView.addAnimation(this.getScaleAnimation(this.dialogView),"scaleAnimation")),this.appDeveloperText&&this.appDeveloperText.addAnimation(this.getAlphaAnimation(this.appDeveloperText),"alphaAnimation")}getAlphaAnimation(t){const e=new TKKeyframeAnimation;return e.setAnimations([()=>(t.style={opacity:0},0),()=>(t.style={opacity:1},1)]),e.duration=300,e}getScaleAnimation(t){const e=new TKKeyframeAnimation;return e.setAnimations([()=>(t.style={transform:{scale:this.isNeedScale?.6:.8}},0),()=>(t.style={transform:{scale:this.isNeedScale?.8:1}},1)]),e.duration=300,e}addSwipeEvent(t,e){if(bt.supportMinimumTKVersion("5.0.0")){let i=0,a=0;t.addEventListener("down",(t=>{i=t.position.x,a=t.position.y})),t.addEventListener("up",(t=>{let s=t.position.x,n=t.position.y;this.vm.tryConvertSlideEvent(i,a,s,n,e)}))}}}class Me extends TKView{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.isLandScape=this.vm.callerContext.isLandScape(),this.setupViews(),this.setupData(),this.setupActions(),me(this.vm,this.vm.$attrsPath.showEndPage,(t=>{t&&this.pageDeallocAction()})),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupViews(){this.style={position:"absolute",flexDirection:"column",width:"100%",height:200,bottom:0,left:0,gradientBgColor:"90, #00000059, #00000000"},this.rotateArrowImage=new TKImage,this.rotateArrowImage.style={alignSelf:"center",width:67,height:24,marginTop:23,marginBottom:0},this.rotateArrowImage.setSrc("image/ksad-splash-play-card/ic_top_rotate_arrow.png"),this.appendChild(this.rotateArrowImage),this.rotatePhoneImage=new TKImage,this.rotatePhoneImage.style={alignSelf:"center",width:44,height:62,marginBottom:this.isLandScape?10:15},this.rotatePhoneImage.setSrc("image/ksad-splash-play-card/ic_rotate_phone_vertical.png"),this.appendChild(this.rotatePhoneImage),this.title=new TKText,this.title.style={alignSelf:"center",color:"#FFFFFF",fontSize:this.isLandScape?14:16,fontWeight:"medium",textAlign:"center",shadow:"1 1 1 #00000099",marginBottom:3,width:"100%"},this.title.setText(this.vm.getSplashRotateTitle()),this.title.enabled=!1,this.appendChild(this.title),this.subTitle=new TKText,this.subTitle.style={alignSelf:"center",color:"#FFFFFF",fontSize:this.isLandScape?10:12,fontWeight:"medium",textAlign:"center",shadow:"1 1 1 #00000099",marginBottom:34,width:"100%"},this.subTitle.setText(this.vm.getSplashRotateSubtitle()),this.subTitle.enabled=!1,this.appendChild(this.subTitle)}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"hideEnd":this.pageDeallocAction();break;case"pageVisiable":this.pageShowAction();break;case"pageInvisiable":this.vm.stopSensorListener()}}))}pageShowAction(){this.alreadyShow?this.vm.playcardShowEnd||this.vm.startSensorListener():(this.alreadyShow=!0,this.vm.startSensorListener(),this.startRotateAnimation(),KSAdSensorManager.supportSensor(2)||jt.log(914,null,null),this.vm.reportElementActionBarImpression(184))}pageDeallocAction(){this.vm.stopSensorListener(),this.rotateAnimationTimer&&(clearInterval(this.rotateAnimationTimer),this.rotateAnimationTimer=0),this.rotatePhoneImage&&this.rotatePhoneImage.removeAllAnimation()}setupActions(){this.rotateArrowImage.addEventListener("tap",(t=>{this.vm.convert(1,{x:t.position.rawX,y:t.position.rawY},At.ROTATE_BIG_ICON_CLICK)})),this.rotatePhoneImage.addEventListener("tap",(t=>{this.vm.convert(1,{x:t.position.rawX,y:t.position.rawY},At.ROTATE_BIG_ICON_CLICK)}))}startRotateAnimation(){this.addRotateAnim();const t=this;this.rotateAnimationTimer=setInterval((()=>{t.addRotateAnim()}),3180)}addRotateAnim(){if(!this.rotatePhoneImage)return;const t=new TKKeyframeAnimation,e=this;t.setAnimations([()=>(e.rotatePhoneImage.style={transform:{rotate:0}},0),()=>(e.rotatePhoneImage.style={transform:{rotate:-25}},.16),()=>(e.rotatePhoneImage.style={transform:{rotate:-25}},.26),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},.28),()=>(e.rotatePhoneImage.style={transform:{rotate:12}},.3),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},.31),()=>(e.rotatePhoneImage.style={transform:{rotate:-12}},.33),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},.34),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},.5),()=>(e.rotatePhoneImage.style={transform:{rotate:25}},.66),()=>(e.rotatePhoneImage.style={transform:{rotate:25}},.76),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},.78),()=>(e.rotatePhoneImage.style={transform:{rotate:-12}},.8),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},.81),()=>(e.rotatePhoneImage.style={transform:{rotate:12}},.83),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},.84),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},1)]),t.duration=3180,t.timingFunction="linear",this.rotatePhoneImage.addAnimation(t,"rotateAnimation")}}class He extends TKView{requestDraw(){}}let Oe;Oe="undefined"==typeof Canvas2DView?He:Canvas2DView;class We extends Oe{}class Ue extends We{constructor(t,e,i,a=!0){if(super(),this.hasDownEvent=!1,bt.supportMinimumTKVersion("5.0.0")){const s=new Paint;s.setColor("#FFFFFF64"),s.setStrokeWidth(14),s.setStyle(1),s.setJoin(2),s.setCap(1);const n=new Path;let o=0,r=0,h=0,l=0,c=0,d=0;this.addEventListener("down",(t=>{h=t.position.x,l=t.position.y,c=h,d=l,n.reset(),n.moveTo(h,l),o=h,r=l,a&&this.requestDraw(),this.hasDownEvent=!0})),this.addEventListener("up",(s=>{let o=s.position.x,r=s.position.y;this.canConvertClick(c,d,o,r)?i(o,r):this.canHitSwipeEvent(c,d,h,l,t)&&this.hasDownEvent&&(this.hasDownEvent=!1,e(c,d,h,l)),setTimeout((()=>{a&&(n.reset(),this&&this.requestDraw())}),200)})),this.addEventListener("pan",(t=>{let e=0,i=0;bt.isAndroid()?(e=t.translation.deltaX+h,i=t.translation.deltaY+l):(e=t.translation.deltaX+c,i=t.translation.deltaY+d),h=e,l=i;let s=Math.abs(e-o),p=Math.abs(i-r);(s>=5||p>=5)&&(n.quadTo(o,r,(e+o)/2,(i+r)/2),o=e,r=i,a&&this.requestDraw())})),this.onDraw=t=>{a&&t.drawPath(n,s)}}}canConvertClick(t,e,i,a){return Math.abs(i-t)>=0&&Math.abs(i-t)<10&&Math.abs(a-e)>=0&&Math.abs(a-e)<10}canHitSwipeEvent(t,e,i,a,s){const n=i-t,o=a-e;return!(Math.abs(n)<s&&Math.abs(o)<s)}}class ze extends TKView{constructor(t){super(),this.btnLotties=[],this.cardLotties=[],this.alreadyShow=!1,this.hasCompleteTranslate=!1,this.vm=t,this.initLottieData(),this.setupViews(),this.setupData(),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.pageShowAction();break;case"hideEnd":this.pageDeallocAction()}})),me(this.vm,this.vm.$attrsPath.pageHasVisibled,(t=>{t&&this.pageShowAction()})),this.vm.getActionBarRect=()=>{var t;return{x:65,y:(null===(t=this.cardLottieView)||void 0===t?void 0:t.getOrigin().y)-80,width:this.vm.containerLimit.width-130,height:60}}}initLottieData(){this.btnLotties=[],this.cardLotties=[],9==this.vm.getActionBarInteractiveStyle()?(this.btnLotties.push("bundle://image/ksad-splash-play-card/ic_shake_combine_white.json"),this.btnLotties.push("bundle://image/ksad-splash-play-card/ic_shake_combine_black.json")):(this.btnLotties.push("bundle://image/ksad-splash-play-card/white_btn.json"),this.btnLotties.push("bundle://image/ksad-splash-play-card/black_btn.json")),this.vm.callerContext.isLandScape()?this.cardLotties.push("bundle://image/ksad-splash-play-card/white_card_land.json"):this.cardLotties.push("bundle://image/ksad-splash-play-card/white_card.json"),this.vm.callerContext.isLandScape()?this.cardLotties.push("bundle://image/ksad-splash-play-card/black_card_land.json"):this.cardLotties.push("bundle://image/ksad-splash-play-card/black_card.json")}setupViews(){this.style={position:"absolute",alignItems:"center",width:"100%",height:"100%"},this.appendActionBarLottieView(),this.appendActionBarDescInfo()}appendActionBarLottieView(){let t=0;if(t=1==this.vm.getSplashCombinedStyle()||83==this.vm.getSplashCombinedStyle()?0:1,1==this.vm.getSplashCombinedStyle()||83==this.vm.getSplashCombinedStyle()){let t=new TKView;t.style={position:"absolute",bottom:0,left:0,width:"100%",height:160,gradientBgColor:"-90,00000000,00000080 0.88"},this.appendChild(t)}bt.supportMinimumTKVersion("5.0.0")&&(this.cardLottieView=new TKLottieImageView,this.cardLottieView.style={position:"absolute",bottom:this.vm.callerContext.isLandScape()?-75:-70,left:6,right:6,height:70},this.appendChild(this.cardLottieView),this.actionBarLottieView=new TKLottieImageView,this.actionBarLottieView.style={position:"absolute",bottom:70,left:this.vm.callerContext.isLandScape()?110*this.vm.containerLimit.width/375:0,width:this.vm.callerContext.isLandScape()?"40%":"100%",height:100},this.appendChild(this.actionBarLottieView),this.actionBarLottieView.setUri(this.btnLotties[t]),this.cardLottieView.setUri(this.cardLotties[t]),bt.isAndroid()||(this.actionBarLottieView.enabled=!1,this.cardLottieView.enabled=!1))}appendActionBarDescInfo(){let t=this.vm.containerLimit.width/375,e=new TKText;e.style={color:"#FFFFFF",fontSize:16,position:"absolute",bottom:this.vm.callerContext.isLandScape()?118:121,left:this.vm.callerContext.isLandScape()?178*t:168*t},e.enabled=!1,this.subTitle=new TKText,this.subTitle.style={color:"#FFFFFF99",fontSize:12,position:"absolute",bottom:98,left:0,right:0,textAlign:"center"},this.subTitle.enabled=!1,9==this.vm.getActionBarInteractiveStyle()?(e.setText(this.vm.getSplashShakeTitle()),this.subTitle.setText(this.vm.getSplashShakeActionBarText())):(e.setText(this.vm.getSplashRotateTitle()),this.subTitle.setText(this.vm.getSplashRotateSubtitle())),this.appendChild(e),this.appendChild(this.subTitle)}pageShowAction(){this.alreadyShow||(this.alreadyShow=!0,this.startTranslateAnimation())}pageDeallocAction(){this.hasCompleteTranslate&&this.showTimer&&(bt.supportMinimumTKVersion("5.0.0")&&(this.cardLottieView.stop(),this.actionBarLottieView.stop()),clearInterval(this.showTimer),this.showTimer=0)}startTranslateAnimation(){var t;let e=this;const i=new TKKeyframeAnimation;i.setAnimations([()=>(bt.supportMinimumTKVersion("5.0.0")&&(e.cardLottieView.style={transform:{translate:{y:0}},opacity:0}),0),()=>(bt.supportMinimumTKVersion("5.0.0")&&(e.cardLottieView.style={transform:{translate:{y:-70}},opacity:1}),1)]),i.timingFunction="ease-out",i.duration=300,i.on("end",(()=>{e.hasCompleteTranslate=!0,e.animationPlay(200)})),bt.supportMinimumTKVersion("5.0.0")&&(null===(t=this.cardLottieView)||void 0===t||t.addAnimation(i,"cardShowAnimation"))}animationPlay(t){setTimeout((()=>{bt.supportMinimumTKVersion("5.0.0")&&(this.actionBarLottieView.play(),this.cardLottieView.play()),this.animationReplay(1620)}),t)}animationReplay(t){this.showTimer=setInterval((()=>{bt.supportMinimumTKVersion("5.0.0")&&(this.actionBarLottieView.stop(),this.cardLottieView.stop(),this.actionBarLottieView.play(),this.cardLottieView.play())}),t)}}class Ye extends TKView{constructor(t,e){super(),this.isAnimStarting=!1,this.vm=t,this.viewWH=e,this.style={width:e,height:e},this.setupView(),this.setupData()}setupView(){this.rotateArrowImage=new TKImage,this.rotateArrowImage.style={position:"absolute",top:0,left:0,width:this.viewWH,height:this.viewWH},this.rotateArrowImage.setSrc("image/ksad-splash-play-card/ic_rotate_arrow.png"),this.appendChild(this.rotateArrowImage),this.rotatePhoneImage=new TKImage,this.rotatePhoneImage.style={position:"absolute",top:0,left:0,width:this.viewWH,height:this.viewWH},this.rotatePhoneImage.setSrc("image/ksad-splash-play-card/ic_rotate_phone.png"),this.appendChild(this.rotatePhoneImage)}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.startRotateAnimation();break;case"hideEnd":case"pageInvisiable":this.stopRotateAnimation()}}))}startRotateAnimation(){if(this.isAnimStarting)return;this.stopRotateAnimation(),this.isAnimStarting=!0,this.addRotateAnim();const t=this;this.rotateAnimationTimer=setInterval((()=>{t.addRotateAnim()}),1880)}addRotateAnim(){if(!this.rotatePhoneImage)return;const t=new TKKeyframeAnimation,e=this;t.setAnimations([()=>(e.rotatePhoneImage.style={transform:{rotate:0}},800/1880),()=>(e.rotatePhoneImage.style={transform:{rotate:-23}},1070/1880),()=>(e.rotatePhoneImage.style={transform:{rotate:20}},1540/1880),()=>(e.rotatePhoneImage.style={transform:{rotate:-10}},1710/1880),()=>(e.rotatePhoneImage.style={transform:{rotate:0}},1)]),t.duration=1880,t.timingFunction="linear",this.rotatePhoneImage.addAnimation(t,"rotateAnimation")}stopRotateAnimation(){this.isAnimStarting=!1,this.rotateAnimationTimer&&(clearInterval(this.rotateAnimationTimer),this.rotateAnimationTimer=0),this.rotatePhoneImage&&this.rotatePhoneImage.removeAllAnimation()}}class Ge extends TKView{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.setupViews(),this.setupData(),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupViews(){let t=this.vm.callerContext.isCurvedScreen(),e=this.vm.callerContext.isLandScape();this.style={position:"absolute",alignSelf:"center",flexDirection:"row",justifyContent:"center",width:"100%",bottom:0,height:e?t?125:139:200*Tachikoma.env.deviceWidth/375},bt.supportMinimumTKVersion("5.0.0")&&(this.swipeLottieView=new TKLottieImageView,this.swipeLottieView.style={position:"absolute",top:0,left:0,width:"100%",height:"100%"},this.appendChild(this.swipeLottieView));let i=new TKView;i.style={position:"absolute",bottom:e?t?32:34:61,height:34,width:"100%",left:0,flexDirection:"row",alignItems:"center",justifyContent:"center"},this.appendChild(i),this.rotatePhoneView=new Ye(this.vm,34),this.rotatePhoneView.style={marginRight:8},i.appendChild(this.rotatePhoneView),this.subTitle=new TKText,this.subTitle.style={color:"#FFFFFF",fontSize:20},this.subTitle.enabled=!1,this.subTitle.setText(this.vm.getSplashRotateSubtitle()),i.appendChild(this.subTitle),bt.supportMinimumTKVersion("5.0.0")&&(bt.isAndroid()||(this.swipeLottieView.enabled=!1),e?this.swipeLottieView.setUri("bundle://image/ksad-splash-play-card/lottie_bottom_mask_bounce_landscape.json"):this.swipeLottieView.setUri("bundle://image/ksad-splash-play-card/lottie_bottom_mask_bounce.json"))}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"hideEnd":this.pageDeallocAction();break;case"pageVisiable":this.pageShowAction()}})),me(this.vm,this.vm.$attrsPath.pageHasVisibled,(t=>{t&&this.pageShowAction()})),this.vm.getActionBarRect=()=>({x:this.getOrigin().x,y:this.getOrigin().y+16,width:755,height:538})}pageShowAction(){this.alreadyShow||(this.alreadyShow=!0,this.animationPlay())}pageDeallocAction(){this.showTimer&&(bt.supportMinimumTKVersion("5.0.0")&&this.swipeLottieView.stop(),clearInterval(this.showTimer),this.showTimer=0)}animationPlay(){bt.supportMinimumTKVersion("5.0.0")&&this.swipeLottieView.play(),this.animationReplay(1e3)}animationReplay(t){this.showTimer=setInterval((()=>{bt.supportMinimumTKVersion("5.0.0")&&(this.swipeLottieView.stop(),this.swipeLottieView.play())}),t)}}class Xe extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.vm.getActionBarRect=()=>({x:Tachikoma.env.deviceWidth/2-46,y:this.getOrigin().y+19,width:92,height:92}),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupView(){this.style={position:"absolute",alignSelf:"center",bottom:0,height:180,flexDirection:"column",alignItems:"center"},this.cycleView=new TKView,this.cycleView.style={marginTop:19,height:92,width:92,backgroundColor:"#00000099",borderRadius:46,borderColor:"#FFFFFF99",borderWidth:2,flexDirection:"column",alignItems:"center"},this.appendChild(this.cycleView),this.rotatePhoneView=new Ye(this.vm,48),this.rotatePhoneView.style={position:"absolute",top:11},this.cycleView.appendChild(this.rotatePhoneView),this.title=new TKText,this.title.style={color:"#FFFFFF",fontSize:14,top:59,height:20},this.title.enabled=!1,this.title.setText(this.vm.getSplashRotateTitle()),this.cycleView.appendChild(this.title),this.subTitle=new TKText,this.subTitle.style={color:"#FFFFFF",fontSize:12,height:17,marginTop:12},this.subTitle.enabled=!1,this.subTitle.setText(this.vm.getSplashRotateSubtitle()),this.appendChild(this.subTitle)}}class je extends TKView{constructor(t,e,i){super(),this.isAnimStarting=!1,this.vm=t,this.icon=i,this.viewWH=e,this.setupView(),this.setupData()}setupView(){this.shakeAnimationView=new TKView,this.shakeAnimationView.style={width:2*this.viewWH,height:2*this.viewWH},this.appendChild(this.shakeAnimationView),this.shakeImage=new TKImage,this.shakeImage.style={width:this.viewWH,height:this.viewWH,left:0,top:0,position:"absolute"},mt(this.icon)?this.shakeImage.setSrc(this.icon):this.shakeImage.setSrc("image/ksad-splash-play-card/ic_splash_shake_hand.png"),this.shakeAnimationView.appendChild(this.shakeImage)}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.startShakeAnimation();break;case"hideEnd":case"pageInvisiable":this.stopShakeAnimation()}}))}startShakeAnimation(){if(this.isAnimStarting)return;this.stopShakeAnimation(),this.isAnimStarting=!0,this.addShakeAnim();const t=this;this.shakeAnimationTimer=setInterval((()=>{t.addShakeAnim()}),1200)}addShakeAnim(){const t=new TKKeyframeAnimation;t.animType="rotationZ";let e=bt.isAndroid()?.8:1;t.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:.25,value:bt.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.33,value:-bt.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.5,value:bt.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.66,value:-bt.getRotateSemiCircle()/(5.625*e),easing:"EaseInEaseOut"},{percent:.83,value:bt.getRotateSemiCircle()/(11.25*e),easing:"EaseInEaseOut"},{percent:.91,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}],t.duration=1500,t.repeatCount=0,this.shakeAnimationView&&this.shakeAnimationView.addAnimation(t,"shakeAnimation")}stopShakeAnimation(){this.isAnimStarting=!1,this.shakeAnimationTimer&&(clearInterval(this.shakeAnimationTimer),this.shakeAnimationTimer=0),this.shakeAnimationView&&this.shakeAnimationView.removeAllAnimation()}}class $e extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.vm.getActionBarRect=()=>({x:this.getOrigin().x,y:this.getOrigin().y,width:this.getSize().width,height:this.getSize().height}),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupView(){let t=this.vm.callerContext.isLandScape();this.style={position:"absolute",alignSelf:"center",bottom:t?25:40,height:t?45:56,backgroundColor:"#00000099",borderRadius:28,borderWidth:1,borderColor:"#FFFFFF99",minWidth:288};let e=new TKView;e.style={alignSelf:"center",height:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.appendChild(e),9==this.vm.getActionBarInteractiveStyle()?(this.phoneView=new je(this.vm,28),this.phoneView.style={marginTop:28,marginLeft:14,marginRight:-23}):(this.phoneView=new Ye(this.vm,28),this.phoneView.style={marginLeft:14,marginRight:5}),e.appendChild(this.phoneView),this.title=new TKText,this.title.style={color:"#FFFFFF",fontSize:14,marginRight:4},this.title.enabled=!1,this.title.setText(9==this.vm.getActionBarInteractiveStyle()?this.vm.getSplashShakeTitle():this.vm.getSplashRotateTitle()),e.appendChild(this.title);let i=new TKView;i.style={backgroundColor:"#FFFFFF4c",width:1,height:12,marginLeft:4,marginRight:4},e.appendChild(i),this.subTitle=new TKText,this.subTitle.style={color:"#FFFFFF",fontSize:14,marginLeft:4,marginRight:0},this.subTitle.enabled=!1,this.subTitle.setText(9==this.vm.getActionBarInteractiveStyle()?this.vm.getSplashShakeActionBarText():this.vm.getSplashRotateSubtitle()),e.appendChild(this.subTitle);let a=new TKImage;a.style={width:14,height:14,marginRight:16},a.setSrc("image/ksad-splash-play-card/ic_arrow_right.png"),e.appendChild(a)}}class Je extends TKView{constructor(t){super(),this.alreadyShow=!1,this.isAnimStarting=!1,this.needShowNativeImage=!1,this.vm=t,this.simulateDefaultPlayImage(),this.setupView(),this.setupData()}simulateDefaultPlayImage(){if(!this.vm.isImageMaterial()||!this.vm.getSplashAdLoadProcessChange())return void(this.needShowNativeImage=!1);let t=!1;const e=this;me(this.vm,this.vm.$attrsPath.tkHasShowNativeImage,(i=>{!t&&i&&(t=!0,e.needShowNativeImage=!0)}));let i=this.vm.getImageDownloadTimeMs();i>50&&(i-=50),setTimeout((()=>{t||(t=!0,e.needShowNativeImage=!0)}),i);let a=new TKImage;a.setImageLoadCallback((i=>{t||(t=!0,e.needShowNativeImage=!i)})),a.setVisibility("hidden"),this.appendChild(a),a.setUri(A(this.vm.adInfo))}setupView(){let t=this.vm.callerContext.isLandScape();this.style={position:"absolute",width:"100%",height:143,bottom:t?200*Tachikoma.env.deviceHeight/500+3:200*Tachikoma.env.deviceWidth/375+3,alignSelf:"center",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",visibility:"hidden"};let e=new TKText;e.style={marginTop:0,width:"100%",height:20,fontSize:16,textAlign:"center",color:"#FFFFFF",fontWeight:"medium",shadow:"1 1 1 #00000099"},e.setText(this.getHiText()),this.appendChild(e),bt.supportMinimumTKVersion("5.0.0")&&(this.rippleLottieView=new TKLottieImageView,this.rippleLottieView.style={marginTop:-3,width:126,height:126},this.appendChild(this.rippleLottieView),this.rippleLottieView.enabled=!1,this.rippleLottieView.setUri("bundle://image/ksad-splash-play-card/cycle_ripple.json")),this.iconImage=new TKImage,this.iconImage.style={position:"absolute",alignSelf:"center",top:32,width:96,height:96,borderRadius:48,borderWidth:1,borderColor:"#FFFFFF"},this.iconImage.setSrc(this.vm.getSplashShapeChangeIconUrl()),this.appendChild(this.iconImage),bt.supportMinimumTKVersion("5.0.0")&&(this.cycleView=new TKLottieImageView,this.cycleView.style={position:"absolute",alignSelf:"center",top:32,width:96,height:96,opacity:0,borderRadius:48},this.cycleView.enabled=!1,this.cycleView.setUri("bundle://image/ksad-splash-play-card/cycle_rotate.json"),this.appendChild(this.cycleView))}setupData(){const t=this;me(this.vm,this.vm.$attrsPath.lifeStatus,(e=>{switch(e){case"hideEnd":t.deallocAnimationAction();break;case"pageVisiable":t.pageShowAction()}})),me(this.vm,this.vm.$attrsPath.pageHasVisibled,(e=>{e&&t.pageShowAction()})),me(this.vm,this.vm.$attrsPath.adHasConvert,(e=>{e&&t.isAnimStarting&&(t.style={visibility:"hidden"},t.deallocAnimationAction())})),this.vm.isClickShapeChangeIcon=(e,i)=>{if(bt.supportMinimumTKVersion("5.0.0")){if(!t.isAnimStarting)return!1;let a=this.cycleView.getLocationOnScreen().x+48,s=this.cycleView.getLocationOnScreen().y+48;return Math.pow(a-e,2)+Math.pow(s-i,2)<=Math.pow(48,2)&&(t.vm.clickRotateBigIconConvert(),!0)}return!1}}pageShowAction(){this.alreadyShow||(this.alreadyShow=!0,this.startRotateAnimation())}startRotateAnimation(){const t=this;let e=this.vm.getBeginShapeChangeTimeMs(),i=this.vm.getShapeChangeDurationMs();this.rotateIconAnimationTimer=setTimeout((()=>{t.vm.adHasConvert||t.needShowNativeImage||(t.isAnimStarting=!0,t.style={visibility:"visible"},t.addIconRotateAnim1(),t.rippleAnimationPlay(1100),t.endAnimationTimer=setTimeout((()=>{t.style={visibility:"hidden"},t.deallocAnimationAction()}),i))}),e)}deallocAnimationAction(){this.isAnimStarting=!1,this.stopRippleAnimation(),this.rotateIconAnimationTimer&&(clearInterval(this.rotateIconAnimationTimer),this.rotateIconAnimationTimer=0),this.iconImage&&this.iconImage.removeAllAnimation(),this.cycleView&&bt.supportMinimumTKVersion("5.0.0")&&(this.cycleView.stop(),this.cycleView.removeAllAnimation()),this.endAnimationTimer&&(clearInterval(this.endAnimationTimer),this.endAnimationTimer=0)}rippleAnimationPlay(t){const e=this;this.rippleTimer=setTimeout((()=>{bt.supportMinimumTKVersion("5.0.0")&&(e.rippleLottieView.play(),e.rippleAnimationReplay(1100))}),t)}rippleAnimationReplay(t){const e=this;this.rippleReplayTimer=setInterval((()=>{bt.supportMinimumTKVersion("5.0.0")&&(e.rippleLottieView.stop(),e.rippleLottieView.play())}),t)}stopRippleAnimation(){(this.rippleTimer||this.rippleReplayTimer)&&(bt.supportMinimumTKVersion("5.0.0")&&this.rippleLottieView.stop(),clearInterval(this.rippleTimer),clearInterval(this.rippleReplayTimer),this.rippleTimer=0,this.rippleReplayTimer=0)}addIconRotateAnim1(){const t=new TKKeyframeAnimation,e=this;t.setAnimations([()=>(e.iconImage.style={transform:{rotate:0}},0),()=>(e.iconImage.style={transform:{rotate:-23}},270/1580),()=>(e.iconImage.style={transform:{rotate:20}},740/1580),()=>(e.iconImage.style={transform:{rotate:-10}},910/1580),()=>(e.iconImage.style={transform:{rotate:0}},1080/1580),()=>(e.iconImage.style={transform:{rotate:0}},1)]),t.duration=1580,t.timingFunction="linear",t.on("end",(()=>{e.addIconRotateAnim2()})),this.iconImage.addAnimation(t,"iconRotateAnimation1")}addIconRotateAnim2(){const t=new TKKeyframeAnimation,e=this;t.setAnimations([()=>(e.iconImage.style={transform:{rotate:0}},0),()=>(e.iconImage.style={transform:{rotate:-23}},.25),()=>(e.iconImage.style={transform:{rotate:20}},740/1080),()=>(e.iconImage.style={transform:{rotate:-10}},910/1080),()=>(e.iconImage.style={transform:{rotate:0}},1)]),t.duration=1080,t.timingFunction="linear",t.on("end",(()=>{e.add2DFlipAnim()})),this.iconImage.addAnimation(t,"iconRotateAnimation2")}add2DFlipAnim(){this.stopRippleAnimation();const t=new TKKeyframeAnimation,e=this;t.setAnimations([()=>(e.iconImage.style={transform:{scale:{x:1,y:1}},opacity:1},0),()=>(e.iconImage.style={transform:{scale:{x:0,y:1}},opacity:0},1)]),t.timingFunction="linear",t.duration=300,this.iconImage.addAnimation(t,"icon2DFlip");const i=new TKKeyframeAnimation;i.setAnimations([()=>(bt.supportMinimumTKVersion("5.0.0")&&(e.cycleView.style={transform:{scale:{x:0,y:1}},opacity:0}),0),()=>(bt.supportMinimumTKVersion("5.0.0")&&(e.cycleView.style={transform:{scale:{x:0,y:1}},opacity:0}),190/490),()=>(bt.supportMinimumTKVersion("5.0.0")&&(e.cycleView.style={transform:{scale:{x:1,y:1}},opacity:1}),1)]),i.timingFunction="linear",i.duration=490,i.on("end",(()=>{bt.supportMinimumTKVersion("5.0.0")&&(e.cycleView.play(),e.rippleAnimationPlay(0))})),bt.supportMinimumTKVersion("5.0.0")&&this.cycleView.addAnimation(i,"cycle2DFlip")}getHiText(){let t,e=(new Date).getHours();return t=e>=0&&e<12?"早上好":e>=12&&e<18?"下午好":"晚上好","Hi "+t+"，扭一扭"}}class Ze extends TKView{constructor(t,e){super(),this.alreadyShow=!1,this.vm=t,this.showTitle=e,this.setupViews(),this.setupData()}setupViews(){let t=this.vm.callerContext.isLandScape();const e=t?56:72,i=t?146:186;if(this.style={position:"absolute",alignSelf:"center",width:e,height:i+30},bt.supportMinimumTKVersion("5.0.0")&&(this.swipeLottieView=new TKLottieImageView,this.swipeLottieView.style={position:"absolute",top:t?40:0,left:0,width:e,height:i},this.appendChild(this.swipeLottieView)),this.showTitle){let t=new TKText;t.style={color:"#FFFFFF",fontSize:14,position:"absolute",bottom:0,width:"100%",height:20,textAlign:"center",shadow:"1 1 1 #00000066"},t.enabled=!1,t.setText("轻滑试试"),this.appendChild(t)}bt.supportMinimumTKVersion("5.0.0")&&(bt.isAndroid()||(this.swipeLottieView.enabled=!1),this.swipeLottieView.setUri("bundle://image/ksad-splash-play-card/lottie_ver_slide.json"))}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"hideEnd":this.pageDeallocAction();break;case"pageVisiable":this.pageShowAction()}})),me(this.vm,this.vm.$attrsPath.pageHasVisibled,(t=>{t&&this.pageShowAction()}))}pageShowAction(){this.alreadyShow||(this.alreadyShow=!0,this.animationPlay())}pageDeallocAction(){this.showTimer&&(bt.supportMinimumTKVersion("5.0.0")&&this.swipeLottieView.stop(),clearInterval(this.showTimer),this.showTimer=0)}animationPlay(){bt.supportMinimumTKVersion("5.0.0")&&this.swipeLottieView.play(),this.animationReplay(4650)}animationReplay(t){this.showTimer=setInterval((()=>{bt.supportMinimumTKVersion("5.0.0")&&(this.swipeLottieView.stop(),this.swipeLottieView.play())}),t)}}class qe extends TKView{constructor(t){super(),this.vm=t,this.isBigStyle=33==this.vm.getSplashCombinedStyle(),this.rotatePhoneWH=this.isBigStyle?32:28,this.setupView(),this.vm.getActionBarRect=()=>({x:this.getOrigin().x,y:this.getOrigin().y,width:this.getSize().width,height:this.getSize().height}),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupView(){this.style={position:"absolute",alignSelf:"center",bottom:40,width:this.isBigStyle?303:263,height:this.isBigStyle?80:62,backgroundColor:"#00000099",borderRadius:this.isBigStyle?40:31,borderWidth:2,borderColor:"#FFFFFF99"},this.rotatePhoneView=new Ye(this.vm,this.rotatePhoneWH),this.rotatePhoneView.style={position:"absolute",top:this.isBigStyle?9:8,left:this.isBigStyle?92:78},this.appendChild(this.rotatePhoneView),this.title=new TKText,this.title.style={color:"#FFFFFF",fontSize:this.isBigStyle?20:18,position:"absolute",top:this.isBigStyle?15:12,left:this.rotatePhoneWH+(this.isBigStyle?103:87)},this.title.setText(this.vm.getSplashRotateTitle()),this.title.enabled=!1,this.appendChild(this.title),this.subTitle=new TKText,this.subTitle.style={color:"#FFFFFF99",fontSize:this.isBigStyle?14:12,position:"absolute",bottom:this.isBigStyle?14:9,left:0,right:0,textAlign:"center"},this.subTitle.setText(this.vm.getSplashRotateSubtitle()),this.title.enabled=!1,this.appendChild(this.subTitle)}}class Qe extends TKView{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.vm.isDefaultActionBarView=!0,this.setupViews(),this.setupActions(),_(this.vm.adInfo)&&de(this.title,"text",this.vm.$attrsPath.actionBarText)}setupViews(){this.style={position:"absolute",alignItems:"center",left:0,bottom:0,width:"100%",height:120},this.btnView=new TKView,this.btnView.style={position:"absolute",alignSelf:"center",bottom:46,height:60,backgroundColor:"#00000099",borderRadius:30,borderWidth:1,borderColor:"#FFFFFF99",minWidth:195},this.appendChild(this.btnView);let t=new TKView;t.style={alignSelf:"center",height:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.btnView.appendChild(t),this.title=new TKText,this.title.style={color:"#FFFFFF",fontSize:18,fontWeight:"medium",marginLeft:30,marginRight:4},this.title.enabled=!1,this.title.setText(this.vm.getSplashActionbarTitle()),t.appendChild(this.title);let e=new TKImage;e.style={width:14,height:14,marginRight:30},e.setSrc("image/ksad-splash-play-card/ic_arrow_right.png"),t.appendChild(e)}setupActions(){this.btnView.addEventListener("tap",(t=>{const e=pt(t,this);this.vm.convert(1,e,At.SPLASH_CONVERSION_BUTTON_CLICK)})),this.vm.enableSwipe()&&this.addEventListener("swipe",(t=>{this.vm.convert(2,{x:0,y:0},At.CARD_SWIPE_CONVERT)}))}}class ti extends Jt{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.setupViews(),this.setupData()}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":case"pageVisiable":this.pageShowAction();break;case"hideEnd":this.pageDeallocAction(),this.vm.playcardShowEnd=!0;break;case"pageInvisiable":this.pageDeallocAction()}})),me(this.vm,this.vm.$attrsPath.pageHasVisibled,(t=>{t&&this.pageShowAction()})),me(this.vm,this.vm.$attrsPath.showEndPage,(t=>{t&&this.pageDeallocAction()}))}pageShowAction(){this.alreadyShow?this.vm.playcardShowEnd||this.vm.startSensorListener():(this.alreadyShow=!0,this.vm.startSensorListener(),this.vm.reportElementActionBarImpression(200),ke.reportRotateSensorStatus(this.vm.adStyle))}pageDeallocAction(){this.vm.stopSensorListener()}setupViews(){this.style={width:"100%",height:"100%"},this.appendRotateSwipeActionBar(),this.isDefaultActionbar||this.appendSlideAnimationView()}appendRotateSwipeActionBar(){let t,e,i=this.vm.callerContext.isLandScape();switch(this.vm.getSplashCombinedStyle()){case 1:case 2:default:t=new ze(this.vm);break;case 31:if(i){t=new Qe(this.vm),this.isDefaultActionbar=!0;break}t=new $e(this.vm),e=new Ze(this.vm,!0),e.style={bottom:120};break;case 32:case 33:if(i){t=new Qe(this.vm),this.isDefaultActionbar=!0;break}t=new qe(this.vm),e=new Ze(this.vm,!0),e.style={bottom:32==this.vm.getSplashCombinedStyle()?126:144},this.appendChild(e);break;case 34:if(i){t=new Qe(this.vm),this.isDefaultActionbar=!0;break}t=new Xe(this.vm),e=new Ze(this.vm,!0),e.style={bottom:185};break;case 35:t=new Ge(this.vm);break;case 36:if(i){t=new Qe(this.vm),this.isDefaultActionbar=!0;break}let a=new Je(this.vm);this.appendChild(a),t=new Ge(this.vm)}e&&this.appendChild(e),this.appendChild(t)}appendSlideAnimationView(){this.canvasView=new Ue(this.vm.getSplashSlideConvertDistance(),((t,e,i,a)=>{const s=i-t,n=a-e;Math.abs(s)>=Math.abs(n)?s>0?this.vm.handleSlideConvert(t,e,3,s):this.vm.handleSlideConvert(t,e,2,s):n>0?this.vm.handleSlideConvert(t,e,4,n):this.vm.handleSlideConvert(t,e,1,n)}),((t,e)=>{this.vm.callerContext.onClickEvent&&this.vm.callerContext.onClickEvent(t,e),this.isClickActionBar(t,e)&&this.vm.clickActionBarConvert()})),this.canvasView.style={position:"absolute",width:"100%",height:"100%"},this.appendChild(this.canvasView)}isClickActionBar(t,e){if(36==this.vm.getSplashCombinedStyle()&&this.vm.isClickShapeChangeIcon(t,e))return!1;let i=this.vm.getActionBarRect();if(35==this.vm.getSplashCombinedStyle()||36==this.vm.getSplashCombinedStyle()){let a=i.width/2,s=i.height/2,n=this.vm.containerLimit.width/2,o=i.y+s;return Math.pow(n-t,2)/Math.pow(a,2)+Math.pow(o-e,2)/Math.pow(s,2)<=1}return t>i.x&&t<i.x+i.width&&e>i.y&&e<i.y+i.height}}class ei extends TKView{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.setupViews(),this.setupData(),this.setupActions(),me(this.vm,this.vm.$attrsPath.showEndPage,(t=>{t&&this.pageDeallocAction()})),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupViews(){let t=this.vm.callerContext.isLandScape();this.style={position:"absolute",flexDirection:"column",width:"100%",height:181,bottom:0,left:0},this.maskView=new TKView,this.maskView.style={position:"absolute",width:"100%",height:"100%",left:0,top:0,gradientBgColor:"90, #00000059, #00000000"},this.appendChild(this.maskView),this.roundView=new TKView,this.roundView.style={position:"absolute",alignSelf:"center",width:92,height:92,top:t?6:16,backgroundColor:"#00000066",borderRadius:46},this.appendChild(this.roundView),this.shakeAnimationView=new je(this.vm,52),this.shakeAnimationView.style={position:"absolute",top:20,left:20},this.shakeAnimationView.enabled=!1,this.roundView.appendChild(this.shakeAnimationView),this.title=new TKText,this.title.style={alignSelf:"center",color:"#FFFFFF",fontSize:14,textAlign:"center",shadow:"1 1 1 #00000099",position:"absolute",top:t?null:117,bottom:t?60:null,width:"100%"},this.title.setText(this.vm.getSplashShakeTitle()),this.title.enabled=!1,this.appendChild(this.title),this.subTitle=new TKText,this.subTitle.style={alignSelf:"center",color:"#FFFFFFCC",fontSize:t?12:10,textAlign:"center",shadow:"1 1 1 #00000099",position:"absolute",top:t?null:137,bottom:t?46:null,width:"100%"},this.subTitle.setText(this.vm.getSplashActionbarTitle()),this.title.enabled=!1,this.appendChild(this.subTitle)}addJumpAnim(t){this.shakeAnimationView.stopShakeAnimation();let e=this;const i=new TKKeyframeAnimation;i.setAnimations([()=>(e.roundView.style={transform:{translate:{y:0}}},0),()=>(e.roundView.style={transform:{translate:{y:8}}},.11),()=>(e.roundView.style={transform:{translate:{y:-8}}},.33),()=>(e.roundView.style={transform:{translate:{y:8}}},.55),()=>(e.roundView.style={transform:{translate:{y:-8}}},.77),()=>(e.roundView.style={transform:{translate:{y:0}}},1)]),i.timingFunction="linear",i.duration=900,i.on("end",(()=>{t&&t()})),this.roundView.addAnimation(i,"roundJumpAnimation")}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"hideEnd":case"pageInvisiable":this.pageDeallocAction();break;case"pageVisiable":this.pageShowAction()}}))}pageShowAction(){this.alreadyShow?this.vm.playcardShowEnd||this.handleSensorConvertAndJump():(this.alreadyShow=!0,this.handleSensorConvertAndJump(),KSAdSensorManager.supportSensor(1)||jt.log(914,null,null),this.vm.reportElementActionBarImpression(185))}pageDeallocAction(){this.vm.stopSensorListener()}handleSensorConvertAndJump(){this.vm.startSensorListener((t=>{this.addJumpAnim((()=>{t?this.vm.convertShake():this.vm.convertRotate()}))}))}setupActions(){this.vm.isOnlyShakeCanConvert()||(this.vm.enableShakeViewClick()&&this.roundView.addEventListener("tap",(t=>{const e=pt(t,this.roundView);this.addJumpAnim((()=>{this.vm.convert(1,e,At.SHAKE_BIG_ICON_CLICK)}))})),this.vm.enableSwipe()&&this.roundView.addEventListener("swipe",(t=>{this.addJumpAnim((()=>{this.vm.convert(2,{x:0,y:0},At.CARD_SWIPE_CONVERT)}))})))}}class ii extends TKView{constructor(){super(),this.setupViews()}setupViews(){this.style={width:28,height:34,flexDirection:"column-reverse",justifyContent:"space-around",alignItems:"center"},this.mArrow1=this.createArrowUpView(),this.appendChild(this.mArrow1),this.mArrow2=this.createArrowUpView(),this.appendChild(this.mArrow2),this.mArrow3=this.createArrowUpView(),this.appendChild(this.mArrow3)}createArrowUpView(){let t=new TKImage;return t.style={width:"100%",height:18,opacity:0},t.setSrc("image/ksad-pre-landingpage-card/icon_up_arrow.png"),t}startAnimation(){let t=this.createArrowAnimation(this.mArrow1,[1,.6,.3,0,0,0]),e=this.createArrowAnimation(this.mArrow2,[0,1,.6,.3,0,0]),i=this.createArrowAnimation(this.mArrow3,[0,0,1,.6,.3,0]);this.mArrow1.addAnimation(t,"arrowUp"),this.mArrow2.addAnimation(e,"arrowUp"),this.mArrow3.addAnimation(i,"arrowUp")}stopAnimation(){this.mArrow1.removeAllAnimation(),this.mArrow2.removeAllAnimation(),this.mArrow3.removeAllAnimation()}createArrowAnimation(t,e){if(e.length<5)return null;let i=new TKKeyframeAnimation;return i.duration=600,i.timingFunction="ease-out",i.repeatCount=Number.MAX_SAFE_INTEGER,i.setAnimations([()=>(t.style={opacity:e[0]},1/6),()=>(t.style={opacity:e[1]},2/6),()=>(t.style={opacity:e[2]},.5),()=>(t.style={opacity:e[3]},4/6),()=>(t.style={opacity:e[4]},5/6),()=>(t.style={opacity:e[5]},1)]),i}}class ai extends TKView{constructor(t){super(),this.vm=t,this.setupViews(),this.setupDatas(),this.vm.getActionBarRect=()=>({x:this.btnView.getLocationOnScreen().x,y:this.vm.containerLimit.height-156,width:this.btnView.getSize().width,height:60}),_(this.vm.adInfo)&&de(this.title,"text",this.vm.$attrsPath.actionBarText)}setupViews(){this.style={position:"absolute",alignSelf:"center",flexDirection:"column",alignItems:"center",width:"100%",bottom:0,height:300,gradientBgColor:"90, #00000059, #00000000"},this.shakeAnimationView=new je(this.vm,80,"image/ksad-splash-play-card/ic_shake_white.png"),this.shakeAnimationView.style={position:"absolute",top:10,left:Tachikoma.env.deviceWidth/2-40},this.shakeAnimationView.enabled=!1,this.appendChild(this.shakeAnimationView);let t=new TKText;t.style={alignSelf:"center",color:"#FFFFFF",fontSize:16,textAlign:"center",shadow:"1 1 1 #00000099",position:"absolute",top:90,width:"100%"},t.setText(this.vm.getSplashShakeTitle()),t.enabled=!1,this.appendChild(t),this.btnView=new TKView,this.btnView.style={position:"absolute",alignSelf:"center",bottom:100,height:56,backgroundColor:"#00000099",borderRadius:30,borderWidth:1,borderColor:"#FFFFFF99",minWidth:288},this.appendChild(this.btnView);let e=new TKView;e.style={alignSelf:"center",height:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.btnView.appendChild(e),this.title=new TKText,this.title.style={color:"#FFFFFF",fontSize:16,marginLeft:30,marginRight:4},this.title.enabled=!1,this.title.setText(this.vm.getSplashShakeActionBarText()),e.appendChild(this.title);let i=new TKImage;i.style={width:14,height:14,marginRight:30},i.setSrc("image/ksad-splash-play-card/ic_arrow_right.png"),e.appendChild(i),this.appendUpSlideTipsView()}setupDatas(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"pageVisiable":this.slideUpIconView.startAnimation();break;case"pageInvisiable":case"hideEnd":this.slideUpIconView.stopAnimation()}}))}appendUpSlideTipsView(){this.slideUpIconView=new ii,this.slideUpIconView.style={bottom:45,alignSelf:"center",position:"absolute"},this.appendChild(this.slideUpIconView);let t=new TKText;t.style={position:"absolute",bottom:19,fontSize:16,color:"#FFFFFF",alignSelf:"center"},t.setText("向上滑动"),this.appendChild(t)}}class si extends TKView{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.setupViews(),this.setupData()}setupViews(){this.style={width:"100%",height:"100%"},this.appendShakeSwipeActionBar(),this.isDefaultActionBar||this.appendSlideAnimationView()}appendShakeSwipeActionBar(){let t,e,i=this.vm.callerContext.isLandScape();switch(this.vm.getSplashCombinedStyle()){case 81:if(i){t=new Qe(this.vm),this.appendSlideAnimationView(),this.isDefaultActionBar=!0;break}t=new $e(this.vm),e=new Ze(this.vm,!0),e.style={bottom:this.vm.callerContext.isLandScape()?80:120};break;case 82:if(i){t=new Qe(this.vm),this.isDefaultActionBar=!0;break}t=new ai(this.vm);break;case 83:case 84:t=new ze(this.vm);break;default:if(i){t=new Qe(this.vm),this.isDefaultActionBar=!0;break}t=new $e(this.vm),e=new Ze(this.vm,!0),e.style={bottom:this.vm.callerContext.isLandScape()?80:120}}t&&this.appendChild(t),e&&this.appendChild(e)}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"hideEnd":case"pageInvisiable":this.pageDeallocAction();break;case"pageVisiable":this.pageShowAction()}})),me(this.vm,this.vm.$attrsPath.showEndPage,(t=>{t&&this.pageDeallocAction()}))}pageShowAction(){this.alreadyShow?this.vm.playcardShowEnd||this.vm.startSensorListener():(this.alreadyShow=!0,this.vm.startSensorListener(),this.vm.reportElementActionBarImpression(199))}pageDeallocAction(){this.vm.stopSensorListener()}appendSlideAnimationView(){this.canvasView=new Ue(this.vm.getSplashSlideConvertDistance(),((t,e,i,a)=>{const s=i-t,n=a-e;Math.abs(s)>=Math.abs(n)?s>0?this.vm.handleSlideConvert(t,e,3,s):this.vm.handleSlideConvert(t,e,2,s):n>0?this.vm.handleSlideConvert(t,e,4,n):this.vm.handleSlideConvert(t,e,1,n)}),((t,e)=>{this.vm.callerContext.onClickEvent&&this.vm.callerContext.onClickEvent(t,e),this.isClickActionBar(t,e)&&this.vm.clickActionBarConvert()})),this.canvasView.style={position:"absolute",width:"100%",height:"100%"},this.appendChild(this.canvasView)}isClickActionBar(t,e){let i=this.vm.getActionBarRect();return t>i.x&&t<i.x+i.width&&e>i.y&&e<i.y+i.height}}class ni extends TKView{constructor(t){super(),this.isHandleElementShow=!1,this.vm=t,this.isLandScape=this.vm.callerContext.isLandScape(),this.setupViews(),this.setupData(),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarText)}setupViews(){let t=this.vm.callerContext.isLandScape();this.style={position:"absolute",width:"100%",height:"100%",bottom:0,left:0};let e=new TKView;e.style={position:"absolute",flexDirection:"column",width:"100%",height:310,bottom:0,left:0},e.enabled=!1,this.appendChild(e),this.swipeHandView=new Ze(this.vm,!1),this.swipeHandView.style={position:"absolute",top:t?50:16},e.appendChild(this.swipeHandView),this.maskView=new TKView,this.maskView.style={position:"absolute",width:"100%",height:218,left:0,top:218,gradientBgColor:"90, #0000007F, #00000000"},e.appendChild(this.maskView),this.title=new TKText,this.title.style={alignSelf:"center",color:"#FFFFFF",fontSize:20,fontWeight:"medium",textAlign:"center",shadow:"1 1 1 #00000099",position:"absolute",top:t?null:250,height:24,left:0,width:"100%",bottom:t?70:null},this.title.setText(this.vm.getSplashSlideTitle()),this.title.enabled=!1,e.appendChild(this.title),this.subTitle=new TKText,this.subTitle.style={alignSelf:"center",color:"#FFFFFF",fontSize:14,textAlign:"center",fontWeight:"medium",shadow:"1 1 1 #00000099",position:"absolute",top:t?null:278,width:"100%",height:17,left:0,bottom:t?46:null},this.subTitle.setText(this.vm.getSplashSlideActionBarText()),this.title.enabled=!1,e.appendChild(this.subTitle),this.appendSlideAnimationView()}appendSlideAnimationView(){this.canvasView=new Ue(this.vm.getSplashSlideConvertDistance(),((t,e,i,a)=>{const s=i-t,n=a-e;let o=Math.sqrt(Math.pow(s,2)+Math.pow(n,2));if(o>=this.vm.getSplashSlideConvertDistance()){let i={fingerSwipeType:1,fingerSwipeDistance:o};this.vm.convert(2,{x:t,y:e},At.CARD_SWIPE_CONVERT,i)}}),((t,e)=>{this.vm.callerContext.onClickEvent&&this.vm.callerContext.onClickEvent(t,e)})),this.canvasView.style={position:"absolute",width:"100%",height:"100%"},this.appendChild(this.canvasView)}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{if("pageVisiable"===t)if(!this.isHandleElementShow){this.isHandleElementShow=!0;let t={fingerSwipeType:1};this.vm.reportElementActionBarImpression(190,t)}}))}}class oi extends TKView{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.setupViews(),this.setupData(),this.setupActions(),_(this.vm.adInfo)&&de(this.title,"text",this.vm.$attrsPath.actionBarText)}setupViews(){this.style={position:"absolute",alignItems:"center",left:0,bottom:0,width:"100%",height:this.vm.callerContext.isLandScape()?120:100},this.btnView=new TKView,this.btnView.style={position:"absolute",alignSelf:"center",bottom:this.vm.callerContext.isLandScape()?46:40,height:60,backgroundColor:"#00000099",borderRadius:30,borderWidth:1,borderColor:"#FFFFFF99",minWidth:195},this.appendChild(this.btnView);let t=new TKView;t.style={alignSelf:"center",height:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.btnView.appendChild(t),this.title=new TKText,this.title.style={color:"#FFFFFF",fontSize:18,fontWeight:"medium",marginLeft:30,marginRight:4},this.title.enabled=!1,this.title.setText(this.vm.getSplashActionbarTitle()),t.appendChild(this.title);let e=new TKImage;e.style={width:14,height:14,marginRight:30},e.setSrc("image/ksad-splash-play-card/ic_arrow_right.png"),t.appendChild(e),bt.supportMinimumTKVersion("5.0.0")&&(this.handLottieView=new TKLottieImageView,this.handLottieView.style={alignSelf:"center",bottom:this.vm.callerContext.isLandScape()?-6:0,marginLeft:50,width:100,height:100},this.handLottieView.enabled=!1,this.appendChild(this.handLottieView),this.handLottieView.setUri("bundle://image/ksad-splash-play-card/hand_click.json"))}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"hideEnd":this.pageDeallocAction();break;case"pageVisiable":this.pageShowAction()}}))}pageShowAction(){if(this.alreadyShow)return;this.alreadyShow=!0,this.animationPlay();let t=new c;t.shield_reason=this.vm.getSplashDisableType()?1:0;let e={clientExtData:JSON.stringify(t)};jt.exposeElement(123,e)}pageDeallocAction(){this.showTimer&&(bt.supportMinimumTKVersion("5.0.0")&&this.handLottieView.stop(),clearInterval(this.showTimer),this.showTimer=0)}animationPlay(){bt.supportMinimumTKVersion("5.0.0")&&this.handLottieView.play(),this.animationReplay(1e3)}animationReplay(t){this.showTimer=setInterval((()=>{bt.supportMinimumTKVersion("5.0.0")&&(this.handLottieView.stop(),this.handLottieView.play())}),t)}setupActions(){this.btnView.addEventListener("tap",(t=>{const e=pt(t,this);this.vm.convert(1,e,At.SPLASH_CONVERSION_BUTTON_CLICK)})),this.vm.enableSwipe()&&this.addEventListener("swipe",(t=>{this.vm.convert(2,{x:0,y:0},At.CARD_SWIPE_CONVERT)}))}}class ri extends TKView{constructor(t){super(),this.alreadyShow=!1,this.vm=t,this.isLandScape=t.callerContext.isLandScape(),this.setupViews(),this.onViewCreated(),this.setupActions()}setupViews(){this.style={width:"100%",height:"100%",position:"absolute"},this.throughHitTest=!0,this.actionBarContainer=new TKView,this.actionBarContainer.style={position:"absolute",alignSelf:"center",flexDirection:"row",justifyContent:"center",width:"100%",bottom:0,height:this.isLandScape?this.vm.callerContext.isCurvedScreen()?125:139:200*Tachikoma.env.deviceWidth/375},this.actionBarHeight=Number(this.actionBarContainer.style.height),this.appendChild(this.actionBarContainer),this.actionBarImageView=new TKImage,this.actionBarImageView.style={position:"absolute",top:this.isLandScape?40:20,height:this.isLandScape?600:"100%",width:this.isLandScape?600:"100%"},vt(this.actionBarImageView,this.isLandScape?"splash_cycler_actionbar_land.png":"splash_cycler_actionbar.png"),this.actionBarContainer.appendChild(this.actionBarImageView),this.appendTextView()}appendTextView(){let t=new TKView;t.style={position:"absolute",top:this.isLandScape?90*this.actionBarHeight/180:null,bottom:this.isLandScape?null:61,height:34,width:"100%",left:0,flexDirection:"column",alignItems:"center",justifyContent:"center"},this.actionBarContainer.appendChild(t),this.actionbarTitle=new TKText,this.actionbarTitle.style={color:"#FFFFFF",width:"100%",textAlign:"center",fontSize:20,textLineClamp:1,textShadow:"0 0 5 #00000099",textOverflow:"ellipsis",minimumTextScaleFactor:.8},this.actionbarTitle.enabled=!1,this.actionbarTitle.setText(this.vm.getSplashActionbarTitle()),t.appendChild(this.actionbarTitle),_(this.vm.adInfo)&&de(this.actionbarTitle,"text",this.vm.$attrsPath.actionBarText)}setupActions(){pe(this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"pageVisiable":this.pageShowAction();break;case"hideEnd":this.pageDeallocAction()}})),pe(this.vm.$attrsPath.pageHasVisibled,(t=>{t&&this.pageShowAction()})),this.vm.getActionBarRect=()=>({x:this.actionBarContainer.getOrigin().x,y:this.actionBarContainer.getOrigin().y+20,width:755,height:538})}startActionbarAnimation(){let t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.actionBarImageView.style={transform:{translate:{y:0}}},0),()=>(t.actionBarImageView.style={transform:{translate:{y:-10}}},.5),()=>(t.actionBarImageView.style={transform:{translate:{y:0}}},1)]),e.duration=1e3,e.timingFunction="linear",e.repeatCount=Number.MAX_SAFE_INTEGER,this.actionBarImageView.addAnimation(e,"actionBarHeightBreathAnimation")}pageShowAction(){this.alreadyShow||(this.alreadyShow=!0,this.startActionbarAnimation())}pageDeallocAction(){var t;null===(t=this.actionBarImageView)||void 0===t||t.removeAllAnimation()}onViewCreated(){}}class hi extends ri{constructor(t){super(t),this.setupHandClickAction()}setupHandClickAction(){let t=0,e=0;this.addEventListener("down",(i=>{t=i.position.x,e=i.position.y})),this.addEventListener("up",(i=>{let a=i.position.x,s=i.position.y;this.hitClickAction(t,e,a,s)&&(this.vm.callerContext.onClickEvent&&this.vm.callerContext.onClickEvent(a,s),this.canConvertClick(a,s)&&this.vm.clickActionBarConvert())}))}canConvertClick(t,e){let i=this.vm.getActionBarRect(),a=i.width/2,s=i.height/2,n=this.vm.containerLimit.width/2,o=i.y+s;return Math.pow(n-t,2)/Math.pow(a,2)+Math.pow(o-e,2)/Math.pow(s,2)<=1}hitClickAction(t,e,i,a){return Math.abs(i-t)>=0&&Math.abs(i-t)<10&&Math.abs(a-e)>=0&&Math.abs(a-e)<10}pageShowAction(){if(this.alreadyShow)return;super.pageShowAction();let t=new c;t.shield_reason=this.vm.getSplashDisableType()?1:0;let e={clientExtData:JSON.stringify(t)};jt.exposeElement(123,e)}}class li extends TKView{constructor(t){super(),this.vm=t,this.style={position:"absolute",width:"100%",height:"100%"},this.throughHitTest=!0,this.appendClickActionBar()}appendClickActionBar(){let t;if(101===this.vm.getSplashCombinedStyle())t=new hi(this.vm);else t=new oi(this.vm);this.appendChild(t)}}class ci extends ri{appendTextView(){let t=new TKView;t.style={position:"absolute",top:this.isLandScape?90*this.actionBarHeight/180:null,bottom:this.isLandScape?null:61,height:48,width:"100%",left:0,flexDirection:"column",alignItems:"center",justifyContent:"center"},this.actionBarContainer.appendChild(t),this.actionbarTitle=new TKText,this.actionbarTitle.style={color:"#FFFFFF",fontSize:20,textShadow:"0 0 5 #00000099"},this.actionbarTitle.enabled=!1,this.actionbarTitle.setText(this.vm.getActionBarPrefixByStyle()),t.appendChild(this.actionbarTitle),this.subTitle=new TKText,this.subTitle.style={color:"#FFFFFF",marginTop:4,fontSize:12,textShadow:"0 0 5 #00000099"},this.subTitle.enabled=!1,this.subTitle.setText(this.vm.getSplashActionbarContentNoPrefix()),t.appendChild(this.subTitle),_(this.vm.adInfo)&&de(this.subTitle,"text",this.vm.$attrsPath.actionBarTextNoPrefix)}onViewCreated(){this.appendAnimationView()}appendAnimationView(){this.middleContainerView=new TKView,this.middleContainerView.style={height:200,width:306,alignSelf:"center",position:"absolute",bottom:this.isLandScape?60:175},this.appendChild(this.middleContainerView),this.arrowsContainer=new TKView,this.arrowsContainer.style={height:120,width:206,bottom:60,alignSelf:"center",position:"absolute"},this.middleContainerView.appendChild(this.arrowsContainer),this.handImage=new TKImage,this.handImage.style={height:this.isLandScape?129:162,width:this.isLandScape?80:100,bottom:this.isLandScape?10:-20,left:this.isLandScape?129:149,position:"absolute"},vt(this.handImage,"splash_slide_animation_hand.png"),this.middleContainerView.appendChild(this.handImage),this.baseArrows=new TKImage,this.baseArrows.style={height:"100%",width:"100%",position:"absolute"},vt(this.baseArrows,"splash_base_arrows.png"),this.arrowsContainer.appendChild(this.baseArrows);let t=new TKView;t.style={height:42,width:"100%",left:0,top:0,position:"absolute",overflow:"hidden"},this.arrowsContainer.appendChild(t),this.upHighlightArrow=new TKImage,this.upHighlightArrow.style={height:120,width:"100%",left:0,top:0,position:"absolute",opacity:0,overflow:"hidden"},vt(this.upHighlightArrow,"splash_up_highlight_arrow.png"),t.appendChild(this.upHighlightArrow);let e=new TKView;e.style={height:"100%",width:42,right:0,top:0,position:"absolute",overflow:"hidden"},this.arrowsContainer.appendChild(e),this.rightHighlightArrow=new TKImage,this.rightHighlightArrow.style={height:"100%",width:206,right:0,top:0,position:"absolute",opacity:0},vt(this.rightHighlightArrow,"splash_right_hightlight_arrow.png"),e.appendChild(this.rightHighlightArrow);let i=new TKView;i.style={height:42,width:"100%",left:0,bottom:0,position:"absolute",overflow:"hidden"},this.arrowsContainer.appendChild(i),this.downHighlightArrow=new TKImage,this.downHighlightArrow.style={height:120,width:"100%",left:0,bottom:0,position:"absolute",opacity:0,overflow:"hidden"},vt(this.downHighlightArrow,"splash_down_hightlight_arrow.png"),i.appendChild(this.downHighlightArrow);let a=new TKView;a.style={height:"100%",width:42,left:0,top:0,position:"absolute",overflow:"hidden"},this.arrowsContainer.appendChild(a),this.leftHighlightArrow=new TKImage,this.leftHighlightArrow.style={height:"100%",width:206,left:0,top:0,position:"absolute",opacity:0,overflow:"hidden"},vt(this.leftHighlightArrow,"splash_left_hightlight_arrow.png"),a.appendChild(this.leftHighlightArrow)}startShowAnimation(){let t=this.createAnimation(),e=this.createAnimation(),i=this.createAnimation(),a=this.createAnimation(),s=this.createAnimation();this.upHighlightArrow.addAnimation(e,"upArrowOpacityAnimation"),this.rightHighlightArrow.addAnimation(i,"rightArrowOpacityAnimation"),this.handImage.addAnimation(t,"handTranslateAnimation"),this.downHighlightArrow.addAnimation(a,"downArrowOpacityAnimation"),this.leftHighlightArrow.addAnimation(s,"leftArrowOpacityAnimation")}createAnimation(){let t=-120,e=this,i=new TKKeyframeAnimation;return i.setAnimations([()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},0),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},.02),()=>(e.upHighlightArrow.style={opacity:1},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:-73}},opacity:1},.11),()=>(e.upHighlightArrow.style={opacity:1},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:-73}},opacity:1},.13),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:-73}},opacity:0},.22),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:0},.23),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},.25),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},.27),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:1},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:85,y:0}},opacity:1},.36),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:1},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:85,y:0}},opacity:1},.38),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:85,y:0}},opacity:0},.47),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:0},.48),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},.5),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},.52),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:1},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:60}},opacity:1},.61),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:1},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:60}},opacity:1},.63),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:60}},opacity:0},.72),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:0},.73),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},.75),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:1},.77),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:1},e.handImage.style={transform:{translate:{x:t,y:0}},opacity:1},.86),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:1},e.handImage.style={transform:{translate:{x:t,y:0}},opacity:1},.88),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:t,y:0}},opacity:0},.97),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:0},.98),()=>(e.upHighlightArrow.style={opacity:0},e.rightHighlightArrow.style={opacity:0},e.downHighlightArrow.style={opacity:0},e.leftHighlightArrow.style={opacity:0},e.handImage.style={transform:{translate:{x:0,y:0}},opacity:0},1)]),i.duration=5e3,i.timingFunction="linear",i.repeatCount=Number.MAX_SAFE_INTEGER,i}pageDeallocAction(){var t,e,i,a,s;null===(t=this.upHighlightArrow)||void 0===t||t.removeAllAnimation(),null===(e=this.rightHighlightArrow)||void 0===e||e.removeAllAnimation(),null===(i=this.downHighlightArrow)||void 0===i||i.removeAllAnimation(),null===(a=this.leftHighlightArrow)||void 0===a||a.removeAllAnimation,null===(s=this.baseArrows)||void 0===s||s.removeAllAnimation()}pageShowAction(){this.alreadyShow||(this.alreadyShow=!0,this.startShowAnimation(),jt.exposeElement(243))}}class di extends TKView{constructor(t){super(),this.vm=t,this.setupViews()}setupViews(){this.style={width:"100%",height:"100%",position:"absolute"},this.throughHitTest=!0,this.appendSwipeActionBar(),this.appendSwipeAnimationView()}appendSwipeActionBar(){let t=new ci(this.vm);this.appendChild(t)}appendSwipeAnimationView(){this.canvasView=new Ue(this.vm.getSplashSlideConvertDistance(),((t,e,i,a)=>{const s=i-t,n=a-e;Math.abs(s)>=Math.abs(n)?s>0?this.vm.handleSlideConvert(t,e,3,s,!1):this.vm.handleSlideConvert(t,e,2,s,!1):n>0?this.vm.handleSlideConvert(t,e,4,n,!1):this.vm.handleSlideConvert(t,e,1,n,!1)}),((t,e)=>{this.vm.callerContext.onClickEvent&&this.vm.callerContext.onClickEvent(t,e),this.isClickActionBar(t,e)&&this.vm.clickActionBarConvert()})),this.canvasView.style={position:"absolute",width:"100%",height:"100%"},this.appendChild(this.canvasView)}isClickActionBar(t,e){let i=this.vm.getActionBarRect(),a=i.width/2,s=i.height/2,n=this.vm.containerLimit.width/2,o=i.y+s;return Math.pow(n-t,2)/Math.pow(a,2)+Math.pow(o-e,2)/Math.pow(s,2)<=1}}class pi extends Jt{constructor(t){super(),this.vm=t,this.setupViews()}setupViews(){let t;switch(this.style={position:"absolute",width:"100%",height:"100%"},this.throughHitTest=!0,this.vm.getActionBarInteractiveStyle()){case 1:t=new Me(this.vm);break;case 2:t=new ei(this.vm);break;case 3:t=new ni(this.vm);break;case 4:t=new li(this.vm);break;case 9:t=new si(this.vm);break;case 10:t=new ti(this.vm);break;case 12:t=new di(this.vm);break;case 13:t=new Qe(this.vm);default:t=new Qe(this.vm)}t&&this.appendChild(t)}}class mi extends TKView{constructor(t){super(),this.playTime=0,this.isPageVisiable=!1,this.vm=t,this.setupData(),this.setupViews(),this.setupAction()}setupData(){me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":default:break;case"hideEnd":this.clearTimer();break;case"pageVisiable":this.isPageVisiable=!0,this.startCountDown(),this.vm.reportSkipViewImpression();break;case"pageInvisiable":this.isPageVisiable=!1,this.clearTimer()}})),this.countdownNum=this.vm.getImageDisplaySecond(),this.circleCountDownNum=1e3*this.vm.getImageDisplaySecond()}setupViews(){let t;t=bt.isAndroid()?this.vm.isImmersiveMode?Tachikoma.env.statusBarHeight:0:ht?Tachikoma.env.statusBarHeight-11:Tachikoma.env.statusBarHeight,this.style={position:"absolute",width:154,height:118,top:t},this.vm.isShowSkipTopRightView()?this.style={right:0}:this.style={left:0},this.appendSkipView()}setupAction(){this.vm.isShowSplashSkipArea()&&this.addEventListener("tap",(t=>{this.handleClickAction()})),this.ovalSkipView&&this.ovalSkipView.addEventListener("tap",(t=>{this.handleClickAction()})),this.circleSkipView&&this.circleSkipView.addEventListener("tap",(t=>{this.handleClickAction()})),this.circleSkipLottieView&&bt.supportMinimumTKVersion("5.0.0")&&this.circleSkipLottieView.addEventListener("tap",(t=>{this.handleClickAction()}))}appendSkipView(){this.vm.isShowSkipView()&&(this.vm.isShowCircleSkipView()?this.appendCircleSkipView():this.appendOvalSkipView())}appendCircleSkipView(){if(this.vm.isShowSkipCountdown()&&bt.supportMinimumTKVersion("5.0.0")){this.circleSkipLottieView=new TKLottieImageView,this.circleSkipLottieView.style={position:"absolute",top:16,width:36,height:36},this.vm.isShowSkipTopRightView()?this.circleSkipLottieView.style={right:16}:this.circleSkipLottieView.style={left:16},this.appendChild(this.circleSkipLottieView),this.circleSkipLottieView.setUri("bundle://image/ksad-splash-play-card/circle_skip.json");let t=new TKView;t.style={position:"absolute",top:16,width:36,height:36,borderRadius:18,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.vm.isShowSkipTopRightView()?t.style={right:16}:t.style={left:16},t.enabled=!1,this.appendChild(t);let e=new TKText;e.style={fontSize:12,color:"#FFFFFF"},e.setText("跳过"),t.appendChild(e)}else{this.circleSkipView=new TKView,this.circleSkipView.style={position:"absolute",top:16,width:36,height:36,backgroundColor:"#FFFFFF33",borderRadius:18,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.vm.isShowSkipTopRightView()?this.circleSkipView.style={right:16}:this.circleSkipView.style={left:16},this.appendChild(this.circleSkipView);let t=new TKView;t.style={width:32,height:32,backgroundColor:"#0000004D",borderRadius:16,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.circleSkipView.appendChild(t);let e=new TKText;e.style={fontSize:12,color:"#FFFFFF"},e.setText("跳过"),t.appendChild(e)}}appendOvalSkipView(){this.ovalSkipView=new TKView,this.ovalSkipView.style={position:"absolute",top:16,height:32,paddingLeft:16,paddingRight:16,backgroundColor:"#0000004D",flexDirection:"row",borderRadius:16,justifyContent:"center",alignItems:"center"},this.vm.isShowSkipTopRightView()?this.ovalSkipView.style={right:16}:this.ovalSkipView.style={left:16},this.appendChild(this.ovalSkipView);let t=new TKText;if(t.style={fontSize:14,color:"#FFFFFF"},t.setText(this.vm.getSkipTips()),this.ovalSkipView.appendChild(t),this.vm.isShowSkipCountdown()){let t=new TKView;t.style={width:1,height:12,backgroundColor:"#FFFFFF33",marginLeft:8,marginRight:8},this.ovalSkipView.appendChild(t),this.countDownText=new TKText,this.countDownText.style={fontSize:14,color:"#FFFFFF"},this.countDownText.setText(this.countdownNum+""),this.ovalSkipView.appendChild(this.countDownText)}}updateCountdownText(){0!=this.countdownNum?this.countDownText&&this.countDownText.setText(this.countdownNum+""):this.countDownFinish()}updateCircleSkipViewProgress(){let t=this.circleCountDownNum/(1e3*this.vm.getImageDisplaySecond());t<=0&&(t=0),this.circleSkipLottieView&&bt.supportMinimumTKVersion("5.0.0")&&this.circleSkipLottieView.setProgress(t),0==this.circleCountDownNum&&this.countDownFinish()}countDownFinish(){this.vm.playcardShowEnd=!0,!this.vm.adHasConvert&&M(this.vm.adInfo)?this.countDownFinishCallback&&this.countDownFinishCallback():Pt(1),this.clearTimer()}startCountDown(){let t=this;this.vm.isShowSkipCountdown()&&this.vm.isShowCircleSkipView()?this.countdownTimer=setInterval((()=>{t.isPageVisiable&&(this.playTime+=.05,this.circleCountDownNum=this.circleCountDownNum-50,this.updateCircleSkipViewProgress(),this.vm.notifyTimerProgress(this.playTime))}),50):this.countdownTimer=setInterval((()=>{t.isPageVisiable&&(this.playTime+=1,t.countdownNum--,t.updateCountdownText(),this.vm.notifyTimerProgress(this.playTime))}),1e3)}clearTimer(){this.countdownTimer&&clearInterval(this.countdownTimer)}handleClickAction(){this.vm.callAdSkip(this.playTime),this.clearTimer()}}class ui extends TKView{constructor(t){super(),this.vm=t,this.style={height:"100%",top:0,position:"absolute",width:"100%",left:0,justifyContent:"center",alignItems:"center"},this.setupViews()}setupViews(){let t=new TKImage;t.style={height:"100%",top:0,position:"absolute",width:"100%",left:0},this.appendChild(t),t.setSrc("image/ksad-splash-play-card/ic_splash_default_bgimg.webp");let e=new TKView;e.style={width:278,justifyContent:"center",alignItems:"center",marginBottom:70},this.appendChild(e);let i=new TKImage;i.style={width:53,height:53,borderRadius:12},i.setUri(v(this.vm.adInfo)),e.appendChild(i);let a=new TKText;a.style={height:43,maxWidth:278,color:"#ffffff",fontSize:34,marginTop:11,textOverflow:"ellipsis",textLineClamp:1,fontWeight:"bold"},a.setText(L(this.vm.adInfo)),e.appendChild(a);let s=new TKImage;s.style={width:278,height:264,marginTop:8},s.setSrc("image/ksad-splash-play-card/ic_splash_default_icon.png"),e.appendChild(s);let n=new TKText;n.style={maxWidth:278,color:"#ffffff",fontSize:19,marginTop:8,textOverflow:"ellipsis",textLineClamp:2,textAlign:"center"},n.setText(this.vm.adInfo.adBaseInfo.adDescription),e.appendChild(n);let o=new TKText;o.style={maxWidth:278,color:"#BDBDBD",fontSize:8,marginTop:10,textOverflow:"ellipsis",textLineClamp:1,textAlign:"center"},o.setText("*实际福利以活动详情为准"),e.appendChild(o)}}class gi extends TKView{constructor(t){super(),this.isShowing=!1,this.vm=t,this.setupViews(),this.setupAction()}setupAction(){pe(this.vm.$attrsPath.lifeStatus,(t=>{"hideEnd"==t&&this.pageDeallocAction()}))}setupViews(){this.style={position:"absolute",width:"100%",height:"100%",visibility:"hidden"},this.appendBaseImageView(),this.appendMaterialImageView()}appendBaseImageView(){this.baseImageView=new ui(this.vm),this.appendChild(this.baseImageView)}appendMaterialImageView(){this.materialImgView=new TKImage,this.materialImgView.style={width:"100%",height:"100%"},this.materialImgView.setUri(A(this.vm.adInfo)),this.appendChild(this.materialImgView)}pageDeallocAction(){this.materialImgView.removeAllAnimation(),this.baseImageView.removeAllAnimation(),this.isShowing=!1}pageShowAction(t){this.isShowing||(this.isShowing=!0,t?(this.removeChild(this.materialImgView),this.startAnimation(this.baseImageView)):(this.removeChild(this.baseImageView),this.startAnimation(this.materialImgView)),this.style={visibility:"visible"},this.exposeDynamicLayer())}}class wi extends gi{startAnimation(t){let e=new TKKeyframeAnimation;e.setAnimations([()=>(t.style={transform:{scale:1.5},opacity:.3},0),()=>(t.style={transform:{scale:2},opacity:0},33/83),()=>(t.style={transform:{scale:1.5},opacity:0},1)]),e.duration=830,e.timingFunction="linear",e.repeatCount=Number.MAX_SAFE_INTEGER,t.addAnimation(e,"splashScaleOpacityBreatheAnimation")}exposeDynamicLayer(){let t=new c;t.template_id="splash_dynamics_1";let e={clientExtData:JSON.stringify(t)};jt.log(140,{x:0,y:0},e)}}class fi extends TKView{constructor(t){super(),this.vm=t,this.setupViews()}setupViews(){if(this.style={position:"absolute",width:"100%",height:"100%"},this.throughHitTest=!0,11===this.vm.getDynamicTemplateStyle())this.dynamicLayer=new wi(this.vm);this.dynamicLayer&&this.appendChild(this.dynamicLayer)}pageShow(t){var e;null===(e=this.dynamicLayer)||void 0===e||e.pageShowAction(t)}}function yi(t,e,i=!1){const a=new TKKeyframeAnimation;return i?(a.setAnimations([()=>(t.style={opacity:1},1)]),a.timingFunction="ease-in-out"):(a.animType="opacity",a.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:1,value:1,easing:"EaseInEaseOut"}]),a.duration=e,a}function Ii(t,e,i=!1){const a=new TKKeyframeAnimation;return i?(a.setAnimations([()=>(t.style={opacity:0},1)]),a.timingFunction="ease-in-out"):(a.animType="opacity",a.keyframes=[{percent:0,value:0,easing:"EaseInEaseOut"},{percent:1,value:0,easing:"EaseInEaseOut"}]),a.duration=e,a}class Ci extends TKView{constructor(t){super(),this.vm=t,this.setupView(),this.setupAction(),this.fitHorizontalScreenView(),this.vm.getActionBarRect=()=>({x:this.actionbarView.getOrigin().x,y:this.actionbarView.getOrigin().y,width:169,height:48}),pe(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{"hideEnd"==t&&this.sweepTimer&&clearInterval(this.sweepTimer)}))}setupView(){this.setupRootView(),this.setupCountDownView(),this.setupBgView(),this.setupCardInfoView(),this.setupCouponInfoView(),this.setupActionbarView(),this.setupCloseView(),this.tryReportImpression()}setupAction(){this.actionbarView&&this.actionbarView.addEventListener("tap",(t=>{const e=pt(t,this.actionbarView);this.vm.convert(e,1,At.CARD_ACTION_BAR_CLICK),this.vm.enableShowCloseView()&&this.onCloseClick&&this.onCloseClick(3)})),this.closeImage&&this.closeImage.addEventListener("tap",(t=>{this.onCloseClick&&this.onCloseClick(1)})),this.vm.isSplashScene()||this.vm.isInterstitialScene()||this.bgContainerView.addEventListener("tap",(t=>{const e=pt(t,this.bgContainerView);this.vm.convert(e,2,At.CARD_OTHERAREA_CLICK),this.onCloseClick&&this.onCloseClick(3)}))}setupRootView(){this.actionBarSize=this.getActionBarSize(),this.style={width:"100%",height:"100%",backgroundColor:"#00000099",flexDirection:"column",alignItems:"center",justifyContent:"center"},this.rootContainerView=new TKView,this.rootContainerView.style={width:"100%",height:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:52},this.vm.enableShowCloseView()&&(this.rootContainerView.style={transform:{scale:0},opacity:0}),this.appendChild(this.rootContainerView)}setupCountDownView(){if(!this.vm.enableShowCountDownView())return;let t=new TKView;t.style={shadow:"0 0 26 #FFDF8E99"},this.countDownTextView=new TKText,this.countDownTextView.style={fontSize:22,marginBottom:8,fontWeight:"600",color:bt.isAndroid()?"#FFE296":"#FFF7E0",gradientTextColor:"270,FFFFFF,FFE296"},t.appendChild(this.countDownTextView),this.countDownTextView.setText("限时福利 "+this.vm.getRightsCardStayTime()+"s 后消失"),this.rootContainerView.appendChild(t)}setupBgView(){this.bgContainerView=new TKView,this.bgContainerView.style={width:273,height:263,flexDirection:"column",alignItems:"center"},this.rootContainerView.appendChild(this.bgContainerView),this.bgImageView=new TKImage,this.bgImageView.style={width:273,height:263,bottomLeftRadius:60,bottomRightRadius:60},this.bgImageView.setSrc(this.vm.getBgUrl()),this.bgContainerView.appendChild(this.bgImageView),this.setupIPView(),this.bgBottomImageView=new TKImage,this.bgBottomImageView.style={width:273,height:263,position:"absolute",left:0,top:0},vt(this.bgBottomImageView,this.vm.getBottomImageViewName()),this.bgContainerView.appendChild(this.bgBottomImageView),this.setupTipsView()}setupTipsView(){let t=this.vm.getBottomTipsText();if(ft(t))return;let e=new TKText;e.style={maxWidth:"249",height:"15",fontSize:10,color:"#B8AB3B",includeFontPadding:!1,textAlign:"center",position:"absolute",bottom:10},e.setText(t),this.bgContainerView.appendChild(e)}setupCardInfoView(){this.cardInfoView=new TKView,this.cardInfoView.style={position:"absolute",left:40,width:84,top:34,flexDirection:"column"},this.bgContainerView.appendChild(this.cardInfoView),this.cardTitleText=new TKText,this.cardTitleText.style={fontSize:20,fontWeight:"900",color:"#FFFFFF"},this.cardTitleText.setText("恭喜获得"),this.cardInfoView.appendChild(this.cardTitleText),this.cardDescText=new TKText,this.cardDescText.style={color:"#FFFFFF",fontSize:11,marginTop:2,width:"100%",textLineClamp:1,textOverflow:"ellipsis"},this.cardDescText.setText(this.vm.getTitleDesc()),this.cardInfoView.appendChild(this.cardDescText)}setupIPView(){this.ipImageView=new TKImage,this.ipImageView.style={position:"absolute",right:12,top:1,width:134,height:134},this.ipImageView.setSrc(this.vm.getUserIcon()),this.bgContainerView.appendChild(this.ipImageView)}setupCouponInfoView(){this.couponInfoView=new TKView,this.couponInfoView.style={position:"absolute",left:31,bottom:38,width:211,height:69,flexDirection:"row",alignItems:"center"},this.bgContainerView.appendChild(this.couponInfoView),this.priceView=new TKView,this.priceView.style={paddingLeft:8,height:69,width:"36%",flexDirection:"row",alignItems:"center"},this.couponInfoView.appendChild(this.priceView);const t=this.getMeatureSize(this.vm.isVertical()?30:20);this.priceSymbolText=new TKText,this.priceSymbolText.style={fontSize:16,fontWeight:"500",color:"#FFFFFF",marginRight:-4,marginTop:(30==t?8:6)*t/30},this.priceSymbolText.setText("￥"),this.priceView.appendChild(this.priceSymbolText),this.priceText=new TKText,this.priceText.style={fontSize:t,color:"#FFFFFF",fontWeight:"600",width:54,textLineClamp:1,textOverflow:"ellipsis"},this.priceText.setText(this.vm.getPriceAmount()),this.priceView.appendChild(this.priceText),this.couponDescView=new TKView,this.couponDescView.style={flexDirection:"column",height:69,width:"64%",paddingRight:10,justifyContent:"center"},this.couponInfoView.appendChild(this.couponDescView),this.couponTitleText=new TKText,this.couponTitleText.style={fontSize:15,color:"#FFFFFF",textLineClamp:1,textOverflow:"ellipsis",fontWeight:"600"},this.couponTitleText.setText(this.vm.getCouponTitle()),this.couponDescView.appendChild(this.couponTitleText),this.couponDescText=new TKText,this.couponDescText.style={fontSize:10,color:"#FFFFFF",marginTop:4,textLineClamp:1,textOverflow:"ellipsis"},this.couponDescText.setText(this.vm.getCouponDesc()),this.couponDescView.appendChild(this.couponDescText)}setupActionbarView(){this.vm.enableShowActionbarView()&&(this.actionbarView=new TKView,this.actionbarView.style={width:169,height:48,borderRadius:this.actionBarSize.height/2,marginTop:16},this.rootContainerView.appendChild(this.actionbarView),this.actionbarBgImageView=new TKImage,this.actionbarBgImageView.style={width:169,height:48},vt(this.actionbarBgImageView,"ec_card_actionbar_bg.png"),this.actionbarView.appendChild(this.actionbarBgImageView),this.actionbarText=new TKText,this.actionbarText.style={position:"absolute",left:0,top:-1,fontWeight:"600",width:169,height:48,paddingLeft:10,paddingRight:10,textLineClamp:1,minimumTextScaleFactor:.5,textOverflow:"ellipsis",textAlign:"center",color:"#FFFFFF",fontSize:20},this.actionbarView.appendChild(this.actionbarText),1==this.vm.callerContext.adInfo.adBaseInfo.adOperationType?de(this.actionbarText,"text",this.vm.$attrsPath.actionBarText):this.actionbarText.setText(this.vm.getActionbarDesc()),this.tryShowSweepAnimation())}tryShowSweepAnimation(){this.vm.enableAnimation()&&bt.supportMinimumTKVersion("5.0.0")&&(this.sweepTimer&&clearInterval(this.sweepTimer),this.addSweepAnimation(),this.sweepTimer=setInterval((()=>{this.addSweepAnimation()}),2e3))}addSweepAnimation(){if(this.sweepView&&this.actionbarView.removeChild(this.sweepView),bt.supportMinimumTKVersion("5.0.0")){this.sweepView=new RoundRectView,this.sweepView.style={width:this.actionBarSize.width,height:this.actionBarSize.height,borderRadius:this.actionBarSize.height/2,left:0,top:0,position:"absolute"};const t=128*this.actionBarSize.height/60;this.sweepImage=new TKImage,this.sweepImage.style={width:t,height:this.actionBarSize.height,left:-t,top:0,position:"absolute"},this.sweepView.appendChild(this.sweepImage),vt(this.sweepImage,"ksad_light.png"),this.actionbarView.appendChild(this.sweepView),this.sweepImage.addAnimation(function(t,e){const i=new TKBasicAnimation;return i.duration=t,i.timingFunction="Linear",i.animValue={position:{x:e,y:0,z:0}},i}(1e3,this.actionBarSize.width+t),"anim")}}setupCloseView(){this.vm.enableShowCloseView()&&(this.closeImage=new TKImage,this.closeImage.style={width:40,height:40,marginTop:10},vt(this.closeImage,"ec_card_close.png"),this.rootContainerView.appendChild(this.closeImage))}show(){this.startShowAnimation()}updateCountdown(t){this.countDownTextView&&this.countDownTextView.setText(`限时福利 ${t}s 后消失`)}startShowAnimation(){let t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.rootContainerView.style={transform:{scale:0},opacity:0},0),()=>(t.rootContainerView.style={transform:{scale:1},opacity:1},1)]),e.duration=600,e.timingFunction="linear",this.rootContainerView.addAnimation(e,"ecShowAnimation")}getMeatureSize(t){try{let e=new TKText;if(e.style={fontSize:t,width:54,fontWeight:"600"},e.setText(this.vm.getPriceAmount()),e.measureText(54,2).height>1.5*t){if((t-=2)<=18)return t;t=this.getMeatureSize(t)}}catch(e){return t}return t}tryReportImpression(){this.vm.logSplashCardImpression()}getActionBarSize(){return{width:169,height:48}}fitHorizontalScreenView(){}}class Ti extends Jt{constructor(t){super(),this.vm=t,this.vm.getSplashAdLoadProcessChange()&&(this.beginRenderTime=(new Date).getTime()),this.setupViews()}setupViews(){this.style={width:"100%",height:"100%"},this.startImageLoadCountDown(),this.appendDefaultImageView(),this.appendImageAndDynamicLayer(),this.appendForegroundImageView(),this.appendECView(),this.appendActionBarView(),this.appendMiddleCardView(),this.appendSkipView(),this.appendLogoView(),this.appendPrivacyView(),this.appendGradientBgView(),function(t){try{let e=t.adMatrixInfo.adDataV2.splashInfo.interactionInfo,i=e.interactiveStyle,a=-1,s="";switch(i){case 0:a=1,s="interactiveStyle为0";break;case 2:case 9:e.shakeInfo&&e.shakeInfo.enable||(a=2,s=e.shakeInfo?"shakeInfo.enable不为true":"shakeInfo为空");break;case 1:case 10:e.rotateInfo&&e.rotateInfo.enable||(a=3,s=e.rotateInfo?"rotateInfo.enable不为true":"rotateInfo为空")}zt({error_msg:s,error_code:a})}catch(e){zt({error_msg:rt(e),error_code:4})}}(this.vm.adInfo)}showDynamicLayer(t){this.dynamicLayer=new fi(this.vm),this.imageDynamicLayerContainer.appendChild(this.dynamicLayer),this.dynamicLayer.pageShow(t)}appendImageAndDynamicLayer(){this.imageDynamicLayerContainer=new TKView,this.imageDynamicLayerContainer.style={height:"100%",top:0,position:"absolute",width:"100%",left:0,justifyContent:"center",alignItems:"center"},this.appendChild(this.imageDynamicLayerContainer)}appendECView(){if(!this.vm.enableShowECCardView())return;let t=new Ci(this.vm.ecCustomCardViewModel);t.style={position:"absolute",left:0,top:0,width:"100%",height:"100%",paddingBottom:this.vm.isSplashViewFullscreen()?0:80},this.appendChild(t),this.vm.callerContext.onClickEvent=(t,e)=>{this.vm.tryConvertECCardView(t,e)}}appendForegroundImageView(){this.foregroundImage=new TKImage,this.foregroundImage.style={position:"absolute",width:"100%",left:0,resize:"cover"},this.vm.isInnerImage()?(this.adapterImageCutRule(),this.foregroundImage.style={top:this.imageTop,bottom:this.imageBottom}):this.foregroundImage.style={height:"100%",top:0},this.foregroundImage.setImageLoadCallback((t=>{t?(this.isImageLoadSuccess=!0,this.vm.reportSplashShowImageDuration(!0,this.beginRenderTime),this.showDynamicLayer(!1)):this.showNativeImage()})),this.foregroundImage.setUri(A(this.vm.adInfo)),this.imageDynamicLayerContainer.appendChild(this.foregroundImage)}startImageLoadCountDown(){if(!this.vm.getSplashAdLoadProcessChange())return;var t;Ut({status:3001,creative_id:(t=this.vm.adInfo).adBaseInfo.creativeId,preload_id:t.adPreloadInfo.preloadId,material_type:2,url:A(t)});let e=this;setTimeout((()=>{e.showNativeImage()}),this.vm.getImageDownloadTimeMs())}showNativeImage(){var t;this.hasShowNativeImage||(this.isImageLoadSuccess?Ut({status:3002,creative_id:(t=this.vm.adInfo).adBaseInfo.creativeId,preload_id:t.adPreloadInfo.preloadId,material_type:2,url:A(t)}):(this.vm.reportSplashShowImageDuration(!1,this.beginRenderTime),function(t){Ut({status:3003,creative_id:t.adBaseInfo.creativeId,preload_id:t.adPreloadInfo.preloadId,material_type:2,url:A(t)})}(this.vm.adInfo),this.hasShowNativeImage=!0,this.vm.tkHasShowNativeImage=!0,this.removeChild(this.foregroundImage),this.appendDefaultImageContent(),this.defaultImageContainer.style={visibility:"visible"},this.showDynamicLayer(!0)))}appendDefaultImageView(){this.defaultImageContainer=new TKView,this.defaultImageContainer.style={height:"100%",top:0,position:"absolute",width:"100%",left:0,justifyContent:"center",alignItems:"center",visibility:"hidden"},this.appendChild(this.defaultImageContainer)}appendDefaultImageContent(){this.defaultImageView=new ui(this.vm),this.defaultImageContainer.appendChild(this.defaultImageView)}adapterImageCutRule(){let t=this.vm.containerLimit.width,e=this.vm.containerLimit.height,i=2340,a=t/1080,s=1152*(880*a)/880,n=(i*a-e)/2,o=((i*a-s)*(664/1188)-n-((i*a-s)*(524/1188)-n))/2-.03*e;o>0?(this.imageTop=0,this.imageBottom=-1*o):(this.imageTop=-1*o,this.imageBottom=0)}appendMiddleCardView(){this.vm.isSplashRedPacketDisplayTopLevel()||(this.middleCardView=new TKView,this.middleCardView.style={position:"absolute",left:0,top:0,width:"100%",height:"100%"},this.appendChild(this.middleCardView),this.middleCardView.throughHitTest=!0)}getMiddleView(){return this.middleCardView}appendSkipView(){this.skipView=new mi(this.vm),this.skipView.countDownFinishCallback=()=>{this.removeAll(),this.vm.showEndPage=!0,this.appendEndCard()},this.appendChild(this.skipView)}appendEndCard(){let t=new Be(this.vm.adInfo,this.vm.configInfo,this.vm.containerLimit,this.vm.screenOrientation),e=new Fe(t);this.appendChild(e)}appendLogoView(){if(!this.vm.isShowLogoView())return;let t=this.vm.callerContext.isLandScape();this.logoView=new we(1,this.vm.adInfo),this.logoView.style={position:"absolute",right:t?null:16,bottom:t?34:16,left:this.vm.getSideMargin()},this.logoView.enabled=!1,this.appendChild(this.logoView)}appendPrivacyView(){if(!E(this.vm.adInfo))return;const t=this.vm.containerLimit.width-30;this.privacyView=new fe(this.vm.adInfo,this.vm.screenOrientation,t),this.privacyView.style={backgroundColor:"#FFFFFF00",top:this.vm.isImmersiveMode?this.vm.getPrivacyViewOriTop()+Tachikoma.env.statusBarHeight:this.vm.getPrivacyViewOriTop(),position:"absolute",left:this.vm.callerContext.isLandScape()?6:null},this.privacyView.clickCallback=(t,e)=>{Bt.openURL(t,e)},this.appendChild(this.privacyView)}appendActionBarView(){let t=new pi(this.vm);this.appendChild(t)}appendGradientBgView(){let t=new TKView;t.style={position:"absolute",top:0,left:0,width:"100%",height:80,gradientBgColor:"90,00000000,00000066"},t.enabled=!1,this.appendChild(t)}}class vi extends TKView{constructor(t){super(),this.playTime=0,this.vm=t,this.setupData(),this.setupViews(),this.setupAction()}setupData(){this.totalCountdownTime=Math.min(this.vm.getVideoDisplaySecond(),V(this.vm.adInfo))}setupViews(){this.style={width:"100%",height:this.vm.callerContext.isLandScape()?55:118,position:"absolute",top:this.getTopMargin()},this.skipAreaView=new TKView,this.skipAreaView.style={position:"absolute",top:lt().top,width:154,height:this.vm.callerContext.isLandScape()?55:118,right:0},this.appendChild(this.skipAreaView),this.skipRootView=new TKView,this.skipRootView.style={top:16,height:32,flexDirection:"row",alignItems:"center",position:"absolute"},this.vm.isShowSkipTopRightView()?this.skipRootView.style={right:16}:this.skipRootView.style={left:16},this.appendChild(this.skipRootView),this.appendSkipAndPreloadView(),this.vm.videoProgressCallback=(t,e,i)=>{this.playTime=t,this.currentTime=Math.floor(this.totalCountdownTime-t),this.updateCountdownText(),this.vm.notifyTimerProgress(this.playTime),this.vm.reportSkipViewImpression()}}getTopMargin(){return dt()?this.vm.isImmersiveMode?Tachikoma.env.statusBarHeight:0:ht?Tachikoma.env.statusBarHeight-11:Tachikoma.env.statusBarHeight}setupAction(){this.vm.isShowSplashSkipArea()&&this.skipAreaView.addEventListener("tap",(t=>{this.vm.callAdSkip(this.playTime)})),this.ovalSkipView&&this.ovalSkipView.addEventListener("tap",(t=>{this.vm.callAdSkip(this.playTime)}))}appendSkipView(){this.vm.isShowSkipView()&&this.appendOvalSkipView()}appendOvalSkipView(){this.ovalSkipView=new TKView,this.ovalSkipView.style={height:32,paddingLeft:16,paddingRight:16,backgroundColor:"#0000004D",flexDirection:"row",borderRadius:16,justifyContent:"center",alignItems:"center"},this.skipRootView.appendChild(this.ovalSkipView);let t=new TKText;if(t.style={fontSize:14,color:"#FFFFFF"},t.setText(this.vm.getSkipTips()),this.ovalSkipView.appendChild(t),this.vm.isShowSkipCountdown()){let t=new TKView;t.style={width:1,height:12,backgroundColor:"#FFFFFF33",marginLeft:8,marginRight:8},this.ovalSkipView.appendChild(t),this.countDownText=new TKText,this.countDownText.style={fontSize:14,color:"#FFFFFF"},this.countDownText.setText(this.totalCountdownTime+""),this.ovalSkipView.appendChild(this.countDownText)}}appendPreloadTipsView(){if(ft(this.vm.getPreloadTips()))return;let t=new TKText;t.style={color:"#FFFFFF",fontSize:12,marginLeft:15,marginRight:15},t.setText(this.vm.getPreloadTips()),this.skipRootView.appendChild(t)}updateCountdownText(){if(this.currentTime<=0)return this.vm.playcardShowEnd=!0,void Pt(1);this.countDownText&&this.countDownText.setText(this.currentTime+"")}appendSkipAndPreloadView(){this.vm.isShowSkipTopRightView()?(this.appendPreloadTipsView(),this.appendSkipView()):(this.appendSkipView(),this.appendPreloadTipsView())}}class Si extends Jt{constructor(t){super(),this.hasPlay=!1,this.vm=t,this.setupViews(),this.setupAction(),bt.isAndroid()||(this.soundImageView.style={top:ht?Tachikoma.env.statusBarHeight-11+16:Tachikoma.env.statusBarHeight+16})}setupViews(){this.style={width:"100%",height:"100%",backgroundColor:"#000000"},this.appendFirstFrameView(),this.appendVideoView(),this.appendECView(),this.appendActionBarView(),this.appendMiddleCardView(),this.appendSkipView(),this.appendSoundView(),this.appendLogoView(),this.appendPrivacyView(),this.appendGradientBgView(),me(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{switch(t){case"showEnd":this.hasPlay||(this.hasPlay=!0,this.playerView.play());break;case"pageVisiable":this.playerView.resume();break;case"pageInvisiable":this.playerView.pause();break;case"hideEnd":this.playerView.stop()}})),me(this.vm,this.vm.$attrsPath.isMuted,(t=>{this.playerView.setMuted(t),vt(this.soundImageView,this.vm.getSoundUrl())}))}setupAction(){this.soundImageView.addEventListener("tap",(t=>{this.vm.isMuted=!this.vm.isMuted}))}appendFirstFrameView(){this.firstFrameImage=new TKImage,this.firstFrameImage.style={width:"100%",height:"100%"};let t=b(this.vm.adInfo);ft(t)||this.firstFrameImage.setUri(t),this.appendChild(this.firstFrameImage)}appendVideoView(){this.playerView=new TKVideoPlayer,this.playerView.style={width:"100%",height:"100%",position:"absolute"},this.playerView.setURL(A(this.vm.adInfo)),this.playerView.setVideoAdaptStrategy(this.vm.callerContext.isLandScape()?1:2),this.playerView.prepareToPlay(),this.playerView.setMuted(this.vm.isMuted),this.appendChild(this.playerView),this.playerView.setOnFailed(((t,e)=>{this.vm.videoPlayFailed(0,"onMediaPlayError")})),this.playerView.setOnFinish((()=>{this.vm.videoFinish()})),this.playerView.setOnProgress(((t,e,i)=>{this.vm.videoProgress(t,e,i)})),this.playerView.setOnMuteChange((t=>{this.vm.isMuted=t})),this.playerView.setOnFirstFrame((()=>{this.vm.videoPlayStart()}))}appendMiddleCardView(){this.vm.isSplashRedPacketDisplayTopLevel()||(this.middleCardView=new TKView,this.middleCardView.style={position:"absolute",left:0,top:0,width:"100%",height:"100%"},this.appendChild(this.middleCardView),this.middleCardView.throughHitTest=!0)}getMiddleView(){return this.middleCardView}appendSkipView(){this.skipView=new vi(this.vm),this.appendChild(this.skipView)}appendSoundView(){this.soundImageView=new TKImage,this.soundImageView.style={top:this.vm.isImmersiveMode?16+Tachikoma.env.statusBarHeight:16+lt().top,width:34,height:30,position:"absolute"},this.vm.isShowSkipTopRightView()?this.soundImageView.style={left:16}:this.soundImageView.style={right:16},vt(this.soundImageView,this.vm.getSoundUrl()),this.appendChild(this.soundImageView)}appendLogoView(){if(!this.vm.isShowLogoView())return;let t=this.vm.callerContext.isLandScape();this.logoView=new we(1,this.vm.adInfo),this.logoView.style={position:"absolute",right:t?null:16,bottom:t?34:16,left:this.vm.getSideMargin()},this.logoView.enabled=!1,this.appendChild(this.logoView)}appendPrivacyView(){if(!E(this.vm.adInfo))return;const t=this.vm.containerLimit.width-62;this.privacyView=new fe(this.vm.adInfo,this.vm.screenOrientation,t),this.privacyView.style={backgroundColor:"#FFFFFF00",left:this.vm.callerContext.isLandScape()?6:16,right:16,top:this.vm.isImmersiveMode?76+(this.vm.isShowSkipTopRightView()?Tachikoma.env.statusBarHeight:16):76,position:"absolute"},this.privacyView.clickCallback=(t,e)=>{Bt.openURL(t,e)},this.appendChild(this.privacyView)}appendECView(){if(!this.vm.enableShowECCardView())return;let t=new Ci(this.vm.ecCustomCardViewModel);t.style={position:"absolute",left:0,top:0,width:"100%",height:"100%",paddingBottom:this.vm.isSplashViewFullscreen()?0:80},this.appendChild(t),this.vm.callerContext.onClickEvent=(t,e)=>{this.vm.tryConvertECCardView(t,e)}}appendActionBarView(){let t=new pi(this.vm);this.appendChild(t)}appendGradientBgView(){let t=new TKView;t.style={position:"absolute",top:0,left:0,width:"100%",height:80,gradientBgColor:"90,00000000,00000066"},t.enabled=!1,this.appendChild(t)}}class bi extends TKView{constructor(t,e){super(),this.vm=t,this.screenWidth=this.vm.callerContext.containerLimit.width,this.screenHeight=this.vm.callerContext.containerLimit.height,this.nextAnim=e,this.setupViews(),this.setupActions()}setupViews(){this.style={width:"100%",height:"100%",position:"absolute",top:0,left:0},this.throughHitTest=!0,this.setupPreHeatView(),setTimeout((()=>{this.vm.enableCountDown()?this.setBubbleAppearAnimation((()=>{this.vm.isShowEnd||(this.preHeatView.removeChild(this.preHeatBubbleRedPacketView),this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.setBubbleCountDownAnimation())}),bi.NEO_PREHEAT_ANIMATION_SPEED):this.vm.isSplash()?this.setBubbleAppearAnimation((()=>{this.vm.isShowEnd||(this.preHeatView.removeChild(this.preHeatBubbleRedPacketView),this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.setBubbleDisappearAnimation(bi.SPLASH_PREHEAT_ANIMATION_SPEED))}),bi.SPLASH_PREHEAT_ANIMATION_SPEED):this.setBubbleAppearAnimation((()=>{this.vm.isShowEnd||(this.preHeatView.removeChild(this.preHeatBubbleRedPacketView),this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.setBubbleDisappearAnimation(bi.INTERSTITIAL_PREHEAT_ANIMATION_SPEED))}),bi.INTERSTITIAL_PREHEAT_ANIMATION_SPEED)}),200)}setupPreHeatView(){this.preHeatView=new TKView,this.preHeatView.throughHitTest=!0,this.preHeatView.style={width:"100%",height:"100%",top:0,alignSelf:"center",flexDirection:"column",alignItems:"center"},this.appendChild(this.preHeatView),this.preHeatBubbleRedPacketView=new TKView,this.preHeatBubbleRedPacketView.throughHitTest=!0,this.preHeatBubbleRedPacketView.style={position:"absolute",width:"100%",height:"100%",top:0,opacity:0},this.preHeatView.appendChild(this.preHeatBubbleRedPacketView),this.preHeatRedPacketView=new TKView,this.preHeatRedPacketView.style={position:"absolute",width:this.screenAdaptate(270),height:this.screenAdaptate(270),top:(this.screenHeight-this.screenAdaptate(270)-38)/2,alignSelf:"center"},this.preHeatBubbleRedPacketView.appendChild(this.preHeatRedPacketView);let t=this.vm.getIndustryTopIcon();this.preHeatRedPacket=new TKImage,ft(t)?(this.preHeatRedPacket.style={position:"absolute",width:this.screenAdaptate(132),height:this.screenAdaptate(132),top:this.screenAdaptate(69),alignSelf:"center"},vt(this.preHeatRedPacket,"image/BubbleRainResources/icon_ksad_bubble_rain_red_packet.png"),this.preHeatRedPacketView.appendChild(this.preHeatRedPacket),this.setupSubView(bi.LOGO_DISTANCE_WITHOUT_IP,bi.NUMBER_DISTANCE_WITHOUT_IP)):(this.preHeatRedPacket.style={position:"absolute",width:this.screenAdaptate(132),height:this.screenAdaptate(172),top:this.screenAdaptate(46),alignSelf:"center"},vt(this.preHeatRedPacket,t),this.preHeatRedPacketView.appendChild(this.preHeatRedPacket),this.setupSubView(bi.LOGO_DISTANCE_WITH_IP,bi.NUMBER_DISTANCE_WITH_IP)),this.preHeatBubble=new TKImage,this.preHeatBubble.style={position:"absolute",width:this.screenAdaptate(270),height:this.screenAdaptate(270),top:(this.screenHeight-this.screenAdaptate(270)-38)/2,alignSelf:"center"},vt(this.preHeatBubble,"image/BubbleRainResources/icon_ksad_bubble_rain_bubble.png"),this.preHeatBubbleRedPacketView.appendChild(this.preHeatBubble),this.preHeatDescView=new TKView,this.preHeatDescView.style={position:"absolute",width:202,height:38,top:(this.screenHeight+this.screenAdaptate(270)-38)/2,alignItems:"center"},this.preHeatView.appendChild(this.preHeatDescView),this.preHeatDescTextBackground=new TKView,this.preHeatDescTextBackground.style={width:202,height:38,borderRadius:20,gradientBgColor:"270, #FFF9EB, #B8976A, #DBC3A7"},this.preHeatDescView.appendChild(this.preHeatDescTextBackground),this.preHeatDescText=new TKText,this.preHeatDescText.style={position:"absolute",width:198,height:34,top:2,fontSize:16,color:"#FFFFFF",textLineHeight:22,borderRadius:20,textAlign:"center",fontWeight:"500",shadow:"0 1 3 #00000025",backgroundColor:"#FC4118"};let e=this.vm.getBubbleActionDes();ft(e)&&(e="立即开启大促"),this.preHeatDescText.text=e,this.preHeatDescView.appendChild(this.preHeatDescText)}setupSubView(t,e){let i=this.vm.getRedPacketIndustryIcon();ft(i)&&(i=""),this.preHeatLogo=new TKImage,this.preHeatLogo.style={position:"absolute",width:this.screenAdaptate(86),height:this.screenAdaptate(38),top:this.screenAdaptate(147+t),left:this.screenAdaptate(94)},St(this.preHeatLogo,i,500,(t=>{t||this.preHeatLogo.setVisibility("hidden")})),this.preHeatRedPacketView.appendChild(this.preHeatLogo),this.preHeatNumber3=new TKImage,this.preHeatNumber3.style={position:"absolute",width:this.screenAdaptate(24),height:this.screenAdaptate(34),top:this.screenAdaptate(146+e),left:this.screenAdaptate(122),opacity:0},vt(this.preHeatNumber3,"image/BubbleRainResources/icon_ksad_bubble_rain_preheat_number3.png"),this.preHeatRedPacketView.appendChild(this.preHeatNumber3),this.preHeatNumber2=new TKImage,this.preHeatNumber2.style={position:"absolute",width:this.screenAdaptate(24),height:this.screenAdaptate(34),top:this.screenAdaptate(146+e),left:this.screenAdaptate(123),opacity:0},vt(this.preHeatNumber2,"image/BubbleRainResources/icon_ksad_bubble_rain_preheat_number2.png"),this.preHeatRedPacketView.appendChild(this.preHeatNumber2),this.preHeatNumber1=new TKImage,this.preHeatNumber1.style={position:"absolute",width:this.screenAdaptate(14),height:this.screenAdaptate(35),top:this.screenAdaptate(146+e),left:this.screenAdaptate(127),opacity:0},vt(this.preHeatNumber1,"image/BubbleRainResources/icon_ksad_bubble_rain_preheat_number1.png"),this.preHeatRedPacketView.appendChild(this.preHeatNumber1)}setBubbleAppearAnimation(t,e){let i=new TKKeyframeAnimation;dt()?i.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:.13,translate:{x:0,y:154,z:0},rotate:{x:0,y:180,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1.196,y:1.059},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]):i.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:.037,y:.13},translate:{x:0,y:154,z:0},rotate:{x:0,y:360,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1.196,y:1.059},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]),i.duration=400*e,i.timingFunction="0.0 0.0 0.0 1.0";let a=new TKKeyframeAnimation;a.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1.196,y:1.059},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:.985,y:1},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]),a.duration=200*e,a.timingFunction="0.0 0.0 0.56 1.0";let s=new TKKeyframeAnimation;s.setAnimations([()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:.985,y:1},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},.001),()=>(this.preHeatBubbleRedPacketView.style={transform:{scale:{x:1,y:1},translate:{x:0,y:0,z:0},rotate:{x:0,y:360,z:0}},opacity:1},1)]),s.duration=250*e,s.timingFunction="linear",s.on("end",t),a.on("end",(()=>{this.vm.isShowEnd||this.preHeatBubbleRedPacketView.addAnimation(s,"bubbleAppearAnimation3")})),i.on("end",(()=>{this.vm.isShowEnd||this.preHeatBubbleRedPacketView.addAnimation(a,"bubbleAppearAnimation2")})),this.preHeatBubbleRedPacketView.addAnimation(i,"bubbleAppearAnimation1")}setBubbleCountDownAnimation(){let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.preHeatLogo.style={opacity:1},.001),()=>(this.preHeatLogo.style={opacity:0},1)]),t.duration=500,t.timingFunction="0.0 0.0 0.38 0.99",this.preHeatLogo.addAnimation(t,"logoAnimation");let e=new TKKeyframeAnimation;e.setAnimations([()=>(this.preHeatNumber3.style={opacity:0},.001),()=>(this.preHeatNumber3.style={opacity:1},5/7),()=>(this.preHeatNumber3.style={opacity:0},1)]),e.duration=700,e.timingFunction="0.0 0.0 0.38 0.99";let i=new TKKeyframeAnimation;i.setAnimations([()=>(this.preHeatNumber2.style={opacity:0},.001),()=>(this.preHeatNumber2.style={opacity:1},5/7),()=>(this.preHeatNumber2.style={opacity:0},1)]),i.duration=700,i.timingFunction="0.0 0.0 0.38 0.99";let a=new TKKeyframeAnimation;a.setAnimations([()=>(this.preHeatNumber1.style={opacity:0},.001),()=>(this.preHeatNumber1.style={opacity:1},1)]),a.duration=500,a.timingFunction="0.0 0.0 0.38 0.99",a.on("end",(()=>{this.vm.isShowEnd||this.setBubbleDisappearAnimation(bi.NEO_PREHEAT_ANIMATION_SPEED)})),i.on("end",(()=>{this.vm.isShowEnd||this.preHeatNumber1.addAnimation(a,"number1Animation")})),e.on("end",(()=>{this.vm.isShowEnd||this.preHeatNumber2.addAnimation(i,"number2Animation")})),this.preHeatNumber3.addAnimation(e,"number3Animation")}setBubbleDisappearAnimation(t){let e=new TKKeyframeAnimation;e.setAnimations([()=>(this.preHeatDescView.style={opacity:1},.001),()=>(this.preHeatDescView.style={opacity:0},1)]),e.duration=1e3*t,e.timingFunction="0.42 0.0 0.58 1.0",this.preHeatDescView.addAnimation(e,"buttonDisappearAnimation");let i=new TKKeyframeAnimation;i.setAnimations([()=>(this.preHeatBubble.style={transform:{scale:1,translate:{y:0}},opacity:1},.001),()=>(this.preHeatBubble.style={transform:{scale:9.47,translate:{y:250}},opacity:0},1)]),i.duration=1e3*t,i.timingFunction="0.42 0.0 0.58 1.0",this.preHeatBubble.addAnimation(i,"bubbleDisappearAnimation");let a=new TKKeyframeAnimation;a.setAnimations([()=>(this.preHeatRedPacketView.style={transform:{scale:1,translate:{y:0}}},.001),()=>(this.preHeatRedPacketView.style={transform:{scale:7.4,translate:{y:550}}},1)]),a.duration=1e3*t,a.timingFunction="0.42 0.0 0.58 1.0",this.preHeatRedPacketView.addAnimation(a,"redPacketEnlargeAnimation");let s=new TKKeyframeAnimation;s.setAnimations([()=>(this.preHeatRedPacketView.style={opacity:1},.001),()=>(this.preHeatRedPacketView.style={opacity:0},1)]),s.duration=1e3*t,s.on("end",(()=>{this.vm.isShowEnd||(this.nextAnim(),this.stopAllAnimation())})),this.preHeatRedPacketView.addAnimation(s,"redPacketDisappearAnimation")}setupActions(){let t=new c;t.template_show_type="bubble_id_click",this.preHeatDescText.addEventListener("tap",(e=>{this.vm.convert(1,{x:e.position.rawX,y:e.position.rawY},At.BUBBLE_RAIN_CLICK,t)})),this.preHeatDescView.addEventListener("tap",(e=>{this.vm.convert(1,{x:e.position.rawX,y:e.position.rawY},At.BUBBLE_RAIN_CLICK,t)})),this.preHeatBubble.addEventListener("tap",(e=>{this.vm.convert(1,{x:e.position.rawX,y:e.position.rawY},At.BUBBLE_RAIN_CLICK,t)}))}stopAllAnimation(){this.preHeatBubbleRedPacketView&&this.preHeatBubbleRedPacketView.removeAllAnimation(),this.preHeatLogo&&this.preHeatLogo.removeAllAnimation(),this.preHeatNumber1&&this.preHeatNumber1.removeAllAnimation(),this.preHeatNumber2&&this.preHeatNumber2.removeAllAnimation(),this.preHeatNumber3&&this.preHeatNumber3.removeAllAnimation(),this.preHeatDescView&&this.preHeatDescView.removeAllAnimation(),this.preHeatBubble&&this.preHeatBubble.removeAllAnimation(),this.preHeatRedPacketView&&this.preHeatRedPacketView.removeAllAnimation(),this.removeAll()}screenAdaptate(t){return t*this.screenWidth/414}}bi.LOGO_DISTANCE_WITH_IP=17,bi.LOGO_DISTANCE_WITHOUT_IP=0,bi.NUMBER_DISTANCE_WITH_IP=17,bi.NUMBER_DISTANCE_WITHOUT_IP=0,bi.SPLASH_PREHEAT_ANIMATION_SPEED=.5,bi.NEO_PREHEAT_ANIMATION_SPEED=1,bi.INTERSTITIAL_PREHEAT_ANIMATION_SPEED=1;class Ai{getStartTime(){return this.startTime}setStartTime(t){this.startTime=t}}class Vi extends Ai{constructor(t,e){super(),this.alpha=t,this.setStartTime(e)}getAplha(){return this.alpha}setAlpha(t){this.alpha=t}}class _i extends Ai{getAplha(){return this.alpha}setAlpha(t){this.alpha=t}getRotationZ(){return this.rotationZ}getRotationX(){return this.rotationX}getRotationY(){return this.rotationY}setRotationX(t){this.rotationX=t}setRotationY(t){this.rotationY=t}setRotationZ(t){this.rotationZ=t}getScaleX(){return this.scaleX}setScaleX(t){this.scaleX=t}getScaleY(){return this.scaleY}setScaleY(t){this.scaleY=t}getTranslationX(){return this.translationX}setTranslationX(t){this.translationX=t}getTranslationY(){return this.translationY}setTranslationY(t){this.translationY=t}toString(){return"{alpha :"+this.alpha+" + rotationX :"+this.rotationX+" + rotationY :"+this.rotationY+" + rotationZ :"+this.rotationZ+" + scaleX :"+this.scaleX+" + scaleY :"+this.scaleY+" + translationX :"+this.translationX+" + translationY :"+this.translationY+"}"}}class Li extends Ai{constructor(t,e,i,a){super(),this.rotationX=void 0,this.rotationY=void 0,this.rotationZ=t,this.rotationY=a,this.rotationX=i,this.setStartTime(e)}getRotationZ(){return this.rotationZ}getRotationX(){return this.rotationX}getRotationY(){return this.rotationY}setRotation(t){this.rotationZ=t}}class xi extends Ai{constructor(t,e,i){super(),this.scaleX=t,this.scaleY=e,this.setStartTime(i)}getScaleX(){return this.scaleX}setScaleX(t){this.scaleX=t}getScaleY(){return this.scaleY}setScaleY(t){this.scaleY=t}}class ki extends Ai{constructor(t,e,i){super(),this.translationX=t,this.translationY=e,this.setStartTime(i)}getTranslationX(){return this.translationX}setTranslationX(t){this.translationX=t}getTranslationY(){return this.translationY}setTranslationY(t){this.translationY=t}}function Di(t,e){return t.getStartTime()-e.getStartTime()}function Ri(t,e,i,a,s){return((a-s)*t+(s-i)*e)/(a-i)}class Ei{produceAnimationResult(t){t.sort(Di);let e=t.length;this.rotationInfoList=new Array,this.alphaInfoList=new Array,this.scaleInfoList=new Array,this.translationInfoList=new Array,this.animationResult=new Map,this.timestampSet=new Set;for(let o=0;o<e;o++)this.timestampSet.add(t[o].getStartTime()),t[o]instanceof Li?this.rotationInfoList.push(t[o]):t[o]instanceof Vi?this.alphaInfoList.push(t[o]):t[o]instanceof xi?this.scaleInfoList.push(t[o]):t[o]instanceof ki&&this.translationInfoList.push(t[o]),this.duration=t[o].getStartTime();let i=0,a=0,s=0,n=0;for(this.timestampSet.forEach((t=>{for(;i<this.alphaInfoList.length;){let e=this.alphaInfoList[i].getStartTime();if(!(e<=t)){if(i>0&&this.alphaInfoList[i-1].getStartTime()!=t){let a=this.alphaInfoList[i-1].getStartTime(),s=Ri(this.alphaInfoList[i-1].getAplha(),this.alphaInfoList[i].getAplha(),a,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setAlpha(s);else{let e=new _i;e.setStartTime(t),e.setAlpha(s),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setAlpha(this.alphaInfoList[i].getAplha());else{let a=new _i;a.setStartTime(t),a.setAlpha(this.alphaInfoList[i].getAplha()),this.animationResult.set(e,a)}i++}for(;s<this.rotationInfoList.length;){let e=this.rotationInfoList[s].getStartTime();if(!(e<=t)){if(s>0&&this.rotationInfoList[s-1].getStartTime()!=t){let i=this.rotationInfoList[s-1].getStartTime(),a=Ri(this.rotationInfoList[s-1].getRotationZ(),this.rotationInfoList[s].getRotationZ(),i,e,t),n=Ri(this.rotationInfoList[s-1].getRotationY(),this.rotationInfoList[s].getRotationY(),i,e,t),o=Ri(this.rotationInfoList[s-1].getRotationX(),this.rotationInfoList[s].getRotationX(),i,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setRotationZ(a),this.animationResult.get(t).setRotationY(n),this.animationResult.get(t).setRotationX(o);else{let e=new _i;e.setStartTime(t),e.setRotationZ(a),e.setRotationY(n),e.setRotationX(o),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setRotationZ(this.rotationInfoList[s].getRotationZ()),this.animationResult.get(e).setRotationY(this.rotationInfoList[s].getRotationY()),this.animationResult.get(e).setRotationX(this.rotationInfoList[s].getRotationX());else{let i=new _i;i.setStartTime(t),i.setRotationZ(this.rotationInfoList[s].getRotationZ()),i.setRotationY(this.rotationInfoList[s].getRotationY()),i.setRotationX(this.rotationInfoList[s].getRotationX()),this.animationResult.set(e,i)}s++}for(;a<this.scaleInfoList.length;){let e=this.scaleInfoList[a].getStartTime();if(!(e<=t)){if(a>0&&this.scaleInfoList[a-1].getStartTime()!=t){let i=this.scaleInfoList[a-1].getStartTime(),s=Ri(this.scaleInfoList[a-1].getScaleX(),this.scaleInfoList[a].getScaleX(),i,e,t),n=Ri(this.scaleInfoList[a-1].getScaleY(),this.scaleInfoList[a].getScaleY(),i,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setScaleX(s),this.animationResult.get(t).setScaleY(n);else{let e=new _i;e.setStartTime(t),e.setScaleX(s),e.setScaleY(n),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setScaleX(this.scaleInfoList[a].getScaleX()),this.animationResult.get(e).setScaleY(this.scaleInfoList[a].getScaleY());else{let i=new _i;i.setStartTime(t),i.setScaleX(this.scaleInfoList[a].getScaleX()),i.setScaleY(this.scaleInfoList[a].getScaleY()),this.animationResult.set(e,i)}a++}for(;n<this.translationInfoList.length;){let e=this.translationInfoList[n].getStartTime();if(!(e<=t)){if(n>0&&this.translationInfoList[n-1].getStartTime()!=t){let i=this.translationInfoList[n-1].getStartTime(),a=Ri(this.translationInfoList[n-1].getTranslationX(),this.translationInfoList[n].getTranslationX(),i,e,t),s=Ri(this.translationInfoList[n-1].getTranslationY(),this.translationInfoList[n].getTranslationY(),i,e,t);if(this.animationResult.has(t))this.animationResult.get(t).setTranslationX(a),this.animationResult.get(t).setTranslationY(s);else{let e=new _i;e.setStartTime(t),e.setTranslationX(a),e.setTranslationY(s),this.animationResult.set(t,e)}}break}if(this.animationResult.has(e))this.animationResult.get(e).setTranslationX(this.translationInfoList[n].getTranslationX()),this.animationResult.get(e).setTranslationY(this.translationInfoList[n].getTranslationY());else{let t=new _i;t.setStartTime(e),t.setTranslationX(this.translationInfoList[n].getTranslationX()),t.setTranslationY(this.translationInfoList[n].getTranslationY()),this.animationResult.set(e,t)}n++}}));i<this.alphaInfoList.length;){let t=this.alphaInfoList[i].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setAlpha(this.alphaInfoList[i].getAplha());else{let e=new _i;e.setStartTime(t),e.setAlpha(this.alphaInfoList[i].getAplha()),this.animationResult.set(t,e)}i++}for(;s<this.rotationInfoList.length;){let t=this.rotationInfoList[s].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setRotationZ(this.rotationInfoList[s].getRotationZ()),this.animationResult.get(t).setRotationY(this.rotationInfoList[s].getRotationY()),this.animationResult.get(t).setRotationX(this.rotationInfoList[s].getRotationX());else{let e=new _i;e.setRotationZ(this.rotationInfoList[s].getRotationZ()),e.setRotationY(this.rotationInfoList[s].getRotationY()),e.setRotationX(this.rotationInfoList[s].getRotationX()),this.animationResult.set(t,e)}s++}for(;a<this.scaleInfoList.length;){let t=this.scaleInfoList[a].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setScaleX(this.scaleInfoList[a].getScaleX()),this.animationResult.get(t).setScaleY(this.scaleInfoList[a].getScaleY());else{let e=new _i;e.setScaleX(this.scaleInfoList[a].getScaleX()),e.setScaleY(this.scaleInfoList[a].getScaleY()),this.animationResult.set(t,e)}a++}for(;n<this.translationInfoList.length;){let t=this.translationInfoList[n].getStartTime();if(this.animationResult.has(t))this.animationResult.get(t).setTranslationX(this.translationInfoList[n].getTranslationX()),this.animationResult.get(t).setTranslationY(this.translationInfoList[n].getTranslationY());else{let e=new _i;e.setTranslationX(this.translationInfoList[n].getTranslationX()),e.setTranslationY(this.translationInfoList[n].getTranslationY()),this.animationResult.set(t,e)}n++}this.animationFiltering()}animationFiltering(){let t=-1;this.timestampSet.forEach((e=>{if(-1!=t){let i=this.animationResult.get(e);this.isInvaildNumber(i.getAplha())&&i.setAlpha(this.animationResult.get(t).getAplha()),this.isInvaildNumber(i.getRotationZ())&&i.setRotationZ(this.animationResult.get(t).getRotationZ()),this.isInvaildNumber(i.getRotationY())&&i.setRotationY(this.animationResult.get(t).getRotationY()),this.isInvaildNumber(i.getRotationX())&&i.setRotationX(this.animationResult.get(t).getRotationX()),this.isInvaildNumber(i.getScaleX())&&i.setScaleX(this.animationResult.get(t).getScaleX()),this.isInvaildNumber(i.getScaleY())&&i.setScaleY(this.animationResult.get(t).getScaleY()),this.isInvaildNumber(i.getTranslationX())&&i.setTranslationX(this.animationResult.get(t).getTranslationX()),this.isInvaildNumber(i.getTranslationY())&&i.setTranslationY(this.animationResult.get(t).getTranslationY())}t=e}))}isInvaildNumber(t){return isNaN(t)||null==t||null==t}bindViewAnmation(t,e,i,a){if(null==t)return;const s=new TKKeyframeAnimation;let n=new Array;this.timestampSet.forEach((e=>{n.push((()=>(t.style={transform:{scale:{x:this.animationResult.get(e).getScaleX(),y:this.animationResult.get(e).getScaleY()},translate:{x:this.animationResult.get(e).getTranslationX(),y:this.animationResult.get(e).getTranslationY()},rotate:{z:this.animationResult.get(e).getRotationZ(),y:this.animationResult.get(e).getRotationY(),x:this.animationResult.get(e).getRotationX()}},opacity:this.animationResult.get(e).getAplha()},0==this.duration?1:this.animationResult.get(e).getStartTime()/this.duration)))})),s.setAnimations(n),s.duration=this.duration,ft(a)?s.timingFunction="linear":s.timingFunction=a,i&&(s.on("start",(t=>{i("start")})),s.on("end",(t=>{i("end")}))),t.addAnimation(s,e)}}class Bi{static bindAnimation(t,e,i,a,s){let n=new Ei;n.produceAnimationResult(t),n.bindViewAnmation(e,i,a,s)}}class Pi extends TKView{constructor(t){super(),this.vm=t,this.animationMap=new Map,this.setupViews()}setupViews(){this.screenWidth=this.vm.callerContext.containerLimit.width,this.screenHeight=this.vm.callerContext.containerLimit.height,this.differenceLength=this.screenAdaptate(102)-this.screenHeight+896,this.style={width:"100%",height:"100%",position:"absolute",top:0,left:0},this.throughHitTest=!0,this.setBubbleRainAnimation()}setBubbleRainAnimation(){this.setBubbleAnimation1(),this.setBubbleAnimation2(),this.setBubbleAnimation3(),this.setBubbleAnimation4(),this.setBubbleAnimation5(),this.setBubbleAnimation6(),this.setBubbleAnimation7(),this.setBubbleAnimation8(),this.setBubbleAnimation9(),this.setBubbleAnimation10(),this.setBubbleAnimation11(),this.setBubbleAnimation12()}screenAdaptate(t){return t*this.screenWidth/414}bindBubbleRainAnim(){let t=this.vm.getRedPacketUrl(),e=this.vm.getRedPacketIndustryIcon();ft(e)&&(e=""),this.bubbles=new Array;for(let i=1;i<=12;i++){let a=new TKView,s=new TKImage,n=new TKImage,o=new TKImage,r=new TKImage,h=new c;if(h.template_show_type="bubble_redpacket_click",5==i?(h.template_show_type="bubble_gold_redpacket_click",a.style={position:"absolute",width:this.screenAdaptate(259),height:this.screenAdaptate(259),top:0,left:0,opacity:0},this.appendChild(a),n.style={position:"absolute",width:this.screenAdaptate(139),height:this.screenAdaptate(139),top:this.screenAdaptate(57),left:this.screenAdaptate(61)},vt(n,"image/BubbleRainResources/icon_ksad_bubble_rain_golden_red_packet.png"),a.appendChild(n),o.style={position:"absolute",width:this.screenAdaptate(86),height:this.screenAdaptate(38),top:this.screenAdaptate(83),left:this.screenAdaptate(88)},St(o,e,500,(t=>{t||o.setVisibility("hidden")})),a.appendChild(o),s.style={position:"absolute",width:this.screenAdaptate(259),height:this.screenAdaptate(259),top:0,left:0},vt(s,"image/BubbleRainResources/icon_ksad_bubble_rain_golden_bubble.png"),a.appendChild(s)):(a.style={position:"absolute",width:this.screenAdaptate(204),height:this.screenAdaptate(204),top:0,left:0,opacity:0},this.appendChild(a),ft(t)?(n.style={position:"absolute",width:this.screenAdaptate(110),height:this.screenAdaptate(110),top:this.screenAdaptate(47),left:this.screenAdaptate(47)},vt(n,"image/BubbleRainResources/icon_ksad_bubble_rain_red_packet.png"),a.appendChild(n),o.style={position:"absolute",width:this.screenAdaptate(72),height:this.screenAdaptate(32),top:this.screenAdaptate(111),left:this.screenAdaptate(68)},St(o,e,500,(t=>{t||o.setVisibility("hidden")})),a.appendChild(o)):(r.style={position:"absolute",width:this.screenAdaptate(152),height:this.screenAdaptate(152),top:this.screenAdaptate(26),left:this.screenAdaptate(26)},vt(r,t),a.appendChild(r)),s.style={position:"absolute",width:this.screenAdaptate(204),height:this.screenAdaptate(204),top:0,left:0},vt(s,"image/BubbleRainResources/icon_ksad_bubble_rain_bubble.png"),a.appendChild(s)),a.addEventListener("tap",(t=>{this.vm.convert(1,{x:t.position.rawX,y:t.position.rawY},At.BUBBLE_RAIN_CLICK,h)})),12==i){const t=this;Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_1"),a,"bubbleAnimation"+i+"_1",(e=>{if("end"==e){if(this.vm.isShowEnd)return;Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_2"),a,"bubbleAnimation"+i+"_2",(e=>{if("end"==e){if(this.vm.isShowEnd)return;Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_3"),a,"bubbleAnimation"+i+"_3",(e=>{if("end"==e){if(this.vm.isShowEnd)return;Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_4"),a,"bubbleAnimation"+i+"_4",(e=>{if("end"==e){if(this.vm.isShowEnd)return;t.onAnimateComplete&&t.onAnimateComplete()}}),"0.92 0.0 0.68 1.0")}}))}}),"0.51 0.57 0.69 0.94")}}),"0.0 0.0 0.0 0.99")}else Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_1"),a,"bubbleAnimation"+i+"_1",(t=>{if("end"==t){if(this.vm.isShowEnd)return;Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_2"),a,"bubbleAnimation"+i+"_2",(t=>{if("end"==t){if(this.vm.isShowEnd)return;Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_3"),a,"bubbleAnimation"+i+"_3",(t=>{if("end"==t){if(this.vm.isShowEnd)return;Bi.bindAnimation(this.animationMap.get("bubbleAnimation"+i+"_4"),a,"bubbleAnimation"+i+"_4",null,"0.92 0.0 0.68 1.0")}}))}}),"0.51 0.57 0.69 0.94")}}),"0.0 0.0 0.0 0.99");this.bubbles.push(a),this.appendChild(a)}}setBubbleAnimation1(){let t=new Array;t=[new Vi(1,.001),new Li(90,.001),new Li(-4.98,800),new ki(.126*-this.screenWidth,-813-this.differenceLength,.001),new ki(.118*-this.screenWidth,927-this.differenceLength,800)],this.animationMap.set("bubbleAnimation1_1",t);let e=new Array;e=[new Vi(1,.001),new Li(-4.98,.001),new Li(1,900),new ki(.118*-this.screenWidth,927-this.differenceLength,.001),new ki(.116*-this.screenWidth,829-this.differenceLength,900)],this.animationMap.set("bubbleAnimation1_2",e);let i=new Array;i=[new Vi(1,.001),new Li(1,.001),new Li(0,600),new ki(.116*-this.screenWidth,829-this.differenceLength,.001),new ki(.116*-this.screenWidth,835-this.differenceLength,600)],this.animationMap.set("bubbleAnimation1_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.116*-this.screenWidth,835-this.differenceLength,.001),new ki(.116*-this.screenWidth,1211-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation1_4",a)}setBubbleAnimation2(){let t=new Array;t=[new Vi(1,.001),new Li(90,.001),new Li(-4.98,800),new ki(.167*this.screenWidth,-425-this.differenceLength,.001),new ki(.258*this.screenWidth,789-this.differenceLength,800)],this.animationMap.set("bubbleAnimation2_1",t);let e=new Array;e=[new Vi(1,.001),new Li(-4.98,.001),new Li(1,900),new ki(.258*this.screenWidth,789-this.differenceLength,.001),new ki(.254*this.screenWidth,718-this.differenceLength,900)],this.animationMap.set("bubbleAnimation2_2",e);let i=new Array;i=[new Vi(1,.001),new Li(1,.001),new Li(0,600),new ki(.254*this.screenWidth,718-this.differenceLength,.001),new ki(.254*this.screenWidth,724-this.differenceLength,600)],this.animationMap.set("bubbleAnimation2_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.254*this.screenWidth,724-this.differenceLength,.001),new ki(.254*this.screenWidth,1281-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation2_4",a)}setBubbleAnimation3(){let t=new Array;t=[new Vi(1,.001),new Li(-90,.001),new Li(4.98,800),new ki(.587*this.screenWidth,-706-this.differenceLength,.001),new ki(.587*this.screenWidth,949-this.differenceLength,800)],this.animationMap.set("bubbleAnimation3_1",t);let e=new Array;e=[new Vi(1,.001),new Li(4.98,.001),new Li(-1,900),new ki(.587*this.screenWidth,949-this.differenceLength,.001),new ki(.587*this.screenWidth,855-this.differenceLength,900)],this.animationMap.set("bubbleAnimation3_2",e);let i=new Array;i=[new Vi(1,.001),new Li(-1,.001),new Li(0,600),new ki(.587*this.screenWidth,855-this.differenceLength,.001),new ki(.587*this.screenWidth,861-this.differenceLength,600)],this.animationMap.set("bubbleAnimation3_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.587*this.screenWidth,861-this.differenceLength,.001),new ki(.589*this.screenWidth,1318-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation3_4",a)}setBubbleAnimation4(){let t=new Array;t=[new Vi(1,.001),new Li(-90,.001),new Li(4.98,800),new ki(.71*this.screenWidth,-480-this.differenceLength,.001),new ki(.71*this.screenWidth,719-this.differenceLength,800)],this.animationMap.set("bubbleAnimation4_1",t);let e=new Array;e=[new Vi(1,.001),new Li(4.98,.001),new Li(-1,900),new ki(.71*this.screenWidth,719-this.differenceLength,.001),new ki(.71*this.screenWidth,654-this.differenceLength,900)],this.animationMap.set("bubbleAnimation4_2",e);let i=new Array;i=[new Vi(1,.001),new Li(-1,.001),new Li(0,600),new ki(.71*this.screenWidth,654-this.differenceLength,.001),new ki(.71*this.screenWidth,660-this.differenceLength,600)],this.animationMap.set("bubbleAnimation4_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.71*this.screenWidth,660-this.differenceLength,.001),new ki(.71*this.screenWidth,1008-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation4_4",a)}setBubbleAnimation5(){let t=this.screenAdaptate(130)-this.screenHeight+896,e=new Array;e=[new Vi(1,.001),new Li(-90,.001),new Li(4.98,800),new ki(.08*-this.screenWidth,-641-t,.001),new ki(.08*-this.screenWidth,604-t,800)],this.animationMap.set("bubbleAnimation5_1",e);let i=new Array;i=[new Vi(1,.001),new Li(4.98,.001),new Li(-1,900),new ki(.08*-this.screenWidth,604-t,.001),new ki(.08*-this.screenWidth,533-t,900)],this.animationMap.set("bubbleAnimation5_2",i);let a=new Array;a=[new Vi(1,.001),new Li(-1,.001),new Li(0,600),new ki(.08*-this.screenWidth,533-t,.001),new ki(.08*-this.screenWidth,538-t,600)],this.animationMap.set("bubbleAnimation5_3",a);let s=new Array;s=[new Vi(1,.001),new Li(0,.001),new ki(.08*-this.screenWidth,538-t,.001),new ki(.08*-this.screenWidth,1210-t,2e3)],this.animationMap.set("bubbleAnimation5_4",s)}setBubbleAnimation6(){let t=new Array;t=[new Vi(1,.001),new Li(90,.001),new Li(-4.98,800),new ki(.483*this.screenWidth,-287-this.differenceLength,.001),new ki(.505*this.screenWidth,524-this.differenceLength,800)],this.animationMap.set("bubbleAnimation6_1",t);let e=new Array;e=[new Vi(1,.001),new Li(-4.98,.001),new Li(1,900),new ki(.505*this.screenWidth,524-this.differenceLength,.001),new ki(.505*this.screenWidth,477-this.differenceLength,900)],this.animationMap.set("bubbleAnimation6_2",e);let i=new Array;i=[new Vi(1,.001),new Li(1,.001),new Li(0,600),new ki(.505*this.screenWidth,477-this.differenceLength,.001),new ki(.505*this.screenWidth,481-this.differenceLength,600)],this.animationMap.set("bubbleAnimation6_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.505*this.screenWidth,481-this.differenceLength,.001),new ki(.505*this.screenWidth,1578-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation6_4",a)}setBubbleAnimation7(){let t=new Array;t=[new Vi(1,.001),new Li(90,.001),new Li(-4.98,800),new ki(.097*this.screenWidth,-776-this.differenceLength,.001),new ki(.053*this.screenWidth,376-this.differenceLength,800)],this.animationMap.set("bubbleAnimation7_1",t);let e=new Array;e=[new Vi(1,.001),new Li(-4.98,.001),new Li(1,900),new ki(.053*this.screenWidth,376-this.differenceLength,.001),new ki(.058*this.screenWidth,319-this.differenceLength,900)],this.animationMap.set("bubbleAnimation7_2",e);let i=new Array;i=[new Vi(1,.001),new Li(1,.001),new Li(0,600),new ki(.058*this.screenWidth,319-this.differenceLength,.001),new ki(.058*this.screenWidth,325-this.differenceLength,600)],this.animationMap.set("bubbleAnimation7_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.058*this.screenWidth,325-this.differenceLength,.001),new ki(.058*this.screenWidth,1470-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation7_4",a)}setBubbleAnimation8(){let t=new Array;t=[new Vi(1,.001),new Li(90,.001),new Li(-4.98,800),new ki(.529*this.screenWidth,-581-this.differenceLength,.001),new ki(.57*this.screenWidth,323-this.differenceLength,800)],this.animationMap.set("bubbleAnimation8_1",t);let e=new Array;e=[new Vi(1,.001),new Li(-4.98,.001),new Li(1,900),new ki(.57*this.screenWidth,323-this.differenceLength,.001),new ki(.57*this.screenWidth,271-this.differenceLength,900)],this.animationMap.set("bubbleAnimation8_2",e);let i=new Array;i=[new Vi(1,.001),new Li(1,.001),new Li(0,600),new ki(.57*this.screenWidth,271-this.differenceLength,.001),new ki(.57*this.screenWidth,275-this.differenceLength,600)],this.animationMap.set("bubbleAnimation8_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.57*this.screenWidth,275-this.differenceLength,.001),new ki(.57*this.screenWidth,1442-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation8_4",a)}setBubbleAnimation9(){let t=new Array;t=[new Vi(1,.001),new Li(-90,.001),new Li(4.98,800),new ki(.188*-this.screenWidth,-599-this.differenceLength,.001),new ki(.188*-this.screenWidth,199-this.differenceLength,800)],this.animationMap.set("bubbleAnimation9_1",t);let e=new Array;e=[new Vi(1,.001),new Li(4.98,.001),new Li(-1,900),new ki(.188*-this.screenWidth,199-this.differenceLength,.001),new ki(.188*-this.screenWidth,153-this.differenceLength,900)],this.animationMap.set("bubbleAnimation9_2",e);let i=new Array;i=[new Vi(1,.001),new Li(-1,.001),new Li(0,600),new ki(.188*-this.screenWidth,153-this.differenceLength,.001),new ki(.188*-this.screenWidth,158-this.differenceLength,600)],this.animationMap.set("bubbleAnimation9_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.188*-this.screenWidth,158-this.differenceLength,.001),new ki(.188*-this.screenWidth,1379-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation9_4",a)}setBubbleAnimation10(){let t=new Array;t=[new Vi(1,.001),new Li(90,.001),new Li(-4.98,800),new ki(.312*this.screenWidth,-513-this.differenceLength,.001),new ki(.312*this.screenWidth,136-this.differenceLength,800)],this.animationMap.set("bubbleAnimation10_1",t);let e=new Array;e=[new Vi(1,.001),new Li(-4.98,.001),new Li(1,900),new ki(.312*this.screenWidth,136-this.differenceLength,.001),new ki(.312*this.screenWidth,99-this.differenceLength,900)],this.animationMap.set("bubbleAnimation10_2",e);let i=new Array;i=[new Vi(1,.001),new Li(1,.001),new Li(0,600),new ki(.312*this.screenWidth,99-this.differenceLength,.001),new ki(.312*this.screenWidth,103-this.differenceLength,600)],this.animationMap.set("bubbleAnimation10_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.312*this.screenWidth,103-this.differenceLength,.001),new ki(.312*this.screenWidth,1386-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation10_4",a)}setBubbleAnimation11(){let t=new Array;t=[new Vi(1,.001),new Li(-90,.001),new Li(4.98,800),new ki(.036*-this.screenWidth,-425-this.differenceLength,.001),new ki(.036*-this.screenWidth,-17-this.differenceLength,800)],this.animationMap.set("bubbleAnimation11_1",t);let e=new Array;e=[new Vi(1,.001),new Li(4.98,.001),new Li(-1,900),new ki(.036*-this.screenWidth,-17-this.differenceLength,.001),new ki(.036*-this.screenWidth,-43-this.differenceLength,900)],this.animationMap.set("bubbleAnimation11_2",e);let i=new Array;i=[new Vi(1,.001),new Li(-1,.001),new Li(0,600),new ki(.036*-this.screenWidth,-43-this.differenceLength,.001),new ki(.036*-this.screenWidth,-36-this.differenceLength,600)],this.animationMap.set("bubbleAnimation11_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.036*-this.screenWidth,-36-this.differenceLength,.001),new ki(.036*-this.screenWidth,1566-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation11_4",a)}setBubbleAnimation12(){let t=new Array;t=[new Vi(1,.001),new Li(90,.001),new Li(-4.98,800),new ki(.792*this.screenWidth,-146-this.differenceLength,.001),new ki(.792*this.screenWidth,17-this.differenceLength,800)],this.animationMap.set("bubbleAnimation12_1",t);let e=new Array;e=[new Vi(1,.001),new Li(-4.98,.001),new Li(1,900),new ki(.792*this.screenWidth,17-this.differenceLength,.001),new ki(.792*this.screenWidth,7-this.differenceLength,900)],this.animationMap.set("bubbleAnimation12_2",e);let i=new Array;i=[new Vi(1,.001),new Li(1,.001),new Li(0,600),new ki(.792*this.screenWidth,7-this.differenceLength,.001),new ki(.792*this.screenWidth,10-this.differenceLength,600)],this.animationMap.set("bubbleAnimation12_3",i);let a=new Array;a=[new Vi(1,.001),new Li(0,.001),new ki(.792*this.screenWidth,10-this.differenceLength,.001),new ki(.792*this.screenWidth,1526-this.differenceLength,2e3)],this.animationMap.set("bubbleAnimation12_4",a)}stopAllAnimation(){if(!ft(this.bubbles))for(let t=0;t<this.bubbles.length;t++)this.bubbles[t].removeAllAnimation();this.removeAll()}}class Ki{constructor(t){this.currentPlaybackTimeMs=0,this.countDownTime=0,this.isTimerPaused=!1,this.mTimerInterval=500,this.mTotalStayTime=0,this.mTotalStayTime=t}setTotalPlayTime(t){t&&(this.mTotalStayTime=t)}setTimerInterval(t){t&&(this.mTimerInterval=t)}play(){this.startTimer()}paused(){this.isTimerPaused=!0}resume(){this.isTimerPaused=!1}stop(){this.stopTimer()}startTimer(){this.mTimer&&clearInterval(this.mTimer),this.mTimer=setInterval((()=>{this.isTimerPaused||(this.currentPlaybackTimeMs+=this.mTimerInterval,this.onCurrentPlaybackCallback&&this.onCurrentPlaybackCallback(this.currentPlaybackTimeMs),this.currentPlaybackTimeMs>=this.mTotalStayTime?(this.stopTimer(),this.onFinishCallback&&this.onFinishCallback()):this.currentPlaybackTimeMs<this.mTotalStayTime&&(this.countDownTime=(this.mTotalStayTime-this.currentPlaybackTimeMs)/1e3,this.countDownCallback&&this.countDownCallback(this.countDownTime)))}),this.mTimerInterval)}stopTimer(){this.mTimer&&clearInterval(this.mTimer)}}class Ni extends TKView{constructor(t){super(),this.hasRemove=!1,this.vm=t,this.throughHitTest=!0,this.style={width:"100%",height:"100%",position:"absolute",top:0,left:0};const e=this;this.timePlay=new Ki(this.vm.getDelayTime()),this.timePlay.onFinishCallback=()=>{e.vm.hasShown=!0,e.vm.reportElementImpression(),e.setupViews()},Nt().on(xt,(t=>{this.vm.hasShown&&(this.vm.isShowEnd=!0)})),pe(this.vm.$attrsPath.isShowEnd,(t=>{t&&this.onDismiss()})),pe(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{switch(t){case"showEnd":this.timePlay.play();break;case"pageInvisiable":this.timePlay.paused();break;case"pageVisiable":this.timePlay.resume();break;case"hideEnd":this.vm.isShowEnd=!0}}))}setupViews(){const t=this;this.preHeatView=new bi(this.vm,(()=>{t.rainFallView=new Pi(this.vm),t.rainFallView.onAnimateComplete=()=>{t.onDismiss()},t.appendChild(this.rainFallView),t.rainFallView.bindBubbleRainAnim()})),this.appendChild(this.preHeatView)}onDismiss(){this.hasRemove||(this.hasRemove=!0,this.preHeatView&&this.preHeatView.stopAllAnimation(),this.rainFallView&&this.rainFallView.stopAllAnimation(),this.timePlay.stop(),this.style={visibility:"hidden"},this.onDismissComplete&&this.onDismissComplete())}}class Fi extends TKView{constructor(t){super(),this.vm=t,this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute"},this.throughHitTest=!0,this.setPreloadData(),this.preloadView(),this.produceAnimation(),this.setupAction()}setPreloadData(){this.imageViews=new Array,this.animationMap=new Map,this.imageSrcs=new Array,this.levelsConfig=[8,10,9,7,5,4,13,12,11,6,3,2,1];for(let t=0;t<3;t++){let e="image/ksad-compose-image/GiftBox/ksad_gift_box_"+t+".png",i=this.vm.getGiftBoxIconUrls()[t];this.imageSrcs.push(ft(i)?e:i)}}preloadView(){this.vm.callerContext.containerLimit.width;let t=this.vm.callerContext.containerLimit.height,e=this.vm.callerContext.containerLimit.width/375,i=[85*e,215.5*e,-28*e,100*e,-10*e,170*e,223*e,-59*e,27*e,-27*e,198.5*e,113.5*e,60*e],a=[0,0,0,1,0,0,1,0,1,0,2,2,0];3==this.vm.callerContext.adStyle||2==this.vm.callerContext.adStyle?bt.isAndroid()?this.appendHeight=70*e/t:this.appendHeight=100*e/t:this.appendHeight=53*e/t;for(let s=0;s<13;s++){let t=new TKImage;t.style={position:"absolute",width:195*e,height:195*e,top:200*-e,left:i[s],right:0,opacity:1},St(t,this.imageSrcs[a[s]],500,(e=>{e||(this.hasLoadFailed=!0,vt(t,"image/ksad-compose-image/GiftBox/ksad_gift_box_"+a[s]+".png"))})),this.imageViews.push(t)}}produceAnimation(){this.configGiftBoxAnimation1(),this.configGiftBoxAnimation2(),this.configGiftBoxAnimation3(),this.configGiftBoxAnimation4(),this.configGiftBoxAnimation5(),this.configGiftBoxAnimation6(),this.configGiftBoxAnimation7(),this.configGiftBoxAnimation8(),this.configGiftBoxAnimation9(),this.configGiftBoxAnimation10(),this.configGiftBoxAnimation11(),this.configGiftBoxAnimation12(),this.configGiftBoxAnimation13()}configGiftBoxAnimation1(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(0,500),new Li(-18,600),new ki(0,0,0),new ki(0,1.025*t+t*this.appendHeight,500)],this.animationMap.set("animation0",e)}configGiftBoxAnimation2(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(-45,0),new Li(-45,700),new Li(-60,800),new ki(0,0,500),new ki(0,1.024*t+t*this.appendHeight,700)],this.animationMap.set("animation1",e)}configGiftBoxAnimation3(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(-60,0),new Li(-60,750),new Li(-40,850),new ki(0,0,550),new ki(0,1.034*t+t*this.appendHeight,750)],this.animationMap.set("animation2",e)}configGiftBoxAnimation4(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(-100,0),new ki(0,0,600),new ki(0,.93*t+t*this.appendHeight,750),new ki(0,.91*t+t*this.appendHeight,800),new ki(0,.945*t+t*this.appendHeight,850)],this.animationMap.set("animation3",e)}configGiftBoxAnimation5(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(-100,0),new Li(-100,800),new Li(-85,850),new ki(0,0,600),new ki(0,.95*t+t*this.appendHeight,800)],this.animationMap.set("animation4",e)}configGiftBoxAnimation6(){let t=this.vm.callerContext.containerLimit.height,e=new Array,i=new Li(-15,0),a=new ki(0,0,800);e=[i,a,a,new ki(0,.925*t+t*this.appendHeight,1050)],this.animationMap.set("animation5",e)}configGiftBoxAnimation7(){let t=this.vm.callerContext.containerLimit.width,e=this.vm.callerContext.containerLimit.height,i=new Array;i=[new Li(35,0),new Li(35,1050),new Li(105,1150),new ki(0,0,850),new ki(0,.825*e+e*this.appendHeight,1050),new ki(.1*t,.925*e+e*this.appendHeight,1150)],this.animationMap.set("animation6",i)}configGiftBoxAnimation8(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new ki(0,0,900),new ki(0,.92*t+t*this.appendHeight,1200)],this.animationMap.set("animation7",e)}configGiftBoxAnimation9(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(-35,0),new Li(-35,1400),new Li(-25,1500),new ki(0,0,1100),new ki(0,.835*t+t*this.appendHeight,1400)],this.animationMap.set("animation8",e)}configGiftBoxAnimation10(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(-60,0),new Li(-60,1850),new Li(-40,1950),new ki(0,0,1650),new ki(0,.777*t+t*this.appendHeight,1850)],this.animationMap.set("animation9",e)}configGiftBoxAnimation11(){let t=this.vm.callerContext.containerLimit.width,e=this.vm.callerContext.containerLimit.height,i=new Array;i=[new Li(70,0),new Li(70,1950),new Li(95,2150),new ki(0,0,1650),new ki(0,.803*e+e*this.appendHeight,1950),new ki(.05*t,.823*e+e*this.appendHeight,2150)],this.animationMap.set("animation10",i)}configGiftBoxAnimation12(){let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(8,0),new ki(0,0,1650),new ki(0,.795*t+t*this.appendHeight,1900)],this.animationMap.set("animation11",e)}configGiftBoxAnimation13(){this.vm.callerContext.containerLimit.width;let t=this.vm.callerContext.containerLimit.height,e=new Array;e=[new Li(-15,0),new Li(-15,2600),new Li(-40,2750),new ki(0,0,2400),new ki(0,.682*t+t*this.appendHeight,2600),new ki(.02*-t,.702*t+t*this.appendHeight,2750)],this.animationMap.set("animation12",e)}setupAction(){const t=this;for(let e=0;e<this.imageViews.length;e++)this.appendChild(this.imageViews[this.levelsConfig[e]-1]),this.imageViews[this.levelsConfig[e]-1].addEventListener("tap",(e=>{this.hasClicked=!0,t.clickCallback&&t.clickCallback(),t.setVisibility("gone")}))}show(){console.log("giftbox multibox show"+this.imageViews.length);for(let e=0;e<this.imageViews.length;e++)Bi.bindAnimation(this.animationMap.get("animation"+(this.levelsConfig[e]-1)),this.imageViews[this.levelsConfig[e]-1],"showAnimation"+e);const t=this;setTimeout((()=>{t.dismiss()}),this.vm.getGiftBoxShowTime()-1500)}dismiss(){if(this.hasClicked||this.hasDismissed)return;let t=new Vi(1,0),e=new Vi(0,150);const i=this;Bi.bindAnimation([t,e],this,"dismissAnimation",(t=>{i.hasClicked||i.hasDismissed||"end"==t&&(i.autoDismissCallback&&i.autoDismissCallback(),i.hasDismissed=!0,i.setVisibility("gone"),console.log("giftbox multibox dismiss"))}))}}class Mi extends TKView{constructor(t){super(),this.vm=t,this.setupViews(),this.setupData(),this.setupAction()}setupViews(){this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",visibility:"hidden"},this.throughHitTest=!0,this.guideView=new TKView,this.guideView.style={justifyContent:"center",alignItems:"center",opacity:0},this.appendChild(this.guideView),this.guideLabel=new TKText,this.guideLabel.style={height:36,paddingLeft:20,paddingRight:20,backgroundColor:"#0D0000B2",textAlign:"center",color:"#FFFFFF",borderRadius:18,fontWeight:"bold"},this.guideView.appendChild(this.guideLabel),this.guideImageView=new TKImage,this.guideImageView.style={width:12,height:6},this.guideView.appendChild(this.guideImageView),this.giftBoxImage=new TKImage,this.giftBoxImage.style={marginTop:-7,width:195,height:195,opacity:0},this.appendChild(this.giftBoxImage)}setupData(){let t="image/ksad-compose-image/GiftBox/ksad_gift_box_0.png",e=ft(this.vm.getGiftBoxIconUrls()[0])?t:this.vm.getGiftBoxIconUrls()[0];St(this.giftBoxImage,e,500,(e=>{e||(vt(this.giftBoxImage,t),this.hasLoadFailed=!0)})),this.guideLabel.setText(this.vm.getSingleBoxGuideText()),vt(this.guideImageView,"icon_ksad_gift_box_guide_arrow.png")}setupAction(){const t=this;this.giftBoxImage.addEventListener("tap",(e=>{t.hasClicked=!0,t.clickCallback&&t.clickCallback(),t.dismiss()}))}autoDismiss(){this.hasClicked||(this.autoDismissCallback&&this.autoDismissCallback(),this.dismiss())}startShowAnimation(){const t=this,e=yi(this.giftBoxImage,300,!0);e.on("end",(()=>{t.startShakeAnimation()})),this.giftBoxImage.addAnimation(e,"giftBoxShowAnimation");const i=yi(this.guideView,300,!0);this.guideView.addAnimation(i,"guideShowAnimation")}startShakeAnimation(){const t=this,e=new TKKeyframeAnimation;e.setAnimations([()=>(t.giftBoxImage.style={transform:{rotate:20}},.16),()=>(t.giftBoxImage.style={transform:{rotate:0}},.32),()=>(t.giftBoxImage.style={transform:{rotate:-20}},.48),()=>(t.giftBoxImage.style={transform:{rotate:0}},.64),()=>(t.giftBoxImage.style={transform:{rotate:20}},.8),()=>(t.giftBoxImage.style={transform:{rotate:0}},1)]),e.duration=900,e.timingFunction="linear",e.on("end",(()=>{t.startHideAnimation()})),this.giftBoxImage.addAnimation(e,"shakeAnimation")}startHideAnimation(){const t=this,e=Ii(this.giftBoxImage,200,!0);e.on("end",(()=>{t.autoDismiss()})),this.giftBoxImage.addAnimation(e,"giftBoxHideAnimation");const i=Ii(this.guideView,200,!0);this.guideView.addAnimation(i,"guideHideAnimation")}show(){console.log("giftbox singlebox show"),this.style={visibility:"visible"},this.startShowAnimation()}dismiss(){this.style={visibility:"hidden"},this.setVisibility("gone")}}class Hi extends TKView{constructor(t){super(),this.lottieLoadFailed=!1,this.vm=t,this.setupViews(),this.setupData()}setupViews(){this.style={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"absolute",visibility:"hidden"},this.throughHitTest=!0;const t=this,e=Math.ceil(812*Tachikoma.env.deviceWidth/375);bt.supportMinimumTKVersion("5.0.0")&&(this.couponView=new TKLottieImageView,this.couponView.style={width:"100%",height:e,opacity:0},this.couponView.enabled=!1,this.couponView.setLoop(!1),this.couponView.onAnimationLoaded((e=>{e||(console.log("giftbox transition load animation failed"),t.lottieLoadFailed=!0)})),this.couponView.onAnimationEnd((()=>{t.convert()})),this.appendChild(this.couponView))}setupData(){this.couponView&&this.couponView.setUri(this.vm.getClickAnimationLottieUrl())}startShowAnimation(){this.style={visibility:"visible"},this.startCouponViewFallAnimation()}startCouponViewFallAnimation(){this.couponView&&(this.couponView.style={opacity:1},this.couponView.play())}convert(){this.hasConverted||(this.hasConverted=!0,this.vm.reportGiftBoxClick())}show(){this.vm.enableShowClickAnimation()&&!this.lottieLoadFailed?(console.log("giftbox transition show"),this.startShowAnimation(),setTimeout((()=>{this.convert()}),2300)):this.convert()}}class Oi{static reportGiftBoxShowEvent(t){try{Yt({category:"ad_client_apm_log",biz:"TACHIKOMA",sub_biz:"OTHER",rate:t?.1:.001,suffixRatio:"",event_id:"ad_huge_scene_render_performance",primaryKey:"status",type:"OTHER",msg:{load_status:t?2:1,scene:"gift_box",status:1}})}catch(e){}}static reportGiftBoxClickEvent(t){try{Yt({category:"ad_client_apm_log",biz:"TACHIKOMA",sub_biz:"OTHER",rate:t?.1:.001,suffixRatio:"",event_id:"ad_huge_scene_render_performance",primaryKey:"status",type:"OTHER",msg:{load_status:t?2:1,scene:"gift_box",status:2}})}catch(e){}}}class Wi extends TKView{constructor(t){super(),this.vm=t,this.setupViews();const e=this;pe(this.vm.$attrsPath.callerContext.lifeStatus,(t=>{"showEnd"===t&&(2!=e.vm.callerContext.adStyle&&3!=e.vm.callerContext.adStyle||e.startDelayTimerIfNeeded()),"pageVisiable"===t&&e.startDelayTimerIfNeeded(),"pageInvisiable"===t&&e.stopDelayTimerIfNeeded()})),Nt().on(xt,(t=>{setTimeout((()=>{console.log("giftbox dismiss"),e.transitionView&&(e.transitionView.hasConverted=!0),e.dismissCallback&&e.dismissCallback()}),500)}))}setupViews(){this.style={width:"100%",height:"100%"},this.throughHitTest=!0;const t=this;this.singleBoxView=new Mi(this.vm),this.singleBoxView.autoDismissCallback=()=>{console.log("giftbox singlebox auto dissmiss"),t.multiBoxView&&t.multiBoxView.show()},this.singleBoxView.clickCallback=()=>{console.log("giftbox singlebox click"),t.convert()},this.appendChild(this.singleBoxView),this.multiBoxView=new Fi(this.vm),this.multiBoxView.clickCallback=()=>{console.log("giftbox multibox click"),t.convert()},this.multiBoxView.autoDismissCallback=()=>{t.dismissCallback&&t.dismissCallback()},this.appendChild(this.multiBoxView),this.transitionView=new Hi(this.vm),this.appendChild(this.transitionView)}show(){console.log("giftbox show"),this.vm.hasShown=!0,this.vm.showMultiBoxViewDirectly()?this.multiBoxView&&this.multiBoxView.show():this.singleBoxView&&this.singleBoxView.show(),this.vm.reportGiftBoxImpression();let t=this.singleBoxView.hasLoadFailed||this.multiBoxView.hasLoadFailed;Oi.reportGiftBoxShowEvent(t)}hide(){this.style={visibility:"gone"},this.dismissCallback&&this.dismissCallback()}convert(){this.transitionView&&this.transitionView.show();let t=this.singleBoxView.hasLoadFailed||this.multiBoxView.hasLoadFailed;Oi.reportGiftBoxClickEvent(t)}startDelayTimerIfNeeded(){if(this.vm.hasShown)return;if(this.vm.getGiftBoxDelayTime()<=0)return void this.show();if(this.delayTimer)return void this.delayTimer.resume();this.delayTimer=new Ki(this.vm.getGiftBoxDelayTime()),this.delayTimer.play();const t=this;this.delayTimer.onFinishCallback=()=>{t.show()}}stopDelayTimerIfNeeded(){this.vm.hasShown||this.delayTimer&&this.delayTimer.paused()}}class Ui extends Jt{constructor(t){super(),this.vm=t,this.vm.checkDataValid()&&(this.setupViews(),me(this.vm,this.vm.$attrsPath.showRedPacketRain,(t=>{t&&this.redPackView&&this.redPackView.show()})),me(this.vm,this.vm.$attrsPath.adHasConvert,(t=>{t&&this.redPackView&&this.redPackView.hide(!0)})))}setupViews(){this.style={width:"100%",height:"100%"},H(this.vm.adInfo)?(this.appendFullTKPage(),this.setupDownloadPopup()):(this.appendActionbarViewIfNeed(),this.throughHitTest=!0,this.appendTopfloorIfNeed(this))}setupDownloadPopup(){G(this.vm.adInfo)&&(this.downloadPopup=new Ke(this.vm.downloadPopupVM,this))}appendActionbarViewIfNeed(){if(bt.supportMinimumTKVersion("5.0.1")&&this.vm.enableShowActionBarView()){let t=new ti(this.vm);this.appendChild(t)}}appendTopfloorIfNeed(t){if(t){if(this.vm.enableShowGiftBoxView()){const e=this;return this.giftBoxView=new Wi(this.vm.giftBoxViewModel),this.giftBoxView.dismissCallback=()=>{t.removeChild(e.giftBoxView)},t.appendChild(this.giftBoxView),void this.giftBoxView.startDelayTimerIfNeeded()}if(this.vm.enableShowBubbleRainView())return this.bubbleRainView=new Ni(this.vm.bubbleRainViewModel),this.bubbleRainView.onDismissComplete=()=>{t.removeChild(this.bubbleRainView)},void t.appendChild(this.bubbleRainView);this.vm.enableShowRedPacketView()&&(this.redPackView=new ge(this.vm.redPacketViewModel),this.redPackView.style={position:"absolute",left:0,top:0},t.appendChild(this.redPackView))}}appendFullTKPage(){let t;t=this.vm.isImageMaterial()?new Ti(this.vm):new Si(this.vm),this.appendChild(t),this.appendTopfloorIfNeed(t.getMiddleView())}}class zi extends ye{constructor(t,e,i,a=1,s){if(super(),this.paramValid=!1,this.animMinTime=50,this.dismissCallbackCompleted=!1,this.lastAnimedArray=[],this.slotId=-1,this.componentData=void 0,this.containerSize=t,this.adInfo=e,this.adStyle=i,this.animType=a,this.currentRandomParams=this.getRedPacketRandomParam(),this.initLastAnimedArray(),s&&(this.slotId=s),2==a)this.redPacketInfo=function(t,e){let i=null,a=U(t,e);if(a){let e=O(t,a);e&&(i=e.redPacketInfo),i&&(i.showTime=1.5)}return i}(this.adInfo,this.adStyle);else if(g(this.adInfo)){let t=w(this.adInfo,"red-packet",this.slotId);t&&(this.redPacketInfo=f(t),this.componentData=t)}else this.redPacketInfo=N(this.adInfo,this.adStyle)}initLastAnimedArray(){this.lastAnimedArray=[5,2]}getAnimType(){return this.animType}getRowNum(){return 2==this.animType?5:3}getAnimMinTime(){return this.animMinTime}getOriginShowTime(){let t=6;return!ft(this.redPacketInfo)&&!ft(this.redPacketInfo.showTime)&&this.redPacketInfo.showTime>0&&(t=g(this.adInfo)?this.redPacketInfo.showTime/1e3:this.redPacketInfo.showTime),t}getScaleType(t,e){return this.currentRandomParams[e*this.getRowNum()+t].scaleType}dismissCallbackOnlyOnce(){this.dismissCallbackCompleted||(this.dismissCallbackCompleted=!0,this.dismissCallback&&this.dismissCallback())}enableShowRedPacketView(){return!ft(this.redPacketInfo)}getRedPacketViewDelayShowTime(){return ft(this.redPacketInfo)?1:g(this.adInfo)?this.redPacketInfo.delayTime/1e3:this.redPacketInfo.delayTime}isShowRedPacketViewRightNow(){return!ft(this.redPacketInfo)&&0==this.redPacketInfo.delayTime}checkParam(){return!ft(this.redPacketInfo)&&(!ft(t=this.redPacketInfo.iconUrls)&&0!=t.length&&(this.paramValid=!0,!0));var t}isParamValid(){return this.paramValid}getShowTime(t){let e=this.getOriginShowTime();return 2==this.animType||ft(this.currentRandomParams[t].iconShowTime)||(e=this.currentRandomParams[t].iconShowTime*this.getTimeCoefficient()),e}getIconDelayTime(t){return Math.floor(this.currentRandomParams[t].delayTime*this.getTimeCoefficient())*this.animMinTime}getDelayTime(){let t=1;return ft(this.redPacketInfo)||ft(this.redPacketInfo.delayTime)||(t=this.redPacketInfo.delayTime),t}getTimeCoefficient(){return 2==this.animType?1:this.getOriginShowTime()/4*1.1}getRotateTimeCoefficient(){return this.getOriginShowTime()/6}getRotateAnimDelayTime(t){return 2==this.animType||ft(this.currentRandomParams[t].rotateDelayTime)?-1:Math.floor(this.currentRandomParams[t].rotateDelayTime*this.getRotateTimeCoefficient())*this.getAnimMinTime()}isCanShowRotateAnim(t){return-1!=this.getRotateAnimDelayTime(t)}getLastAnimIconIndex(){return this.lastAnimedArray[this.currentRandomParamIndex]}getAnimedCount(){return 2==this.animType?15:9}isCanClick(){return this.redPacketInfo.clickSwitch}getRedPacketIconUrl(){let t=Math.floor(Math.random()*this.redPacketInfo.iconUrls.length);return this.redPacketInfo.iconUrls[t]}reportRedPacketImpression(){if(1!=this.animType)return;let t=new c;if(g(this.adInfo)&&this.componentData){t.universe_feature_freq=this.componentData.componentId;const e=this.adInfo.adMatrixInfo.adDataV2.styleComponentInfo;let i={page_id:e.playCardInfo.pageId,combination_id:e.playCardInfo.combinationIds,component_id:this.componentData.componentId};t.component_module=JSON.stringify(i)}else t.universe_feature_freq=1;let e={elementType:201,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Bt.sendLog(i)}convert(t,e,i,a=null,s){if(g(this.adInfo)&&this.componentData){a||(a=new c);const t=this.adInfo.adMatrixInfo.adDataV2.styleComponentInfo;let e={page_id:t.playCardInfo.pageId,combination_id:t.playCardInfo.combinationIds,component_id:this.componentData.componentId};a.component_module=JSON.stringify(e)}jt.convertIfNeeded(0,this.adInfo,t,e,i,a,s)}getRedPacketRandomParam(){let t=[];return t=2==this.animType?[[{delayTime:0,scaleType:.85},{delayTime:4.5,scaleType:.7},{delayTime:8.25,scaleType:.7},{delayTime:13.5,scaleType:1},{delayTime:18,scaleType:.7},{delayTime:2.25,scaleType:.7},{delayTime:7.5,scaleType:1},{delayTime:11.25,scaleType:.85},{delayTime:16.5,scaleType:1},{delayTime:21,scaleType:.85},{delayTime:0,scaleType:.85},{delayTime:4.5,scaleType:.7},{delayTime:9,scaleType:.7},{delayTime:14.25,scaleType:.85},{delayTime:18.75,scaleType:.85}]]:[[{delayTime:5,scaleType:.7,iconShowTime:2},{delayTime:15,rotateDelayTime:10,scaleType:.85,iconShowTime:2},{delayTime:22,scaleType:1,iconShowTime:2},{delayTime:0,rotateDelayTime:16,scaleType:1,iconShowTime:2.3},{delayTime:8,scaleType:.85,iconShowTime:2.5},{delayTime:20,scaleType:.7,iconShowTime:2.5},{delayTime:3,scaleType:.7,iconShowTime:1.9},{delayTime:11,scaleType:.7,iconShowTime:1.9},{delayTime:22,rotateDelayTime:13,scaleType:.85,iconShowTime:1.95}],[{delayTime:0,rotateDelayTime:12,scaleType:1,iconShowTime:2.3},{delayTime:10,scaleType:.85,iconShowTime:2.3},{delayTime:20,rotateDelayTime:16,scaleType:1,iconShowTime:2.7},{delayTime:2,scaleType:.7,iconShowTime:2},{delayTime:12,scaleType:1,iconShowTime:2.3},{delayTime:22,scaleType:.7,iconShowTime:2.1},{delayTime:0,scaleType:.85,iconShowTime:1.8},{delayTime:6,rotateDelayTime:18,scaleType:.85,iconShowTime:2.4},{delayTime:21,scaleType:1,iconShowTime:2.4}]],this.currentRandomParamIndex=Math.floor(Math.random()*t.length),t[this.currentRandomParamIndex]}}class Yi extends ye{constructor(t,e){super(),this.hasShown=!1,this.isShowEnd=!1,this.slotId=-1,this.componentData=void 0,this.callerContext=t,e&&(this.slotId=e);if(g(this.callerContext.adInfo)&&-1!=this.slotId){let t=w(this.callerContext.adInfo,"bubble-rain",this.slotId);t&&(this.bubbleRainInfo=f(t),this.componentData=t)}else this.bubbleRainInfo=function(t,e){let i,a=U(t,e);if(a){let e=D(t,a);if(null==e)return;i=JSON.parse(e.data).bubbleRainInfo}return i}(this.callerContext.adInfo,this.callerContext.adStyle)}enableShowBubbleRainView(){return 1!=this.callerContext.screenOrientation&&!ft(this.bubbleRainInfo)}enableCountDown(){return 2==this.callerContext.adStyle||3==this.callerContext.adStyle}isSplash(){return 4==this.callerContext.adStyle}getBubbleActionDes(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.bubbleActionDescription)&&void 0!==e?e:"立即开启大促"}getIndustryTopIcon(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.industryTopIcon)&&void 0!==e?e:""}getRedPacketUrl(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.redPacketUrl)&&void 0!==e?e:""}getSpecialRedPacketUrl(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.specialRedPacketUrl)&&void 0!==e?e:""}getRedPacketIndustryIcon(){var t,e;return null!==(e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.redPacketIndustryIcon)&&void 0!==e?e:""}getDelayTime(){var t;const e=null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.delayTime;return e>0?e:0}getShowTime(){var t;return null===(t=this.bubbleRainInfo)||void 0===t?void 0:t.showTime}reportElementImpression(){let t=new c;if(g(this.callerContext.adInfo)&&this.componentData){t.universe_feature_freq=this.componentData.componentId;const e=this.callerContext.adInfo.adMatrixInfo.adDataV2.styleComponentInfo;let i={page_id:e.playCardInfo.pageId,combination_id:e.playCardInfo.combinationIds,component_id:this.componentData.componentId};t.component_module=JSON.stringify(i)}else t.universe_feature_freq=20;let e={elementType:238};e.clientExtData=JSON.stringify(t),jt.log(140,{x:0,y:0},e)}convert(t,e,i,a=null,s){g(this.callerContext.adInfo)&&this.componentData&&(a||(a=new c),a.component_module=function(t,e,i=!0){try{const a=t.adMatrixInfo.adDataV2.styleComponentInfo;let s={component_id:e.componentId,combination_id:i?a.playCardInfo.combinationIds:a.endCardInfo.combinationIds,page_id:i?a.playCardInfo.pageId:a.endCardInfo.pageId};return JSON.stringify(s)}catch(a){return""}}(this.callerContext.adInfo,this.componentData)),jt.convertIfNeeded(0,this.callerContext.adInfo,t,e,i,a,s)}}class Gi extends ye{constructor(t){super(),this.hasShown=!1,this.callerContext=t,this.setupData()}setupData(){this.giftBoxInfo=W(this.callerContext.adInfo,this.callerContext.adStyle)}isVertical(){return 0==this.callerContext.screenOrientation||ft(this.callerContext.screenOrientation)}getGiftBoxInfo(){return this.giftBoxInfo}getGiftBoxIconUrls(){try{return this.giftBoxInfo.iconUrls}catch(t){}return[]}getGiftBoxDelayTime(){try{return this.giftBoxInfo.delayTime}catch(t){}return 1e3}getGiftBoxShowTime(){try{return this.giftBoxInfo.showTime}catch(t){}return 6e3}enableShowClickAnimation(){let t=!1;try{t=this.giftBoxInfo.showClickAnimation}catch(e){}return ft(this.getClickAnimationLottieUrl())&&(t=!1),bt.supportMinimumTKVersion("5.0.0")||(t=!1),t}getClickAnimationLottieUrl(){let t="";try{t=this.giftBoxInfo.clickAnimationLottieUrl}catch(e){}return ft(t)&&(t=bt.isAndroid()?"image/ksad-compose-image/GiftBox/ksad_lottie_gift_box_transition_android.json":"image/ksad-compose-image/GiftBox/ksad_lottie_gift_box_transition_ios.json"),t}getSingleBoxGuideText(){return"点击盒子，领取惊喜"}enableShowGiftBox(){const t=this.isVertical()&&!ft(this.giftBoxInfo)&&!ft(this.getGiftBoxIconUrls())&&this.getGiftBoxIconUrls().length>0;return console.log("giftbox enableshow"+t),t}showMultiBoxViewDirectly(){return!0}reportGiftBoxClick(){jt.convertIfNeeded(1,this.callerContext.adInfo,1,{x:0,y:0},At.SURPRISE_BOX_CLICK)}reportGiftBoxImpression(){let t=new c;t.universe_feature_freq=21;let e={elementType:237,clientExtData:JSON.stringify(t)};jt.log(140,null,e)}}class Xi extends ye{constructor(t,e,i=null){super(),this.reportFreQ=!1,this.clickType=0,this.getActionBarRect=()=>({x:0,y:0,width:0,height:0}),this.callerContext=t,this.industryInfo=e,ft(i)?this.templateShowType=this.obtainTemplateShowType():this.templateShowType=i}obtainTemplateShowType(){let t="ecommerce_coupon";if(this.industryInfo){switch(this.industryInfo.merchantStyleType){case o.PRODUCT:t="benefit_card_item";break;case o.COUPON:t="ecommerce_coupon";break;case o.EVENT:t="benefit_card_activity";break;case o.DEFAULT:t="benefit_card_default"}}return t}updateProgressListener(t){if(t.result&&bt.isSupportDownloadProgressListen()&&_(this.callerContext.adInfo)){const{status:e,progress:i,totalBytes:a}=t.data,s=Number((100*i).toFixed(0))>100?"100":(100*i).toFixed(0);switch(e){case 0:case 1:case 4:this.actionBarText=this.callerContext.adInfo.adBaseInfo.adActionDescription;break;case 2:this.actionBarText=`${s}%`;break;case 3:this.actionBarText="继续下载";break;case 5:this.actionBarText=mt(this.callerContext.adInfo.adBaseInfo.installAppLabel)?this.callerContext.adInfo.adBaseInfo.installAppLabel:"点击安装";break;case 6:this.actionBarText=mt(this.callerContext.adInfo.adBaseInfo.openAppLabel)?this.callerContext.adInfo.adBaseInfo.openAppLabel:"立即打开"}}}isCouponLegacy(){return!1}getBottomTipsText(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.riskPromptText)||"具体活动或金额以实际活动为准"}supportHorizontal(){return!1}enableShowCard(){return!ft(this.industryInfo)}getRightsCardStayTime(){var t,e;let i=7;try{let a=null!==(e=null===(t=this.industryInfo)||void 0===t?void 0:t.rightsCardShowTime)&&void 0!==e?e:7e3;i=Math.ceil(a/1e3)}catch(a){}return i}enableInteractCard(){return this.getInteractShowTime()>0}getInteractShowTime(){var t,e;return null!==(e=null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardShowTime)&&void 0!==e?e:2e3}getInteractTitle(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardTitle)||""}getInteractSubTitle(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardSubTitle)||""}getInteractIcon(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardIcon)||""}getInteractCustomerInfo(){var t;return(null===(t=this.industryInfo)||void 0===t?void 0:t.interactiveCardCustomer)||[]}getDelayShowTime(){var t,e;let i=5;try{let a=null!==(e=null===(t=this.industryInfo)||void 0===t?void 0:t.delayTime)&&void 0!==e?e:2e3;i=Math.ceil(a/1e3)}catch(a){i=5}return i}isVertical(){return 0==this.callerContext.screenOrientation}isSplashScene(){return 4==this.callerContext.adStyle}isInterstitialScene(){return 13==this.callerContext.adStyle}logInteractionImp(){let t=new c;t.template_show_type="interaction_card_ecom";let e={elementType:191,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};Bt.sendLog(i)}logInteractionClick(t){let e=new c;e.click_area=t,e.template_show_type="interaction_card_ecom";let i={elementType:191,clientExtData:JSON.stringify(e)},a={actionType:141,payload:JSON.stringify(i)};Bt.sendLog(a)}logRightsImp(t,e){let i=new c;i.template_show_type=t,this.reportFreQ||(i.universe_feature_freq=e),this.reportFreQ=!0;let a={elementType:191,clientExtData:JSON.stringify(i)},s={actionType:140,payload:JSON.stringify(a)};Bt.sendLog(s)}convert(t,e,i,a){let s=new c;return s.template_show_type=this.templateShowType,jt.convertIfNeeded(1,this.callerContext.adInfo,e,t,i,s,a)}logSplashCardImpression(){if(this.isSplashScene()){let t={elementType:239};jt.log(140,null,t)}}}class ji{}class $i extends Xi{constructor(t,e){super(t,e),this.couponInfo=this.industryInfo,this.actionBarText=this.callerContext.adInfo.adBaseInfo.adActionDescription,this.mScreenWidthDp=function(t){if(null==t)return-1;let e=t.screenWidth;return dt()&&(e=Tachikoma.px2Dp(e)),e}(et()),this.mScreenScaleX=this.mScreenWidthDp/414}getCardSize(){let t=new ji;return t.width=Math.ceil(406*this.mScreenScaleX),t.height=Math.ceil(372*t.width/406),t}getRootBgColor(){return null}getCouponBarSize(){let t=new ji;return t.width=Math.ceil(264*this.mScreenScaleX),t.height=Math.ceil(92*t.width/264),t.left=Math.ceil((this.mScreenWidthDp-t.width)/2),t.bottom=Math.ceil(68*t.height/92),t}getFullCardBgUrl(){return"ec_card_coupon_anim_bg.png"}getFullCardHeight(){return 497*this.mScreenWidthDp/414}getRightsCardTitle(){return""}needCouponBarBg(){return!0}getBottomTipsMarginBottom(){return Math.ceil(45*this.mScreenScaleX)}getBottomImageViewName(){return null}useLegacyAnim(){return!1}getBgUrl(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardBgUrl)||""}getUserIcon(){return""}getTitleDesc(){return""}getCouponTitle(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardTitle)||""}getCouponDesc(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardDescription)||""}getPriceAmount(){var t;return(null===(t=this.couponInfo)||void 0===t?void 0:t.merchantCardAmount)||""}enableAnimation(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle||4==this.callerContext.adStyle}enableShowCloseView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowCountDownView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowActionbarView(){return 13!=this.callerContext.adStyle}enableHandBreathAnim(){return!0}getActionbarDesc(){return this.couponInfo.merchantCardActionDescription||"立即领取"}logECCardImpression(){let t=new c;t.template_show_type="ecommerce_coupon";let e={clientExtData:JSON.stringify(t)};jt.exposeElement(191,e)}}class Ji extends $i{constructor(t){var e;super(t,null),this.merchantCardInfo=F(this.callerContext.adInfo,this.callerContext.adStyle),this.actionBarText=(null===(e=this.merchantCardInfo)||void 0===e?void 0:e.merchantCardActionDescription)||"立即领取"}getCardSize(){let t=new ji;return t.width=263,t.height=273,t}getRootBgColor(){return"#00000099"}getCouponBarSize(){let t=new ji;return t.width=211,t.height=69,t.left=31,t.bottom=38,t}getFullCardBgUrl(){return null}supportHorizontal(){return!0}getRightsCardTitle(){return"恭喜获得"}needCouponBarBg(){return!1}getBottomTipsText(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.riskPromptText)||"具体活动或金额以实际活动为准"}getBottomImageViewName(){return"ec_card_view_bg.png"}useLegacyAnim(){return!0}getBgUrl(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardBgUrl)||""}getUserIcon(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardUserIcon)||""}getTitleDesc(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardTitleDescription)||""}getCouponTitle(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardTitle)||""}getCouponDesc(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardDescription)||""}getPriceAmount(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardAmount)||""}getRightsCardStayTime(){let t=10;try{t=Math.ceil(this.merchantCardInfo.merchantCardStayTime/1e3)}catch(e){t=10}return t}getDelayShowTime(){let t=5;try{t=Math.ceil(this.merchantCardInfo.merchantCardShowTime/1e3)}catch(e){t=5}return t}enableInteractCard(){return!1}isCouponLegacy(){return!ft(this.merchantCardInfo)}enableShowCard(){return!ft(this.merchantCardInfo)}enableAnimation(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle||4==this.callerContext.adStyle}enableShowCloseView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowCountDownView(){return 3==this.callerContext.adStyle||2==this.callerContext.adStyle}enableShowActionbarView(){return 13!=this.callerContext.adStyle}enableHandBreathAnim(){return!1}getActionbarDesc(){var t;return(null===(t=this.merchantCardInfo)||void 0===t?void 0:t.merchantCardActionDescription)||"立即领取"}}class Zi extends ye{constructor(){super(...arguments),this.lifeStatus="none",this.inShowingOtherVC=!1,this.adHasConvert=!1,this.showRedPacketRain=!1,this.hasReportExpose=!1,this.lastReportTime=0,this.isHasReportSkipImpress=!1,this.showEndPage=!1,this.pageHasVisibled=!1,this.isMuted=!1,this.isImmersiveMode=!1,this.downloadState=0,this.playcardShowEnd=!1,this.getActionBarRect=()=>({x:0,y:0,width:0,height:0}),this.isClickShapeChangeIcon=()=>!1}getData(t){let e=[];e.push(Bt.getKsAdDataAsync()),e.push(Bt.getDeviceInfoAsync()),e.push(Bt.getKsAdConfigAsync()),e.push(Bt.getContainerLimitAsync()),e.push(Bt.getScreenOrientationAsync()),Promise.all(e).then((e=>{const i=e[0].data,a=e[1].data,s=e[2].data,n=e[3].data,o=e[4].data;try{this.adInfo=i.impAdInfo[0].adInfo[0],this.adStyle=i.impAdInfo[0].adStyle,this.screenOrientation=o.screenOrientation,this.deviceInfo=a,Q(this.deviceInfo)}catch(r){}this.configInfo=s,this.containerLimit=n,this.screenOrientation=o.screenOrientation,this.downloadPopupVM=new Te(this.adInfo,this.adStyle,this.configInfo,this.screenOrientation),this.initCallerContext(),this.createViewModels(),this.registerBridges(),this.setDatas(),t&&t(!0)}))}checkDataValid(){return!!this.adInfo}setDatas(){this.isShowRedPacketViewRightNow()&&this.updateShowRedPacketRain(0),this.isMuted=this.isVideoMute(),this.videoPlayReportSeconds=function(t){let e=[];if(t.adBaseInfo.videoPlayedNS){let a=t.adBaseInfo.videoPlayedNS.split(",");if(a.length>0)for(var i=0;i<a.length;i++){let t=Number(a[i]);e.push(t)}else e=[3]}return e.sort(),e}(this.adInfo)}registerBridges(){var t,e,i;H(this.adInfo)||(t=t=>{if(t.result&&t.data&&t.data.currentTime){this.pageHasVisibled=!0;const e=t.data.currentTime;this.isShowRedPacketViewRightNow()||this.updateShowRedPacketRain(e)}},Bt.callNativeWithCallback("registerSplashProgressListener",null,t,!1)),H(this.adInfo)&&bt.isAndroid()&&(e=t=>{t.result&&t.data&&(t.data.hasLoseAudioFocus&&(this.isMuted=!0),2==t.data.audioFocusStatus&&(this.isMuted=!0))},Bt.callNativeWithCallback("registerAudioFocusListener",null,e,!1),this.isImmersiveMode=1==Tachikoma.env.isImmersiveMode),Bt.registerLifecycleListener((t=>{if(t.result&&t.data){const e=t.data.lifeStatus;"pageVisiable"==e?(this.inShowingOtherVC=!1,H(this.adInfo)&&(this.pageHasVisibled=!0)):"pageInvisiable"==e&&(this.inShowingOtherVC=!0),e!==this.lifeStatus&&(this.lifeStatus=e,this.callerContext.lifeStatus=e)}})),bt.supportMinimumTKVersion("4.0.8")&&(i=t=>{t.result&&t.data&&Nt().emit(xt,{})},Bt.callNativeWithCallback("registerAdConvertListener",null,i,!1)),Nt().on(xt,(t=>{this.adHasConvert=!0})),this.actionBarText=this.getActionBarPrefixByStyle()+this.adInfo.adBaseInfo.adActionDescription,this.actionBarTextNoPrefix=this.adInfo.adBaseInfo.adActionDescription,bt.isSupportDownloadProgressListen()&&_(this.adInfo)&&Bt.registerProgressListener((t=>{if(this.ecCustomCardViewModel&&this.ecCustomCardViewModel.updateProgressListener(t),t.result){const{status:e,progress:i,totalBytes:a}=t.data,s=Number((100*i).toFixed(0))>100?"100":(100*i).toFixed(0);switch(this.downloadState=e,this.downloadPopupVM.updateDownloadProgress(ve.newInstance(e,i,a)),e){case 0:case 1:case 4:this.actionBarText=this.getActionBarPrefixByStyle()+this.adInfo.adBaseInfo.adActionDescription,this.actionBarTextNoPrefix=this.adInfo.adBaseInfo.adActionDescription;break;case 2:this.actionBarText=`${s}%`,this.actionBarTextNoPrefix=this.actionBarText;break;case 3:this.actionBarText=this.getActionBarPrefixByStyle()+"继续下载",this.actionBarTextNoPrefix="继续下载";break;case 5:this.actionBarText=this.getActionBarPrefixByStyle()+(mt(this.adInfo.adBaseInfo.installAppLabel)?this.adInfo.adBaseInfo.installAppLabel:"点击安装"),this.actionBarTextNoPrefix=mt(this.adInfo.adBaseInfo.installAppLabel)?this.adInfo.adBaseInfo.installAppLabel:"点击安装";break;case 6:this.actionBarText=this.getActionBarPrefixByStyle()+(mt(this.adInfo.adBaseInfo.openAppLabel)?this.adInfo.adBaseInfo.openAppLabel:"立即打开"),this.actionBarTextNoPrefix=mt(this.adInfo.adBaseInfo.openAppLabel)?this.adInfo.adBaseInfo.openAppLabel:"立即打开"}}}))}initCallerContext(){this.callerContext=new Re(this.adInfo,this.adStyle,this.configInfo,this.containerLimit,this.screenOrientation)}createViewModels(){this.giftBoxViewModel=new Gi(this.callerContext),this.redPacketViewModel=new zi(this.containerLimit,this.adInfo,this.adStyle),this.ecCustomCardViewModel=new Ji(this.callerContext),this.bubbleRainViewModel=new Yi(this.callerContext)}updateShowRedPacketRain(t){this.enableShowRedPacketView()&&(this.showRedPacketRain=t>=this.getRedPacketViewDelayShowTime())}enableShowBubbleRainView(){return!this.callerContext.isLandScape()&&this.bubbleRainViewModel.enableShowBubbleRainView()}enableShowGiftBoxView(){return this.giftBoxViewModel.enableShowGiftBox()}enableShowRedPacketView(){return this.redPacketViewModel.enableShowRedPacketView()}getRedPacketViewDelayShowTime(){return this.redPacketViewModel.getRedPacketViewDelayShowTime()}isShowRedPacketViewRightNow(){return this.redPacketViewModel.isShowRedPacketViewRightNow()}isImageMaterial(){return 2==S(this.adInfo)}isInnerImage(){return 1==function(t){try{return t.adMaterialInfo.materialFeature[0]}catch(e){}return null}(this.adInfo).source}enableShowActionBarView(){try{return 10==this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.interactiveStyle}catch(t){}return!1}getActionBarInteractiveStyle(){try{return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.interactiveStyle}catch(t){}return 0}getSplashCombinedStyle(){try{return 9==this.getActionBarInteractiveStyle()?this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.combinedStyleType+80:this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.combinedStyleType}catch(t){}return 9==this.getActionBarInteractiveStyle()?81:2}getActionBarPrefixByStyle(){let t="";switch(this.getActionBarInteractiveStyle()){case 2:this.isOnlyShakeCanConvert()||(t="或点击");break;case 1:case 9:t="或点击";break;case 10:t="扭动或点击";break;case 4:t="点击";break;case 12:t="任意方向滑动或点击"}return this.isDefaultActionBarView&&(t="点击"),t}getSplashSlideConvertDistance(){try{return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.slideInfo.convertDistance}catch(t){}return 50}handleSlideConvert(t,e,i,a,s=!0){if(s&&!this.enableConvertBySwipeType(i))return;let n={fingerSwipeType:i,fingerSwipeDistance:a};jt.convertIfNeeded(1,this.adInfo,2,{x:t,y:e},At.CARD_SWIPE_CONVERT,null,n)}getSplashShakeActionBarText(){let t="";try{t=_(this.adInfo)?this.actionBarText:"或"+this.configInfo.appConfig.splashBtnText}catch(e){}return t}getSplashSlideActionBarText(){let t="";try{t=_(this.adInfo)?this.actionBarText:this.getActionBarPrefixByStyle()+(this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.slideInfo.subtitle||"跳转详情页或第三方应用")}catch(e){}return t}getSplashShakeTitle(){try{return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.shakeInfo.subtitle}catch(t){}return"摇一摇"}getSplashRotateTitle(){try{return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.rotateInfo.title}catch(t){}return"扭一扭"}getSplashSlideTitle(){try{return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.slideInfo.title}catch(t){}return"滑动屏幕"}getSplashRotateSubtitle(){let t="";try{t=_(this.adInfo)?this.actionBarText:this.getActionBarPrefixByStyle()+(this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.rotateInfo.subTitle||"跳转详情页或第三方应用")}catch(e){}return t}getSplashActionbarTitle(){let t="跳转详情页或第三方应用";try{t=_(this.adInfo)?this.actionBarText:this.getActionBarPrefixByStyle()+(this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.actionBarInfo.title||"跳转详情页或第三方应用")}catch(e){}return t}getSplashActionbarContentNoPrefix(){return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.actionBarInfo.title||"跳转详情页或第三方应用"}getSplashDisableType(){try{return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.isMediaDisable}catch(t){}return!1}getPreloadTips(){let t="";try{t=this.adInfo.adPreloadInfo.preloadTips}catch(e){}return t}getImageDisplaySecond(){let t=0;try{return this.adInfo.adSplashInfo.imageDisplaySecond}catch(e){}return 0==t&&(t=5),t}getVideoDisplaySecond(){try{return this.adInfo.adSplashInfo.videoDisplaySecond}catch(t){}return 0}getBeginShapeChangeTimeMs(){let t=0;try{t=this.configInfo.abConfig.splashAdBeginShapeChangeTimeMs}catch(e){}return(ft(t)||t<1e3||t>2e3)&&(t=1500),t}getShapeChangeDurationMs(){let t=0,e=this.getBeginShapeChangeTimeMs();try{t=this.configInfo.abConfig.splashAdEndShapeChangeTimeMs}catch(i){}return(ft(t)||t<3e3||t>6e3)&&(t=6e3),t-e}isShowSkipTopRightView(){let t=!1;try{t=0==this.adInfo.adSplashInfo.skipButtonPosition}catch(e){}return t}isShowSkipCountdown(){let t=!1;try{t=1==this.adInfo.adSplashInfo.countdownShow}catch(e){}return t}getSkipTips(){let t="跳过";try{t=this.adInfo.adSplashInfo.skipTips}catch(e){}return t}isShowCircleSkipView(){let t=!1;try{t=2==this.adInfo.adSplashInfo.skipType||3==this.adInfo.adSplashInfo.skipType}catch(e){}return t}getPrivacyViewOriTop(){return this.isShowCircleSkipView()?52:48}getSideMargin(){return ht()&&this.callerContext.isLandScape()?48:this.callerContext.isLandScape()?16:null}isShowSkipView(){let t=!0;try{t=this.adInfo.adSplashInfo.skipSecond>=0}catch(e){}return t}isShowSplashSkipArea(){let t=!1;if(!this.isShowSkipView())return t;try{t=(0==this.adInfo.adSplashInfo.skipType||2==this.adInfo.adSplashInfo.skipType)&&this.isShowSkipTopRightView()}catch(e){}return t}isShowLogoView(){let t=!1;try{t=1==this.adInfo.adSplashInfo.logoPosition}catch(e){}return t}isVideoMute(){let t=!1;try{t=2!=this.adInfo.adSplashInfo.mute}catch(e){}return t}getSoundUrl(){let t="";try{t=this.isMuted?this.adInfo.adSplashInfo.speakerMuteIconUrl:this.adInfo.adSplashInfo.speakerIconUrl}catch(e){}return ft(t)&&(t=this.isMuted?"splash_sound_mute.webp":"splash_sound_unmute.webp"),t}getSplashShapeChangeIconUrl(){let t="";try{t=this.adInfo.adMatrixInfo.adDataV2.splashPlayCardTKInfo.splashShapeChangeIconUrl}catch(e){}return ft(t)&&(t="https://p1-lm.adkwai.com/udata/pkg/ks-ad-ssp/splash/packet_3x.png"),t}getImageDownloadTimeMs(){let t=500;try{t=this.configInfo.abConfig.splashMaterialDownloadTimeMs}catch(e){}return(ft(t)||0==t)&&(t=500),t}getSplashAdLoadProcessChange(){let t=!1;try{t=this.configInfo.abConfig.splashAdLoadProcessChange}catch(e){}return t}isSplashRedPacketDisplayTopLevel(){let t=!1;try{t=this.configInfo.abConfig.splashRedPacketDisplayTopLevel}catch(e){}return t}callAdSkip(t){this.reportCloseAction(t),Pt(2)}videoPlayFailed(t,e){Pt(4,t,e)}videoFinish(){jt.log(400,null,null)}reportVideoPlayNs(t){const e=Math.floor(t);if(e!=this.lastReportTime)for(var i=0;i<this.videoPlayReportSeconds.length;i++)if(e==this.videoPlayReportSeconds[i]){this.lastReportTime=this.videoPlayReportSeconds[i],jt.playNSecond(this.lastReportTime);break}}reportCloseAction(t){t=Math.floor(1e3*t);let e=new l;e.duration=t;let i=new c;i.duration=t;let a={businessSceneType:22,itemCloseType:1,clientExtData:JSON.stringify(i),extParams:JSON.stringify(e)};jt.log(3,null,a)}reportSkipViewImpression(){this.isHasReportSkipImpress||(this.isHasReportSkipImpress=!0,this.isShowSkipView()&&this.isShowSkipCountdown()&&jt.log(140,{x:0,y:0},{elementType:124}))}notifyTimerProgress(t){this.isShowRedPacketViewRightNow()||this.updateShowRedPacketRain(t)}videoProgress(t,e,i){this.videoProgressCallback&&this.videoProgressCallback(t,e,i),this.reportVideoPlayNs(t)}videoPlayStart(){jt.log(399,null,null),Pt(5)}enableSwipe(){try{return this.adInfo.adStyleInfo.slideClick}catch(t){}return!1}enableShakeViewClick(){try{return!this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.shakeInfo.clickDisabled}catch(t){}return!1}reportElementActionBarImpression(t,e){this.hasReportExpose||(this.hasReportExpose=!0,jt.exposeElement(t,e))}reportSplashShowImageDuration(t,e){if(0==e||!this.getSplashAdLoadProcessChange())return;let i=(new Date).getTime()-e;Wt(this.adInfo,t,i,this.getImageDownloadTimeMs())}startSensorListener(t){this.sensorUtil||(this.sensorUtil=new ke(this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo)),this.sensorUtil.startSensorListener(((e,i,a)=>{this.maxAcceleration=i,this.maxSensorValus=a,this.sensorCanConvert()&&(t?t(e):e?this.convertShake():this.convertRotate())}))}sensorCanConvert(){return!this.inShowingOtherVC&&this.pageHasVisibled}stopSensorListener(){var t;null===(t=this.sensorUtil)||void 0===t||t.stopSensorListener()}convertShake(){this.convert(2,{x:0,y:0},At.SHAKE_ICON_SHACK,{splash_shake_acceleration:this.maxAcceleration})}convertRotate(){let t={splashInteractionRotateAngle:this.maxSensorValus};jt.convertIfNeeded(1,this.adInfo,2,{x:0,y:0},At.ROTATE_ICON_ROTATE,null,t)}convert(t,e,i,a){jt.convertIfNeeded(1,this.adInfo,t,e,i,null,a)}clickActionBarConvert(){jt.convertIfNeeded(1,this.adInfo,1,{x:0,y:0},At.SPLASH_CONVERSION_BUTTON_CLICK)}clickRotateBigIconConvert(){jt.convertIfNeeded(1,this.adInfo,1,{x:0,y:0},At.ROTATE_BIG_ICON_CLICK)}enableConvertBySwipeType(t){let e=!0;try{let i=this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.slideInfo.convertSlideDirection;if(ft(i))return!1;if(i.length<4)return!1;switch(t){case 1:e="1"==i.substring(0,1);break;case 4:e="1"==i.substring(1,2);break;case 2:e="1"==i.substring(2,3);break;case 3:e="1"==i.substring(3,4)}}catch(i){}return e}enableShowECCardView(){return this.ecCustomCardViewModel.enableShowCard()}tryConvertECCardView(t,e){let i=this.ecCustomCardViewModel.getActionBarRect();t>i.x&&t<i.x+i.width&&e>i.y&&e<i.y+i.height&&this.ecCustomCardViewModel.convert({x:t,y:e},1,At.CARD_ACTION_BAR_CLICK)}isSplashViewFullscreen(){let t=!0;try{t=Tachikoma.env.deviceHeight-this.callerContext.containerLimit.height-Tachikoma.env.statusBarHeight<30}catch(e){}return t}isOnlyShakeCanConvert(){var t;return null===(t=this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo)||void 0===t?void 0:t.shakeInfo.clickAndSlideDisable}getDynamicTemplateStyle(){try{return this.adInfo.adMatrixInfo.adDataV2.splashInfo.interactionInfo.dynamicEffectInfo.effectStyle}catch(t){}return 0}}(new class extends $t{constructor(){super(),this.vm=new Zi}setupViews(){this.contentView=new Ui(this.vm),this.rootView.throughHitTest=!0,this.rootView.appendChild(this.contentView)}render(){if(this.renderCalled)return!1;this.renderCalled=!0;try{this.vm.getData((t=>{if(t)try{this.setupViews(),Tachikoma.render(this.rootView),this.updateRenderStatus(1,"")}catch(e){this.updateRenderStatus(0,rt(e))}else this.updateRenderStatus(0,"data invalid")}))}catch(t){this.updateRenderStatus(0,rt(t))}return!0}}).render()})();
//# sourceMappingURL=ksad-splash-play-card.346.js.map