(()=>{"use strict";class t{static saveLocal(t,e){if("undefined"!=typeof TKLocalStorage){(new TKLocalStorage).set(t,e)}}static getLocalString(t){if("undefined"!=typeof TKLocalStorage){let e=(new TKLocalStorage).get(t);if(e)return e.toString()}return null}static getLocalInt(t){if("undefined"!=typeof TKLocalStorage){let e=(new TKLocalStorage).get(t);if(e)return Number.parseInt(e.toString())}return 0}}let e=null;const i="TKResIndexKey";class a{constructor(){var e,a,s;this.defaultHost="p1-lm.adukwai.com",this.currentIndex=0;let l=null===(s=null===(a=null===(e=n)||void 0===e?void 0:e.appConfig)||void 0===a?void 0:a.idc)||void 0===s?void 0:s.tkres;l&&0!=l.length||(l=["p1-lm.adukwai.com","p2-lm.adukwai.com"]),this.resList=l;let r=t.getLocalInt(i);r>l.length&&(r=0),this.currentIndex=r}static getInstance(){return e||(e=new a),e}getCurrentHost(){return this.currentIndex>=this.resList.length?this.defaultHost:this.resList[this.currentIndex]}markUrlFail(e){if(!(e.indexOf(this.getCurrentHost())<0||"undefined"!=typeof KSAdTKNetworkManager&&0==KSAdTKNetworkManager.getCurrentNetworkType())){const e=this.currentIndex;this.currentIndex=++this.currentIndex%this.resList.length,this.currentIndex!==e&&t.saveLocal(i,this.currentIndex)}}}var s=null,n=null,l=null;function r(t){s=t}function o(t){return t instanceof Error?t.stack?t.stack:t.message:"string"==typeof t?t:"number"==typeof t?t+"":"unknown"}function c(){return!_(Tachikoma.env.hasTKBridge)&&1==Tachikoma.env.hasTKBridge}function h(){return"Android"===Tachikoma.env.platform}function d(t){return"string"==typeof t&&t.length>0}function C(){return s?s.tkVersion:Tachikoma.env.tkVersion}function T(){return s?s.SDKVersion:Tachikoma.env.SDKVersion}function u(){return s?s.sdkType:Tachikoma.env.sdkType}function _(t){return null===t||null==t||""===t}function I(t){if(t)for(const i in t){if("object"==typeof t[i]&&!i.includes("$"))try{t[i].nativeID||(t[i].nativeID=i),I(t[i])}catch(e){}}}function p(t){let e=t;return e.indexOf("/")>=0||t.startsWith("http")||(e="https://"+a.getInstance().getCurrentHost()+"/kos/nlav111362/ksad/"+t),e}function g(t,e){!function(t,e,i){if(t&&e){const s=p(e);t.setImageLoadCallback&&s.startsWith("http")&&t.setImageLoadCallback((t=>{a.getInstance().markUrlFail(s),i&&i(t)})),t.setSrc(s)}}(t,e,null)}class A{static isAndroid(){return"Android"===this.platform}static isSupportDownloadProgressListen(){return this.isAndroid()||A.supportMinimumTKVersion("5.0.4")}static isSupportDownloadDel(){return this.isAndroid()&&A.supportMinimumTKVersion("5.0.7")}static getCurrentTimeStamp(){return(new Date).getTime()}static getSemiCircle(){return this.isAndroid()?180:Math.PI}static getRotateSemiCircle(){return this.isAndroid()?45:Math.PI}static compareVersion(t,e){if(void 0===t&&void 0===e)return 0;if(void 0===t)return-1;if(void 0===e)return 1;let i=t.split("."),a=e.split("."),s=Math.max(i.length,a.length);for(var n=0;n<s;n++){let t=Number(void 0!==i[n]?i[n]:"0"),e=Number(void 0!==a[n]?a[n]:"0");if(t>e)return 1;if(t!=e)return-1}return 0}static supportMinimumVersion(t="0.0.0",e="0.0.0"){let i=u(),a=1==i&&-1!=A.compareVersion(T(),t),s=2==i&&-1!=A.compareVersion(T(),e);return a||s}static supportCurrentVersion(t="0.0.0",e="0.0.0"){let i=u(),a=1==i&&0==A.compareVersion(T(),t),s=2==i&&0==A.compareVersion(T(),e);return a||s}static supportCurrentTKVersion(t="0.0.0"){return C()==t}static supportMinimumTKVersion(t="0.0.0"){return-1!=A.compareVersion(C(),t)}}A.platform=Tachikoma.env.platform;class f{static randomString(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i="",a=0;a<t;a++)i+=e.charAt(Math.floor(48*Math.random()));return i}static randomName(t){return"jscb_"+t+"_"+this.randomString(4)+this.globalIndex++}static registerCallback(t,e=!0){return this.registerCallbackForAction(t,e,"")}static registerCallbackForAction(t,e=!0,i){if(!t)return null;const a=this.randomName(i);return Tachikoma[a]=e=>{t(e)},"Tachikoma."+a}}f.globalIndex=0;const L=new class{constructor(){this.enabled=!1,this.logs=[]}setLoggerEnabled(t){this.enabled=t}log(t){if(this.enabled){const e=new Date;0==this.logs.length&&this.logs.push(e.getMonth()+1+":"+e.getDate()+"-"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.logs.push(e.getMilliseconds()+":"+t)}}clear(){this.logs.splice(0,this.logs.length)}exportLog(){return JSON.stringify(this.logs)}};class m{static getDeviceInfoAsync(){return m.callNative("getDeviceInfo",null).then((t=>(t.result&&t.data&&r(t.data),t)))}static getKsAdDataAsync(){return m.callNative("getKsAdData",null)}static getKsAdConfigAsync(){return m.callNative("getKsAdConfig",null).then((t=>{var e;return t.result&&t.data&&(e=t.data,n=e),t}))}static getScreenOrientationAsync(){return m.callNative("getScreenOrientation",null)}static getVideoCloseTime(){return m.callNative("getVideoCloseTime",null)}static getContainerLimitAsync(){return m.callNative("getContainerLimit",null)}static getTKPreEnvAsync(){return m.callNative("getTKPreEnv",null)}static getDeviceInfo(t){this.callNativeWithCallback("getDeviceInfo",null,t)}static getKsAdData(t){this.callNativeWithCallback("getKsAdData",null,t)}static getKsAdConfig(t){this.callNativeWithCallback("getKsAdConfig",null,t)}static getScreenOrientation(t){this.callNativeWithCallback("getScreenOrientation",null,t)}static getContainerLimit(t){return this.callNativeWithCallback("getContainerLimit",null,t)}static registerLifecycleListener(t){this.callNativeWithCallback("registerLifecycleListener",null,t,!1)}static registerFocusListener(t){A.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("registerFocusListener",null,t,!1)}static registerNativeId(t){this.callNativeWithCallback("configNativeId",null,t,!1)}static registerExtraDataListener(t){this.callNativeWithCallback("getKsAdExtraData",null,t,!1)}static hideCard(t,e,i,a=!0){this.callNativeWithCallback("hide",{type:t,playDuration:e},i,a)}static sendLog(t,e){this.callNativeWithCallback("log",t,e)}static sendCommonLog(t,e){this.callNativeWithCallback("commonLog",t,e)}static sendCommercialLog(t,e){this.callNativeWithCallback("commercialLog",t,e)}static adOutCallback(t,e){A.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("adOutCallback",t,e)}static pageStatus(t,e){this.callNativeWithCallback("pageStatus",{status:t,errorMsg:d(e)?e:""})}static clickAction(t,e,i,a,s){this.clickActionBase(Object.assign(Object.assign({area:t,logParam:e},i),{creativeId:a}),s)}static clickActionBase(t,e){this.callNativeWithCallback("clickAction",t,e)}static convert(t){this.callNativeWithCallback("convert",{clickActionButton:t})}static updateExceptedPosition(t){this.callNativeWithCallback("initKsAdFrame",t)}static replayVideo(){this.callNativeWithCallback("replayVideo")}static registerVideoListener(t){this.callNativeWithCallback("registerVideoListener",null,t,!1)}static dislike(){this.callNativeWithCallback("dislike")}static registerProgressListener(t){this.callNativeWithCallback("registerProgressListener",null,t,!1)}static registerVideoProgressListener(t){this.callNativeWithCallback("registerVideoProgressListener",null,t,!1)}static registerGetDynamicActionDesListener(t){this.callNativeWithCallback("getDynamicActionDes",null,t,!1)}static registerTimerListener(t){this.callNativeWithCallback("registerTimerListener",null,t,!1)}static registerVideoMuteStateListener(t){this.callNativeWithCallback("registerMuteStateListener",null,t,!1)}static registerVideoAutoPlayListener(t){this.callNativeWithCallback("registerVideoAutoPlayListener",null,t,!1)}static registerPlayStateResetListener(t){this.callNativeWithCallback("registerPlayStateResetListener",null,t,!1)}static updateVideoMuteState(t){this.callNativeWithCallback("updateVideoMuteState",{muted:t})}static skipVideo(t,e,i,a=0){this.callNativeWithCallback("skipVideo",{needPromopt:t,needReport:e,showTime:i,playDuration:a})}static closeVideo(t){this.callNativeWithCallback("closeVideo",{forceClose:t})}static showPlayEnd(t,e=0){this.callNativeWithCallback("showPlayEnd",{userForce:t,type:e})}static showPlayable(t=0){this.callNativeWithCallback("showPlayable",{playableSource:t})}static registerSceneChangeListener(t){this.callNativeWithCallback("registerSceneChangeListener",null,t,!1)}static hasReward(t){this.callNativeWithCallback("hasReward",{severCheckResult:t})}static clickGift(){this.callNativeWithCallback("clickGift")}static clickCall(t){this.callNativeWithCallback("clickCall",{isEnd:t})}static callButtonImpressionWhenPlay(){this.callNativeWithCallback("callButtonImpressionWhenPlay")}static callButtonImpressionWhenFinish(){this.callNativeWithCallback("callButtonImpressionWhenFinish")}static registerDeepRewardListener(t){this.callNativeWithCallback("registerDeepRewardListener",null,t,!1)}static giveRewardInAdvance(t){this.callNativeWithCallback("giveRewardInAdvance",null,t,!1)}static showLiveEndPage(t){this.callNativeWithCallback("showLiveEndPage",null,t,!1)}static updateRewardTaskState(t){this.callNativeWithCallback("updateRewardTaskState",null,t,!1)}static openURL(t,e,i){this.callNativeWithCallback("openURL",{url:t,title:e,showConfirmDialog:i})}static showTKDialog(t){this.callNativeWithCallback("showTKDialog",{templateId:t})}static closeTKDialog(t){this.callNativeWithCallback("closeTKDialog",{templateId:t})}static registerKeyboardChangeListener(t){this.callNativeWithCallback("registerKeyboardChangeListener",null,t,!1)}static registerShakeListener(t){this.callNativeWithCallback("registerMotionListener",null,t,!1)}static close(t){this.callNativeWithCallback("close",null,t,!1)}static closePassData(t,e){this.callNativeWithCallback("close",t,e,!1)}static updateVideoPlayStatus(t,e,i,a){this.callNativeWithCallback("updateVideoPlayStatus",{status:t,errorCode:e||0,errorReason:i||"",currentTime:a||0})}static registerConvertStatusListener(t){this.callNativeWithCallback("registerConvertStatusListener",null,t,!1)}static cardImpression(){this.callNativeWithCallback("cardImpression")}static getCardShowCount(t){this.callNativeWithCallback("getCardShowCount",null,t,!1)}static getNativeData(t,e){this.callNativeWithCallback("getNativeData",{target:t},e,!1)}static updateExtraReward(t){this.callNativeWithCallback("updateExtraReward",t)}static registerApkInstalledListener(t){this.callNativeWithCallback("registerApkInstalledListener",null,t,!1)}static showToast(t){this.callNativeWithCallback("showToast",{message:t})}static registerExtraDialogListener(t){this.callNativeWithCallback("registerExtraDialogListener",null,t,!1)}static getPlayEndType(t){this.callNativeWithCallback("getPlayEndType",null,t,!1)}static playableConvert(t){this.callNativeWithCallback("playableConvert",t)}static getKsPlayableAdData(t){this.callNativeWithCallback("getKsPlayableAdData",null,t)}static getKsPlayableDeviceInfo(t){this.callNativeWithCallback("getKsPlayableDeviceInfo",null,t)}static registerPlayableStatusListener(t){this.callNativeWithCallback("registerPlayableStatusListener",null,t,!1)}static getTrackAdStatus(t){this.callNativeWithCallback("getTrackAdStatus",null,t,!1)}static showLandingPage(t){this.callNative("showLandingPage",{needCloseNeo:t})}static needCloseNeo(t){this.callNativeWithCallback("needCloseNeo",{needClose:t})}static registerBackPressed(t){h()&&this.callNativeWithCallback("registerBackPressedListener",null,t,!1)}static innerAdImpression(){this.callNativeWithCallback("adImpression",null)}static neoDidShowPlayAgain(){this.callNativeWithCallback("neoDidShowPlayAgain")}static showPlayAgain(){this.callNativeWithCallback("showPlayAgain")}static registerAggregationDataListener(t){this.callNativeWithCallback("registerAggregationDataListener",null,t,!1)}static getLandingPageInfo(t){this.callNativeWithCallback("getLandingPageInfo",null,t,!1)}static registerNeoStatusListener(t){this.callNativeWithCallback("registerNeoStatusListener",null,t,!1)}static callNative(t,e){return new Promise(((i,a)=>this.callNativeWithCallback(t,e,(t=>{t?(1!=t.result&&(t.result=null),i(t)):i({result:0,data:null})}))))}static callNativeWithCallback(t,e,i,a=!0){const s=c()?1:0;c()&&"pageStatus"==t||c()&&"registerLifecycleListener"==t?this.callNativeWithCallbackAndType(t,e,i,a,0):this.callNativeWithCallbackAndType(t,e,i,a,s)}static callTKWithCallback(t,e,i,a=!0){this.callNativeWithCallbackAndType(t,e,i,a,1)}static callNativeWithCallbackAndType(t,e,i,a=!0,s=0){if("undefined"==typeof KwaiAd)return L.log("undefined value KwaiAd"),void(i&&i({result:0,data:null}));L.log("call:"+t);let n=e=>{let a=0,s=null;try{let t=null;t="string"==typeof e?JSON.parse(e):e,a=t.result,s=t.data}catch(n){a=0,s=null}L.log("cb:"+t+"  r:"+a),i&&i({result:a,data:s})};const l=f.registerCallbackForAction(n,a,t),r={action:t,data:JSON.stringify(e||{}),callback:!0===Tachikoma.env.useNewBridge?n:l};0==s?KwaiAd.callAdBridge(r):KwaiAd.callTKBridge(r)}}class v{constructor(){this.renderCalled=!1,this.renderStatusCalled=!1,this.rootView=new TKView,this.rootView.style={width:"100%",height:"100%"}}render(){return!this.renderCalled&&(this.renderCalled=!0,!0)}updateRenderStatus(t,e=""){this.renderCalled&&!this.renderStatusCalled&&(this.renderStatusCalled=!0,m.pageStatus(t,e),this.registerNativeId())}registerNativeId(){1==Tachikoma.env.isDebug&&A.supportMinimumTKVersion("4.0.7")&&!A.isAndroid()&&(this.startConfig(),m.registerNativeId((t=>{t&&t.data&&this.startConfig()})))}startConfig(){this.configNativeIdTimer&&clearTimeout(this.configNativeIdTimer),this.configNativeIdTimer=setTimeout((()=>{I(this)}),120)}}class k extends TKView{}class E extends k{constructor(t,e){super(),this.vm=t,this.type=e,1==this.type?this.setupToastViews():this.setupGuideViews(),this.addEventListener("tap",(t=>{}))}setupGuideViews(){this.bgView=new TKImage,this.bgView.style={width:"150%",height:"100%",position:"absolute",top:0,right:"100%"},this.bgView.setSrc("image/ksad-video-task-card/icon_ksad_video_task_tipsbg.png"),this.appendChild(this.bgView),this.fristTips=new TKText,this.fristTips.style={fontSize:32,color:"#FFFFFF",height:"100%",textAlign:"center",alignContent:"center",right:"100%",fontWeight:"bold"};const t=this.createFontSizeSpanItem(45,5,8,"absoluteSize"),e=new TKSpan;e.addSpan(t);const i=this.createFontSizeSpanItem(45,5,8,"textStyle");e.addSpan(i),this.fristTips.setSpan("恭喜你获得特权!",e),this.appendChild(this.fristTips),this.secondTips=new N(this.vm.getProfileUrl(),this.vm.getGuideTaskTips()),this.secondTips.style={position:"absolute",top:20,width:"100%",height:40,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",left:-Tachikoma.env.deviceWidth},this.appendChild(this.secondTips),this.thirdTips=new TKText,this.thirdTips.style={fontSize:32,color:"#FFFFFF",width:"100%",textAlign:"right",position:"absolute",bottom:12,left:Tachikoma.env.deviceWidth,fontWeight:"bold"};const{start:a,end:s,text:n}=this.vm.getGuideThirdTips(),l=this.createFontSizeSpanItem(45,a,s,"absoluteSize"),r=new TKSpan;r.addSpan(l);const o=this.createFontSizeSpanItem(45,a,s,"textStyle");r.addSpan(o),this.thirdTips.setSpan(n,r),this.appendChild(this.thirdTips)}createFontSizeSpanItem(t,e,i,a){const s=new TKSpanItem;return s.spanType=a,s.size=t,s.start=e,s.end=i,s.textStyle="bold",s}setupToastViews(){this.bgView=new TKImage,this.bgView.style={width:"150%",height:"100%",position:"absolute",top:0,right:0},this.bgView.setSrc("image/ksad-video-task-card/icon_ksad_video_task_tipsbg.png"),this.appendChild(this.bgView),this.fristTips=new TKText,this.fristTips.style={fontSize:32,color:"#FFFFFF",height:"100%",width:"100%",textAlign:"center",alignContent:"center",fontWeight:"bold",right:"100%"},this.fristTips.setText(this.vm.getClickToast()),this.appendChild(this.fristTips)}startAnimation(t){1!=this.type&&(this.bgViewEnterScene(),setTimeout((()=>{t&&t()}),2500))}startToastAnimation(){this.bgViewEnterScene()}bgViewEnterScene(){let t=new TKBasicAnimation;t.setStartValue((()=>{this.bgView.style={opacity:0}})),t.setEndValue((()=>{this.bgView.style={right:-50,opacity:1}})),t.duration=300,t.on("end",(t=>{this.bgViewMovingAnimation(),this.firstStepMovingAnimation()})),this.bgView.addAnimation(t,"bgInitAnimation")}bgViewMovingAnimation(){let t=new TKBasicAnimation;t.setEndValue((()=>{this.bgView.style={right:-150}})),t.duration=2e3,this.bgView.addAnimation(t,"bgMoveAnimation")}firstStepMovingAnimation(){let t=new TKBasicAnimation;t.setEndValue((()=>{this.fristTips.style={left:(this.getSize().width-this.fristTips.getSize().width)/2}})),t.duration=300,this.fristTips.addAnimation(t,"firstLabelEnterAnimaiton"),1!=this.type&&setTimeout((()=>{let t=new TKBasicAnimation;t.setEndValue((()=>{this.fristTips.style={left:this.getSize().width}})),t.duration=300,t.on("end",(t=>{this.secondStepMovingAnimation()})),this.fristTips.addAnimation(t,"firstLabelLeaveAnimaiton")}),600)}secondStepMovingAnimation(){let t=new TKBasicAnimation;t.setEndValue((()=>{this.secondTips.style={left:22}})),t.duration=300,this.secondTips.addAnimation(t,"secondTipsEnterAnimaiton");let e=new TKBasicAnimation;e.setEndValue((()=>{this.thirdTips.style={left:-15}})),e.duration=300,this.thirdTips.addAnimation(e,"thirdTipsEnterAnimaiton"),setTimeout((()=>{let t=new TKBasicAnimation;t.setStartValue((()=>{this.style={opacity:1}})),t.setEndValue((()=>{this.style={opacity:0}})),t.duration=600,this.addAnimation(t,"disappearAnimaiton")}),1e3)}}class N extends TKView{constructor(t,e){super(),this.profile=new TKImage,this.profile.setSrc(t),this.profile.style={width:40,height:40,borderColor:"#FFFFFF",borderWidth:2,borderRadius:12},this.appendChild(this.profile),this.taskDescription=new TKText,this.taskDescription.setText(e),this.taskDescription.style={color:"#FFFFFF",fontSize:32,textAlign:"left",left:10,fontWeight:"bold",alignSelf:"center"},this.appendChild(this.taskDescription)}}class y extends TKView{constructor(){super(),this.style={alignItems:"center",justifyContent:"center"},this.imageView=new TKImage,this.appendChild(this.imageView)}setImageSize(t){this.imageView.style={width:t.width,height:t.height}}setImageSrc(t){g(this.imageView,t)}setImageSrcAndSize(t,e){this.setImageSize(e),this.setImageSrc(t)}configImage(t){t&&t(this.imageView)}}class R extends Object{constructor(t,e,i,a){var s;super(),this.depIds={},this.vm=t,this.getter="function"==typeof e?e:this.parseGetter(e.trim()),this.cb=i,this.value=this.get(),this.cb(null!==(s=this.value)&&void 0!==s?s:a,null),console.log("Watcher on "+e)}update(){const t=this.get();t!=this.value&&(this.cb.call(this.vm,t,this.value),this.value=t)}addDep(t){const e=t.pid;this.depIds.hasOwnProperty(e)||(t.addDep(this),this.depIds[e]=t)}get(){R.target=this;const t=this.getter.call(this.vm,this.vm);return R.target=null,t}parseGetter(t){if(/[^\w.$]/.test(t))return;const e=t.split(".");return function(t){for(let i=0,a=e.length;i<a;i++){if(!t)return;t=t[e[i]]}return t}}}let w;function S(){if(null!=w)return w;let t=!1;try{t=!1,w=t}catch(e){}return t}function D(t){S()&&console.log("tachikoma TKMVVM log -> "+t)}class b extends Object{constructor(t,e){super(),this.object=t,this.observeKey=e,this._observe(t,e)}_observe(t,e){var i=this;Array.isArray(t)?this.defineArray(t):Object.keys(t).forEach((function(a){e?e===a&&i.observeValueWithKey(t,a):i.observeValueWithKey(t,a)}))}observeValueWithKey(t,e){let i=t[e];var a=new O(e);P(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:function(){return R.target&&a.depend(),i},set:function(t){t!==i&&(i=t,a.notify(),P(t))}})}defineArray(t){if(t)for(let e=0,i=t.length;e<i;e++)P(t[e])}}var K=0;class O extends Object{constructor(t){super(),this.key=t,this.pid=K++,this.deps=new Array}depend(){R.target.addDep(this)}addDep(t){this.deps.push(t)}removeDep(t){}notify(){this.deps.forEach((function(t){t.update()}))}}function P(t,e){if(!t||"object"!=typeof t)return;var i;if(!("object"==typeof(i=t)&&Object.keys(i).length>0))return;let a=!1,s=(null!=e?e:"")+"_tkmvvm_observed";if(t.hasOwnProperty(s)&&(a=t[s]),!a)return D("observe "+s),t[s]=!0,new b(t,e);D("already observe "+s)}class V extends Object{constructor(){super()}tk_observe(t){t&&(t in this?P(this,t):console.log("=====++++++ observe2: key not in this:"+t+":"+typeof this))}}class x extends V{constructor(){super(),this.$attrsPath=new Proxy(this,{get:(t,e)=>W(t,e)})}getData(t){}}function W(t,e){return new Proxy({$vm:t,$bind_path:e},{get:(i,a)=>"string"!=typeof a||"function"==typeof i[a]||0==a.indexOf("$")?Reflect.get(i,a):W(t,e+"."+a)})}var M,B,F;!function(t){t.adClickCallback="adClickCallback"}(M||(M={})),function(t){t.START="start",t.CENTRT="center",t.END="end"}(B||(B={})),function(t){t[t.unknown=0]="unknown",t[t.DetailOne=1]="DetailOne",t[t.Simple=2]="Simple",t[t.DetailTwo=3]="DetailTwo"}(F||(F={}));var U,G;!function(t){t[t.RETAIN_CARD_TYPE_1=8]="RETAIN_CARD_TYPE_1",t[t.RETAIN_CARD_TYPE_2=9]="RETAIN_CARD_TYPE_2",t[t.RETAIN_CARD_TYPE_3=10]="RETAIN_CARD_TYPE_3",t[t.RETAIN_CARD_TYPE_4=11]="RETAIN_CARD_TYPE_4",t[t.RETAIN_CARD_TYPE_5=14]="RETAIN_CARD_TYPE_5",t[t.RETAIN_CARD_TYPE_7=16]="RETAIN_CARD_TYPE_7",t[t.RETAIN_CARD_TYPE_8=17]="RETAIN_CARD_TYPE_8",t[t.RETAIN_CARD_TYPE_9=18]="RETAIN_CARD_TYPE_9",t[t.RETAIN_CARD_TYPE_10=19]="RETAIN_CARD_TYPE_10",t[t.RETAIN_CARD_TYPE_11=20]="RETAIN_CARD_TYPE_11"}(U||(U={}));class Y{}!function(t){t[t.UNKNOWN_LIVE_ROOM_PATTERN=0]="UNKNOWN_LIVE_ROOM_PATTERN",t[t.STANDARD_LIVE_ROOM_PATTERN=1]="STANDARD_LIVE_ROOM_PATTERN",t[t.SIMPLIFIED_LIVE_ROOM_PATTERN=2]="SIMPLIFIED_LIVE_ROOM_PATTERN"}(G||(G={}));var H,z,j,J,$,X,q;!function(t){t[t.LIVE_CUT3_STYLE1=11]="LIVE_CUT3_STYLE1",t[t.LIVE_CUT3_STYLE2=12]="LIVE_CUT3_STYLE2"}(H||(H={})),function(t){t[t.LIVE_CUT3_STYLE2=1]="LIVE_CUT3_STYLE2"}(z||(z={})),function(t){t[t.unkonwn=0]="unkonwn",t[t.videoPromoteFollow=1]="videoPromoteFollow",t[t.videoPromoteGoods=2]="videoPromoteGoods",t[t.liveGoods=3]="liveGoods",t[t.liveNotGoods=4]="liveNotGoods",t[t.videoAd=5]="videoAd"}(j||(j={}));!function(t){t[t.NONE=-1]="NONE",t[t.ACTION_BAR_CLICK=1]="ACTION_BAR_CLICK",t[t.UNKNOWN_ITEM_CLICK=0]="UNKNOWN_ITEM_CLICK",t[t.PORTRAIT_CLICK=13]="PORTRAIT_CLICK",t[t.COMMENT_CLICK=14]="COMMENT_CLICK",t[t.PLAY_END_ICON_CLICK=15]="PLAY_END_ICON_CLICK",t[t.PLAY_END_ICON_TITLE_CLICK=16]="PLAY_END_ICON_TITLE_CLICK",t[t.PLAY_END_ICON_DESCRIPTION_CLICK=17]="PLAY_END_ICON_DESCRIPTION_CLICK",t[t.COMMENT_DETAIL_CLICK=25]="COMMENT_DETAIL_CLICK",t[t.PLAY_END_ACTION_BAR_CLICK=26]="PLAY_END_ACTION_BAR_CLICK",t[t.CARD_ACTION_BAR_CLICK=29]="CARD_ACTION_BAR_CLICK",t[t.CARD_ICON_CLICK=30]="CARD_ICON_CLICK",t[t.CARD_ICON_NAME_CLICK=31]="CARD_ICON_NAME_CLICK",t[t.CARD_ICON_COMMENT_CLICK=32]="CARD_ICON_COMMENT_CLICK",t[t.CARD_BLANK_AREA_CLICK=35]="CARD_BLANK_AREA_CLICK",t[t.CARD_PLAY_END_CLICK1=37]="CARD_PLAY_END_CLICK1",t[t.CARD_PLAY_END_CLICK2=38]="CARD_PLAY_END_CLICK2",t[t.PLAY_END_CALL_CLICK=39]="PLAY_END_CALL_CLICK",t[t.PLAY_DETAIL_CALL_CLICK=40]="PLAY_DETAIL_CALL_CLICK",t[t.PLAY_END_GIFT_CLICK=41]="PLAY_END_GIFT_CLICK",t[t.CARD_APP_STORE_CLICK=45]="CARD_APP_STORE_CLICK",t[t.CARD_APP_DOWNLOAD_NUM_CLICK=46]="CARD_APP_DOWNLOAD_NUM_CLICK",t[t.CARD_OTHERAREA_CLICK=53]="CARD_OTHERAREA_CLICK",t[t.CARD_ICON_MOBILE_CLICK=54]="CARD_ICON_MOBILE_CLICK",t[t.CARD_PICTURE_CLICK_ONE=57]="CARD_PICTURE_CLICK_ONE",t[t.CARD_PICTURE_CLICK_TWO=58]="CARD_PICTURE_CLICK_TWO",t[t.CARD_PICTURE_CLICK_THREE=59]="CARD_PICTURE_CLICK_THREE",t[t.CARD_PICTURE_TITLE_CLICK_ONE=60]="CARD_PICTURE_TITLE_CLICK_ONE",t[t.CARD_PICTURE_TITLE_CLICK_TWO=61]="CARD_PICTURE_TITLE_CLICK_TWO",t[t.CARD_PICTURE_TITLE_CLICK_THREE=62]="CARD_PICTURE_TITLE_CLICK_THREE",t[t.CARD_PICTURE_SUBTITLE_CLICK_ONE=63]="CARD_PICTURE_SUBTITLE_CLICK_ONE",t[t.CARD_PICTURE_SUBTITLE_CLICK_TWO=64]="CARD_PICTURE_SUBTITLE_CLICK_TWO",t[t.CARD_PICTURE_SUBTITLE_CLICK_THREE=65]="CARD_PICTURE_SUBTITLE_CLICK_THREE",t[t.CARD_RANK_CLICK=75]="CARD_RANK_CLICK",t[t.CARD_DOWNLOAD_CNT_CLICK=76]="CARD_DOWNLOAD_CNT_CLICK",t[t.CARD_TAG_CLICK=77]="CARD_TAG_CLICK",t[t.CARD_ITEM_BULLET_CLICK=80]="CARD_ITEM_BULLET_CLICK",t[t.CARD_RECOMMEND_REASON_CLICK=84]="CARD_RECOMMEND_REASON_CLICK",t[t.CARD_PAGE_CLICK=85]="CARD_PAGE_CLICK",t[t.COMMENT_PICTURE_CLICK=100]="COMMENT_PICTURE_CLICK",t[t.PLAYEND_ICON_OTHERAREA_CLICK=104]="PLAYEND_ICON_OTHERAREA_CLICK",t[t.INTERACT_LANDING_PAGE_CLICK=110]="INTERACT_LANDING_PAGE_CLICK",t[t.ACTIONBAR_ICON_CLICK=115]="ACTIONBAR_ICON_CLICK",t[t.ACTIONBAR_ICON_COMMENT_CLICK=117]="ACTIONBAR_ICON_COMMENT_CLICK",t[t.ACTIONBAR_ICON_OTHER_AREA_CLICK=118]="ACTIONBAR_ICON_OTHER_AREA_CLICK",t[t.CLOSE_BULLET_ICON_CLICK=127]="CLOSE_BULLET_ICON_CLICK",t[t.CLOSE_BULLET_ICON_TITLE_CLICK=128]="CLOSE_BULLET_ICON_TITLE_CLICK",t[t.CLOSE_BULLET_ICON_DESCRIPTION_CLICK=129]="CLOSE_BULLET_ICON_DESCRIPTION_CLICK",t[t.CLOSE_BULLET_OTHERAREA_CLICK=130]="CLOSE_BULLET_OTHERAREA_CLICK",t[t.CLOSE_BULLET_ACTION_BAR_CLICK=131]="CLOSE_BULLET_ACTION_BAR_CLICK",t[t.SPLASH_CONVERSION_BUTTON_CLICK=132]="SPLASH_CONVERSION_BUTTON_CLICK",t[t.NEO_AUTO_SHOW_STOREKIT=147]="NEO_AUTO_SHOW_STOREKIT",t[t.CARD_LEFT_ACTION_BAR_CLICK=150]="CARD_LEFT_ACTION_BAR_CLICK",t[t.CARD_SWIPE_CONVERT=153]="CARD_SWIPE_CONVERT",t[t.ONLINE_AUDIENCE_NUM=154]="ONLINE_AUDIENCE_NUM",t[t.SHAKE_ICON_SHACK=157]="SHAKE_ICON_SHACK",t[t.SHAKE_BIG_ICON_CLICK=158]="SHAKE_BIG_ICON_CLICK",t[t.ROTATE_ICON_ROTATE=161]="ROTATE_ICON_ROTATE",t[t.ROTATE_BIG_ICON_CLICK=162]="ROTATE_BIG_ICON_CLICK",t[t.CARD_TROLLEY_ICON_CLICK=164]="CARD_TROLLEY_ICON_CLICK",t[t.LANDING_PAGE_OTHER_AREA_CLICK=171]="LANDING_PAGE_OTHER_AREA_CLICK",t[t.CARD_FOLLOW_NUM=172]="CARD_FOLLOW_NUM",t[t.FALL_ICON_CLICK=173]="FALL_ICON_CLICK",t[t.LIVE_BUTTON_CLICK=175]="LIVE_BUTTON_CLICK",t[t.DIRECT_H5_PAGE_CLICK=177]="DIRECT_H5_PAGE_CLICK",t[t.GOODS_ITEM_CARD_CLICK=178]="GOODS_ITEM_CARD_CLICK",t[t.GOODS_ITEM_CARD_SLIDE_CLICK=179]="GOODS_ITEM_CARD_SLIDE_CLICK",t[t.ITEM_HOT_BUY_STYLE_CLICK=180]="ITEM_HOT_BUY_STYLE_CLICK",t[t.GUIDE_ENTER_LIVE_CLICK=181]="GUIDE_ENTER_LIVE_CLICK",t[t.AUTO_CLICK_OTHER_AREA=182]="AUTO_CLICK_OTHER_AREA",t[t.POPLAY_FALL_IOCN=186]="POPLAY_FALL_IOCN",t[t.ROTATE_SHAKE_BIG_ICON_CLICK=187]="ROTATE_SHAKE_BIG_ICON_CLICK"}(J||(J={})),function(t){t[t.adClickReward=1]="adClickReward"}($||($={})),function(t){t[t.isRewarded=1]="isRewarded",t[t.noExtraReward=2]="noExtraReward",t[t.hasWatchReward=3]="hasWatchReward"}(X||(X={})),function(t){t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical"}(q||(q={}));const Q="ad_convert_event";p("h5_default_icon.png"),p("download_default_icon.png");var Z,tt;!function(t){t[t.THREEIMG_DEFAULT_CLICK=0]="THREEIMG_DEFAULT_CLICK",t[t.THREEIMG_FIRST_CLICK=1]="THREEIMG_FIRST_CLICK",t[t.THREEIMG_SECOND_CLICK=2]="THREEIMG_SECOND_CLICK",t[t.THREEIMG_THIRD_CLICK=3]="THREEIMG_THIRD_CLICK"}(Z||(Z={})),function(t){t[t.picStyle=1]="picStyle",t[t.textStyle=2]="textStyle"}(tt||(tt={}));function et(t){try{return 1==t.adBaseInfo.adOperationType}catch(e){}return!1}function it(t,e){let i;switch(e){case 1:try{i=t.adMatrixInfo.adDataV2.middleTKCardInfo.templateId}catch(a){i=void 0}break;case 12:try{i=t.adMatrixInfo.adDataV2.neoTKInfo.templateId}catch(a){i=void 0}break;case 3:try{i=t.adMatrixInfo.adDataV2.fullScreenInfo.templateId}catch(a){i=void 0}break;case 2:try{i=t.adMatrixInfo.adDataV2.interstitialCardInfo.templateId}catch(a){i=void 0}break;case 4:try{i=t.adMatrixInfo.adDataV2.topFloorTKInfo.templateId}catch(a){i=void 0}break;case 6:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(a){i=void 0}break;case 5:try{i=t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.templateId}catch(a){i=void 0}break;case 7:try{i=t.adMatrixInfo.adDataV2.activityMiddlePageInfo.templateId}catch(a){i=void 0}break;case 10:try{i=t.adMatrixInfo.adDataV2.rewardVideoTaskInfo.templateId}catch(a){i=void 0}break;case 9:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(a){i=void 0}break;case 11:try{i=t.adMatrixInfo.adDataV2.pushTKInfo.templateId}catch(a){i=void 0}break;case 13:try{i=t.adMatrixInfo.adDataV2.splashEndCardTKInfo.templateId}catch(a){i=void 0}break;case 14:try{i=t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId}catch(a){i=void 0}break;case 15:try{i=t.adMatrixInfo.adDataV2.installedActivateInfo.templateId}catch(a){i=void 0}break;case 16:try{i=t.adMatrixInfo.adDataV2.videoImageTKInfo.templateId}catch(a){i=void 0}break;case 17:try{i=t.adMatrixInfo.adDataV2.feedTKCardInfo.templateId}catch(a){i=void 0}break;default:i=void 0}return i}function at(t,e){let i=it(t,e);if(!d(i))return;const a=t.adMatrixInfo.adDataV2.templateDatas.length;for(let s=0;s<a;s++){let e=t.adMatrixInfo.adDataV2.templateDatas[s];if(e.templateId==i)return e}}function st(t,e){let i=!0;if(1==t.adBaseInfo.adOperationType)try{let a=t.downloadSafeInfo.complianceInfo;if(null!=a)switch(e){case 1:i=3!=a.actionBarType;break;case 2:i=3!=a.describeBarType;break;case 3:i=3!=a.materialJumpType;break;default:i=!0}}catch(a){i=!0}else try{let a=t.unDownloadConf.unDownloadRegionConf;if(null!=a)switch(e){case 1:i=1!=a.actionBarType;break;case 2:i=1!=a.describeBarType;break;case 3:i=1!=a.materialJumpType;break;default:i=!0}}catch(a){i=!0}return i}let nt;function lt(){var t;return nt||(nt={all:t=t||new Map,on(e,i){const a=t.get(e);a?a.push(i):t.set(e,[i])},off(e,i){const a=t.get(e);a&&(i?a.splice(a.indexOf(i)>>>0,1):t.set(e,[]))},emit(e,i){let a=t.get(e);a&&a.slice().map((t=>{t(i)})),a=t.get("*"),a&&a.slice().map((t=>{t(e,i)}))},clear(){t.clear()}}),nt}class rt{static updateClientData(t){this.sClientExtData=t}static sendLog(t,e,i){(e=e||{}).renderContainer=1;const a={actionType:t,payload:JSON.stringify(e),adCacheId:i};m.sendLog(a)}static log(t,e,i){(i=i||{}).renderContainer=1;const a={actionType:t,payload:JSON.stringify(i)};e&&(a.clickInfo=e),m.sendLog(a)}static convertIfNeeded(t,e,i,a,s,n,r,o,c){if(!st(e,i))return;let h=l;_(h)||(_(n)&&(n=new Y),_(n.template_id)&&(n.template_id=h.templateId),_(n.template_version)&&(n.template_version=h.templateVersion)),this.convert(i,a,s,t,n,r,o,c)}static convert(t,e,i,a,s,n,l,r){let o,c;o=_(s)?{itemClickType:i,renderContainer:1}:{itemClickType:i,renderContainer:1,clientExtData:JSON.stringify(s)},_(n)||Object.assign(o,n),lt().emit(Q,{clickType:i}),e?(c={x:e.x,y:e.y},e.width&&(c.width=e.width),e.height&&(c.height=e.height)):c={},m.clickAction(t,{payload:JSON.stringify(o),clickInfo:c,sceneType:a,itemClickType:i},l,r,(i=>{1!=i.result&&(this.log(2,e,o),m.convert(1==t))}))}static expose(t){this.log(1,null,t)}static exposeElement(t,e){(e=e||{}).elementType=t,this.log(140,null,e)}static clickElement(t){const e={elementType:t};this.log(141,null,e)}static convertWithTypeIfNeeded(t,e,i,a,s){if(A.isAndroid())this.convertWithType(e,i,a,s);else{if(!st(t,e))return;this.convertWithType(e,i,a,s)}}static convertWithType(t,e,i,a){let s={itemClickType:i,renderContainer:1};lt().emit(Q,{clickType:i}),m.clickAction(t,{payload:JSON.stringify(s),clickInfo:{x:e.x,y:e.y},convertType:a},(i=>{1!=i.result&&(this.log(2,e,s),m.convert(1==t))}))}static convertWithTypeIfNeededNew(t,e,i,a,s,n){if(A.isAndroid())this.convertWithTypeNew(e,i,a,s,n);else{if(!st(t,e))return;this.convertWithTypeNew(e,i,a,s,n)}}static convertWithTypeNew(t,e,i,a,s){let n=s||{};n.itemClickType=i,n.renderContainer=1,lt().emit(Q,{clickType:i}),m.clickAction(t,{payload:JSON.stringify(n),clickInfo:{x:e.x,y:e.y},convertType:a},(i=>{1!=i.result&&(this.log(2,e,n),m.convert(1==t))}))}static convertNew(t,e,i,a,s,n){let l=n||{};l.itemClickType=s,l.renderContainer=1,lt().emit(Q,{clickType:s});let r=s;m.clickAction(e,{payload:JSON.stringify(l),clickInfo:{x:i.x,y:i.y,width:a.width,height:a.height},sceneType:t,itemClickType:r},(t=>{1!=t.result&&(this.log(2,i,l),m.convert(1==e))}))}static playNSecond(t){let e={photoPlaySecond:t};this.log(402,null,e)}static skip(){this.log(501,null,null)}}var ot;!function(t){t[t.begin=-1]="begin",t[t.failed=0]="failed",t[t.finished=1]="finished",t[t.tasking=2]="tasking"}(ot||(ot={}));class ct extends x{getData(t){let e=[];e.push(m.getKsAdDataAsync()),e.push(m.getDeviceInfoAsync()),e.push(m.getKsAdConfigAsync()),e.push(m.getContainerLimitAsync()),e.push(m.getScreenOrientationAsync()),Promise.all(e).then((e=>{const i=e[0].data,a=e[1].data,s=e[2].data,n=e[3].data,l=e[4].data;try{this.adInfo=i.impAdInfo[0].adInfo[0],this.adStyle=i.impAdInfo[0].adStyle,this.screenOrientation=l.screenOrientation,r(this.deviceInfo),this.cardInitInfo()}catch(o){}this.deviceInfo=a,this.configInfo=s,this.containerLimit=n,this.screenOrientation=l.screenOrientation,t&&t(!0)}))}cardInitInfo(){this.rewardTaskInfo=this.adInfo.adMatrixInfo.adDataV2.rewardVideoTaskInfo,this.rewartStyleDataInfo=function(t,e){let i=at(t,e);if(null!=i)return JSON.parse(i.data)}(this.adInfo,10),this.hasShowCloseToast=!1,m.updateRewardTaskState((t=>{if(t.data){const e=t.data.rewardTaskState||ot.failed;this.updateTaskState(e)}})),A.isSupportDownloadProgressListen()&&et(this.adInfo)&&this.isCovertTask()&&m.registerProgressListener((t=>{if(t.result){const{status:e,progress:i,totalBytes:a}=t.data,s=Number((100*i).toFixed(0))>100?"100":(100*i).toFixed(0);let n;switch(this.downloadState=e,e){case 1:case 4:this.updateTaskState(ot.failed);break;case 2:n=`${s}%`,this.updateActionText(n);break;case 3:n="继续下载",this.updateActionText(n);break;case 5:n=d(this.adInfo.adBaseInfo.installAppLabel)?this.adInfo.adBaseInfo.installAppLabel:"点击安装",this.updateActionText(n);break;case 6:n=d(this.adInfo.adBaseInfo.openAppLabel)?this.adInfo.adBaseInfo.openAppLabel:"立即打开"}}}))}updateActionText(t){this.updateActionTextCallback&&this.updateActionTextCallback(t)}checkDataValid(){return!!this.adInfo}getTaskType(){var t;return null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.taskType}isCovertTask(){return 1==this.getTaskType()}isFinishedTask(){return this.taskState==ot.finished}getTaskCardDuration(){var t;return(null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.duration)||10}getTaskDescription(){var t;return null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.taskDescription}getTaskActionDescription(){var t,e,i;return 0==(null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.taskType)?`点击，提前${null===(e=this.rewardTaskInfo)||void 0===e?void 0:e.thresholdTime}秒跳过广告`:null===(i=this.rewardTaskInfo)||void 0===i?void 0:i.taskActionDescription}getProfileUrl(){var t;return null===(t=this.rewartStyleDataInfo)||void 0===t?void 0:t.adAppUrl}getTaskCardTitle(){var t,e;return 1==(null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.taskType)?"免看广告特权":`提前${null===(e=this.rewardTaskInfo)||void 0===e?void 0:e.thresholdTime}秒获得奖励特权`}getGuideTaskTips(){var t;return 1==this.rewardTaskInfo.taskType?null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.taskDescription:"点击广告"}getGuideThirdTips(){var t,e;let i="",a=0;if(1==(null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.taskType))i="免看本次广告",a=2;else{const t=`提前${null===(e=this.rewardTaskInfo)||void 0===e?void 0:e.thresholdTime}秒`;i=t+"获得奖励",a=t.length}return{start:0,end:a,text:i}}getClickToast(){var t;return`可提前${null===(t=this.rewardTaskInfo)||void 0===t?void 0:t.thresholdTime}秒获得奖励`}handleTaskAction(t){if(0==this.getTaskType()&&A.isAndroid()&&et(this.adInfo)&&!function(t){var e,i;try{return(null===(i=null===(e=t.adConversionInfo)||void 0===e?void 0:e.deeplinkUrl)||void 0===i?void 0:i.length)>0}catch(a){}return!1}(this.adInfo))return this.switchToastCallbackInClickTask&&this.switchToastCallbackInClickTask(),void setTimeout((()=>{this.convertIfNeeded(t),this.closePage(3,{interactSuccess:!0})}),2e3);this.convertIfNeeded(t)}updateTaskState(t){this.taskState=t,this.taskStateCallback&&this.taskStateCallback(t)}updateClickTaskState(t){this.switchToastCallbackInClickTask&&this.switchToastCallbackInClickTask(),setTimeout((()=>{this.closePage(3,{interactSuccess:!0})}),2e3)}closePage(t,e){this.taskCardClose(t),!this.hasShowCloseToast&&this.isCovertTask()&&0==e.interactSuccess&&(this.hasShowCloseToast=!0,this.showAlmostTipsCallback&&this.showAlmostTipsCallback()),m.closePassData(e)}taskCardImpression(){let t=new Y;t.award_task_name=this.getRewardTaskName(),t.universe_feature_freq=3;let e={elementType:191,clientExtData:JSON.stringify(t)},i=140;1==this.getTaskType()&&(this.taskState==ot.tasking?(e.business_scene_type=25,i=241):this.taskState==ot.finished&&(i=759));let a={actionType:i,payload:JSON.stringify(e)};m.sendLog(a)}convertIfNeeded(t){let e=new Y;e.award_task_name=this.getRewardTaskName();let i=1==t?J.CARD_ACTION_BAR_CLICK:J.CARD_OTHERAREA_CLICK;rt.convertIfNeeded(0,this.adInfo,1,{x:0,y:0},i,e,null,{convertPageType:this.isCovertTask()?1:0})}taskCardClose(t){let e=new Y;e.award_task_name=this.getRewardTaskName();let i={elementType:69,clientExtData:JSON.stringify(e),adCloseType:t},a=141;1==this.getTaskType()&&(this.taskState==ot.tasking&&(i.business_scene_type=25),this.taskState==ot.finished&&(a=243));let s={actionType:a,payload:JSON.stringify(i)};m.sendLog(s)}getRewardTaskName(){return 1==this.getTaskType()?"UNION_NEO_DEEP_TRANS":"UNION_NEO_SIMPLE_TRANS"}}class ht extends k{constructor(t){super(),this.currentTime=0,this.shortTime=0,this.shortDuration=3,this.vm=t,this.duration=this.vm.getTaskCardDuration(),this.setupViews(),this.vm.taskStateCallback=t=>{this.updateTaskState(t)},this.vm.updateActionTextCallback=t=>{this.actionButton.setText(t)},this.addEventListener("tap",(t=>{})),this.vm.showAlmostTipsCallback=()=>{let t=0;null!=this.getSize()&&(t=this.getSize().height),t>0&&m.showToast("差一点获得免看广告特权,\n再点广告试一试吧")}}setupViews(){this.closeButton=new y,this.closeButton.style={width:24,height:24,alignSelf:"flex-end",top:0,right:32},this.closeButton.setImageSrcAndSize("image/ksad-video-task-card/icon_ksad_video_task_close.png",{width:24,height:24}),this.appendChild(this.closeButton),this.closeButton.addEventListener("tap",(()=>{this.closePage(1,!1)})),this.titleText=new TKText,this.titleText.style={fontSize:30,color:"#FFFAD3",textAlign:"center",fontWeight:"bold"},this.titleText.setText(this.vm.getTaskCardTitle()),this.appendChild(this.titleText),this.middleView=new dt(this.vm),this.middleView.style={width:280,height:294,top:19,backgroundColor:"#FFFFF5",borderRadius:24,overflow:"hidden",justifyContent:"flex-start",alignItems:"center"},this.middleView.addEventListener("tap",(t=>{this.handleTaskAction(2)})),this.appendChild(this.middleView);let t=new TKView;t.style={width:273,height:59,top:40,justifyContent:"flex-start",overflow:"visible"},this.appendChild(t),this.actionButton=new TKText,this.actionButton.setText(this.vm.getTaskActionDescription()),this.actionButton.style={width:273,height:59,top:0,borderRadius:30,backgroundColor:"#FE3666",fontSize:20,fontWeight:"bold",color:"#FFFFFF",textAlign:"center"},t.appendChild(this.actionButton),this.actionButton.addEventListener("tap",(()=>{this.handleTaskAction(1)})),this.handGuide=new TKImage,this.handGuide.style={position:"absolute",width:60,height:61,visibility:"hidden",top:40,left:250},this.handGuide.setSrc("image/ksad-video-task-card/icon_ksad_video_task_hand.png"),t.appendChild(this.handGuide)}updateTaskState(t){this.vm.taskState!=ot.failed?1==this.vm.getTaskType()?this.updateCovertTaskState(t):this.vm.updateClickTaskState(t):this.closePage(2,!1)}updateCovertTaskState(t){this.vm.taskState==ot.tasking?this.setTaskingStateData():this.vm.taskState==ot.finished&&(this.removeTaskAnimation(),this.vm.taskCardImpression(),this.closeButton.style={visibility:"hidden"},this.handGuide.style={visibility:"hidden"},this.titleText.setText("已免看广告"),this.actionButton.setText(`知道了(${this.shortDuration})`),this.middleView.setFinishStateData(),this.startShortLifeTimer())}setTaskingStateData(){this.vm.taskCardImpression(),this.actionButton.setText("去打开,免看本次广告"),this.middleView.setTaskingStateData(),this.stopLifeTimer(),this.startLifeTimer()}startLifeTimer(){this.lifeTimer=setInterval((()=>{this.currentTime++,this.currentTime==this.duration&&this.closePage(2,!1)}),1e3)}stopLifeTimer(){this.lifeTimer&&(clearInterval(this.lifeTimer),this.lifeTimer=0)}startShortLifeTimer(){let t=this;this.shortLifeTimer=setInterval((()=>{if(t.shortTime++,t.shortTime==t.shortDuration)t.actionButton.setText("知道了"),t.closePage(2,!0);else{let e=t.shortDuration-t.shortTime;t.actionButton.setText(`知道了(${e})`)}}),1e3)}stopShortLifeTimer(){this.shortLifeTimer&&(clearInterval(this.shortLifeTimer),this.shortLifeTimer=0)}handleTaskAction(t){if(this.stopLifeTimer(),this.vm.taskState!=ot.finished)this.vm.handleTaskAction(t);else{if(2==t)return;this.closePage(1,!0)}}closePage(t,e){this.stopShortLifeTimer(),this.stopLifeTimer(),this.vm.closePage(t,{interactSuccess:e})}startAnimation(){let t=new TKBasicAnimation;t.setEndValue((()=>{this.style={opacity:1}})),t.duration=450,this.addAnimation(t,"taskShowAnimation");let e=new TKKeyframeAnimation;e.duration=600,e.setAnimations([()=>(this.actionButton.style={opacity:0,transform:{scale:.8}},0),()=>(this.actionButton.style={opacity:.5,transform:{scale:1.2}},.5),()=>(this.actionButton.style={opacity:1,transform:{scale:1}},1)]),e.on("end",(()=>{this.middleView.startScaleAnimation(),this.startLifeTimer(),setTimeout((()=>{this.breathingAnimaton()}),300)})),this.actionButton.addAnimation(e,"actionButtonKeyframeAniamtion")}breathingAnimaton(){if(this.vm.isFinishedTask())return;let t=new TKKeyframeAnimation;t.setAnimations([()=>(this.handGuide.style={top:40,left:250,visibility:"visible"},0),()=>(this.handGuide.style={top:25,left:240},.5),()=>(this.handGuide.style={top:40,left:250,visibility:"visible"},1)]),t.duration=600,t.repeatCount=Number.MAX_VALUE,this.handGuide.addAnimation(t,"handMoveAnimation");let e=new TKKeyframeAnimation;e.setAnimations([()=>(this.actionButton.style={transform:{scale:1}},0),()=>(this.actionButton.style={transform:{scale:.9}},.5),()=>(this.actionButton.style={transform:{scale:1}},1)]),e.duration=600,e.repeatCount=Number.MAX_VALUE,setTimeout((()=>{this.actionButton.addAnimation(e,"actionButtonScaleAnimation")}),300)}removeTaskAnimation(){this.actionButton.removeAnimation("actionButtonScaleAnimation"),this.handGuide.removeAnimation("handMoveAnimation")}}class dt extends k{constructor(t){super(),this.vm=t,this.setupViews()}setupViews(){this.titleText=new TKText,this.titleText.style={width:162,height:40,fontSize:24,color:"#413530",textAlign:"center",backgroundColor:"#FFD7A7",bottomLeftRadius:15,bottomRightRadius:15,fontWeight:"bold"},this.titleText.setText("完成任务"),this.appendChild(this.titleText),this.taskText=new TKText,this.taskText.style={fontSize:32,color:"#413530",textAlign:"center",top:30,fontWeight:"bold"},this.taskText.setText(this.vm.getTaskDescription()),this.appendChild(this.taskText),this.profile=new TKImage,this.profile.setSrc(this.vm.getProfileUrl()),this.profile.style={width:100,height:100,borderRadius:24,top:40},this.appendChild(this.profile),this.unitionText=new TKText,this.unitionText.style={fontSize:24,fontWeight:"medium",color:"#222222",textAlign:"center",top:50},this.unitionText.setText("快手联盟"),this.appendChild(this.unitionText),this.vm.isCovertTask()&&(this.taskState=new TKImage,this.taskState.style={width:74,height:48,position:"absolute",bottom:20,right:15,overflow:"visible",transform:{rotate:-30},opacity:0},this.taskState.setSrc("image/ksad-video-task-card/icon_ksad_video_task_unfinished.png"),this.appendChild(this.taskState))}startScaleAnimation(){if(!this.vm.isCovertTask())return;let t=new TKBasicAnimation;t.setStartValue((()=>{this.taskState.style={transform:{scale:1.5,rotate:-30},opacity:0}})),t.setEndValue((()=>{this.taskState.style={transform:{scale:1,rotate:-30},opacity:1}})),t.duration=300,this.taskState.addAnimation(t,"taskScaleAnimation")}setTaskingStateData(){this.taskText.setText("立即打开")}setFinishStateData(){this.taskState.setSrc("image/ksad-video-task-card/icon_ksad_video_task_finished.png"),this.startScaleAnimation()}}class Ct extends k{constructor(t){super(),this.vm=t,this.vm.switchToastCallbackInClickTask=()=>{this.switchToastTipsView()},this.vm.checkDataValid()&&(this.style={width:"100%",height:"100%",backgroundColor:"#00000099",justifyContent:"center"},this.tipsView=new E(this.vm,0),this.tipsView.style={width:"100%",height:137},this.appendChild(this.tipsView),this.tipsView.startAnimation((()=>{this.removeChild(this.tipsView),this.tipsView=null,this.showTaskView()})),this.addEventListener("tap",(t=>{})))}showTaskView(){this.taskView=new ht(this.vm),this.taskView.style={width:"100%",height:467,justifyContent:"flex-start",alignItems:"center",opacity:0,overflow:"visible"},this.appendChild(this.taskView),this.layout(),this.taskView.startAnimation(),this.vm.taskCardImpression()}switchToastTipsView(){this.removeChild(this.taskView),this.taskView=null,this.tipsView=new E(this.vm,1),this.tipsView.style={width:"100%",height:137,justifyContent:"center",alignContent:"center"},this.appendChild(this.tipsView),this.layout(),this.tipsView.startToastAnimation()}}(new class extends v{constructor(){super(),this.vm=new ct}setupViews(){this.contentView=new Ct(this.vm),this.rootView.appendChild(this.contentView)}render(){if(this.renderCalled)return!1;this.renderCalled=!0;try{this.vm.getData((t=>{if(t)try{this.setupViews(),Tachikoma.render(this.rootView),this.updateRenderStatus(1,"")}catch(e){this.updateRenderStatus(0,o(e))}else this.updateRenderStatus(0,"data invalid")}))}catch(t){this.updateRenderStatus(0,o(t))}return!0}}).render()})();
//# sourceMappingURL=ksad-video-task-card.128.js.map