(()=>{"use strict";class t{static saveLocal(t,e){if("undefined"!=typeof TKLocalStorage){(new TKLocalStorage).set(t,e)}}static getLocalString(t){if("undefined"!=typeof TKLocalStorage){let e=(new TKLocalStorage).get(t);if(e)return e.toString()}return null}static getLocalInt(t){if("undefined"!=typeof TKLocalStorage){let e=(new TKLocalStorage).get(t);if(e)return Number.parseInt(e.toString())}return 0}}let e=null;const i="TKResIndexKey";class a{constructor(){var e,a,s;this.defaultHost="p1-lm.adukwai.com",this.currentIndex=0;let r=null===(s=null===(a=null===(e=n)||void 0===e?void 0:e.appConfig)||void 0===a?void 0:a.idc)||void 0===s?void 0:s.tkres;r&&0!=r.length||(r=["p1-lm.adukwai.com","p2-lm.adukwai.com"]),this.resList=r;let l=t.getLocalInt(i);l>r.length&&(l=0),this.currentIndex=l}static getInstance(){return e||(e=new a),e}getCurrentHost(){return this.currentIndex>=this.resList.length?this.defaultHost:this.resList[this.currentIndex]}markUrlFail(e){if(!(e.indexOf(this.getCurrentHost())<0||"undefined"!=typeof KSAdTKNetworkManager&&0==KSAdTKNetworkManager.getCurrentNetworkType())){const e=this.currentIndex;this.currentIndex=++this.currentIndex%this.resList.length,this.currentIndex!==e&&t.saveLocal(i,this.currentIndex)}}}var s=null,n=null,r=null;function l(t){s=t}function o(t){return t instanceof Error?t.stack?t.stack:t.message:"string"==typeof t?t:"number"==typeof t?t+"":"unknown"}function d(){return!I(Tachikoma.env.hasTKBridge)&&1==Tachikoma.env.hasTKBridge}function c(){return"Android"===Tachikoma.env.platform}function h(t){return"string"==typeof t&&t.length>0}function u(){return s?s.tkVersion:Tachikoma.env.tkVersion}function C(){return s?s.SDKVersion:Tachikoma.env.SDKVersion}function g(){return s?s.sdkType:Tachikoma.env.sdkType}function I(t){return null===t||null==t||""===t}function _(t){if(t)for(const i in t){if("object"==typeof t[i]&&!i.includes("$"))try{t[i].nativeID||(t[i].nativeID=i),_(t[i])}catch(e){}}}function p(t){let e=t;return e.indexOf("/")>=0||t.startsWith("http")||(e="https://"+a.getInstance().getCurrentHost()+"/kos/nlav111362/ksad/"+t),e}function T(t,e){!function(t,e,i){if(t&&e){const s=p(e);t.setImageLoadCallback&&s.startsWith("http")&&t.setImageLoadCallback((t=>{a.getInstance().markUrlFail(s),i&&i(t)})),t.setSrc(s)}}(t,e,null)}class m{static isAndroid(){return"Android"===this.platform}static isSupportDownloadProgressListen(){return this.isAndroid()||m.supportMinimumTKVersion("5.0.4")}static isSupportDownloadDel(){return this.isAndroid()&&m.supportMinimumTKVersion("5.0.7")}static getCurrentTimeStamp(){return(new Date).getTime()}static getSemiCircle(){return this.isAndroid()?180:Math.PI}static getRotateSemiCircle(){return this.isAndroid()?45:Math.PI}static compareVersion(t,e){if(void 0===t&&void 0===e)return 0;if(void 0===t)return-1;if(void 0===e)return 1;let i=t.split("."),a=e.split("."),s=Math.max(i.length,a.length);for(var n=0;n<s;n++){let t=Number(void 0!==i[n]?i[n]:"0"),e=Number(void 0!==a[n]?a[n]:"0");if(t>e)return 1;if(t!=e)return-1}return 0}static supportMinimumVersion(t="0.0.0",e="0.0.0"){let i=g(),a=1==i&&-1!=m.compareVersion(C(),t),s=2==i&&-1!=m.compareVersion(C(),e);return a||s}static supportCurrentVersion(t="0.0.0",e="0.0.0"){let i=g(),a=1==i&&0==m.compareVersion(C(),t),s=2==i&&0==m.compareVersion(C(),e);return a||s}static supportCurrentTKVersion(t="0.0.0"){return u()==t}static supportMinimumTKVersion(t="0.0.0"){return-1!=m.compareVersion(u(),t)}}m.platform=Tachikoma.env.platform;class A{static randomString(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i="",a=0;a<t;a++)i+=e.charAt(Math.floor(48*Math.random()));return i}static randomName(t){return"jscb_"+t+"_"+this.randomString(4)+this.globalIndex++}static registerCallback(t,e=!0){return this.registerCallbackForAction(t,e,"")}static registerCallbackForAction(t,e=!0,i){if(!t)return null;const a=this.randomName(i);return Tachikoma[a]=e=>{t(e)},"Tachikoma."+a}}A.globalIndex=0;const f=new class{constructor(){this.enabled=!1,this.logs=[]}setLoggerEnabled(t){this.enabled=t}log(t){if(this.enabled){const e=new Date;0==this.logs.length&&this.logs.push(e.getMonth()+1+":"+e.getDate()+"-"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.logs.push(e.getMilliseconds()+":"+t)}}clear(){this.logs.splice(0,this.logs.length)}exportLog(){return JSON.stringify(this.logs)}};class L{static getDeviceInfoAsync(){return L.callNative("getDeviceInfo",null).then((t=>(t.result&&t.data&&l(t.data),t)))}static getKsAdDataAsync(){return L.callNative("getKsAdData",null)}static getKsAdConfigAsync(){return L.callNative("getKsAdConfig",null).then((t=>{var e;return t.result&&t.data&&(e=t.data,n=e),t}))}static getScreenOrientationAsync(){return L.callNative("getScreenOrientation",null)}static getVideoCloseTime(){return L.callNative("getVideoCloseTime",null)}static getContainerLimitAsync(){return L.callNative("getContainerLimit",null)}static getTKPreEnvAsync(){return L.callNative("getTKPreEnv",null)}static getDeviceInfo(t){this.callNativeWithCallback("getDeviceInfo",null,t)}static getKsAdData(t){this.callNativeWithCallback("getKsAdData",null,t)}static getKsAdConfig(t){this.callNativeWithCallback("getKsAdConfig",null,t)}static getScreenOrientation(t){this.callNativeWithCallback("getScreenOrientation",null,t)}static getContainerLimit(t){return this.callNativeWithCallback("getContainerLimit",null,t)}static registerLifecycleListener(t){this.callNativeWithCallback("registerLifecycleListener",null,t,!1)}static registerFocusListener(t){m.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("registerFocusListener",null,t,!1)}static registerNativeId(t){this.callNativeWithCallback("configNativeId",null,t,!1)}static registerExtraDataListener(t){this.callNativeWithCallback("getKsAdExtraData",null,t,!1)}static hideCard(t,e,i,a=!0){this.callNativeWithCallback("hide",{type:t,playDuration:e},i,a)}static sendLog(t,e){this.callNativeWithCallback("log",t,e)}static sendCommonLog(t,e){this.callNativeWithCallback("commonLog",t,e)}static sendCommercialLog(t,e){this.callNativeWithCallback("commercialLog",t,e)}static adOutCallback(t,e){m.supportMinimumTKVersion("5.0.6")&&this.callNativeWithCallback("adOutCallback",t,e)}static pageStatus(t,e){this.callNativeWithCallback("pageStatus",{status:t,errorMsg:h(e)?e:""})}static clickAction(t,e,i,a,s){this.clickActionBase(Object.assign(Object.assign({area:t,logParam:e},i),{creativeId:a}),s)}static clickActionBase(t,e){this.callNativeWithCallback("clickAction",t,e)}static convert(t){this.callNativeWithCallback("convert",{clickActionButton:t})}static updateExceptedPosition(t){this.callNativeWithCallback("initKsAdFrame",t)}static replayVideo(){this.callNativeWithCallback("replayVideo")}static registerVideoListener(t){this.callNativeWithCallback("registerVideoListener",null,t,!1)}static dislike(){this.callNativeWithCallback("dislike")}static registerProgressListener(t){this.callNativeWithCallback("registerProgressListener",null,t,!1)}static registerVideoProgressListener(t){this.callNativeWithCallback("registerVideoProgressListener",null,t,!1)}static registerGetDynamicActionDesListener(t){this.callNativeWithCallback("getDynamicActionDes",null,t,!1)}static registerTimerListener(t){this.callNativeWithCallback("registerTimerListener",null,t,!1)}static registerVideoMuteStateListener(t){this.callNativeWithCallback("registerMuteStateListener",null,t,!1)}static registerVideoAutoPlayListener(t){this.callNativeWithCallback("registerVideoAutoPlayListener",null,t,!1)}static registerPlayStateResetListener(t){this.callNativeWithCallback("registerPlayStateResetListener",null,t,!1)}static updateVideoMuteState(t){this.callNativeWithCallback("updateVideoMuteState",{muted:t})}static skipVideo(t,e,i,a=0){this.callNativeWithCallback("skipVideo",{needPromopt:t,needReport:e,showTime:i,playDuration:a})}static closeVideo(t){this.callNativeWithCallback("closeVideo",{forceClose:t})}static showPlayEnd(t,e=0){this.callNativeWithCallback("showPlayEnd",{userForce:t,type:e})}static showPlayable(t=0){this.callNativeWithCallback("showPlayable",{playableSource:t})}static registerSceneChangeListener(t){this.callNativeWithCallback("registerSceneChangeListener",null,t,!1)}static hasReward(t){this.callNativeWithCallback("hasReward",{severCheckResult:t})}static clickGift(){this.callNativeWithCallback("clickGift")}static clickCall(t){this.callNativeWithCallback("clickCall",{isEnd:t})}static callButtonImpressionWhenPlay(){this.callNativeWithCallback("callButtonImpressionWhenPlay")}static callButtonImpressionWhenFinish(){this.callNativeWithCallback("callButtonImpressionWhenFinish")}static registerDeepRewardListener(t){this.callNativeWithCallback("registerDeepRewardListener",null,t,!1)}static giveRewardInAdvance(t){this.callNativeWithCallback("giveRewardInAdvance",null,t,!1)}static showLiveEndPage(t){this.callNativeWithCallback("showLiveEndPage",null,t,!1)}static updateRewardTaskState(t){this.callNativeWithCallback("updateRewardTaskState",null,t,!1)}static openURL(t,e,i){this.callNativeWithCallback("openURL",{url:t,title:e,showConfirmDialog:i})}static showTKDialog(t){this.callNativeWithCallback("showTKDialog",{templateId:t})}static closeTKDialog(t){this.callNativeWithCallback("closeTKDialog",{templateId:t})}static registerKeyboardChangeListener(t){this.callNativeWithCallback("registerKeyboardChangeListener",null,t,!1)}static registerShakeListener(t){this.callNativeWithCallback("registerMotionListener",null,t,!1)}static close(t){this.callNativeWithCallback("close",null,t,!1)}static closePassData(t,e){this.callNativeWithCallback("close",t,e,!1)}static updateVideoPlayStatus(t,e,i,a){this.callNativeWithCallback("updateVideoPlayStatus",{status:t,errorCode:e||0,errorReason:i||"",currentTime:a||0})}static registerConvertStatusListener(t){this.callNativeWithCallback("registerConvertStatusListener",null,t,!1)}static cardImpression(){this.callNativeWithCallback("cardImpression")}static getCardShowCount(t){this.callNativeWithCallback("getCardShowCount",null,t,!1)}static getNativeData(t,e){this.callNativeWithCallback("getNativeData",{target:t},e,!1)}static updateExtraReward(t){this.callNativeWithCallback("updateExtraReward",t)}static registerApkInstalledListener(t){this.callNativeWithCallback("registerApkInstalledListener",null,t,!1)}static showToast(t){this.callNativeWithCallback("showToast",{message:t})}static registerExtraDialogListener(t){this.callNativeWithCallback("registerExtraDialogListener",null,t,!1)}static getPlayEndType(t){this.callNativeWithCallback("getPlayEndType",null,t,!1)}static playableConvert(t){this.callNativeWithCallback("playableConvert",t)}static getKsPlayableAdData(t){this.callNativeWithCallback("getKsPlayableAdData",null,t)}static getKsPlayableDeviceInfo(t){this.callNativeWithCallback("getKsPlayableDeviceInfo",null,t)}static registerPlayableStatusListener(t){this.callNativeWithCallback("registerPlayableStatusListener",null,t,!1)}static getTrackAdStatus(t){this.callNativeWithCallback("getTrackAdStatus",null,t,!1)}static showLandingPage(t){this.callNative("showLandingPage",{needCloseNeo:t})}static needCloseNeo(t){this.callNativeWithCallback("needCloseNeo",{needClose:t})}static registerBackPressed(t){c()&&this.callNativeWithCallback("registerBackPressedListener",null,t,!1)}static innerAdImpression(){this.callNativeWithCallback("adImpression",null)}static neoDidShowPlayAgain(){this.callNativeWithCallback("neoDidShowPlayAgain")}static showPlayAgain(){this.callNativeWithCallback("showPlayAgain")}static registerAggregationDataListener(t){this.callNativeWithCallback("registerAggregationDataListener",null,t,!1)}static getLandingPageInfo(t){this.callNativeWithCallback("getLandingPageInfo",null,t,!1)}static registerNeoStatusListener(t){this.callNativeWithCallback("registerNeoStatusListener",null,t,!1)}static callNative(t,e){return new Promise(((i,a)=>this.callNativeWithCallback(t,e,(t=>{t?(1!=t.result&&(t.result=null),i(t)):i({result:0,data:null})}))))}static callNativeWithCallback(t,e,i,a=!0){const s=d()?1:0;d()&&"pageStatus"==t||d()&&"registerLifecycleListener"==t?this.callNativeWithCallbackAndType(t,e,i,a,0):this.callNativeWithCallbackAndType(t,e,i,a,s)}static callTKWithCallback(t,e,i,a=!0){this.callNativeWithCallbackAndType(t,e,i,a,1)}static callNativeWithCallbackAndType(t,e,i,a=!0,s=0){if("undefined"==typeof KwaiAd)return f.log("undefined value KwaiAd"),void(i&&i({result:0,data:null}));f.log("call:"+t);let n=e=>{let a=0,s=null;try{let t=null;t="string"==typeof e?JSON.parse(e):e,a=t.result,s=t.data}catch(n){a=0,s=null}f.log("cb:"+t+"  r:"+a),i&&i({result:a,data:s})};const r=A.registerCallbackForAction(n,a,t),l={action:t,data:JSON.stringify(e||{}),callback:!0===Tachikoma.env.useNewBridge?n:r};0==s?KwaiAd.callAdBridge(l):KwaiAd.callTKBridge(l)}}class v{constructor(){this.renderCalled=!1,this.renderStatusCalled=!1,this.rootView=new TKView,this.rootView.style={width:"100%",height:"100%"}}render(){return!this.renderCalled&&(this.renderCalled=!0,!0)}updateRenderStatus(t,e=""){this.renderCalled&&!this.renderStatusCalled&&(this.renderStatusCalled=!0,L.pageStatus(t,e),this.registerNativeId())}registerNativeId(){1==Tachikoma.env.isDebug&&m.supportMinimumTKVersion("4.0.7")&&!m.isAndroid()&&(this.startConfig(),L.registerNativeId((t=>{t&&t.data&&this.startConfig()})))}startConfig(){this.configNativeIdTimer&&clearTimeout(this.configNativeIdTimer),this.configNativeIdTimer=setTimeout((()=>{_(this)}),120)}}class E extends TKView{}class y extends TKView{constructor(){super(),this.style={alignItems:"center",justifyContent:"center"},this.imageView=new TKImage,this.appendChild(this.imageView)}setImageSize(t){this.imageView.style={width:t.width,height:t.height}}setImageSrc(t){T(this.imageView,t)}setImageSrcAndSize(t,e){this.setImageSize(e),this.setImageSrc(t)}configImage(t){t&&t(this.imageView)}}var w,N,b;!function(t){t.adClickCallback="adClickCallback"}(w||(w={})),function(t){t.START="start",t.CENTRT="center",t.END="end"}(N||(N={})),function(t){t[t.unknown=0]="unknown",t[t.DetailOne=1]="DetailOne",t[t.Simple=2]="Simple",t[t.DetailTwo=3]="DetailTwo"}(b||(b={}));var R,D;!function(t){t[t.RETAIN_CARD_TYPE_1=8]="RETAIN_CARD_TYPE_1",t[t.RETAIN_CARD_TYPE_2=9]="RETAIN_CARD_TYPE_2",t[t.RETAIN_CARD_TYPE_3=10]="RETAIN_CARD_TYPE_3",t[t.RETAIN_CARD_TYPE_4=11]="RETAIN_CARD_TYPE_4",t[t.RETAIN_CARD_TYPE_5=14]="RETAIN_CARD_TYPE_5",t[t.RETAIN_CARD_TYPE_7=16]="RETAIN_CARD_TYPE_7",t[t.RETAIN_CARD_TYPE_8=17]="RETAIN_CARD_TYPE_8",t[t.RETAIN_CARD_TYPE_9=18]="RETAIN_CARD_TYPE_9",t[t.RETAIN_CARD_TYPE_10=19]="RETAIN_CARD_TYPE_10",t[t.RETAIN_CARD_TYPE_11=20]="RETAIN_CARD_TYPE_11"}(R||(R={}));class K{}!function(t){t[t.UNKNOWN_LIVE_ROOM_PATTERN=0]="UNKNOWN_LIVE_ROOM_PATTERN",t[t.STANDARD_LIVE_ROOM_PATTERN=1]="STANDARD_LIVE_ROOM_PATTERN",t[t.SIMPLIFIED_LIVE_ROOM_PATTERN=2]="SIMPLIFIED_LIVE_ROOM_PATTERN"}(D||(D={}));var k,O,S,P,V,G,M;!function(t){t[t.LIVE_CUT3_STYLE1=11]="LIVE_CUT3_STYLE1",t[t.LIVE_CUT3_STYLE2=12]="LIVE_CUT3_STYLE2"}(k||(k={})),function(t){t[t.LIVE_CUT3_STYLE2=1]="LIVE_CUT3_STYLE2"}(O||(O={})),function(t){t[t.unkonwn=0]="unkonwn",t[t.videoPromoteFollow=1]="videoPromoteFollow",t[t.videoPromoteGoods=2]="videoPromoteGoods",t[t.liveGoods=3]="liveGoods",t[t.liveNotGoods=4]="liveNotGoods",t[t.videoAd=5]="videoAd"}(S||(S={}));!function(t){t[t.NONE=-1]="NONE",t[t.ACTION_BAR_CLICK=1]="ACTION_BAR_CLICK",t[t.UNKNOWN_ITEM_CLICK=0]="UNKNOWN_ITEM_CLICK",t[t.PORTRAIT_CLICK=13]="PORTRAIT_CLICK",t[t.COMMENT_CLICK=14]="COMMENT_CLICK",t[t.PLAY_END_ICON_CLICK=15]="PLAY_END_ICON_CLICK",t[t.PLAY_END_ICON_TITLE_CLICK=16]="PLAY_END_ICON_TITLE_CLICK",t[t.PLAY_END_ICON_DESCRIPTION_CLICK=17]="PLAY_END_ICON_DESCRIPTION_CLICK",t[t.COMMENT_DETAIL_CLICK=25]="COMMENT_DETAIL_CLICK",t[t.PLAY_END_ACTION_BAR_CLICK=26]="PLAY_END_ACTION_BAR_CLICK",t[t.CARD_ACTION_BAR_CLICK=29]="CARD_ACTION_BAR_CLICK",t[t.CARD_ICON_CLICK=30]="CARD_ICON_CLICK",t[t.CARD_ICON_NAME_CLICK=31]="CARD_ICON_NAME_CLICK",t[t.CARD_ICON_COMMENT_CLICK=32]="CARD_ICON_COMMENT_CLICK",t[t.CARD_BLANK_AREA_CLICK=35]="CARD_BLANK_AREA_CLICK",t[t.CARD_PLAY_END_CLICK1=37]="CARD_PLAY_END_CLICK1",t[t.CARD_PLAY_END_CLICK2=38]="CARD_PLAY_END_CLICK2",t[t.PLAY_END_CALL_CLICK=39]="PLAY_END_CALL_CLICK",t[t.PLAY_DETAIL_CALL_CLICK=40]="PLAY_DETAIL_CALL_CLICK",t[t.PLAY_END_GIFT_CLICK=41]="PLAY_END_GIFT_CLICK",t[t.CARD_APP_STORE_CLICK=45]="CARD_APP_STORE_CLICK",t[t.CARD_APP_DOWNLOAD_NUM_CLICK=46]="CARD_APP_DOWNLOAD_NUM_CLICK",t[t.CARD_OTHERAREA_CLICK=53]="CARD_OTHERAREA_CLICK",t[t.CARD_ICON_MOBILE_CLICK=54]="CARD_ICON_MOBILE_CLICK",t[t.CARD_PICTURE_CLICK_ONE=57]="CARD_PICTURE_CLICK_ONE",t[t.CARD_PICTURE_CLICK_TWO=58]="CARD_PICTURE_CLICK_TWO",t[t.CARD_PICTURE_CLICK_THREE=59]="CARD_PICTURE_CLICK_THREE",t[t.CARD_PICTURE_TITLE_CLICK_ONE=60]="CARD_PICTURE_TITLE_CLICK_ONE",t[t.CARD_PICTURE_TITLE_CLICK_TWO=61]="CARD_PICTURE_TITLE_CLICK_TWO",t[t.CARD_PICTURE_TITLE_CLICK_THREE=62]="CARD_PICTURE_TITLE_CLICK_THREE",t[t.CARD_PICTURE_SUBTITLE_CLICK_ONE=63]="CARD_PICTURE_SUBTITLE_CLICK_ONE",t[t.CARD_PICTURE_SUBTITLE_CLICK_TWO=64]="CARD_PICTURE_SUBTITLE_CLICK_TWO",t[t.CARD_PICTURE_SUBTITLE_CLICK_THREE=65]="CARD_PICTURE_SUBTITLE_CLICK_THREE",t[t.CARD_RANK_CLICK=75]="CARD_RANK_CLICK",t[t.CARD_DOWNLOAD_CNT_CLICK=76]="CARD_DOWNLOAD_CNT_CLICK",t[t.CARD_TAG_CLICK=77]="CARD_TAG_CLICK",t[t.CARD_ITEM_BULLET_CLICK=80]="CARD_ITEM_BULLET_CLICK",t[t.CARD_RECOMMEND_REASON_CLICK=84]="CARD_RECOMMEND_REASON_CLICK",t[t.CARD_PAGE_CLICK=85]="CARD_PAGE_CLICK",t[t.COMMENT_PICTURE_CLICK=100]="COMMENT_PICTURE_CLICK",t[t.PLAYEND_ICON_OTHERAREA_CLICK=104]="PLAYEND_ICON_OTHERAREA_CLICK",t[t.INTERACT_LANDING_PAGE_CLICK=110]="INTERACT_LANDING_PAGE_CLICK",t[t.ACTIONBAR_ICON_CLICK=115]="ACTIONBAR_ICON_CLICK",t[t.ACTIONBAR_ICON_COMMENT_CLICK=117]="ACTIONBAR_ICON_COMMENT_CLICK",t[t.ACTIONBAR_ICON_OTHER_AREA_CLICK=118]="ACTIONBAR_ICON_OTHER_AREA_CLICK",t[t.CLOSE_BULLET_ICON_CLICK=127]="CLOSE_BULLET_ICON_CLICK",t[t.CLOSE_BULLET_ICON_TITLE_CLICK=128]="CLOSE_BULLET_ICON_TITLE_CLICK",t[t.CLOSE_BULLET_ICON_DESCRIPTION_CLICK=129]="CLOSE_BULLET_ICON_DESCRIPTION_CLICK",t[t.CLOSE_BULLET_OTHERAREA_CLICK=130]="CLOSE_BULLET_OTHERAREA_CLICK",t[t.CLOSE_BULLET_ACTION_BAR_CLICK=131]="CLOSE_BULLET_ACTION_BAR_CLICK",t[t.SPLASH_CONVERSION_BUTTON_CLICK=132]="SPLASH_CONVERSION_BUTTON_CLICK",t[t.NEO_AUTO_SHOW_STOREKIT=147]="NEO_AUTO_SHOW_STOREKIT",t[t.CARD_LEFT_ACTION_BAR_CLICK=150]="CARD_LEFT_ACTION_BAR_CLICK",t[t.CARD_SWIPE_CONVERT=153]="CARD_SWIPE_CONVERT",t[t.ONLINE_AUDIENCE_NUM=154]="ONLINE_AUDIENCE_NUM",t[t.SHAKE_ICON_SHACK=157]="SHAKE_ICON_SHACK",t[t.SHAKE_BIG_ICON_CLICK=158]="SHAKE_BIG_ICON_CLICK",t[t.ROTATE_ICON_ROTATE=161]="ROTATE_ICON_ROTATE",t[t.ROTATE_BIG_ICON_CLICK=162]="ROTATE_BIG_ICON_CLICK",t[t.CARD_TROLLEY_ICON_CLICK=164]="CARD_TROLLEY_ICON_CLICK",t[t.LANDING_PAGE_OTHER_AREA_CLICK=171]="LANDING_PAGE_OTHER_AREA_CLICK",t[t.CARD_FOLLOW_NUM=172]="CARD_FOLLOW_NUM",t[t.FALL_ICON_CLICK=173]="FALL_ICON_CLICK",t[t.LIVE_BUTTON_CLICK=175]="LIVE_BUTTON_CLICK",t[t.DIRECT_H5_PAGE_CLICK=177]="DIRECT_H5_PAGE_CLICK",t[t.GOODS_ITEM_CARD_CLICK=178]="GOODS_ITEM_CARD_CLICK",t[t.GOODS_ITEM_CARD_SLIDE_CLICK=179]="GOODS_ITEM_CARD_SLIDE_CLICK",t[t.ITEM_HOT_BUY_STYLE_CLICK=180]="ITEM_HOT_BUY_STYLE_CLICK",t[t.GUIDE_ENTER_LIVE_CLICK=181]="GUIDE_ENTER_LIVE_CLICK",t[t.AUTO_CLICK_OTHER_AREA=182]="AUTO_CLICK_OTHER_AREA",t[t.POPLAY_FALL_IOCN=186]="POPLAY_FALL_IOCN",t[t.ROTATE_SHAKE_BIG_ICON_CLICK=187]="ROTATE_SHAKE_BIG_ICON_CLICK"}(P||(P={})),function(t){t[t.adClickReward=1]="adClickReward"}(V||(V={})),function(t){t[t.isRewarded=1]="isRewarded",t[t.noExtraReward=2]="noExtraReward",t[t.hasWatchReward=3]="hasWatchReward"}(G||(G={})),function(t){t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical"}(M||(M={}));const x="ad_convert_event";p("h5_default_icon.png"),p("download_default_icon.png");var W,B;!function(t){t[t.THREEIMG_DEFAULT_CLICK=0]="THREEIMG_DEFAULT_CLICK",t[t.THREEIMG_FIRST_CLICK=1]="THREEIMG_FIRST_CLICK",t[t.THREEIMG_SECOND_CLICK=2]="THREEIMG_SECOND_CLICK",t[t.THREEIMG_THIRD_CLICK=3]="THREEIMG_THIRD_CLICK"}(W||(W={})),function(t){t[t.picStyle=1]="picStyle",t[t.textStyle=2]="textStyle"}(B||(B={}));function F(t){try{return t.adMaterialInfo.materialFeature[0].featureType}catch(e){}return 0}function U(t,e){let i;switch(e){case 1:try{i=t.adMatrixInfo.adDataV2.middleTKCardInfo.templateId}catch(a){i=void 0}break;case 12:try{i=t.adMatrixInfo.adDataV2.neoTKInfo.templateId}catch(a){i=void 0}break;case 3:try{i=t.adMatrixInfo.adDataV2.fullScreenInfo.templateId}catch(a){i=void 0}break;case 2:try{i=t.adMatrixInfo.adDataV2.interstitialCardInfo.templateId}catch(a){i=void 0}break;case 4:try{i=t.adMatrixInfo.adDataV2.topFloorTKInfo.templateId}catch(a){i=void 0}break;case 6:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(a){i=void 0}break;case 5:try{i=t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.templateId}catch(a){i=void 0}break;case 7:try{i=t.adMatrixInfo.adDataV2.activityMiddlePageInfo.templateId}catch(a){i=void 0}break;case 10:try{i=t.adMatrixInfo.adDataV2.rewardVideoTaskInfo.templateId}catch(a){i=void 0}break;case 9:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(a){i=void 0}break;case 11:try{i=t.adMatrixInfo.adDataV2.pushTKInfo.templateId}catch(a){i=void 0}break;case 13:try{i=t.adMatrixInfo.adDataV2.splashEndCardTKInfo.templateId}catch(a){i=void 0}break;case 14:try{i=t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId}catch(a){i=void 0}break;case 15:try{i=t.adMatrixInfo.adDataV2.installedActivateInfo.templateId}catch(a){i=void 0}break;case 16:try{i=t.adMatrixInfo.adDataV2.videoImageTKInfo.templateId}catch(a){i=void 0}break;case 17:try{i=t.adMatrixInfo.adDataV2.feedTKCardInfo.templateId}catch(a){i=void 0}break;default:i=void 0}return i}function H(t,e){let i=U(t,e);if(!h(i))return;const a=t.adMatrixInfo.adDataV2.templateDatas.length;for(let s=0;s<a;s++){let e=t.adMatrixInfo.adDataV2.templateDatas[s];if(e.templateId==i)return e}}function z(t,e){let i=!0;if(1==t.adBaseInfo.adOperationType)try{let a=t.downloadSafeInfo.complianceInfo;if(null!=a)switch(e){case 1:i=3!=a.actionBarType;break;case 2:i=3!=a.describeBarType;break;case 3:i=3!=a.materialJumpType;break;default:i=!0}}catch(a){i=!0}else try{let a=t.unDownloadConf.unDownloadRegionConf;if(null!=a)switch(e){case 1:i=1!=a.actionBarType;break;case 2:i=1!=a.describeBarType;break;case 3:i=1!=a.materialJumpType;break;default:i=!0}}catch(a){i=!0}return i}function Y(t,e){try{let i=e.adMatrixInfo.adDataV2.templateDatas;for(let e=0;e<i.length;e++){let a=i[e];if(a&&t==a.templateId)return a}}catch(i){}}function j(t){try{let e=t.adMatrixInfo.adDataV2.rewardVideoInteractInfo.showTime;return e<=0&&(e=0),e}catch(e){return 15}}let J,$;function X(){var t;return J||(J={all:t=t||new Map,on(e,i){const a=t.get(e);a?a.push(i):t.set(e,[i])},off(e,i){const a=t.get(e);a&&(i?a.splice(a.indexOf(i)>>>0,1):t.set(e,[]))},emit(e,i){let a=t.get(e);a&&a.slice().map((t=>{t(i)})),a=t.get("*"),a&&a.slice().map((t=>{t(e,i)}))},clear(){t.clear()}}),J}class Q{static updateClientData(t){this.sClientExtData=t}static sendLog(t,e,i){(e=e||{}).renderContainer=1;const a={actionType:t,payload:JSON.stringify(e),adCacheId:i};L.sendLog(a)}static log(t,e,i){(i=i||{}).renderContainer=1;const a={actionType:t,payload:JSON.stringify(i)};e&&(a.clickInfo=e),L.sendLog(a)}static convertIfNeeded(t,e,i,a,s,n,l,o,d){if(!z(e,i))return;let c=r;I(c)||(I(n)&&(n=new K),I(n.template_id)&&(n.template_id=c.templateId),I(n.template_version)&&(n.template_version=c.templateVersion)),this.convert(i,a,s,t,n,l,o,d)}static convert(t,e,i,a,s,n,r,l){let o,d;o=I(s)?{itemClickType:i,renderContainer:1}:{itemClickType:i,renderContainer:1,clientExtData:JSON.stringify(s)},I(n)||Object.assign(o,n),X().emit(x,{clickType:i}),e?(d={x:e.x,y:e.y},e.width&&(d.width=e.width),e.height&&(d.height=e.height)):d={},L.clickAction(t,{payload:JSON.stringify(o),clickInfo:d,sceneType:a,itemClickType:i},r,l,(i=>{1!=i.result&&(this.log(2,e,o),L.convert(1==t))}))}static expose(t){this.log(1,null,t)}static exposeElement(t,e){(e=e||{}).elementType=t,this.log(140,null,e)}static clickElement(t){const e={elementType:t};this.log(141,null,e)}static convertWithTypeIfNeeded(t,e,i,a,s){if(m.isAndroid())this.convertWithType(e,i,a,s);else{if(!z(t,e))return;this.convertWithType(e,i,a,s)}}static convertWithType(t,e,i,a){let s={itemClickType:i,renderContainer:1};X().emit(x,{clickType:i}),L.clickAction(t,{payload:JSON.stringify(s),clickInfo:{x:e.x,y:e.y},convertType:a},(i=>{1!=i.result&&(this.log(2,e,s),L.convert(1==t))}))}static convertWithTypeIfNeededNew(t,e,i,a,s,n){if(m.isAndroid())this.convertWithTypeNew(e,i,a,s,n);else{if(!z(t,e))return;this.convertWithTypeNew(e,i,a,s,n)}}static convertWithTypeNew(t,e,i,a,s){let n=s||{};n.itemClickType=i,n.renderContainer=1,X().emit(x,{clickType:i}),L.clickAction(t,{payload:JSON.stringify(n),clickInfo:{x:e.x,y:e.y},convertType:a},(i=>{1!=i.result&&(this.log(2,e,n),L.convert(1==t))}))}static convertNew(t,e,i,a,s,n){let r=n||{};r.itemClickType=s,r.renderContainer=1,X().emit(x,{clickType:s});let l=s;L.clickAction(e,{payload:JSON.stringify(r),clickInfo:{x:i.x,y:i.y,width:a.width,height:a.height},sceneType:t,itemClickType:l},(t=>{1!=t.result&&(this.log(2,i,r),L.convert(1==e))}))}static playNSecond(t){let e={photoPlaySecond:t};this.log(402,null,e)}static skip(){this.log(501,null,null)}}class Z extends E{constructor(t){super(),this.timerInterval=100,this.totalDuration=1e4,this.timerPaused=!1,this.pageClosed=!1,this.currentTime=0,this.vm=t,this.totalDuration=this.vm.getRewardDuration(),this.setupViews(),this.bindEvent(),this.elementImpression()}templateShowType(){return""}setupViews(){this.closeButton=new y,this.closeButton.style={marginRight:12,width:32,height:32,alignSelf:"flex-end",top:0,right:0},this.closeButton.setImageSrcAndSize("image/ksad-video-interact-card/icon_ksad_video_intteract_close.png",{width:32,height:32}),this.appendChild(this.closeButton),this.titleText=new TKText,this.titleText.enabled=!1,this.titleText.style={width:"100%",fontSize:20,color:"#FFF9E5",top:16,textAlign:"center",fontWeight:"medium"},this.titleText.setText(this.vm.getRewardTitle()),this.appendChild(this.titleText)}bindEvent(){this.closeButton.addEventListener("tap",(()=>{this.closePage(1,{interactSuccess:!1})})),this.addGlobalTapEvent(this)}addGlobalTapEvent(t){t.addEventListener("tap",(()=>{this.globalTapAction()}))}globalTapAction(t=!1){let e=new K;e.template_show_type=this.templateShowType(),Q.convertIfNeeded(0,this.vm.adInfo,3,{x:0,y:0},t?P.CARD_SWIPE_CONVERT:P.CARD_PAGE_CLICK,e)}closePage(t,e){this.pageClosed=!0,this.stopLifeTimer(),this.elementClose(t),this.vm.interactSuccess=null==e?void 0:e.interactSuccess,L.closePassData(e)}userInteractAction(t){let e=t?this.vm.getAnswerSuccessMsg():this.vm.getAnswerErrorMsg();L.showToast(e);let i=t?3:4;this.closePage(i,{interactSuccess:t})}startLifeTimer(){this.notifyLife(0,this.totalDuration,!1);let t=this;this.lifeTimer=setInterval((()=>{t.timerPaused||this.pageClosed||(t.currentTime+=this.timerInterval,t.lifeEnd=t.currentTime==t.totalDuration,t.notifyLife(t.currentTime,t.totalDuration,t.lifeEnd),t.lifeEnd&&t.stopLifeTimer())}),this.timerInterval),this.showAnimation()}stopLifeTimer(){this.lifeTimer&&(clearInterval(this.lifeTimer),this.lifeTimer=0)}showAnimation(){}notifyLife(t,e,i){if(i){if(this.interacting)return;this.closePage(2,{interactSuccess:!1})}}elementImpression(){let t=new K;t.template_show_type=this.templateShowType();let e={elementType:16,clientExtData:JSON.stringify(t)},i={actionType:140,payload:JSON.stringify(e)};L.sendLog(i)}elementClose(t){let e=new K;e.template_show_type=this.templateShowType();let i={elementType:69,clientExtData:JSON.stringify(e),cardCloseType:t},a={actionType:141,payload:JSON.stringify(i)};L.sendLog(a)}}class q extends E{constructor(t,e){super(),this.answer=t,this.icon=e,this.setupViews()}setupViews(){this.style={overflow:"visible"},this.bgImage=new TKImage,this.bgImage.style={height:"100%",width:"100%",position:"absolute",flexDirection:"row",justifyContent:"center",alignItems:"center"},this.bgImage.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_button.png"),this.appendChild(this.bgImage);let t=new TKView;t.style={width:"94%",height:"100%",paddingHorizontal:8,flexDirection:"row",justifyContent:"center",alignItems:"center"},this.answerLabel=new TKText,this.answerLabel.setText(this.answer),this.answerLabel.style={fontSize:15,color:"#FFFFFF",textAlign:"center",marginLeft:4,height:24,textLineClamp:1,textOverflow:"ellipsis",minimumTextScaleFactor:.7},this.iconImage=new TKImage,this.iconImage.setSrc(this.icon),this.iconImage.style={width:16,height:16},t.appendChild(this.iconImage),t.appendChild(this.answerLabel),this.appendChild(t)}setTips(t){this.answerLabel.setText(t)}performAnswerAnimation(t){let e=(t,e)=>(this.iconImage.style={transform:{rotate:t,scale:{x:2.4,y:2.4}}},e);this.iconImage.style={marginTop:-16},this._performAnswerAnimation("iconAnimationOne",130,[()=>e(0,0),()=>e(-10,.3),()=>e(-20,.54),()=>e(-10,.77),()=>e(0,1)],(()=>{this._performAnswerAnimation("iconAnimationTwo",180,[()=>e(10,.17),()=>e(20,.33),()=>e(10,.5),()=>e(0,.67),()=>e(-10,.83),()=>e(0,1)],(()=>{t()}))})),this.answerLabel.style={marginLeft:14},this.bgImage.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_button_red.png")}_performAnswerAnimation(t,e,i,a){let s=new TKKeyframeAnimation;s.repeatCount=1,s.timingFunction="0.77 0.20 0.56 1.00",s.setAnimations(i),s.duration=e,s.on("end",(t=>{a()})),this.iconImage.addAnimation(s,t)}}class tt extends Z{templateShowType(){return"answer"}setupViews(){super.setupViews();let t=new TKView;t.style={width:"100%",height:"100%",top:44,alignItems:"center",borderRadius:8,justifyContent:"flex-start"},this.addGlobalTapEvent(t),this.appendChild(t);let e=new TKView;e.enabled=!1,e.style={width:"100%",height:33,overflow:"hidden",alignItems:"center"},t.appendChild(e);let i=new TKView;i.enabled=!1,i.style={backgroundColor:"#00000066",width:66,height:66,borderRadius:33,overflow:"hidden"},e.appendChild(i);let a=new TKView;a.enabled=!1,a.style={width:"100%",height:66,alignItems:"center",position:"absolute",top:0};let s=new TKView;this.addGlobalTapEvent(s),s.style={backgroundColor:"#00000066",width:311,height:221,justifyContent:"center",alignItems:"center",borderRadius:8,overflow:"visible",opacity:1},t.appendChild(s),t.appendChild(a),this.cicleProgress=new TKCircleProgress,this.cicleProgress.enabled=!1,this.cicleProgress.style={width:50,height:50,marginTop:8,alignItems:"center",overflow:"visible"},a.appendChild(this.cicleProgress),this.numberLabel=new TKText,this.numberLabel.enabled=!1,this.numberLabel.style={width:"100%",height:22,fontSize:20,color:"#FFFFFF",textAlign:"center",position:"absolute",alignItems:"center",top:0,marginTop:22},a.appendChild(this.numberLabel),this.answerTitle=new TKText,this.answerTitle.enabled=!1,this.answerTitle.style={width:"100%",fontSize:16,color:"#FFFFFF",textAlign:"center",fontWeight:"medium",marginTop:20},this.answerTitle.setText(this.vm.getRewardSubTitle()),s.appendChild(this.answerTitle),this.rightAnswerButton=new q(this.vm.getRewardRightAnswer(),"image/ksad-video-interact-card/icon_ksad_video_interact_right.png"),this.rightAnswerButton.style={height:48,width:236,marginTop:20,flexDirection:"row",justifyContent:"center",alignItems:"center"},s.appendChild(this.rightAnswerButton),this.errorAnswerButton=new q(this.vm.getRewardErrorAnswer(),"image/ksad-video-interact-card/icon_ksad_video_interact_error.png"),this.errorAnswerButton.style={height:48,width:236,marginTop:16,flexDirection:"row",justifyContent:"center",alignItems:"center"},s.appendChild(this.errorAnswerButton),this.handGuide=new TKImage,this.handGuide.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_hand.png"),this.handGuide.enabled=!1,this.handGuide.style={width:81,height:70,position:"absolute",top:106,left:156,transform:{scale:1.2}},s.appendChild(this.handGuide),this.addHandAnimation()}addHandAnimation(){let t=new TKKeyframeAnimation;t.repeatCount=Number.MAX_VALUE,t.timingFunction="0.77 0.20 0.56 1.00",t.setAnimations([()=>(this.handGuide.style={transform:{scale:1.2}},0),()=>(this.handGuide.style={transform:{scale:1}},.56),()=>(this.handGuide.style={transform:{scale:1.2}},1)]),t.duration=1080,this.handGuide.addAnimation(t,"HandGuide")}bindEvent(){super.bindEvent(),this.rightAnswerButton.addEventListener("tap",(t=>{this.hidenHandGuide(),this.rightAnswerButton.setTips("回答正确!"),this.rightAnswerButton.performAnswerAnimation((()=>{setTimeout((()=>{this.userInteractAction(!0)}),100)}))})),this.errorAnswerButton.addEventListener("tap",(t=>{this.hidenHandGuide(),this.rightAnswerButton.setTips("回答错误!"),this.errorAnswerButton.performAnswerAnimation((()=>{setTimeout((()=>{this.userInteractAction(!1)}),100)}))}))}hidenHandGuide(){this.handGuide.removeAnimation("HandGuide"),this.handGuide.style={visibility:"hidden"}}notifyLife(t,e,i){let a=((e-t)/1e3).toFixed();this.cicleProgress.updateProgress(t/e),this.numberLabel.setText(a),super.notifyLife(t,e,i)}}class et extends Z{constructor(){super(...arguments),this.beginTime=-1,this.longPressValidDuration=5,this.success=!1,this.flag=!1,this.pressNumber=0}templateShowType(){return"red_packet"}setupViews(){super.setupViews(),this.longPressValidDuration=this.vm.getRedbagLongPressDuraion();let t=new TKView;this.style={overflow:"visible"},this.addGlobalTapEvent(t),t.style={width:120,height:140,marginTop:40,overflow:"visible"},this.appendChild(t),this.redbag=new TKImage,this.redbag.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_redbag.png"),this.redbag.style={width:80,height:96},this.redbag.addEventListener("tap",(t=>{})),t.appendChild(this.redbag),this.handGuide=new TKImage,this.handGuide.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_hand.png"),this.handGuide.enabled=!1,this.handGuide.style={width:60,height:55,position:"absolute",top:75,left:35,transform:{scale:1.2}},t.appendChild(this.handGuide),this.addHandAnimation()}bindEvent(){super.bindEvent(),this.redbag.addEventListener("down",(t=>{this.beginTime=0,this.interacting=!0})),this.redbag.addEventListener("longPress",(t=>{-1!=this.beginTime&&(this.flag||0==this.beginTime&&(this.beginTime=t.timestamp,this.hidenHandGuide(),this.redbagLargeAnimation(),this.flag=!0,this.startPressTimer()))})),this.redbag.addEventListener("up",(t=>{if(this.stopPressTimer(),0!=this.beginTime&&-1!=this.beginTime){if(!this.success)return void this.userInteractAction(!1);this.removeRedbagLargeAnimation()}this.beginTime=-1,this.interacting=!1}))}startPressTimer(){this.stopPressTimer(),this.pressTimer=setInterval((()=>{this.pressNumber++,.5*this.pressNumber>=this.longPressValidDuration&&!this.success&&(this.success=!0,this.stopPressTimer(),this.userInteractAction(!0))}),500)}stopPressTimer(){this.pressNumber=0,this.pressTimer&&clearInterval(this.pressTimer),this.pressTimer=0}hidenHandGuide(){this.handGuide.style={transform:{scale:1}},this.handGuide.removeAnimation("HandGuide")}addHandAnimation(){let t=new TKKeyframeAnimation;t.repeatCount=Number.MAX_VALUE,t.timingFunction="0.77 0.20 0.56 1.00",t.setAnimations([()=>(this.handGuide.style={transform:{scale:1.2}},0),()=>(this.handGuide.style={transform:{scale:1}},.56),()=>(this.handGuide.style={transform:{scale:1.2}},1)]),t.duration=1080,this.handGuide.addAnimation(t,"HandGuide")}redbagLargeAnimation(){let t=new TKBasicAnimation;t.repeatCount=1,t.setStartValue((()=>{this.redbag.style={transform:{scale:1}}}));let e=1+.09*this.longPressValidDuration;t.setEndValue((()=>{this.redbag.style={transform:{scale:e,translate:{y:10}}}})),t.duration=1e3*this.longPressValidDuration,this.redbag.addAnimation(t,"redBagAnimation");let i=new TKBasicAnimation;i.repeatCount=1,i.setStartValue((()=>{this.handGuide.style={transform:{scale:1}}})),i.setEndValue((()=>{this.handGuide.style={transform:{scale:1,translate:{y:10}}}})),i.duration=1e3*this.longPressValidDuration,this.handGuide.addAnimation(i,"redBagAnimation")}removeRedbagLargeAnimation(){this.redbag.removeAnimation("redBagAnimation"),this.redbag.style={transform:{scale:1}}}}class it extends Z{constructor(){super(...arguments),this.bottomBgColor="90,#ff0000,#00ff00"}templateShowType(){return"puzzle"}setupViews(){super.setupViews(),this.style={overflow:"hidden"},this.viewAnimationSize=m.isAndroid()?240:235;const t=new TKView;t.style={width:300,height:"100%",marginTop:40},this.appendChild(t);const e=new TKView;e.enabled=!0,e.style={width:240,height:240,left:30,justifyContent:"flex-start",alignContent:"center"},t.appendChild(e);let i=new TKImage;i.style={width:"100%",height:"100%",backgroundColor:"#ffffff",borderRadius:46},i.setSrc(this.vm.getIconUrl()),e.appendChild(i);let a=new TKImage;a.style={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:46},a.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_puzzle_mask.png"),e.appendChild(a),this.smallPuzzle=new TKView,this.smallPuzzle.style={width:80,height:80,bottomRightRadius:46,transform:{scale:.85,rotate:-10},alignSelf:"center",marginTop:30,marginLeft:20,overflow:"hidden",borderWidth:3,borderColor:"#FFFFFF00"},t.appendChild(this.smallPuzzle),this.puzzleViewTemp=new TKImage,this.puzzleViewTemp.style={width:240,height:240,borderRadius:46,transform:{scale:.85},position:"absolute",right:0,bottom:0},this.puzzleViewTemp.setSrc(this.vm.getIconUrl()),this.smallPuzzle.appendChild(this.puzzleViewTemp),this.smallMark=new TKImage,this.smallMark.style={width:this.viewAnimationSize,height:this.viewAnimationSize,borderRadius:46,transform:{scale:.85},right:0,bottom:0,position:"absolute",visibility:"hidden"},this.smallMark.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_puzzle_mask_tmp.png"),this.smallPuzzle.appendChild(this.smallMark),this.smallPuzzle.addEventListener("swipe",(t=>{this.interacting=!0,this.addConvertAnimation()})),this.smallPuzzle.addEventListener("tap",(t=>{this.interacting=!0,this.addConvertAnimation()})),e.addEventListener("tap",(t=>{})),this.handGuide=new TKImage,this.handGuide.enabled=!0,this.handGuide.setSrc("image/ksad-video-interact-card/icon_ksad_video_interact_hand.png"),this.handGuide.enabled=!1,this.handGuide.style={width:60,height:55,position:"absolute",top:300,left:160,transform:{scale:1}},t.appendChild(this.handGuide),this.handGuide.addEventListener("tap",(t=>{})),this.handGuideGradientRoot=new TKView,this.handGuideGradientRoot.enabled=!0,this.handGuideGradientRoot.style={position:"absolute",width:24,height:120,transform:{rotate:35},top:300,left:160,overflow:"hidden"},t.appendChild(this.handGuideGradientRoot),this.handGuideGradient=new TKView,m.isAndroid()?this.handGuideGradient.style={position:"absolute",width:24,height:120,bottom:0,right:0,gradientBgColor:"270, #FFFFFF80 0.4, #FFFFFF00 1"}:this.handGuideGradient.style={position:"absolute",width:24,height:120,top:0,left:0,gradientBgColor:"270, #FFFFFF80 0.4, #FFFFFF00 1"},this.handGuideGradientRoot.addEventListener("tap",(t=>{})),this.handGuideGradientRoot.appendChild(this.handGuideGradient)}showAnimation(){this.addHandAnimation()}addConvertAnimation(){this.hidenHandGuide();let t=new TKKeyframeAnimation;t.repeatCount=1,t.setAnimations([()=>(this.smallPuzzle.style={transform:{translate:{x:0,y:0},scale:.85,rotate:-10}},this.puzzleViewTemp.style={transform:{scale:.85}},this.smallMark.style={visibility:"visible",width:this.viewAnimationSize,height:this.viewAnimationSize,transform:{scale:.85}},.01),()=>(this.smallPuzzle.style={transform:{translate:{x:70,y:-110},scale:1,rotate:0}},this.puzzleViewTemp.style={transform:{scale:1}},this.smallMark.style={width:this.viewAnimationSize,height:this.viewAnimationSize,transform:{scale:1}},1)]),t.duration=500,t.on("end",(()=>{setTimeout((()=>{this.userInteractAction(!0)}),100)})),this.smallPuzzle.addAnimation(t,"addConvertAnimation")}hidenHandGuide(){this.handGuide.removeAnimation("HandGuide"),this.handGuide.style={visibility:"hidden"},this.handGuideGradientRoot.removeAnimation("handGuideGradient"),this.handGuideGradientRoot.style={visibility:"hidden"}}addHandAnimation(){let t=new TKKeyframeAnimation;t.repeatCount=Number.MAX_VALUE,t.needTranformIdentity=!0,t.setAnimations([()=>(this.handGuide.style={transform:{scale:1.2}},0),()=>(this.handGuide.style={transform:{translate:{x:60,y:-100},scale:1.2}},1)]),t.duration=1080,this.handGuide.addAnimation(t,"HandGuide");let e=new TKKeyframeAnimation;e.repeatCount=Number.MAX_VALUE,e.setAnimations([()=>(this.handGuideGradientRoot.style={height:0,top:300,left:160,position:"absolute"},0),()=>(this.handGuideGradientRoot.style={height:115,top:200,left:195,position:"absolute"},1)]),e.duration=1080,this.handGuideGradientRoot.addAnimation(e,"handGuideGradient")}}class at extends Object{constructor(t,e,i,a){var s;super(),this.depIds={},this.vm=t,this.getter="function"==typeof e?e:this.parseGetter(e.trim()),this.cb=i,this.value=this.get(),this.cb(null!==(s=this.value)&&void 0!==s?s:a,null),console.log("Watcher on "+e)}update(){const t=this.get();t!=this.value&&(this.cb.call(this.vm,t,this.value),this.value=t)}addDep(t){const e=t.pid;this.depIds.hasOwnProperty(e)||(t.addDep(this),this.depIds[e]=t)}get(){at.target=this;const t=this.getter.call(this.vm,this.vm);return at.target=null,t}parseGetter(t){if(/[^\w.$]/.test(t))return;const e=t.split(".");return function(t){for(let i=0,a=e.length;i<a;i++){if(!t)return;t=t[e[i]]}return t}}}function st(t){return!!t}function nt(){if(null!=$)return $;let t=!1;try{t=!1,$=t}catch(e){}return t}function rt(t,e){if(!0===nt()&&(null==t||!1===t))throw new Error("tkmvvm ----- 请检查传值: "+e)}function lt(t){nt()&&console.log("tachikoma TKMVVM log -> "+t)}class ot extends Object{constructor(t,e){super(),this.object=t,this.observeKey=e,this._observe(t,e)}_observe(t,e){var i=this;Array.isArray(t)?this.defineArray(t):Object.keys(t).forEach((function(a){e?e===a&&i.observeValueWithKey(t,a):i.observeValueWithKey(t,a)}))}observeValueWithKey(t,e){let i=t[e];var a=new ct(e);ht(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:function(){return at.target&&a.depend(),i},set:function(t){t!==i&&(i=t,a.notify(),ht(t))}})}defineArray(t){if(t)for(let e=0,i=t.length;e<i;e++)ht(t[e])}}var dt=0;class ct extends Object{constructor(t){super(),this.key=t,this.pid=dt++,this.deps=new Array}depend(){at.target.addDep(this)}addDep(t){this.deps.push(t)}removeDep(t){}notify(){this.deps.forEach((function(t){t.update()}))}}function ht(t,e){if(!t||"object"!=typeof t)return;var i;if(!("object"==typeof(i=t)&&Object.keys(i).length>0))return;let a=!1,s=(null!=e?e:"")+"_tkmvvm_observed";if(t.hasOwnProperty(s)&&(a=t[s]),!a)return lt("observe "+s),t[s]=!0,new ot(t,e);lt("already observe "+s)}class ut extends Object{constructor(){super()}tk_observe(t){st(t)&&(t in this?ht(this,t):console.log("=====++++++ observe2: key not in this:"+t+":"+typeof this))}}function Ct(t){let e=function(t){if(t)return t.bind_path?t.$bind_path:"string"==typeof t?t:void 0}(t);if(e)return e;rt(e,"tk_bind error, check bind path")}class gt extends E{constructor(t){super(),this.vm=t,this.vm.checkDataValid()&&(this.setupViews(),this.bindEvent(),this.setupData())}setupData(){!function(t,e,i){if(!st(t)||!st(e)||!st(i))return;const a=Ct(e),s=null==a?void 0:a.split(".");if(!s)return void rt(s,"tk_bind error, check bind path");const n=s[0];t.tk_observe(n),new at(t,a,((t,e)=>{i&&i(t)}))}(this.vm,this.vm.$attrsPath.playPaused,(t=>{this.interactView&&(this.interactView.timerPaused=t)}))}setupViews(){this.style={gradientBgColor:"270, #00000099 0.5, #00000066 0.75, #00000000 1",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center"},this.touchContainer=new TKView,this.touchContainer.style={position:"absolute",top:0,left:0,right:0,bottom:120},this.appendChild(this.touchContainer);let t=0;switch(this.vm.getInteracrStyle()){case 1:t=460,this.interactView=new it(this.vm);break;case 2:t=414,this.interactView=new tt(this.vm);break;default:t=231,this.interactView=new et(this.vm)}this.interactView.style={width:"100%",height:t,flexDirection:"column",justifyContent:"flex-start",alignItems:"center"},this.appendChild(this.interactView)}startLifeTimer(){this.interactView&&this.interactView.startLifeTimer()}bindEvent(){this.touchContainer.addEventListener("tap",(()=>{this.interactView.globalTapAction()})),this.touchContainer.addEventListener("swipe",(()=>{this.interactView.globalTapAction(!0)}))}}class It extends ut{constructor(){super(),this.$attrsPath=new Proxy(this,{get:(t,e)=>_t(t,e)})}getData(t){}}function _t(t,e){return new Proxy({$vm:t,$bind_path:e},{get:(i,a)=>"string"!=typeof a||"function"==typeof i[a]||0==a.indexOf("$")?Reflect.get(i,a):_t(t,e+"."+a)})}class pt{static isClickReward(t,e){try{let i=!0;if(m.isAndroid()&&!I(e)&&(i=e.sdkApiVersionCode>=3032401),t.adBaseInfo.extraClickReward&&i)return!0}catch(i){}return!1}static isEcOrder(t,e){try{return 1==t.abConfig.ecRewardAdKwaishopStyle&&(4==e.adStyleConfInfo.innerAdType||5==e.adStyleConfInfo.innerAdType)}catch(i){}return!1}static isOriginLiveAd(t){return 1==t.adBaseInfo.universeLiveType&&0!=t.advertiserInfo.userId}static getAuthorId(t){return t.advertiserInfo.userId}static getLiveStreamId(t){return t.adBaseInfo.liveStreamId}static getIconUrl(t){let e=t.adBaseInfo.appIconUrl;return!I(e)&&pt.isDownloadInteraction(t)||(e=t.advertiserInfo.portraitUrl),I(e)&&(e="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),e}static isDownloadInteraction(t){return 1==t.adBaseInfo.adOperationType}static getAdTitle(t){let e=null;try{e=1==t.adBaseInfo.adOperationType?t.adBaseInfo.appName:t.adBaseInfo.productName,e=h(e)?e:t.advertiserInfo.rawUserName}catch(i){}return e=h(e)?e:"可爱的广告君",e}static getAdActionDesc(t){if(I(t))return"查看详情";let e=t.adBaseInfo.adActionDescription;return I(e)&&(e=this.isDownloadInteraction(t)?"立即下载":"查看详情"),e}static obtainVideoLiveData(t){let e=H(t,14);return JSON.parse(e.data)}static liveGetAuthorName(t,e){let i="";try{i=t.neoLiveAuthorInfoData.authorName}catch(a){}try{I(i)&&(i=t.neoLiveCartDetailData.authorName)}catch(a){}try{I(i)&&(i=e.adBaseInfo.appName)}catch(a){}return i}static liveGetLiveDesc(t,e){let i="";try{i=t.neoLiveCartDetailData.liveDesc}catch(a){}try{I(i)&&(i=t.neoLiveAuthorInfoData.liveDesc)}catch(a){}try{I(i)&&(i=t.adDescription)}catch(a){}try{I(i)&&(i=e.adBaseInfo.adDescription)}catch(a){}return i}static getNeoActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.neoTKInfo.actionBarCardType;if(!I(e))return e}catch(e){}return null}static getFullscreenActionBarCardType(t){try{let e=t.adMatrixInfo.adDataV2.fullScreenInfo.actionBarCardType;if(!I(e))return e}catch(e){}return null}static getNeoAutoDialogType(t){try{let e=0,i=F(t);e=1==i?t.adMatrixInfo.adDataV2.neoTKInfo.neoAutoDialogType:2==i?t.adMatrixInfo.adDataV2.videoImageTKInfo.neoAutoDialogType:0,1!=e&&2!=e&&(e=0);let a=function(t){if(null==t)return null;try{let e=null,i=F(t);if(2==i?e=U(t,16):1==i&&(e=U(t,12)),e){let i=Y(e,t);return JSON.parse(i.data).neoAutoDialog}}catch(e){}return null}(t);return 1==e&&I(a.neoAutoDialogGiftPic)&&I(a.neoAutoDialogGiftTitle)&&(e=0),e}catch(e){}return 0}static hasNeoAutoDialog(t){let e=pt.getNeoAutoDialogType(t);return!I(e)&&0!=e}}class Tt extends It{constructor(){super(...arguments),this.interactSuccess=void 0,this.playPaused=!1}checkDataValid(){return!!this.adInfo}getIconUrl(){try{let t=this.adInfo.adBaseInfo.appIconUrl;return h(t)||(t=this.adInfo.advertiserInfo.portraitUrl),h(t)||(t="https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"),t}catch(t){}return"https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"}getRewardDuration(){var t;return 1e3*((null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.duration)||10)}getRewardVideoInteractInfo(){return this.adInfo.adMatrixInfo.adDataV2.rewardVideoInteractInfo}getAnswerSuccessMsg(){var t;return(null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.successfulMsg)||"恭喜您可提前获得奖励"}getAnswerErrorMsg(){var t;return(null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.errorMsg)||"互动错误，继续播放视频"}getRewardTitle(){var t,e;return(null===(e=null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.styleInfo)||void 0===e?void 0:e.title)||"答对可提前获得奖励"}getRewardSubTitle(){var t,e;return(null===(e=null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.styleInfo)||void 0===e?void 0:e.subTitle)||"该视频主要讲的是？"}getRewardRightAnswer(){return pt.getAdTitle(this.adInfo)}getRewardErrorAnswer(){var t,e;return(null===(e=null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.styleInfo)||void 0===e?void 0:e.errorAnswer)||"石头"}getRedbagLongPressDuraion(){var t,e;return(null===(e=null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.styleInfo)||void 0===e?void 0:e.longPressDurarion)||5}getInteracrStyle(){var t;return(null===(t=this.getRewardVideoInteractInfo())||void 0===t?void 0:t.style)||1}getInteractShowTime(){return j(this.adInfo)}}class mt{constructor(){this.mCurrentStatus="none",this.mLoadFinished=!1,this.mVisible=!1,this.mHadFocus=!1}updateLifecycleStatus(t){"showEnd"==t?(this.mLoadFinished=!0,this.mHadFocus=!0,this.mVisible=!0):"pageVisiable"==t?this.mVisible=!0:"pageInvisiable"==t&&(this.mVisible=!1),this.mCurrentStatus=t}updateWindowFocusChangeEvent(t){"windowFocusGet"==t?this.mHadFocus=!0:"windowFocusLost"==t&&(this.mHadFocus=!1)}isVisible(){return this.mLoadFinished&&this.mVisible}isFocusAndVisible(){return this.mLoadFinished&&this.mVisible&&this.mHadFocus}isFocus(){return this.mHadFocus}}class At extends Tt{constructor(t,e){super(),this.lifeStatus="none",this.mLifeCycleHelper=new mt,this.adInfo=t,this.adStyle=e}getData(t){let e=[];e.push(L.getKsAdDataAsync()),e.push(L.getDeviceInfoAsync()),e.push(L.getKsAdConfigAsync()),e.push(L.getContainerLimitAsync()),e.push(L.getScreenOrientationAsync()),Promise.all(e).then((e=>{try{const a=e[0].data;if(a)try{this.adInfo=a.impAdInfo[0].adInfo[0],this.adStyle=a.impAdInfo[0].adStyle,l(this.deviceInfo),t&&t(!0),this.initAfterDataReady()}catch(i){t&&t(!1)}else t&&t(!1)}catch(i){t&&t(!1)}}))}initAfterDataReady(){this.registerLifeStatusListener()}registerLifeStatusListener(){L.registerLifecycleListener((t=>{if(t.result&&t.data){const e=t.data.lifeStatus;e!==this.lifeStatus&&(this.mLifeCycleHelper.updateLifecycleStatus(e),this.checkVisibleChange())}})),L.registerFocusListener((t=>{if(t.result&&t.data){const e=t.data.windowFocusEvent;this.mLifeCycleHelper.updateWindowFocusChangeEvent(e),this.checkVisibleChange()}}))}checkVisibleChange(){let t=this.mLifeCycleHelper.isFocusAndVisible();this.playPaused=!t}}(new class extends v{constructor(){super(),this.vm=new At(null,null)}setupViews(){this.contentView=new gt(this.vm),this.rootView.appendChild(this.contentView),this.contentView.startLifeTimer()}render(){if(this.renderCalled)return!1;this.renderCalled=!0;try{this.vm.getData((t=>{if(t)try{this.setupViews(),Tachikoma.render(this.rootView),this.updateRenderStatus(1,"")}catch(e){this.updateRenderStatus(0,o(e))}else this.updateRenderStatus(0,"data invalid")}))}catch(t){this.updateRenderStatus(0,o(t))}return!0}}).render()})();
//# sourceMappingURL=ksad-video-interact-card.152.js.map