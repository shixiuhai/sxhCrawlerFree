!function(t){var e={};function i(a){if(e[a])return e[a].exports;var l=e[a]={i:a,l:!1,exports:{}};return t[a].call(l.exports,l,l.exports,i),l.l=!0,l.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)i.d(a,l,function(e){return t[e]}.bind(null,l));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var a=null;function l(){return!c(Tachikoma.env.hasTKBridge)&&1==Tachikoma.env.hasTKBridge}function s(t){return"string"==typeof t&&t.length>0}function n(){return a?a.SDKVersion:Tachikoma.env.SDKVersion}function r(){return a?a.sdkType:Tachikoma.env.sdkType}function c(t){return null===t||null==t||""===t}class o{static isAndroid(){return"Android"===this.platform}static getCurrentTimeStamp(){return(new Date).getTime()}static getSemiCircle(){return this.isAndroid()?180:Math.PI}static getRotateSemiCircle(){return this.isAndroid()?45:Math.PI}static compareVersion(t,e){if(void 0===t&&void 0===e)return 0;if(void 0===t)return-1;if(void 0===e)return 1;let i=t.split("."),a=e.split("."),l=Math.max(i.length,a.length);for(var s=0;s<l;s++){let t=Number(void 0!==i[s]?i[s]:"0"),e=Number(void 0!==a[s]?a[s]:"0");if(t>e)return 1;if(t!=e)return-1}return 0}static supportMinimumVersion(t="0.0.0",e="0.0.0"){let i=r(),a=1==i&&-1!=o.compareVersion(n(),t),l=2==i&&-1!=o.compareVersion(n(),e);return a||l}static supportCurrentVersion(t="0.0.0",e="0.0.0"){let i=r(),a=1==i&&0==o.compareVersion(n(),t),l=2==i&&0==o.compareVersion(n(),e);return a||l}static supportMinimumTKVersion(t="0.0.0"){return-1!=o.compareVersion(a?a.tkVersion:Tachikoma.env.tkVersion,t)}}o.platform=Tachikoma.env.platform;class d{static randomString(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i=e.length,a="",l=0;l<t;l++)a+=e.charAt(Math.floor(Math.random()*i));return a}static randomName(t){return"jscb_"+t+"_"+this.randomString(4)+this.globalIndex++}static registerCallback(t,e=!0){return this.registerCallbackForAction(t,e,"")}static registerCallbackForAction(t,e=!0,i){if(!t)return null;const a=this.randomName(i);return Tachikoma[a]=i=>{t(i),e&&(Tachikoma[a]=null)},"Tachikoma."+a}}d.globalIndex=0;const h=new class{constructor(){this.enabled=!1,this.logs=[]}setLoggerEnabled(t){this.enabled=t}log(t){if(this.enabled){const e=new Date;0==this.logs.length&&this.logs.push(e.getMonth()+1+":"+e.getDate()+"-"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.logs.push(e.getMilliseconds()+":"+t)}}clear(){this.logs.splice(0,this.logs.length)}exportLog(){return JSON.stringify(this.logs)}};class u{static getDeviceInfoAsync(){return u.callNative("getDeviceInfo",null)}static getKsAdDataAsync(){return u.callNative("getKsAdData",null)}static getKsAdConfigAsync(){return u.callNative("getKsAdConfig",null)}static getScreenOrientationAsync(){return u.callNative("getScreenOrientation",null)}static getVideoCloseTime(){return u.callNative("getVideoCloseTime",null)}static getContainerLimitAsync(){return u.callNative("getContainerLimit",null)}static getTKPreEnvAsync(){return u.callNative("getTKPreEnv",null)}static getDeviceInfo(t){this.callNativeWithCallback("getDeviceInfo",null,t)}static getKsAdData(t){this.callNativeWithCallback("getKsAdData",null,t)}static getKsAdConfig(t){this.callNativeWithCallback("getKsAdConfig",null,t)}static getScreenOrientation(t){this.callNativeWithCallback("getScreenOrientation",null,t)}static getContainerLimit(t){return this.callNativeWithCallback("getContainerLimit",null,t)}static registerLifecycleListener(t){this.callNativeWithCallback("registerLifecycleListener",null,t,!1)}static registerNativeId(t){this.callNativeWithCallback("configNativeId",null,t,!1)}static registerExtraDataListener(t){this.callNativeWithCallback("getKsAdExtraData",null,t,!1)}static hideCard(t,e,i,a=!0){this.callNativeWithCallback("hide",{type:t,playDuration:e},i,a)}static sendLog(t,e){this.callNativeWithCallback("log",t,e)}static sendCommonLog(t,e){this.callNativeWithCallback("commonLog",t,e)}static sendCommercialLog(t,e){this.callNativeWithCallback("commercialLog",t,e)}static pageStatus(t,e){this.callNativeWithCallback("pageStatus",{status:t,errorMsg:s(e)?e:""})}static clickAction(t,e,i,a){this.clickActionBase(Object.assign({area:t,logParam:e},i),a)}static clickActionBase(t,e){this.callNativeWithCallback("clickAction",t,e)}static convert(t){this.callNativeWithCallback("convert",{clickActionButton:t})}static updateExceptedPosition(t){this.callNativeWithCallback("initKsAdFrame",t)}static replayVideo(){this.callNativeWithCallback("replayVideo")}static registerVideoListener(t){this.callNativeWithCallback("registerVideoListener",null,t,!1)}static dislike(){this.callNativeWithCallback("dislike")}static registerProgressListener(t){this.callNativeWithCallback("registerProgressListener",null,t,!1)}static registerVideoProgressListener(t){this.callNativeWithCallback("registerVideoProgressListener",null,t,!1)}static registerGetDynamicActionDesListener(t){this.callNativeWithCallback("getDynamicActionDes",null,t,!1)}static registerTimerListener(t){this.callNativeWithCallback("registerTimerListener",null,t,!1)}static registerVideoMuteStateListener(t){this.callNativeWithCallback("registerMuteStateListener",null,t,!1)}static registerVideoAutoPlayListener(t){this.callNativeWithCallback("registerVideoAutoPlayListener",null,t,!1)}static registerPlayStateResetListener(t){this.callNativeWithCallback("registerPlayStateResetListener",null,t,!1)}static updateVideoMuteState(t){this.callNativeWithCallback("updateVideoMuteState",{muted:t})}static skipVideo(t,e,i,a=0){this.callNativeWithCallback("skipVideo",{needPromopt:t,needReport:e,showTime:i,playDuration:a})}static closeVideo(t){this.callNativeWithCallback("closeVideo",{forceClose:t})}static showPlayEnd(t,e=0){this.callNativeWithCallback("showPlayEnd",{userForce:t,type:e})}static showPlayable(t=0){this.callNativeWithCallback("showPlayable",{playableSource:t})}static registerSceneChangeListener(t){this.callNativeWithCallback("registerSceneChangeListener",null,t,!1)}static hasReward(){this.callNativeWithCallback("hasReward")}static clickGift(){this.callNativeWithCallback("clickGift")}static clickCall(t){this.callNativeWithCallback("clickCall",{isEnd:t})}static callButtonImpressionWhenPlay(){this.callNativeWithCallback("callButtonImpressionWhenPlay")}static callButtonImpressionWhenFinish(){this.callNativeWithCallback("callButtonImpressionWhenFinish")}static registerDeepRewardListener(t){this.callNativeWithCallback("registerDeepRewardListener",null,t,!1)}static giveRewardInAdvance(t){this.callNativeWithCallback("giveRewardInAdvance",null,t,!1)}static showLiveEndPage(t){this.callNativeWithCallback("showLiveEndPage",null,t,!1)}static updateRewardTaskState(t){this.callNativeWithCallback("updateRewardTaskState",null,t,!1)}static openURL(t,e){this.callNativeWithCallback("openURL",{url:t,title:e})}static showTKDialog(t){this.callNativeWithCallback("showTKDialog",{templateId:t})}static closeTKDialog(t){this.callNativeWithCallback("closeTKDialog",{templateId:t})}static registerKeyboardChangeListener(t){this.callNativeWithCallback("registerKeyboardChangeListener",null,t,!1)}static registerShakeListener(t){this.callNativeWithCallback("registerMotionListener",null,t,!1)}static close(t){this.callNativeWithCallback("close",null,t,!1)}static closePassData(t,e){this.callNativeWithCallback("close",t,e,!1)}static updateVideoPlayStatus(t,e,i,a){this.callNativeWithCallback("updateVideoPlayStatus",{status:t,errorCode:e||0,errorReason:i||"",currentTime:a||0})}static registerConvertStatusListener(t){this.callNativeWithCallback("registerConvertStatusListener",null,t,!1)}static cardImpression(){this.callNativeWithCallback("cardImpression")}static getCardShowCount(t){this.callNativeWithCallback("getCardShowCount",null,t,!1)}static getNativeData(t,e){this.callNativeWithCallback("getNativeData",{target:t},e,!1)}static updateExtraReward(t){this.callNativeWithCallback("updateExtraReward",t)}static registerApkInstalledListener(t){this.callNativeWithCallback("registerApkInstalledListener",null,t,!1)}static showToast(t){this.callNativeWithCallback("showToast",{message:t})}static registerExtraDialogListener(t){this.callNativeWithCallback("registerExtraDialogListener",null,t,!1)}static getPlayEndType(t){this.callNativeWithCallback("getPlayEndType",null,t,!1)}static playableConvert(t){this.callNativeWithCallback("playableConvert",t)}static getKsPlayableAdData(t){this.callNativeWithCallback("getKsPlayableAdData",null,t)}static getKsPlayableDeviceInfo(t){this.callNativeWithCallback("getKsPlayableDeviceInfo",null,t)}static registerPlayableStatusListener(t){this.callNativeWithCallback("registerPlayableStatusListener",null,t,!1)}static getTrackAdStatus(t){this.callNativeWithCallback("getTrackAdStatus",null,t,!1)}static showLandingPage(t){this.callNative("showLandingPage",{needCloseNeo:t})}static needCloseNeo(t){this.callNativeWithCallback("needCloseNeo",{needClose:t})}static registerBackPressed(t){this.callNativeWithCallback("registerBackPressedListener",null,t,!1)}static innerAdImpression(){this.callNativeWithCallback("adImpression",null)}static neoDidShowPlayAgain(){this.callNativeWithCallback("neoDidShowPlayAgain")}static showPlayAgain(){this.callNativeWithCallback("showPlayAgain")}static registerAggregationDataListener(t){this.callNativeWithCallback("registerAggregationDataListener",null,t,!1)}static callNative(t,e){return new Promise((i,a)=>this.callNativeWithCallback(t,e,t=>{t?(1!=t.result&&(t.result=null),i(t)):i({result:0,data:null})}))}static callNativeWithCallback(t,e,i,a=!0){const s=l()?1:0;l()&&"pageStatus"==t||l()&&"registerLifecycleListener"==t?this.callNativeWithCallbackAndType(t,e,i,a,0):this.callNativeWithCallbackAndType(t,e,i,a,s)}static callTKWithCallback(t,e,i,a=!0){this.callNativeWithCallbackAndType(t,e,i,a,1)}static callNativeWithCallbackAndType(t,e,i,a=!0,l=0){if("undefined"==typeof KwaiAd)return h.log("undefined value KwaiAd"),void(i&&i({result:0,data:null}));h.log("call:"+t);const s=d.registerCallbackForAction(e=>{let a=0,l=null;try{let t=null;t="string"==typeof e?JSON.parse(e):e,a=t.result,l=t.data}catch(s){a=0,l=null}h.log("cb:"+t+"  r:"+a),i&&i({result:a,data:l})},a,t),n={action:t,data:JSON.stringify(e||{}),callback:s};0==l?KwaiAd.callAdBridge(n):KwaiAd.callTKBridge(n)}}const g={adImpInfo:u.getKsAdDataAsync,deviceInfo:u.getDeviceInfoAsync,configInfo:u.getKsAdConfigAsync,containerLimit:u.getContainerLimitAsync,screenOrientation:u.getScreenOrientationAsync};class p extends TKView{constructor(t,e){super(),this.style={position:"absolute",left:0,top:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center"};const i=new TKView;i.style={maxWidth:"80%",backgroundColor:"#000000B3",borderRadius:8,paddingLeft:24,paddingRight:24,flexDirection:"column",alignItems:"center"},this.appendChild(i);const a=new TKText;a.style={fontSize:16,marginTop:12,color:"#FFFFFF",textAlign:"center"},i.appendChild(a);const l=new TKText;l.style={fontSize:12,color:"#666666",marginTop:8,marginBottom:12,textAlign:"center"},i.appendChild(l),a.setText(t),l.setText(e),this.addEventListener("tap",()=>{})}static showToastInView(t,e,i,a,l){const s=new p(e,i);t.appendChild(s),t.layout(),setTimeout(()=>{l&&l()},a)}}class b extends TKView{constructor(t,e){super();let i=Math.max(.776*e.width,320);e.width>e.height&&(i=320),this.style={backgroundColor:"#FFFFFF",borderRadius:12,width:i,paddingTop:10,paddingBottom:20,paddingLeft:24,paddingRight:24},this.addEventListener("tap",()=>{});let a=t.feedBackList;a||(a=this.getDefaultFeedbackItems());let l=0;for(;l<a.length;++l){let t=a[l],e=new TKView;e.nativeID="itemView"+l,e.style={height:40,flexDirection:"column",justifyContent:"center",width:"100%"};const i=new TKText;if(i.nativeID="itemLabel"+l,i.style={fontSize:15,color:"#222222",fontWeight:"bold",width:"100%"},i.setText(t.title),e.appendChild(i),this.appendChild(e),2!=t.type){if(t.subItems&&t.subItems.length>0){let e=new TKView;e.style={flexDirection:"row",flexWrap:"wrap",width:"100%"},this.appendChild(e);for(let i=0;i<t.subItems.length;++i){let a=t.subItems[i],l=new TKView;l.nativeID="subview"+i,l.style={backgroundColor:"#F5F5F5",height:24,paddingLeft:13,paddingRight:13,marginBottom:10,marginRight:8,flexDirection:"column",justifyContent:"center",alignItems:"stretch"};const s=new TKText;s.nativeID="subLabel"+i,s.style={color:"#666666",fontSize:12},s.setText(a.title),l.appendChild(s),e.appendChild(l),l.addEventListener("tap",()=>{0==t.type?this.adlogCallback&&this.adlogCallback(t.id,a.id):1==t.type&&this.commonlogCallback&&this.commonlogCallback(t.id,a.id)})}}else e.addEventListener("tap",()=>{0==t.type?this.adlogCallback&&this.adlogCallback(t.id,0):1==t.type&&this.commonlogCallback&&this.commonlogCallback(t.id,0)});const i=new TKView;i.style={backgroundColor:"#F5F5F5",height:1,width:"100%"},this.appendChild(i)}else{const e=new TKView;e.nativeID="itemView"+l,e.style={borderColor:"#F5F5F5",borderWidth:1,borderRadius:4,paddingLeft:10,paddingRight:10,flexDirection:"row",height:36,alignItems:"center",width:"100%"};const i=new TKImage;i.nativeID="itemIcon"+l,i.style={width:16,height:16,marginRight:4},i.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/icon_ksad_feedback_edit.png"),e.appendChild(i);const a=new TKText;a.style={fontSize:12,color:"#9c9c9c"},e.appendChild(a),a.setText("请写下建议"),this.appendChild(e),e.addEventListener("tap",()=>{this.inputCallback&&this.inputCallback(t.id,0)})}}}getDefaultFeedbackItems(){return[{id:1,title:"不感兴趣",type:0},{id:2,title:"页面展示异常（卡顿、黑屏/白屏）",type:1},{id:3,title:"无法关闭",type:1},{id:4,title:"投诉",type:1,subItems:[{id:1,title:"诱导点击"},{id:2,title:"违法违规"},{id:3,title:"低俗色情"},{id:4,title:"虚假欺诈"},{id:5,title:"疑似抄袭"}]},{id:5,title:"其他",type:2}]}}class C extends TKView{constructor(t,e){super(),this.feedbackItemId=t,this.feedbackSubItemId=e,this.style={width:"100%",flexDirection:"column",paddingLeft:16,paddingRight:16,paddingBottom:16,backgroundColor:"#FFFFFF",topLeftRadius:12,topRightRadius:12};const i=new TKView;i.style={width:"100%",height:52,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},this.appendChild(i);let a=new TKText;a.style={fontSize:15,fontWeight:"bold",color:"#222222"},a.setText("你的建议"),i.appendChild(a),this.commitBtn=new TKView,this.commitBtn.style={flexDirection:"row",justifyContent:"center",alignItems:"center"};const l=new TKText;l.style={fontSize:15,color:"#22222288"},l.setText("提交"),this.commitBtn.appendChild(l),i.appendChild(this.commitBtn);let n=new TKView;n.style={borderRadius:4,borderColor:"#f5f5f5",borderWidth:1,overflow:"hidden",width:"100%",height:88,paddingLeft:12,paddingRight:12},this.appendChild(n);let r=new TKTextArea;r.style={width:"100%",height:"100%",fontSize:14,color:"#222222",backgroundColor:"#00000000",returnKeyType:"done",placeholderColor:"#9c9c9c",placeholderFontSize:14},r.placeholder="请描述您的问题，我们会尽快处理~",n.appendChild(r),this.commitBtn.addEventListener("tap",()=>{this.commitCallback&&this.currentText&&this.currentText.length>0&&this.commitCallback(this.feedbackItemId,this.feedbackSubItemId,this.currentText)}),this.addEventListener("tap",()=>{}),this.inputArea=r,this.inputArea.addEventListener("input",t=>{this.currentText=t.text,s(this.currentText)?l.style={color:"#222222"}:l.style={color:"#22222288"}})}updateFocus(t){this.inputArea.focused=t}}(new class extends class{constructor(){this.renderCalled=!1,this.pageStatusCalled=!1,this.rootView=new TKView,this.rootView.style={width:"100%",height:"100%"},this.registerLifeCycleListener()}render(){this.renderCalled||(this.renderCalled=!0,this.fetchCommonData(()=>{try{this.setupViews(),Tachikoma.render(this.rootView),this.viewDidRendered(),this.updateRenderStatus(1),this.registerNativeId()}catch(t){this.updateRenderStatus(0,function(t){return t instanceof Error?t.message:"string"==typeof t?t:"number"==typeof t?t+"":"unknown"}(t))}}))}setupViews(){}viewDidRendered(){}fetchCommonData(t){let e=this.getDataTypes(),i=[],a=0;for(;a<e.length;++a){const t=e[a];let l=this.funcForName(t);if(!l)return void this.updateRenderStatus(0,"data function not found:"+t);i.push(l())}Promise.all(i).then(i=>{let a=0;for(;a<e.length;++a){this[e[a]]=i[a].data}t&&t()})}willAppear(){}willDisappear(){}didAppear(){}didDisappear(){}registerLifeCycleListener(){u.registerLifecycleListener(t=>{if(t&&t.data){switch(t.data.lifeStatus){case"showStart":this.willAppear();break;case"showEnd":this.didAppear();break;case"hideStart":this.willDisappear();break;case"hideEnd":this.didDisappear()}}})}registerNativeId(){1==Tachikoma.env.isDebug&&o.supportMinimumTKVersion("4.0.7")&&!o.isAndroid()&&(this.startConfig(),u.registerNativeId(t=>{t&&t.data&&this.startConfig()}))}startConfig(){this.configNativeIdTimer&&clearTimeout(this.configNativeIdTimer),this.configNativeIdTimer=setTimeout(()=>{!function t(e){if(e)for(const i in e){if("object"==typeof e[i])for(const a in e[i])if("nativeID"==a&&"private"!=i){e[i].nativeID||(e[i].nativeID=i),t(e[i]);break}}}(this)},120)}getDataTypes(){return["adImpInfo","deviceInfo","configInfo","containerLimit","screenOrientation"]}funcForName(t){return g[t]}updateRenderStatus(t,e=""){this.pageStatusCalled&&1==t||(1==t&&(this.pageStatusCalled=!0),u.pageStatus(t,e))}getDefaultAdInfo(){try{return this.adImpInfo.impAdInfo[0].adInfo[0]}catch(t){return null}}getAdStyle(){try{return this.adImpInfo.impAdInfo[0].adStyle}catch(t){return null}}}{setupViews(){this.rootView.style={width:"100%",height:"100%",backgroundColor:"#30303099",alignItems:"center",justifyContent:"center"},this.feedbackCard=new b(this.configInfo,this.containerLimit),this.rootView.appendChild(this.feedbackCard),this.feedbackCard.inputCallback=(t,e)=>{this.showFeedbackInput(t,e)},this.feedbackCard.adlogCallback=(t,e)=>{let i={actionType:4,payload:JSON.stringify({adNegativeTypeContext:1})};u.sendLog(i),this.showFeedbackToast()},this.feedbackCard.commonlogCallback=(t,e)=>{let i={feedbackId:t,feedbackSubId:e},a={actionType:164,payload:JSON.stringify(i)};u.sendCommonLog(a),this.showFeedbackToast()};u.sendLog({actionType:221,payload:""}),this.rootView.addEventListener("tap",()=>{this.closePage()})}showFeedbackInput(t,e){this.feedbackCard.setVisibility("hidden"),this.inputCard=new C(t,e),this.inputCard.commitCallback=(t,e,i)=>{let a={feedbackId:t,feedbackSubId:e,feedbackContent:i},l={actionType:164,payload:JSON.stringify(a)};u.sendCommonLog(l),this.showFeedbackToast()},this.inputCard.style={position:"absolute",width:"100%",left:0,right:0,bottom:0},this.rootView.appendChild(this.inputCard),this.rootView.layout(),o.isAndroid()||u.registerKeyboardChangeListener(t=>{if(t.result){const e=t.data.size;e.height!=this.lastKeyboardHeight&&(this.inputCard.style={bottom:e.height,position:"absolute",left:0,right:0},this.rootView.layout(),this.lastKeyboardHeight=e.height)}}),setTimeout(()=>{this.inputCard.updateFocus(!0)},50)}showFeedbackToast(){this.hideInput(),this.rootView.removeAll(),this.rootView.style={backgroundColor:"#00000000"},p.showToastInView(this.rootView,"感谢您的反馈","我们将持续为您优化广告体验",2e3,()=>{this.closePage()})}closePage(){this.hideInput();let t={actionType:141,payload:JSON.stringify({elementType:69})};u.sendLog(t),u.close()}hideInput(){this.inputCard&&this.inputCard.updateFocus(!1)}}).render()}]);