(()=>{"use strict";var t=null;function e(e){t=e}function i(t){return t instanceof Error?t.message:"string"==typeof t?t:"number"==typeof t?t+"":"unknown"}function a(){return!o(Tachikoma.env.hasTKBridge)&&1==Tachikoma.env.hasTKBridge}function s(t,e){if(h.supportMinimumTKVersion("4.0.0")){const i=e.getLocationOnScreen(),a=t.position;return a.x=parseFloat((a.x+"").replace("dp","")),a.y=parseFloat((a.y+"").replace("dp","")),{x:i.x+a.x,y:i.y+a.y}}return{x:0,y:0}}function n(t){return"string"==typeof t&&t.length>0}function l(){return t?t.SDKVersion:Tachikoma.env.SDKVersion}function r(){return t?t.sdkType:Tachikoma.env.sdkType}function o(t){return null===t||null==t||""===t}function c(t){if(t)for(const i in t){if("object"==typeof t[i]&&!i.includes("$"))try{t[i].nativeID||(t[i].nativeID=i),c(t[i])}catch(e){}}}class h{static isAndroid(){return"Android"===this.platform}static getCurrentTimeStamp(){return(new Date).getTime()}static getSemiCircle(){return this.isAndroid()?180:Math.PI}static getRotateSemiCircle(){return this.isAndroid()?45:Math.PI}static compareVersion(t,e){if(void 0===t&&void 0===e)return 0;if(void 0===t)return-1;if(void 0===e)return 1;let i=t.split("."),a=e.split("."),s=Math.max(i.length,a.length);for(var n=0;n<s;n++){let t=Number(void 0!==i[n]?i[n]:"0"),e=Number(void 0!==a[n]?a[n]:"0");if(t>e)return 1;if(t!=e)return-1}return 0}static supportMinimumVersion(t="0.0.0",e="0.0.0"){let i=r(),a=1==i&&-1!=h.compareVersion(l(),t),s=2==i&&-1!=h.compareVersion(l(),e);return a||s}static supportCurrentVersion(t="0.0.0",e="0.0.0"){let i=r(),a=1==i&&0==h.compareVersion(l(),t),s=2==i&&0==h.compareVersion(l(),e);return a||s}static supportMinimumTKVersion(e="0.0.0"){return-1!=h.compareVersion(t?t.tkVersion:Tachikoma.env.tkVersion,e)}}h.platform=Tachikoma.env.platform;class C{static randomString(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i=e.length,a="",s=0;s<t;s++)a+=e.charAt(Math.floor(Math.random()*i));return a}static randomName(t){return"jscb_"+t+"_"+this.randomString(4)+this.globalIndex++}static registerCallback(t,e=!0){return this.registerCallbackForAction(t,e,"")}static registerCallbackForAction(t,e=!0,i){if(!t)return null;const a=this.randomName(i);return Tachikoma[a]=i=>{t(i),e&&(Tachikoma[a]=null)},"Tachikoma."+a}}C.globalIndex=0;const d=new class{constructor(){this.enabled=!1,this.logs=[]}setLoggerEnabled(t){this.enabled=t}log(t){if(this.enabled){const e=new Date;0==this.logs.length&&this.logs.push(e.getMonth()+1+":"+e.getDate()+"-"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.logs.push(e.getMilliseconds()+":"+t)}}clear(){this.logs.splice(0,this.logs.length)}exportLog(){return JSON.stringify(this.logs)}};class _{static getDeviceInfoAsync(){return _.callNative("getDeviceInfo",null)}static getKsAdDataAsync(){return _.callNative("getKsAdData",null)}static getKsAdConfigAsync(){return _.callNative("getKsAdConfig",null)}static getScreenOrientationAsync(){return _.callNative("getScreenOrientation",null)}static getVideoCloseTime(){return _.callNative("getVideoCloseTime",null)}static getContainerLimitAsync(){return _.callNative("getContainerLimit",null)}static getTKPreEnvAsync(){return _.callNative("getTKPreEnv",null)}static getDeviceInfo(t){this.callNativeWithCallback("getDeviceInfo",null,t)}static getKsAdData(t){this.callNativeWithCallback("getKsAdData",null,t)}static getKsAdConfig(t){this.callNativeWithCallback("getKsAdConfig",null,t)}static getScreenOrientation(t){this.callNativeWithCallback("getScreenOrientation",null,t)}static getContainerLimit(t){return this.callNativeWithCallback("getContainerLimit",null,t)}static registerLifecycleListener(t){this.callNativeWithCallback("registerLifecycleListener",null,t,!1)}static registerNativeId(t){this.callNativeWithCallback("configNativeId",null,t,!1)}static registerExtraDataListener(t){this.callNativeWithCallback("getKsAdExtraData",null,t,!1)}static hideCard(t,e,i,a=!0){this.callNativeWithCallback("hide",{type:t,playDuration:e},i,a)}static sendLog(t,e){this.callNativeWithCallback("log",t,e)}static sendCommonLog(t,e){this.callNativeWithCallback("commonLog",t,e)}static sendCommercialLog(t,e){this.callNativeWithCallback("commercialLog",t,e)}static pageStatus(t,e){this.callNativeWithCallback("pageStatus",{status:t,errorMsg:n(e)?e:""})}static clickAction(t,e,i,a){this.clickActionBase(Object.assign({area:t,logParam:e},i),a)}static clickActionBase(t,e){this.callNativeWithCallback("clickAction",t,e)}static convert(t){this.callNativeWithCallback("convert",{clickActionButton:t})}static updateExceptedPosition(t){this.callNativeWithCallback("initKsAdFrame",t)}static replayVideo(){this.callNativeWithCallback("replayVideo")}static registerVideoListener(t){this.callNativeWithCallback("registerVideoListener",null,t,!1)}static dislike(){this.callNativeWithCallback("dislike")}static registerProgressListener(t){this.callNativeWithCallback("registerProgressListener",null,t,!1)}static registerVideoProgressListener(t){this.callNativeWithCallback("registerVideoProgressListener",null,t,!1)}static registerGetDynamicActionDesListener(t){this.callNativeWithCallback("getDynamicActionDes",null,t,!1)}static registerTimerListener(t){this.callNativeWithCallback("registerTimerListener",null,t,!1)}static registerVideoMuteStateListener(t){this.callNativeWithCallback("registerMuteStateListener",null,t,!1)}static registerVideoAutoPlayListener(t){this.callNativeWithCallback("registerVideoAutoPlayListener",null,t,!1)}static registerPlayStateResetListener(t){this.callNativeWithCallback("registerPlayStateResetListener",null,t,!1)}static updateVideoMuteState(t){this.callNativeWithCallback("updateVideoMuteState",{muted:t})}static skipVideo(t,e,i,a=0){this.callNativeWithCallback("skipVideo",{needPromopt:t,needReport:e,showTime:i,playDuration:a})}static closeVideo(t){this.callNativeWithCallback("closeVideo",{forceClose:t})}static showPlayEnd(t,e=0){this.callNativeWithCallback("showPlayEnd",{userForce:t,type:e})}static showPlayable(t=0){this.callNativeWithCallback("showPlayable",{playableSource:t})}static registerSceneChangeListener(t){this.callNativeWithCallback("registerSceneChangeListener",null,t,!1)}static hasReward(t){this.callNativeWithCallback("hasReward",{severCheckResult:t})}static clickGift(){this.callNativeWithCallback("clickGift")}static clickCall(t){this.callNativeWithCallback("clickCall",{isEnd:t})}static callButtonImpressionWhenPlay(){this.callNativeWithCallback("callButtonImpressionWhenPlay")}static callButtonImpressionWhenFinish(){this.callNativeWithCallback("callButtonImpressionWhenFinish")}static registerDeepRewardListener(t){this.callNativeWithCallback("registerDeepRewardListener",null,t,!1)}static giveRewardInAdvance(t){this.callNativeWithCallback("giveRewardInAdvance",null,t,!1)}static showLiveEndPage(t){this.callNativeWithCallback("showLiveEndPage",null,t,!1)}static updateRewardTaskState(t){this.callNativeWithCallback("updateRewardTaskState",null,t,!1)}static openURL(t,e){this.callNativeWithCallback("openURL",{url:t,title:e})}static showTKDialog(t){this.callNativeWithCallback("showTKDialog",{templateId:t})}static closeTKDialog(t){this.callNativeWithCallback("closeTKDialog",{templateId:t})}static registerKeyboardChangeListener(t){this.callNativeWithCallback("registerKeyboardChangeListener",null,t,!1)}static registerShakeListener(t){this.callNativeWithCallback("registerMotionListener",null,t,!1)}static close(t){this.callNativeWithCallback("close",null,t,!1)}static closePassData(t,e){this.callNativeWithCallback("close",t,e,!1)}static updateVideoPlayStatus(t,e,i,a){this.callNativeWithCallback("updateVideoPlayStatus",{status:t,errorCode:e||0,errorReason:i||"",currentTime:a||0})}static registerConvertStatusListener(t){this.callNativeWithCallback("registerConvertStatusListener",null,t,!1)}static cardImpression(){this.callNativeWithCallback("cardImpression")}static getCardShowCount(t){this.callNativeWithCallback("getCardShowCount",null,t,!1)}static getNativeData(t,e){this.callNativeWithCallback("getNativeData",{target:t},e,!1)}static updateExtraReward(t){this.callNativeWithCallback("updateExtraReward",t)}static registerApkInstalledListener(t){this.callNativeWithCallback("registerApkInstalledListener",null,t,!1)}static showToast(t){this.callNativeWithCallback("showToast",{message:t})}static registerExtraDialogListener(t){this.callNativeWithCallback("registerExtraDialogListener",null,t,!1)}static getPlayEndType(t){this.callNativeWithCallback("getPlayEndType",null,t,!1)}static playableConvert(t){this.callNativeWithCallback("playableConvert",t)}static getKsPlayableAdData(t){this.callNativeWithCallback("getKsPlayableAdData",null,t)}static getKsPlayableDeviceInfo(t){this.callNativeWithCallback("getKsPlayableDeviceInfo",null,t)}static registerPlayableStatusListener(t){this.callNativeWithCallback("registerPlayableStatusListener",null,t,!1)}static getTrackAdStatus(t){this.callNativeWithCallback("getTrackAdStatus",null,t,!1)}static showLandingPage(t){this.callNative("showLandingPage",{needCloseNeo:t})}static needCloseNeo(t){this.callNativeWithCallback("needCloseNeo",{needClose:t})}static registerBackPressed(t){this.callNativeWithCallback("registerBackPressedListener",null,t,!1)}static innerAdImpression(){this.callNativeWithCallback("adImpression",null)}static neoDidShowPlayAgain(){this.callNativeWithCallback("neoDidShowPlayAgain")}static showPlayAgain(){this.callNativeWithCallback("showPlayAgain")}static registerAggregationDataListener(t){this.callNativeWithCallback("registerAggregationDataListener",null,t,!1)}static getLandingPageInfo(t){this.callNativeWithCallback("getLandingPageInfo",null,t,!1)}static registerNeoStatusListener(t){this.callNativeWithCallback("registerNeoStatusListener",null,t,!1)}static callNative(t,e){return new Promise(((i,a)=>this.callNativeWithCallback(t,e,(t=>{t?(1!=t.result&&(t.result=null),i(t)):i({result:0,data:null})}))))}static callNativeWithCallback(t,e,i,s=!0){const n=a()?1:0;a()&&"pageStatus"==t||a()&&"registerLifecycleListener"==t?this.callNativeWithCallbackAndType(t,e,i,s,0):this.callNativeWithCallbackAndType(t,e,i,s,n)}static callTKWithCallback(t,e,i,a=!0){this.callNativeWithCallbackAndType(t,e,i,a,1)}static callNativeWithCallbackAndType(t,e,i,a=!0,s=0){if("undefined"==typeof KwaiAd)return d.log("undefined value KwaiAd"),void(i&&i({result:0,data:null}));d.log("call:"+t);const n=C.registerCallbackForAction((e=>{let a=0,s=null;try{let t=null;t="string"==typeof e?JSON.parse(e):e,a=t.result,s=t.data}catch(n){a=0,s=null}d.log("cb:"+t+"  r:"+a),i&&i({result:a,data:s})}),a,t),l={action:t,data:JSON.stringify(e||{}),callback:n};0==s?KwaiAd.callAdBridge(l):KwaiAd.callTKBridge(l)}}class u{constructor(){this.renderCalled=!1,this.renderStatusCalled=!1,this.rootView=new TKView,this.rootView.style={width:"100%",height:"100%"}}render(){return!this.renderCalled&&(this.renderCalled=!0,!0)}updateRenderStatus(t,e=""){this.renderCalled&&!this.renderStatusCalled&&(this.renderStatusCalled=!0,_.pageStatus(t,e),this.registerNativeId())}registerNativeId(){1==Tachikoma.env.isDebug&&h.supportMinimumTKVersion("4.0.7")&&!h.isAndroid()&&(this.startConfig(),_.registerNativeId((t=>{t&&t.data&&this.startConfig()})))}startConfig(){this.configNativeIdTimer&&clearTimeout(this.configNativeIdTimer),this.configNativeIdTimer=setTimeout((()=>{c(this)}),120)}}class I extends TKView{}var p,T,A,g;!function(t){t[t.NONE=-1]="NONE",t[t.ACTION_BAR_CLICK=1]="ACTION_BAR_CLICK",t[t.UNKNOWN_ITEM_CLICK=0]="UNKNOWN_ITEM_CLICK",t[t.PLAY_END_ICON_CLICK=15]="PLAY_END_ICON_CLICK",t[t.PLAY_END_ICON_TITLE_CLICK=16]="PLAY_END_ICON_TITLE_CLICK",t[t.PLAY_END_ICON_DESCRIPTION_CLICK=17]="PLAY_END_ICON_DESCRIPTION_CLICK",t[t.PLAY_END_ACTION_BAR_CLICK=26]="PLAY_END_ACTION_BAR_CLICK",t[t.CARD_ACTION_BAR_CLICK=29]="CARD_ACTION_BAR_CLICK",t[t.CARD_ICON_CLICK=30]="CARD_ICON_CLICK",t[t.CARD_ICON_NAME_CLICK=31]="CARD_ICON_NAME_CLICK",t[t.CARD_ICON_COMMENT_CLICK=32]="CARD_ICON_COMMENT_CLICK",t[t.CARD_BLANK_AREA_CLICK=35]="CARD_BLANK_AREA_CLICK",t[t.CARD_PLAY_END_CLICK1=37]="CARD_PLAY_END_CLICK1",t[t.CARD_PLAY_END_CLICK2=38]="CARD_PLAY_END_CLICK2",t[t.PLAY_END_CALL_CLICK=39]="PLAY_END_CALL_CLICK",t[t.PLAY_DETAIL_CALL_CLICK=40]="PLAY_DETAIL_CALL_CLICK",t[t.PLAY_END_GIFT_CLICK=41]="PLAY_END_GIFT_CLICK",t[t.CARD_APP_STORE_CLICK=45]="CARD_APP_STORE_CLICK",t[t.CARD_APP_DOWNLOAD_NUM_CLICK=46]="CARD_APP_DOWNLOAD_NUM_CLICK",t[t.CARD_OTHERAREA_CLICK=53]="CARD_OTHERAREA_CLICK",t[t.CARD_ICON_MOBILE_CLICK=54]="CARD_ICON_MOBILE_CLICK",t[t.CARD_PICTURE_CLICK_ONE=57]="CARD_PICTURE_CLICK_ONE",t[t.CARD_PICTURE_CLICK_TWO=58]="CARD_PICTURE_CLICK_TWO",t[t.CARD_PICTURE_CLICK_THREE=59]="CARD_PICTURE_CLICK_THREE",t[t.CARD_PICTURE_TITLE_CLICK_ONE=60]="CARD_PICTURE_TITLE_CLICK_ONE",t[t.CARD_PICTURE_TITLE_CLICK_TWO=61]="CARD_PICTURE_TITLE_CLICK_TWO",t[t.CARD_PICTURE_TITLE_CLICK_THREE=62]="CARD_PICTURE_TITLE_CLICK_THREE",t[t.CARD_PICTURE_SUBTITLE_CLICK_ONE=63]="CARD_PICTURE_SUBTITLE_CLICK_ONE",t[t.CARD_PICTURE_SUBTITLE_CLICK_TWO=64]="CARD_PICTURE_SUBTITLE_CLICK_TWO",t[t.CARD_PICTURE_SUBTITLE_CLICK_THREE=65]="CARD_PICTURE_SUBTITLE_CLICK_THREE",t[t.CARD_RANK_CLICK=75]="CARD_RANK_CLICK",t[t.CARD_DOWNLOAD_CNT_CLICK=76]="CARD_DOWNLOAD_CNT_CLICK",t[t.CARD_TAG_CLICK=77]="CARD_TAG_CLICK",t[t.CARD_ITEM_BULLET_CLICK=80]="CARD_ITEM_BULLET_CLICK",t[t.CARD_RECOMMEND_REASON_CLICK=84]="CARD_RECOMMEND_REASON_CLICK",t[t.CARD_PAGE_CLICK=85]="CARD_PAGE_CLICK",t[t.PLAYEND_ICON_OTHERAREA_CLICK=104]="PLAYEND_ICON_OTHERAREA_CLICK",t[t.INTERACT_LANDING_PAGE_CLICK=110]="INTERACT_LANDING_PAGE_CLICK",t[t.ACTIONBAR_ICON_CLICK=115]="ACTIONBAR_ICON_CLICK",t[t.ACTIONBAR_ICON_COMMENT_CLICK=117]="ACTIONBAR_ICON_COMMENT_CLICK",t[t.ACTIONBAR_ICON_OTHER_AREA_CLICK=118]="ACTIONBAR_ICON_OTHER_AREA_CLICK",t[t.CLOSE_BULLET_ICON_CLICK=127]="CLOSE_BULLET_ICON_CLICK",t[t.CLOSE_BULLET_ICON_TITLE_CLICK=128]="CLOSE_BULLET_ICON_TITLE_CLICK",t[t.CLOSE_BULLET_ICON_DESCRIPTION_CLICK=129]="CLOSE_BULLET_ICON_DESCRIPTION_CLICK",t[t.CLOSE_BULLET_ACTION_BAR_CLICK=131]="CLOSE_BULLET_ACTION_BAR_CLICK",t[t.SPLASH_CONVERSION_BUTTON_CLICK=132]="SPLASH_CONVERSION_BUTTON_CLICK",t[t.NEO_AUTO_SHOW_STOREKIT=147]="NEO_AUTO_SHOW_STOREKIT",t[t.CARD_LEFT_ACTION_BAR_CLICK=150]="CARD_LEFT_ACTION_BAR_CLICK",t[t.CARD_SWIPE_CONVERT=153]="CARD_SWIPE_CONVERT",t[t.SHAKE_ICON_SHACK=157]="SHAKE_ICON_SHACK",t[t.SHAKE_BIG_ICON_CLICK=158]="SHAKE_BIG_ICON_CLICK",t[t.ROTATE_ICON_ROTATE=161]="ROTATE_ICON_ROTATE",t[t.CARD_TROLLEY_ICON_CLICK=164]="CARD_TROLLEY_ICON_CLICK",t[t.LANDING_PAGE_OTHER_AREA_CLICK=171]="LANDING_PAGE_OTHER_AREA_CLICK",t[t.CARD_FOLLOW_NUM=172]="CARD_FOLLOW_NUM",t[t.FALL_ICON_CLICK=173]="FALL_ICON_CLICK",t[t.LIVE_BUTTON_CLICK=175]="LIVE_BUTTON_CLICK",t[t.DIRECT_H5_PAGE_CLICK=177]="DIRECT_H5_PAGE_CLICK",t[t.GOODS_ITEM_CARD_CLICK=178]="GOODS_ITEM_CARD_CLICK",t[t.GOODS_ITEM_CARD_SLIDE_CLICK=179]="GOODS_ITEM_CARD_SLIDE_CLICK",t[t.ITEM_HOT_BUY_STYLE_CLICK=180]="ITEM_HOT_BUY_STYLE_CLICK",t[t.GUIDE_ENTER_LIVE_CLICK=181]="GUIDE_ENTER_LIVE_CLICK",t[t.AUTO_CLICK_OTHER_AREA=182]="AUTO_CLICK_OTHER_AREA"}(p||(p={})),function(t){t[t.adClickReward=1]="adClickReward"}(T||(T={})),function(t){t[t.isRewarded=1]="isRewarded",t[t.noExtraReward=2]="noExtraReward",t[t.hasWatchReward=3]="hasWatchReward"}(A||(A={})),function(t){t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical"}(g||(g={}));const L="ad_convert_event";class N extends Object{constructor(t,e,i,a){var s;super(),this.depIds={},this.vm=t,this.getter="function"==typeof e?e:this.parseGetter(e.trim()),this.cb=i,this.value=this.get(),this.cb(null!==(s=this.value)&&void 0!==s?s:a,null),console.log("Watcher on "+e)}update(){const t=this.get();t!=this.value&&(this.cb.call(this.vm,t,this.value),this.value=t)}addDep(t){const e=t.pid;this.depIds.hasOwnProperty(e)||(t.addDep(this),this.depIds[e]=t)}get(){N.target=this;const t=this.getter.call(this.vm,this.vm);return N.target=null,t}parseGetter(t){if(/[^\w.$]/.test(t))return;const e=t.split(".");return function(t){for(let i=0,a=e.length;i<a;i++){if(!t)return;t=t[e[i]]}return t}}}function v(t){return!!t}let m;function f(){if(null!=m)return m;let t=!1;try{t=!1,m=t}catch(e){}return t}function E(t,e){if(!0===f()&&(null==t||!1===t))throw new Error("tkmvvm ----- 请检查传值: "+e)}function y(t){f()&&console.log("tachikoma TKMVVM log -> "+t)}class D extends Object{constructor(t,e){super(),this.object=t,this.observeKey=e,this._observe(t,e)}_observe(t,e){var i=this;Array.isArray(t)?this.defineArray(t):Object.keys(t).forEach((function(a){e?e===a&&i.observeValueWithKey(t,a):i.observeValueWithKey(t,a)}))}observeValueWithKey(t,e){let i=t[e];var a=new O(e);w(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:function(){return N.target&&a.depend(),i},set:function(t){t!==i&&(i=t,a.notify(),w(t))}})}defineArray(t){if(t)for(let e=0,i=t.length;e<i;e++)w(t[e])}}var R=0;class O extends Object{constructor(t){super(),this.key=t,this.pid=R++,this.deps=new Array}depend(){N.target.addDep(this)}addDep(t){this.deps.push(t)}removeDep(t){}notify(){this.deps.forEach((function(t){t.update()}))}}function w(t,e){if(!t||"object"!=typeof t)return;var i;if(!("object"==typeof(i=t)&&Object.keys(i).length>0))return;let a=!1,s=(null!=e?e:"")+"_tkmvvm_observed";if(t.hasOwnProperty(s)&&(a=t[s]),!a)return y("observe "+s),t[s]=!0,new D(t,e);y("already observe "+s)}class k extends Object{constructor(){super()}tk_observe(t){v(t)&&(t in this?w(this,t):console.log("=====++++++ observe2: key not in this:"+t+":"+typeof this))}}function K(t,e,i){if(!v(t)||!v(e)||!v(i))return;const a=b(e),s=null==a?void 0:a.split(".");if(!s)return void E(s,"tk_bind error, check bind path");const n=s[0];t.tk_observe(n),new N(t,a,((t,e)=>{i&&i(t)}))}function b(t){let e=function(t){if(t)return t.bind_path?t.$bind_path:"string"==typeof t?t:void 0}(t);if(e)return e;E(e,"tk_bind error, check bind path")}class S extends I{constructor(t){super(),this.vm=t,this.startTransY=this.vm.showOnTop()?-40:40,this.setStyle(),this.setUpView(),this.setData(),this.setAction()}setStyle(){this.style={backgroundColor:"#FFFFFF",position:"absolute",flexDirection:"row",alignItems:"center",opacity:0,transform:{translate:{y:this.startTransY}}},0==this.vm.screenOrientation?this.vm.showOnTop()?this.style={height:78,top:8,left:8,right:8,borderRadius:12}:this.style={height:94,left:0,bottom:0,right:0,topLeftRadius:12,topRightRadius:12}:this.vm.showOnTop()?this.style={width:482,height:78,top:8,borderRadius:12}:this.style={width:482,height:78,bottom:8,borderRadius:12}}setUpView(){this.appiconView=new TKImage,this.appiconView.style={width:46,height:46,marginLeft:12,borderRadius:8},this.appendChild(this.appiconView);let t=new TKView;t.style={width:"100%",height:"100%",marginLeft:8,flexShrink:1,flexDirection:"column",justifyContent:"center"},this.appNameView=new TKText,this.appNameView.style={width:"100%",flexWrap:"no-wrap",textLineClamp:1,fontWeight:"medium",textOverflow:"ellipsis",color:"#222222",fontSize:15},t.appendChild(this.appNameView),this.descView=new TKText,this.descView.style={width:"100%",flexWrap:"no-wrap",textLineClamp:1,textOverflow:"ellipsis",marginTop:4,color:"#66666699",fontSize:12},t.appendChild(this.descView),this.appendChild(t),this.btnView=new TKText;let e=this.vm.isBtnRedStyle()?"#FE3666":"#F5F5F5",i=this.vm.isBtnRedStyle()?"#FFFFFF":"#222222";this.btnView.style={width:88,height:36,marginLeft:12,marginRight:28,backgroundColor:e,borderRadius:100,color:i,fontWeight:"medium",fontSize:12,textAlign:"center"},this.appendChild(this.btnView),this.closeView=new TKImage,this.closeView.style={width:10,height:10,position:"absolute",top:12,right:12},this.appendChild(this.closeView)}setData(){this.appiconView.setSrc(this.vm.getAppIconUrl()),this.appNameView.setText(this.vm.getAdName()),K(this.vm,this.vm.$attrsPath.currentTimerValue,(t=>{t>0&&this.descView.setText(t/1e3+this.vm.tipDes)})),this.btnView.setText(this.vm.getBtnText()),this.closeView.setSrc("https://tx-ad.a.yximgs.com/kos/nlav11524/ksad/ksad_installed_activate_close_icon.png")}setAction(){this.addEventListener("tap",(t=>{const e=s(t,this);this.vm.closeAndConvert(1,2,p.CARD_OTHERAREA_CLICK,e)})),this.btnView.addEventListener("tap",(t=>{const e=s(t,this);this.vm.closeAndConvert(1,1,p.ACTION_BAR_CLICK,e)})),this.closeView.addEventListener("tap",(()=>{this.vm.onlyClose()}))}showCardViewAnim(t){let e=new TKKeyframeAnimation;e.duration=t,e.timingFunction="EaseOut",e.setAnimations([()=>(this.style={transform:{translate:{y:this.startTransY}},opacity:0},0),()=>(this.style={transform:{translate:{y:0}},opacity:1},1)]),this.addAnimation(e,"cardShow")}hideCardViewAnim(t,e,i){let a;a=1==t?0:this.startTransY;let s=new TKKeyframeAnimation;s.duration=e,s.timingFunction="EaseOut",s.setAnimations([()=>(this.style={transform:{translate:{y:0}},opacity:1},0),()=>(this.style={transform:{translate:{y:a}},opacity:0},1)]),s.on("end",(()=>{i&&i()})),this.addAnimation(s,"cardClose")}}class P extends I{constructor(t){super(),this.showAnimDuration=600,this.hideAnimDuration=300,this.vm=t,this.setStyle(),this.setUpView(),this.setAction()}setStyle(){this.style={width:"100%",height:"100%",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"}}setUpView(){this.vm.showOnTop()||0!=this.vm.screenOrientation||(this.bgMaskView=new TKView,this.bgMaskView.style={gradientBgColor:"90, 000000CC 0, 00000000 1",width:"100%",height:149,position:"absolute",bottom:0,left:0,opacity:0},this.appendChild(this.bgMaskView)),this.cardView=new S(this.vm),this.appendChild(this.cardView)}setAction(){K(this.vm,this.vm.$attrsPath.lifeStatus,(t=>{"showEnd"==t&&(this.cardView.showCardViewAnim(this.showAnimDuration),this.showMaskViewAnim(this.bgMaskView))})),K(this.vm,this.vm.$attrsPath.closeType,(t=>{2!=t&&1!=t||(this.hideMaskViewAnim(this.bgMaskView),this.cardView.hideCardViewAnim(t,this.hideAnimDuration,(()=>{this.vm.notifyAdClose()})))}))}showMaskViewAnim(t){if(!t)return;let e=new TKKeyframeAnimation;e.duration=this.showAnimDuration,e.timingFunction="EaseOut",e.setAnimations([()=>(t.style={opacity:0},0),()=>(t.style={opacity:1},1)]),t.addAnimation(e,"cardShow")}hideMaskViewAnim(t){if(!t)return;let e=new TKKeyframeAnimation;e.duration=this.hideAnimDuration,e.timingFunction="EaseOut",e.setAnimations([()=>(t.style={opacity:1},0),()=>(t.style={opacity:0},1)]),t.addAnimation(e,"cardHide")}}class V extends k{constructor(){super(),this.$attrsPath=new Proxy(this,{get:(t,e)=>W(t,e)})}getData(t){}}function W(t,e){return new Proxy({$vm:t,$bind_path:e},{get:(i,a)=>"string"!=typeof a||"function"==typeof i[a]||0==a.indexOf("$")?Reflect.get(i,a):W(t,e+"."+a)})}var x,M;!function(t){t.START="start",t.CENTRT="center",t.END="end"}(x||(x={})),function(t){t[t.unknown=0]="unknown",t[t.DetailOne=1]="DetailOne",t[t.Simple=2]="Simple",t[t.DetailTwo=3]="DetailTwo"}(M||(M={}));var B;!function(t){t[t.RETAIN_CARD_TYPE_2=9]="RETAIN_CARD_TYPE_2",t[t.RETAIN_CARD_TYPE_3=10]="RETAIN_CARD_TYPE_3",t[t.RETAIN_CARD_TYPE_4=11]="RETAIN_CARD_TYPE_4"}(B||(B={}));class U{}function F(t){let e=H(t,15);return JSON.parse(e.data)}function Y(t,e){let i;switch(e){case 1:try{i=t.adMatrixInfo.adDataV2.middleTKCardInfo.templateId}catch(a){i=void 0}break;case 12:try{i=t.adMatrixInfo.adDataV2.neoTKInfo.templateId}catch(a){i=void 0}break;case 3:try{i=t.adMatrixInfo.adDataV2.fullScreenInfo.templateId}catch(a){i=void 0}break;case 2:try{i=t.adMatrixInfo.adDataV2.interstitialCardInfo.templateId}catch(a){i=void 0}break;case 4:try{i=t.adMatrixInfo.adDataV2.topFloorTKInfo.templateId}catch(a){i=void 0}break;case 6:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(a){i=void 0}break;case 5:try{i=t.adMatrixInfo.adDataV2.splashPlayCardTKInfo.templateId}catch(a){i=void 0}break;case 7:try{i=t.adMatrixInfo.adDataV2.activityMiddlePageInfo.templateId}catch(a){i=void 0}break;case 10:try{i=t.adMatrixInfo.adDataV2.rewardVideoTaskInfo.templateId}catch(a){i=void 0}break;case 9:try{i=t.adMatrixInfo.adDataV2.actionBarTKInfo.templateId}catch(a){i=void 0}break;case 11:try{i=t.adMatrixInfo.adDataV2.pushTKInfo.templateId}catch(a){i=void 0}break;case 13:try{i=t.adMatrixInfo.adDataV2.splashEndCardTKInfo.templateId}catch(a){i=void 0}break;case 14:try{i=t.adMatrixInfo.adDataV2.videoLiveTKInfo.templateId}catch(a){i=void 0}break;case 15:try{i=t.adMatrixInfo.adDataV2.installedActivateInfo.templateId}catch(a){i=void 0}break;default:i=void 0}return i}function H(t,e){let i=Y(t,e);if(!n(i))return;const a=t.adMatrixInfo.adDataV2.templateDatas.length;for(let s=0;s<a;s++){let e=t.adMatrixInfo.adDataV2.templateDatas[s];if(e.templateId==i)return e}}function G(t,e){let i=!0;if(1==t.adBaseInfo.adOperationType)try{let a=t.downloadSafeInfo.complianceInfo;if(null!=a)switch(e){case 1:i=3!=a.actionBarType;break;case 2:i=3!=a.describeBarType;break;case 3:i=3!=a.materialJumpType;break;default:i=!0}}catch(a){i=!0}else try{let a=t.unDownloadConf.unDownloadRegionConf;if(null!=a)switch(e){case 1:i=1!=a.actionBarType;break;case 2:i=1!=a.describeBarType;break;case 3:i=1!=a.materialJumpType;break;default:i=!0}}catch(a){i=!0}return i}let j;function J(){var t;return j||(j={all:t=t||new Map,on(e,i){const a=t.get(e);a?a.push(i):t.set(e,[i])},off(e,i){const a=t.get(e);a&&(i?a.splice(a.indexOf(i)>>>0,1):t.set(e,[]))},emit(e,i){let a=t.get(e);a&&a.slice().map((t=>{t(i)})),a=t.get("*"),a&&a.slice().map((t=>{t(e,i)}))},clear(){t.clear()}}),j}class ${static log(t,e,i){(i=i||{}).renderContainer=1;const a={actionType:t,payload:JSON.stringify(i)};e&&(a.clickInfo=e),_.sendLog(a)}static convertIfNeeded(t,e,i,a,s,n,l,r){let o=G(e,i);console.log("tkloadcontroller shouldconvert:"+o),o&&this.convert(i,a,s,t,n,l,r)}static convert(t,e,i,a,s,n,l){let r,c;r=o(s)?{itemClickType:i,renderContainer:1}:{itemClickType:i,renderContainer:1,clientExtData:JSON.stringify(s)},o(n)||Object.assign(r,n),J().emit(L,{clickType:i}),c=e?{x:e.x,y:e.y}:{},_.clickAction(t,{payload:JSON.stringify(r),clickInfo:c,sceneType:a,itemClickType:i},l,(i=>{1!=i.result&&(this.log(2,e,r),_.convert(1==t))}))}static expose(t){this.log(1,null,t)}static exposeElement(t,e){(e=e||{}).elementType=t,this.log(140,null,e)}static clickElement(t){const e={elementType:t};this.log(141,null,e)}static convertWithTypeIfNeeded(t,e,i,a,s){if(h.isAndroid())this.convertWithType(e,i,a,s);else{if(!G(t,e))return;this.convertWithType(e,i,a,s)}}static convertWithType(t,e,i,a){let s={itemClickType:i,renderContainer:1};J().emit(L,{clickType:i}),_.clickAction(t,{payload:JSON.stringify(s),clickInfo:{x:e.x,y:e.y},convertType:a},(i=>{1!=i.result&&(this.log(2,e,s),_.convert(1==t))}))}static convertWithTypeIfNeededNew(t,e,i,a,s,n){if(h.isAndroid())this.convertWithTypeNew(e,i,a,s,n);else{if(!G(t,e))return;this.convertWithTypeNew(e,i,a,s,n)}}static convertWithTypeNew(t,e,i,a,s){let n=s||{};n.itemClickType=i,n.renderContainer=1,J().emit(L,{clickType:i}),_.clickAction(t,{payload:JSON.stringify(n),clickInfo:{x:e.x,y:e.y},convertType:a},(i=>{1!=i.result&&(this.log(2,e,n),_.convert(1==t))}))}static convertNew(t,e,i,a,s,n){let l=n||{};l.itemClickType=s,l.renderContainer=1,J().emit(L,{clickType:s});let r=s;_.clickAction(e,{payload:JSON.stringify(l),clickInfo:{x:i.x,y:i.y,width:a.width,height:a.height},sceneType:t,itemClickType:r},(t=>{1!=t.result&&(this.log(2,i,l),_.convert(1==e))}))}static playNSecond(t){let e={photoPlaySecond:t};this.log(402,null,e)}static skip(){this.log(501,null,null)}}class z extends V{constructor(){super(...arguments),this.lifeStatus="none",this.hasReportShow=!1,this.showTimerPaused=!1,this.currentTimerValue=0,this.timerInterval=1e3,this.closeType=0,this.tipDes="s后为你打开，展示更多精彩"}getData(t){let i=[];i.push(_.getKsAdDataAsync()),i.push(_.getDeviceInfoAsync()),i.push(_.getKsAdConfigAsync()),i.push(_.getContainerLimitAsync()),i.push(_.getScreenOrientationAsync()),Promise.all(i).then((i=>{const a=i[0].data,s=i[1].data,n=i[2].data,l=i[3].data,r=i[4].data;try{this.adInfo=a.impAdInfo[0].adInfo[0],this.adStyle=a.impAdInfo[0].adStyle,this.screenOrientation=r.screenOrientation,e(this.deviceInfo),this.additionalInit()}catch(o){}this.deviceInfo=s,this.configInfo=n,this.containerLimit=l,this.screenOrientation=r.screenOrientation,t&&t(!0)}))}additionalInit(){this.showTimeMs=this.getShowTime(),this.currentTimerValue=this.showTimeMs,this.registerLifeStatusListener()}registerLifeStatusListener(){_.registerLifecycleListener((t=>{if(t.result&&t.data){const e=t.data.lifeStatus;e!==this.lifeStatus&&this.updateLifeStatus(e)}}))}updateLifeStatus(t){"showEnd"!=t||this.hasReportShow||(this.hasReportShow=!0,this.reportElementPv(),this.startCountDown()),"pageVisiable"==t?this.showTimerPaused=!1:"pageInvisiable"==t?this.showTimerPaused=!0:"hideEnd"==t&&this.stopCountDown(),this.lifeStatus=t}startCountDown(){this.stopCountDown(),this.countDownTimer=setInterval((()=>{this.showTimerPaused||(this.currentTimerValue=this.currentTimerValue-this.timerInterval,this.currentTimerValue<=0&&this.closeAndConvert(2,1,p.AUTO_CLICK_OTHER_AREA,null))}),this.timerInterval)}stopCountDown(){this.countDownTimer&&clearTimeout(this.countDownTimer)}getAppIconUrl(){let t=F(this.adInfo);return(o(t)?null:t.adAppUrl)||"https://static.yximgs.com/udata/pkg/ad-universe/universe_icon.png"}getAdName(){let t=F(this.adInfo);return o(t)?"":t.adTitle}getBtnText(){let t="立即打开",e=F(this.adInfo),i=o(e)?t:e.adActionDescription;return o(i)?t:i}getShowTime(){let t=F(this.adInfo),e=o(t)?5e3:t.displayDuration;return o(e)?5e3:e}showOnTop(){let t=F(this.adInfo),e=!!o(t)||t.displayLocation;return!!o(e)||1==e}isBtnRedStyle(){let t=F(this.adInfo),e=!!o(t)||t.btnStyle;return!!o(e)||1==e}reportElementPv(){let t=new U;t.universe_feature_freq=8,t.auto_pop_area=this.showOnTop()?1:0,t.card_source_type=1;let e={clientExtData:JSON.stringify(t)};$.exposeElement(16,e)}closeAndConvert(t,e,i,a){this.closeType=t,this.stopCountDown();let s=new U;s.auto_pop_area=this.showOnTop()?1:0,s.card_source_type=1,$.convertIfNeeded(4,this.adInfo,e,a,i,s)}onlyClose(){this.closeType=1,this.stopCountDown();let t=new U;t.auto_pop_area=this.showOnTop()?1:0,t.card_source_type=1;let e={clientExtData:JSON.stringify(t)};$.log(713,null,e)}notifyAdClose(){_.close()}}(new class extends u{constructor(){super(),this.vm=new z}setupViews(){this.contentView=new P(this.vm),this.rootView.appendChild(this.contentView)}render(){if(this.renderCalled)return!1;this.renderCalled=!0;try{this.vm.getData((t=>{if(t)try{this.setupViews(),Tachikoma.render(this.rootView),this.updateRenderStatus(1,"")}catch(e){this.updateRenderStatus(0,i(e))}else this.updateRenderStatus(0,"data invalid")}))}catch(t){this.updateRenderStatus(0,i(t))}return!0}}).render()})();
//# sourceMappingURL=ksad-installed-activate-card.101.js.map