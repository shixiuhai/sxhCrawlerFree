const crypto = require('crypto'); //引入crypto加密模块
// const crypto = require('crypto-js'); //引入crypto加密模块
function MD5 (text) {
    return crypto.createHash('md5').update(text).digest('hex');
}
var window = {};
var navigator = {}
var location = {
    "ancestorOrigins": {},
    "href": "https://www.xiaohongshu.com/explore/641ae24e0000000013036dd2",
    "origin": "https://www.xiaohongshu.com",
    "protocol": "https:",
    "host": "www.xiaohongshu.com",
    "hostname": "www.xiaohongshu.com",
    "port": "",
    "pathname": "/explore/641ae24e0000000013036dd2",
    "search": "",
    "hash": ""
}
var document = {location:location}

function a0_0x5b83(e, t) {
    var r =   [
        "ATWtM",
        "bqDaf",
        "toStrin",
        "ymqYH",
        "IJEoj",
        "enumera",
        "jklmnop",
        "charAt",
        "zqyyp",
        "GLqBv",
        "_hh",
        "0|4|1|3",
        "1|2|6|7",
        "PPKAa",
        "Illegal",
        "oweMY",
        "MEatr",
        "qgAvo",
        "dSyum",
        "EGOqf",
        "Ckzfe",
        "bhAHQ",
        "ZOMOA",
        "pDHep",
        "charCod",
        "LgHoh",
        "STybd",
        "bVZzs",
        "CoGXE",
        "BMFSu",
        "GirPm",
        "nt ",
        "LaKYI",
        "ncvGi",
        "SQQAv",
        "iwltS",
        "MruYQ",
        "bBEav",
        "length",
        "hWCxo",
        "gkwjp",
        "KVPay",
        "raSoA",
        "EMLRo",
        "zPLJb",
        "tmXUb",
        "TTYXx",
        "CcyBF",
        "_isBuff",
        "YDcjt",
        "Adtfa",
        "szTdE",
        "gwbID",
        "szaMQ",
        "qEftJ",
        "rable",
        "jGECV",
        "khBjN",
        "PgptU",
        "|3|0|5|",
        "TQBrM",
        "NbLaf",
        "NOiuy",
        "FPaUz",
        "CpAiz",
        "fsgzU",
        "hPSmI",
        "xyz0123",
        "KbqST",
        "wcDTG",
        "atLE",
        "kcudt",
        "BhPEm",
        "hasOwnP",
        "wsMnf",
        "mZwVe",
        "pngG8yJ",
        "sHTSy",
        "NwSjN",
        "QNpig",
        "ifeoJ",
        "FElCj",
        "sVYgG",
        "TapNb",
        "ykHMn",
        "wsZMG",
        "IIHVQ",
        "hWEFA",
        "cXqsA",
        "fciFe",
        "TiLMD",
        "size",
        "zpOyv",
        "UNDTo",
        "readFlo",
        "CkfrK",
        "DktqT",
        "iNznS",
        "OqNfZ",
        "kvsCX",
        "ldFAh",
        "a2r1ZQo",
        "2445590StPRLD",
        "GkrDW",
        "LjFjr",
        "GPOtx",
        "string",
        "mOSaR",
        "Bvk6/7=",
        "TjoHT",
        "utf8",
        "gDrEw",
        "__esMod",
        "kCaHy",
        "split",
        "MlJAR",
        "XpJuc",
        "qAwzL",
        "Vapyb",
        "NriOb",
        "oqmgK",
        "fRUES",
        "alert",
        "UcRES",
        "OPQRSTU",
        "navigat",
        "wOcza/L",
        "ABCDEFG",
        "BoDQu",
        "ncdJa",
        "QRwZy",
        "ReDEz",
        "6183336CivpSL",
        "WJyBZ",
        "zLCWW",
        "JlsLP",
        "fClwM",
        "asStrin",
        "lzJZP",
        "floor",
        "TgDbm",
        "isBuffe",
        "jvJiF",
        "SABMP",
        "hdQcO",
        "YmZhP",
        "iUPsm",
        "x3VT16I",
        "rotl",
        "sajna",
        "_ii",
        "bSOEY",
        "YNSey",
        "constru",
        "aEcrL",
        "KQHVv",
        "12uchxSR",
        "userAge",
        "getTime",
        "defineP",
        "ize",
        "MHzGn",
        "eWlBu",
        "GGhMh",
        "call",
        "957903QEGqtm",
        "LRnFa",
        "DWesa",
        "HxsYR",
        "Vgfdz",
        "kAfZg",
        "indexOf",
        "gtDTX",
        "ZSeJg",
        "fkHAJ",
        "VRTFJ",
        "cdefghi",
        "feTDL",
        "xkLjY",
        "QgZSI",
        "SUszo",
        " Array]",
        "gNCqr",
        "WyWOq",
        "YPzQp",
        "OiiKE",
        "64DfFvHL",
        "aPxIV",
        "AzYyd",
        "dgPGf",
        "GbwzQ",
        "BObjy",
        "9472617KbSUjn",
        "684891qDcRYp",
        "HVRHK",
        "tUwZw",
        "HQOfg",
        "hECvuRX",
        "IxuxO",
        "rCode",
        "eYpfs",
        "0DSfdik",
        "_gg",
        "xTqVA",
        "lUAFM97",
        "q42KWYj",
        "replace",
        "Fcvbd",
        "tSuKA",
        "2ronXdL",
        "5|2|7|8",
        "prototy",
        "SrrvE",
        "WCJsY",
        "TgLDB",
        "pIfJW",
        "FlTfW",
        "configu",
        "4|0",
        "ugsUl",
        "qrstuvw",
        "endian",
        "ksCzn",
        "ctor",
        "_ff",
        "asBytes",
        "iXmJy",
        "mmRiP",
        "KUobN",
        " argume",
        "LpkCF",
        "yRnhISG",
        "mjclG",
        "kyTxR",
        "join",
        "exports",
        "uUXon",
        "AFluW",
        "IYTJG",
        "RjzRb",
        "A4NjFqY",
        "xXGXd",
        "IWEHf",
        "u5wPHsO",
        "pnICQ",
        "cEfeo",
        "KxVcl",
        "bBcCf",
        "sntZV",
        "ZmserbB",
        "functio",
        "_digest",
        "WiGun",
        "KblCWi+",
        "gReZW",
        "KSyOR",
        "AzOlH",
        "oHpmG",
        "CAVFI",
        "tvGNf",
        "LOOrP",
        "isArray",
        "substr",
        "uKUZY",
        "4452525SuVciK",
        "fromCha",
        "jaAJX",
        " Object",
        "eYVTC",
        "VPDbw",
        "LQJIN",
        "bIoIt",
        "RAazS",
        "vFurd",
        "398524qLrYmx",
        "Hex",
        "AhrYY",
        "rSULQ",
        "eAt",
        "push",
        "Words",
        "qxeiA",
        "[object",
        "bOfQU",
        "|3|1|6|",
        "undefin",
        "lcJDM",
        "OjNlB",
        "npUku",
        "shFgg",
        "Bytes",
        "cIYCO",
        "jYnBe",
        "AACPJ",
        "String",
        "BVZwy",
        "XoHZf",
        "pow",
        "yWLHx",
        "XijJW",
        "fccHo",
        "GagEE",
        "kFiJR",
        "kPxHT",
        "uqZoP",
        "JAxlG",
        "crMna",
        "ffHAy",
        "YbZgt",
        "cVte9UJ",
        "HIJKLMN",
        "roperty",
        "test",
        "iCuMI",
        "slice",
        "binary",
        "ZaUsL",
        "EezaX",
        "aqege",
        "456789+",
        "smllo",
        "kvquB",
        "ZgYto",
        "sWFru",
        "VWXYZab",
        "MbLkN",
        "encodin",
        "wordsTo",
        "kQHog",
        "IDkdx",
        "YfGHk",
        "get",
        "_blocks",
        "BvKNX",
        "WslPu",
        "iamspam",
        "nVtFt",
        "OAolL",
        "0XTdDgM",
        "TvJZj",
        "stringT",
        "RBFhs",
        "TXhTR",
        "nQukf",
        "GwUUs",
        "GDsxQ",
        "AXBCq",
        "oWyVU",
        "anyTY",
        "GoEZk",
        "tecAP",
        "MuyRv",
        "LvgEs",
        "ule",
        "oBytes",
        "ble",
        "default",
        "YduTO",
        "jiTIp",
        "grKok",
        "dcPaY",
        "bin",
        "random",
        "bytesTo",
        "HDmmx",
        "fQIQU",
        "CRbaw",
        "HdSQB",
        "OVGOU",
        "LpfE8xz",
        "stringi",
        "oHQtNP+",
        "SLIdu",
        "DpSoo"
    ]
    // return r[300-142]
    return r[e-=142]
}

function a0_0x34ec01(e, t) {
    return a0_0x5b83(e - 588, t)
}

function sign(e, t) {
    var r = 1487
        , n = 1383
        , o = 1199
        , i = 1333
        , a = 1173
        , s = 1330
        , u = 1315
        , c = 1288
        , l = 1272
        , p = 1386
        , f = 1512
        , d = 1149
        , A = 1014
        , g = 1357
        , h = 1284
        , v = 1140
        , y = 1279
        , m = 1457
        , _ = 1301
        , b = 1440
        , w = 1400
        , T = 1356
        , E = 1206
        , S = 1294
        , x = 1377
        , k = 1127
        , I = 1044
        , O = 1159
        , B = 1067
        , C = 1032
        , M = 1173
        , D = 1031
        , L = 1205
        , R = 1170
        , j = 1101
        , N = 1360
        , F = 1536
        , P = 1262
        , W = 1259
        , U = 1262
        , z = 1050
        , H = 932
        , Z = 1212
        , V = 1247
        , G = 1250
        , Q = 1262
        , q = 1050
        , K = 1330
        , Y = 1234
        , J = 1364
        , X = 1213
        , $ = 1418
        , ee = 1282
        , te = 785
        , re = 780
        , ne = 819
        , oe = 535
        , ie = 519
        , ae = 773
        , se = 764
        , ue = 588
        , ce = 766
        , le = 500
        , pe = 451
        , fe = 572
        , de = 504
        , Ae = 367
        , ge = 380
        , he = 395
        , ve = 504
        , ye = 582
        , me = 654
        , _e = 734
        , be = 767
        , we = 521
        , Te = 775
        , Ee = 799
        , Se = 971
        , xe = 629
        , ke = 813
        , Ie = 773
        , Oe = 639
        , Be = 810
        , Ce = 521
        , Me = 531
        , De = 860
        , Le = 318
        , Re = 177
        , je = 229
        , Ne = 190
        , Fe = 212
        , Pe = 30
        , We = 105
        , Ue = 213
        , ze = 107
        , He = 352
        , Ze = 184
        , Ve = 203
        , Ge = 240
        , Qe = 100
        , qe = 141
        , Ke = 118
        , Ye = 270
        , Je = 184
        , Xe = 147
        , $e = 484
        , et = 353
        , tt = 185
        , rt = 355
        , nt = 184
        , ot = 151
        , it = 298
        , at = 125
        , st = 118
        , ut = 243
        , ct = 199
        , lt = 353
        , pt = 80
        , ft = 118
        , dt = 279
        , At = 298
        , gt = 36
        , ht = 252
        , vt = 87
        , yt = 250
        , mt = 118
        , _t = 184
        , bt = 224
        , wt = 146
        , Tt = 1431
        , Et = {
            aEcrL: function (e, t) {
                return e < t
            },
            SABMP: function (e, t) {
                return e > t
            },
            bOfQU: function (e, t) {
                return e < t
            },
            uUXon: function (e, t) {
                return e | t
            },
            GirPm: function (e, t) {
                return e >> t
            },
            wsZMG: function (e, t) {
                return e | t
            },
            uKUZY: function (e, t) {
                return e & t
            },
            AFluW: function (e, t) {
                return e & t
            },
            XoHZf: function (e, t) {
                return e >> t
            },
            npUku: function (e, t) {
                return e(t)
            },
            AhrYY: kt(1258, 1311) + kt(1332, r) + kt(1266, 1138),
            VPDbw: function (e, t) {
                return e + t
            },
            ymqYH: function (e, t) {
                return e + t
            },
            mZwVe: function (e, t) {
                return e + t
            },
            HdSQB: function (e, t) {
                return e << t
            },
            TgDbm: function (e, t) {
                return e | t
            },
            kFiJR: function (e, t) {
                return e << t
            },
            ZaUsL: function (e, t) {
                return e(t)
            },
            iCuMI: function (e, t) {
                return e & t
            },
            LvgEs: kt(n, o),
            IDkdx: function (e, t) {
                return e === t
            },
            QNpig: function (e, t) {
                return e !== t
            },
            gDrEw: kt(i, a) + "ed",
            TgLDB: function (e, t) {
                return e === t
            },
            kAfZg: kt(s, 1511) + kt(u, 1451) + "]"
        }
        , St = function (e) {
            e = e[o(-227, -Re)](/\r\n/g, "\n");
            for (var t = "", r = 0; Et[o(-100, -je)](r, e[o(-Ne, -345)]); r++) {
                var n = e[o(-Fe, -359) + o(Pe, -We)](r);
                Et[o(-Ue, -je)](n, 128) ? t += String[o(-ze, -118) + o(-He, -Ze)](n) : Et[o(-Ve, -Ge)](n, 127) && Et[o(-157, -Qe)](n, 2048) ? (t += String[o(-qe, -Ke) + o(-Ye, -Je)](Et[o(-180, -Xe)](Et[o(-$e, -et)](n, 6), 192)),
                    t += String[o(-tt, -Ke) + o(-rt, -nt)](Et[o(-ot, -it)](Et[o(36, -120)](n, 63), 128))) : (t += String[o(-at, -st) + o(-ut, -nt)](Et[o(-482, -it)](Et[o(-ct, -lt)](n, 12), 224)),
                        t += String[o(-pt, -ft) + o(-dt, -nt)](Et[o(-309, -At)](Et[o(gt, -146)](Et[o(-ht, -vt)](n, 6), 63), 128)),
                        t += String[o(-yt, -mt) + o(-290, -_t)](Et[o(-bt, -298)](Et[o(-37, -wt)](n, 63), 128)))
            }
            function o(e, t) {
                return kt(t - -Tt, e)
            }
            return t
        }
        , xt = kt(c, l) + kt(1291, 1397) + kt(p, f) + kt(d, A) + kt(g, h) + kt(1156, v) + kt(y, m) + kt(_, b) + kt(1417, 1230) + "m3";
    function kt(e, t) {
        return a0_0x34ec01(e - Le, t)
    }
    console.log(kt(w, T))
    
    var It = Et[kt(w, T)],
        It='test'
        , Ot = (new Date)[kt(E, S)]()
        , Bt = Et[kt(x, 1311)]("undefined" == typeof window ? "undefined" : "object", kt(i, 1166) + "ed") ? __webpack_require__.g : window;
    Et[kt(k, I)]("object", Et[kt(O, B)]) && Bt && Bt[kt(1173, C) + "or"] && Bt[kt(M, D) + "or"][kt(L, O) + "nt"] && Bt[kt(R, j)] && (It = kt(N, F));
    var Ct = Et[kt(P, 1248)](Object[kt(W, U) + "pe"][kt(z, H) + "g"][kt(Z, V)](t), Et[kt(1218, G)]) || Et[kt(Q, 1147)](Object[kt(1259, 1260) + "pe"][kt(q, 941) + "g"][kt(Z, 1138)](t), kt(K, 1335) + kt(1229, Y));
   console.log(([Ot, It, e, Ct ? JSON[kt($, 1361) + "fy"](t) : ""][kt(ee, 1192)]("")))
    return {
        "X-s": Et[kt(J, X)]((function (e) {
            var t, r, n, o, i, a, s, u = "", c = 0;
            for (e = Et[f(te, 784)](St, e); Et[f(re, ne)](c, e[f(oe, ie)]);)
                for (var l = Et[f(ae, se)][f(611, ue)]("|"), p = 0; ;) {
                    switch (l[p++]) {
                        case "0":
                            u = Et[f(ce, 876)](Et[f(le, pe)](Et[f(fe, 654)](u, xt[f(de, Ae)](o)), xt[f(de, ge)](i)), xt[f(504, he)](a)) + xt[f(ve, 605)](s);
                            continue;
                        case "1":
                            a = Et[f(ye, me)](Et[f(864, ae)](Et[f(_e, be)](r, 15), 2), n >> 6);
                            continue;
                        case "2":
                            r = e[f(we, 609) + f(Te, 648)](c++);
                            continue;
                        case "3":
                            i = Et[f(637, 692)](Et[f(Ee, Se)](3 & t, 4), r >> 4);
                            continue;
                        case "4":
                            Et[f(te, xe)](isNaN, r) ? a = s = 64 : Et[f(ke, Ie)](isNaN, n) && (s = 64);
                            continue;
                        case "5":
                            t = e[f(we, 361) + f(775, Oe)](c++);
                            continue;
                        case "6":
                            s = Et[f(Be, 689)](n, 63);
                            continue;
                        case "7":
                            n = e[f(Ce, Me) + f(775, De)](c++);
                            continue;
                        case "8":
                            o = t >> 2;
                            continue
                    }
                    break
                }
            function f(e, t) {
                return kt(e - -551, t)
            }
            return u
        }
        ), MD5([Ot, It, e, Ct ? JSON[kt($, 1361) + "fy"](t) : ""][kt(ee, 1192)](""))),
        "X-t": Ot
    }
}

console.log(sign('/api/sns/web/v1/feed','{"source_note_id":"643a7b950000000027010ebf"}'))
// console.log( a0_0x5b83(158,1294))
// console.log(a0_0x34ec01(888, 1294))
// sYTG12ML0Y5bOiTG0jd6sjdJOBALsgsLsg9+OgOUsjc3
//s2Zvs21W1BdJ16F+02dBsB5lOiFiZj4J0Y5LsgcW02F3
// 12FLZBMbOjZU1isi1g9LOi5LsjdBslTLZBvWsB1CsBM3